微型机 与 应用 
 MICROCOMPUTER   &   ITS   APPLICATIONS 
 2000 　 Vol.19 　 No.6 　 P.51 - 53 
 
 
 
 
 基于 MS   Help   Workshop 的 资料 
 信息 查询 系统 的 实现 
 耿书文 　 刘胜富 
 摘要 ： 运用 MS   Help   Workshop 技术 与 计算机 高级 语言 相结合 研制开发 信息 资料 查询 系统 的 方法 ， 阐述 了 资料库 的 建立 和 目录 式 查询 、 关键词 查询 、 资料 全文 搜索 查询 等 查询 功能 的 技术 实现 以及 与 高级 语言 的 联接 。 
 关键词 ： MS   Help   Workshop 技术 　 资料 查询 系统 　 检索 技术 
 　 　 在 人们 的 日常 工作 中 ， 经常 要 处理 、 查阅 大量 的 文字 、 图表 资料 ， 如 行政部门 的 法律法规 和 行政 公文 处理 、 情报资料 部门 的 情报资料 管理 等等 。 这些 资料 的 特点 是 内容 广泛 、 形式各异 、 格式 纷乱 复杂 ， 很难 找出 统一 的 规律 。 这 就 给 资料库 的 建立 、 资料 查询 系统 的 计算机 实现 带来 很大 的 困难 。 
 　 　 Microsoft 公司 提供 的 Help   Workshop 是 1 个 开放式 的 软件 帮助 制作 工具 。 该 工具 应用 非常灵活 方便 ， 具有 丰富 的 帮助 制作 功能 。 软件 帮助 系统 本身 就是 一个 较 简单 的 资料 信息 查询 系统 。 笔者 经过 开发 实践 认为 ， 计算机 高级 语言 与 MS   Help   Workshop 合理 的 结合 进行 信息 资料 查询 系统 开发 ， 系统结构 简单 、 操作 灵活 ， 且 可 大大减少 编程 工作量 ， 不失为 开发 中小型 文字 、 图表 信息 资料 查询 系统 的 一种 有效 方法 。 
 1     MS   Help   Workshop 技术 简介 
 　 　 MS   Help   Workshop 是 1 个 用于 创建 系统 帮助文件 的 工具 。 通过 编辑 建立 项目 ( project ) 文件 、 目录 ( contents ) 文件 ， 将 包含 帮助 文本 内容 的 RTF 文件 、 位图文件 和 其它 源文件 联系 在 一起 ， 经 编译 生成 可 由 Windows 函数调用 执行 的 帮助文件 ( * . HLP ) 。 其中 关键技术 是 RTF 文件 的 编辑 、 RTF 文件 之间 及 目录 文件 与 RTF 文件 所 包含 的 主题 之间 如何 建立 关联 等 。 经 MS   Help   Workshop 创建 生成 的 帮助文件 具有 目录 查询 、 索引 查询 、 全文 搜索 等 功能 。 
 1.1   RTF 文本编辑 
 　 　 由于 帮助文件 需要 在 文字 内容 中 加入 一些 如 脚注 、 下划线 、 删除 线或 隐藏 文字 等 特殊 格式 ， 甚至 还 必须 能够 加入 图片 ， 因此 一般 的 文本文件 格式 ( * . TXT ) 就 无法 胜任 。 而 RTF 文件 具有 设置 不同 段落 格式 的 属性 。 因此 ， 编辑 帮助文件 文字 内容 必须 保存 为 * . RTF 文件格式 。 MS   Word 是 编辑 RTF 文件 的 最佳 工具 。 RTF 文件 的 编辑 工作 ， 按 顺序 可以 分为 如下 过程 ： 
 　 　 输入 所有 文字 → 分页 → 设置 格式 → 保存 文件 
 1.2   建立 关联 
 　 　 RTF 文件 之间 及 目录 文件 与 RTF 文件 所 包含 的 主题 ( Topic ) 之间 的 关联 是 通过 以 脚注 的 形式 加入 RTF 文件 的 关联 标记 实现 的 。 关联 标记 有 主题 ID 号 、 主题 关键词 和 标题 文字 等 几种 形式 。 目录 文件 与 RTF 文件 之间 以及 跳跃 文字 、 定义 文字 功能 通过 主题 ID 号 实现 关联 ； “ 索引 ” 功能 可 通过 主题 关键词 、 标题 文字 建立 起 索引 菜单 与 主题 文字 内容 之间 的 链接 ， 并且 主题 ID 号 、 主题 关键词 、 标题 文字 之间 也 是 相互 关联 的 。 
 2     信息 资料 查询 功能 的 实现 
 　 　 信息 资料 查询 系统 的 开发 包括 二 方面 的 工作 ： 一是 信息 资料库 的 建立 ， 二是 查询 方式 的 设计 实施 。 信息 资料库 的 建立 就是 将 录入 计算机 的 信息 资料 进行 合理 分类 ， 并 以 一定 的 格式 存放 ， 供 系统 查询 访问 。 查询 方式 的 设计 实施 就是 运用 适当 的 查询 技术 ， 设计 科学 的 查询 方式 ， 以 使 用户 能够 方便 、 灵活 、 快速 、 准确 地 进行 查询 。 查询 方式 的 设计 应 着重 考虑 系统 的 简洁性 、 可靠性 、 灵活性 和 查询 速度 。 信息 资料 查询 的 功能 包括 目录 式 查询 、 主题 关键词 查询 、 资料 全文 搜索 查询 等 几 方面 。 如何 科学合理 地 实现 这 几 方面 的 查询 功能 是 需要 深入探讨 的 问题 。 
 2.1   信息 资料库 的 建立 
 　 　 运用 MS   Help   Workshop 开发 信息 资料 查询 系统 首先 应对 信息 资料 进行 分类 ， 合理 划分 主题 ( MS   Help   Workshop 技术 以 主题 为 基本 查询 单元 ) ； 然后 将 分类 和 划分 主题 后 的 信息 资料 编辑 为 RTF 文件 ， 可以 每 1 个 主题 写成 1 个 RTF 文件 ， 也 可以 几个 主题 写成 1 个 RTF 文件 。 为了 查询 功能 的 实现 ， 在 编辑 RTF 文件 时 ， 最 关键 的 是 其中 特殊 格式 的 设置 。 不同 特殊 格式 及其 作用 、 功能 如表 1 所示 。 RTF 文件 建立 完成 后 ， 将 所有 主题 的 RTF 文件名 和 ID 号 写入 目录 文件 和 项目 文件 ， 最后 编译 形成 * . HLP 文件 ， 可 脱离 原 RTF 文件 运行 ， 具有 很 好 的 安全性 。 
 表 1     特殊 格式 的 作用 及 功能 
 特殊 格式 作用 功能 说明 
 ＃ 脚注 加入 主题 ID 号 设置 资料 主题 与 目录 ( Contents ) 文件 、 
 跳跃 文字 或 定义 文字 的 关联 
 ＄ 脚注 加入 主题 关键词 设置 资料 主题 的 关键词 ， 显示 在 索引 
 搜索 框中 ， 并 建立 索引 与 主题 间 的 关联 
 K 脚注 加入 主题 的 标题 设置 资料 主题 的 标题 名称 
 隐藏 文字 标记 链接 的 主题 
 ID 号 指定 跳跃 文字 或 定义 文字 链接 的 资料 
 主题 的 ID 号 
 双 下划线 或 删除 线 跳跃 文字 设置 转到 下 一页 面 显示 指定 资料 主题 
 下划线 定义 文字 设置 以弹 出 窗口 形式 显示 指定 资料 主题 
 特殊 格式 
 
 2.2   目录 式 查询 功能 的 实现 
 　 　 目录 式 查询 功能 是从 形式 上 模拟 人们 实际 翻阅 书籍 的 情形 。 经 适当 的 分类 后 ， 将 信息 资料 编制 目录 ， 目录 就 类似 1 本 综合性 的 书籍 ， 由篇 、 章到 节 ， 再 到 小节 ， 为 逐级 细化 的 层次结构 ， 详细 列出 了 信息 资料 的 类别 、 标题 名称 、 构成 章目 等 。 运用 MS   Help   Workshop 技术 建立 目录 文件 ， 可 逐级 编排 信息 资料 的 主 类别 、 次 类别 、 章节 、 … … 等 ， 目录 最多 可达 9 级 ， 并且 各级 目录 可任意 进行 编辑 、 移动 。 目录 文件 中 的 最后 1 级 目录 应是 信息 资料 主题 ， 这里 需要 指定 主题 的 标题 名称 、 主题 ID 号 、 主题 所在 的 HELP 文件 的 名称 和 显示 窗体 的 类型 。 MS   Help   Workshop 通过 主题 ID 号 和 HELP 文件名称 实现 最底层 目录 与 指定 资料 主题 的 关联 。 
 　 　 将 目录 文件 写入 项目 文件 ， 经 编译 完成 后 ， 在 目录 窗体 可 显示信息 资料 目录 的 内容 。 目录 可任意 打开 、 关闭 ， 操作 非常灵活 方便 、 直观 。 用户 可 根据 查询 需求 ， 对 目录 逐级 打开 ， 层层 选择 ， 直至 所 查找 信息 资料 的 主题 。 系统 通过 主题 ID 号 和 HELP 文件名称 访问 相应 的 信息 资料库 ， 并 将 指定 主题 的 内容 显示 于 指定 类型 的 窗体 中 ， 从而 实现 对 信息 资料 的 目录 式 查询 。 
 2.3   关键词 查询 
 　 　 关键词 查询 就是 对 每 一 信息 资料 主题 提取 关键词 ， 根据 用户 输入 或 选择 的 关键词 进行 信息 资料 查询 。 运用 MS   Help   Workshop 技术 可 对 每 一 信息 资料 主题 设置 1 个 或 多个 关键词 ( 关键词 长度 最长 可达 255 个字符 ) 。 具体方法 为 ， 在 RTF 文件 中以 “ K ” 脚注 文字 的 方式 给出 ， 若有 多个 关键词 ， 每个 关键词 之间 用 半角 “ ； ” 分隔 。 同时 ， 在 RTF 文件 中以 “ ＄ ” 脚注 文字 的 方式 给出 资料 主题 的 标题 名称 。 需要 说明 的 是 ， “ ＃ ” 、 “ K ” 、 “ ＄ ” 脚注 均 要 置于 资料 主题 的 开头 。 脚注 设置 完成 后 ， 经 MS   Help   Workshop 编译 ， 则 所有 给定 的 关键词 就会 列于 关键词 索引 中 ， 并且 资料 主题 关键词 、 标题 名称 和 主题 内容 之间 建立 起 了 可靠 的 关联 。 
 　 　 MS   Help   Workshop 根据 给定 的 每 一 信息 资料 主题 的 关键词 ， 建立 主题 关键词 索引 ， 并 显示 于 “ 索引 ” 窗体 中 ， 索引 中 的 每 一个 关键词 都 指向 1 个 或 几个 信息 资料 主题 。 通过 “ 索引 ” 窗体 ， 用户 可 直接 输入 关键词 ， 也 可以 从 给出 的 索引 中 选取 ， 系统 根据 用户 的 输入 或 选择 ， 依赖 资料 主题 关键词 、 标题 名称 和 主题 内容 之间 可靠 的 关联 ， 访问信息 资料库 ， 找出 所有 关键词 所 标明 的 资料 主题 ， 给出 符合要求 的 资料 主题 标题 名称 列表 ， 供 用户 进一步 选择 ， 进而 输出 选择 主题 的 内容 。 如果 系统 开发者 提取 的 主题 关键词 完善 合理 ， 关键词 查询 功能 就 可以 很 好 地 实现 。 
 2.4   资料 全文 搜索 查询 
 　 　 资料 全文 搜索 查询 功能 是 指 系统 根据 输入 的 查询 内容 对 资料库 中 的 相关 主题 进行 全文 搜索 ， 从而 找出 所有 含有 与 查询 内容 相匹配 部分 的 资料 主题 。 MS   Help   Workshop 实现 资料 全文 搜索 查询 功能 非常容易 。 在 建立 项目 文件 时 选择 “ Windows   button ” 菜单 ， 给定 窗体 类型 为 “ main ” ， 在 按钮 ( Buttons ) 设置 区 选中 按钮 “ Find ” ， 并 确认 在 ＼ Windows ＼ System ＼ 目录 中有 动态链接库 文件 ftsrch . dll 。 这样 ， 项目 文件 编译 后 ， 就 可以 实现 对 包含 在 该 项目 文件 中 的 所有 信息 资料 RTF 文件 的 全文 搜索 。 
 2.5   相关 查询 
 　 　 相关 查询 是 指 对 信息 资料 的 某些 部分 的 进一步 解释 和 相关 主题 的 查询 。 相关 查询 功能 可 采用 MS   Help   Workshop 的 跳跃 文字 和 定义 文字 技术 实现 。 具体 方式 为 ， 在 编辑 信息 资料 RTF 文件 时 ， 将 配有 相关 内容 的 部分 增加 双 下划线 或 删除 线 设置 为 跳跃 文字 ， 或 增加 下划线 设置 为 定义 文字 ， 并 在 其后 标明 相关 资料 内容 的 主题 ID 号 ( 设置 为 隐藏 文字 ) ， 由此 ， 跳跃 文字 或 定义 文字 与 相关 资料 主题 之间 使 建立 了 关联 。 
 　 　 经 MS   Help   Workshop 编译 后 ， 相关 查询 设置 完成 。 用户 查询 操作 时 ， 只 需 点击 其中 的 跳跃 文字 ( 带有 实 下划线 ) ， 系统 转到 下 一页 面 显示 相关 资料 主题 内容 ； 或 点击 其中 的 定义 文字 ( 带有 虚 下划线 ) ， 系统 以弹 出 窗口 形式 显示 相关 资料 主题 内容 。 
 3     与 高级 语言 的 联接 
 　 　 如前所述 ， 信息 资料 的 核心 查询 功能 完全 可以 运用 MS   Help   Workshop 技术 实现 ， 而 系统 其它 内容 ， 如 系统 界面 、 外部 菜单项 、 各种 格式 输出 以及 其它 的 附加 功能 均 可 由 高级 语言 ( 如 VB 、 VC 等 ) 编写 。 二者之间 的 联接 也 很 简单 ， 可以 用 Windows 提供 的 API 函数 WinHelp 来 实现 ， 即用 WinHelp 函数调用 通过 MS   Help   Workshop 制作 生成 的 信息 资料 * . HLP 文件 。 以 Visual   Basic   6.0 为例 ， WinHelp 函数 定义 语法 为 ： 
 　 　 Declare   Function   WinHelp   Lib   ″ user32 ″   Alias   ″ Win － 
 　 　 　 HelpA ″ ( ByVal   hwnd   As   Long ， ByVallpHelpFile   
 　 　 　 As   String ， ByVal   wCommand   As   Long ， ByVal 
 　 　 　 dwData   As   Long ) As   Long 
 　 　 函数 中 各 参数 的 含义 ： 
 　 　 . hwnd — — 打开 * . HLP 文件 窗口 的 句柄 ； 
 　 　 . lpHelpFile — — 打开 的 * . HLP 文件 的 名称 ； 
 　 　 . wCommand — — 打开 命令 ( 取值 可 参阅 有关 书籍 ) ； 
 　 　 . dwData — — * . HLP 文件 打开 操作 的 附加 数据 。 
 　 　 调用 的 语法 为 ： 
 　 　 Private   Sub   mnuHelp ＿ Click ( ) 
 　 　 　 RetVal ＝ WinHelp ( Forml . hwnd ， ″ c : ＼ vbbb ＼ query ＼ 
 　 　 　 　 query . hlp ″ ，   HELP ＿ INDEX ， cLng ( 0 ) ) 
 　 　 End   Sub 
 　 　 笔者 应用 MS   Help   Workshop 技术 与 Visual   Basic   6.0 相结合 成功 开发 了 “ 矿产 资源管理 法规 查询 系统 ” ， 该 系统 广泛 、 全面 收录 有关 矿产 资源管理 的 国家 和 地方 法律 、 法规 和 政策 规定 、 重要 领导 的 讲话稿 、 矿产 资源管理 典型 案例 以及 其它 有 参考价值 的 资料 ， 经过 对 这些 资料 进行 分类 和 主题 提取 ， 系统 设计 有 主控 界面 、 分类 查询 菜单 ， 实现 了 目录 查询 功能 、 索引 式 查询 功能 、 正文 关键词 查询 功能 、 法规 条文 解释 查阅 功能 以及 其它 打印 、 复制 输出 等 辅助 功能 。 其中 主控 界面 、 分类 查询 菜单 等 用 Visual   Basic   6.0 编写 ， 各种 信息 资料 查询 功能 由 MS   Help   Workshop 技术 实现 。 系统 设计 结构合理 ， 操作 简捷 灵活 ， 可靠性 高 ， 经 许多 用户 使用 ， 反映 良好 。 
 耿书文 （ 北京科技大学 资源 工程学院 100083 ） 
 刘胜富 （ 北京科技大学 资源 工程学院 100083 ） 
 参考文献 
 1 ， 陈俊源 ， 王一华 ． 活用 Visual   Basic5 ． 0 数据库 编程 ． 北京 ： 清   华 大学 出版社 ， 1998 
 2 ， 详实 翻译 组译 ． Visual   Basic   6 技术 内幕 ． 北京 ： 机械 工业 出   版社 ， 1999 
 收稿 日期 ： 1999 － 12 － 23 
