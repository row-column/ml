微型机 与 应用 
 MICROCOMPUTER   &   ITS   APPLICATIONS 
 2000   Vol.19   No.2   P.13 , 54 
 
 
 
 
 ASP 实现 主页 计数器 的 二种 方法 及其 改进 
 张子贤 
 摘   要 ：   以 二个 具体 的 程序 剖析 了 利用 ASP 技术 实现 主页 计数器 的 原理 ， 并 对 目前 的 二种 方法 进行 了 适当 的 改进 。 
 关键词 ：   主页 计数器   Active   Server   Pages   Session 组件 
 　 　 大多数 网站 的 主页 内容 少不了 3 大部件 ： 计数器 、 留言簿 和 联系方式  如 Email 地址 、 联系电话 等  。 然而 由于 计数器 标志 着 本 网站 主页 被 访问 的 频度 ， 因此 在 一个 网站 的 主页 内容 中 的 位置 显得 比后 二者 重要 ， 实现 一个 美观大方 而 又 有 个性 的 计数器 是 大多数 网站 管理员 的 所求 。 随着 微软 的 Active   Server   Pages  ASP  技术 的 出现 ， 用 ASP 技术 来 实现 主页 计数器 则 更 简单 方便 ， 而且 其 原理 也 更 容易 被 理解 ， 同时 这种 方法 能够 制作 出 非常 漂亮 的 计数器 图片 ， 还 可以 通过 各种 条件 的 设置 和 相应 的 判断 ， 经常 变换 主页 计数器 ， 让 主页 在 不同 的 时刻 或者 不同 的 用户 访问 时 显示 不同 风格 的 计数器 。 
 　 　 主页 计数器 的 显示方式 有 2 种 ： 文本 显示 和 图片 显示 。 利用 ASP 技术 实现 的 主页 计数器 完全 能够 满足 这 2 种 显示方式 ， 其 基本原理 如下 ： 通过 读取 服务器 硬盘 上 相应 的 计数器 文件 ， 把 当前 的 计 数值 在 客户端 进行 显示 ， 然后 对 计数器 文件 的 数据 进行 ＋ 1 操作 ， 再 写 回该 计数器 文件 。 在 Active   Server   Pages 中 可以 用 2 种 方法 来 实现 。 
 　 1 ． 方法 1  省略 HTML 源码  
 
 
 
 　 　 目前 的 网站 计数器 或者 大多数 ASP 教程 所 讲 的 计数器 实现 方法 大都 不会 脱离 这 二个 源程序 的 模式 ， 但是 利用 这 二种 方法 实现 的 主页 计数器 运转 起来 有 一个 很 明显 的 特点 ： 只要 指向 包含 该 主页 计数器 文件 的 程序段 的 超链 被 触发 ， 或者说 只要 该 程序段 被 执行 1 次 ， 而 不管 这 是不是 简单 的 “ 返回 主页 ” 操作 ， 计数器 文件 就 会 自己 ＋ 1 。 这样 ， 主页 的 计数器 就 会 增加 得 很快 。 然而 主页 计数器 的 初衷 并非如此 ， 因此 只要 您 尚未 离开 某个 网站 ， 您 在 其中 的 跳转 并 不能 当作 是 “ 再次 光临 ” 该 网站 。 针对 这个 问题 ， 利用 Active   Server   Pages 的 1 个 内置 的 组件 Session ， 对 上面 2 个 源程序 进行 改进 ， 解决 了 原来 程序 存在 的 缺陷 。 下面 是 改进 后 的 源程序 。 
 　 　 3 ． 方法 1 的 改进  省略 HTML 源码 
 
 
 　 　 这样 ， 通过 对 ASP 的 Session 组件 来 判断 用户 是否 仍然 在 本 网站 里 逗留 ， 从而 判断 是否 应该 给 计数器 文件 做 ＋ 1 操作 。 这 二种 改进 均 能 达到 避免 主页 计数器 盲目 ＋ 1 的 操作 。 此外 ， 如果 是 利用 第一种 方法 来 实现 主页 计数器 的话 ， 可以 把 相关 的 程序段 写到 global ． asa 里 ， 然后 直接 在 程序 中 进行 调用 （ 关于 global ． asa 的 知识点 这里 不 进行 讨论 ） 。 
 　 　 目前 ， Active   Server   Pages 技术 已经 在 绝大多数 的 网站 中 得到 广泛 地 应用 ， 如果 能 更 深入 地 钻研 这方面 的 技术 ， 相信 对 网站 的 开发 会 有 很大 的 用处 。 
 张子贤 （ 上海 同济大学 经济 与 管理 学院  200092 ） 
 收稿 日期 ： 1999 － 08 － 26 
