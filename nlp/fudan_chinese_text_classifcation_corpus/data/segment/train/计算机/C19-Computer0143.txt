计算机 应用 
 COMPUTER   APPLICATIONS 
 1999 年   第 19 卷   第 10 期   Vol.19   No.10   1999 
 
 
 
 SAS 在 Internet / Intranet 上 的 决策 支持 应用 
 关铨光 　 覃 英华 
 　 　 摘 　 要 　 本文 目的 是 利用 SAS ／ IntrNet 在 Internet /   Intranet 上 构造 决策 支持 的 Web 应用 。 
 　 　 关键词 　 SAS , Web 应用 , 决策 支持 ,   交互式 ， Internet / Intranet 
 1 　 问题 的 提出 
 　 　 SAS 系统 是 用于 严肃 数据分析 和 决策 支持 的 大型 集成式 模块化 软件包 。 SAS 系统 目前 由 三十多个 模块 及 专用 解决方案 组成 ， 功能 包括 数据库 及其 管理 ， 各类 堪称 行业标准 的 数据分析 工具 （ 如 ： 应用 统计 ， 运筹学 ， 质量 控制 ， 大型 矩阵 计算 ， 及 计量经济学 与 时间 序列 分析 等等 ） 。 随着 社会 的 发展 ， 现代 企业 越来越 注重 有效 地 利用 大量 的 历史数据 对 未来 作出 正确 的 决策 和 计划 。 而 SAS 在 分析 预测 上 具有 几十个 专业 标准 预测 模型 ， 可 根据 用户 指定 的 数据 集 自动 选择 最佳 的 预测 模型 ， 并且 提供 用户 建造 模型 的 工具 ， 其 分析 得到 的 信息 具有 高 的 置信度 ， 因此 SAS 成为 企业 理想 的 辅助 决策 软件包 之一 。 
 　 　 当前 ， SAS 软件 已经 成为 许多 统计 工作者 的 必备 的 分析 工具 。 他们 凭借 SAS 软件 作出 许多 有用 的 分析 ， 为 企业 的 决策 作出 了 巨大贡献 。 但 随着 Internet / Intanet 的 发展 需要 ， 如何 开发 在 浏览器 端 让 用户 （ 如 公司 经理   ） 实现 交互式 的 决策分析 系统 往往 使 他们 束手无策 ， 不知 如何 将 先前 作出 的 静态 的 分析 结果 转化成 交互式 地 动态 生成 。 他们 往往 只能 定期 地 将 程序 重复 运行 ， 将 分析 的 结果 （ 如 图片 和 表格 ） 静态 地 公布 ， 从而 使 决策分析 在 时间 和 费用 上 增加 支出 。 本文 主要 针对 这一 问题 ， 提出 利用 SAS 软件 最新 发布 的 中间件 SAS - IntrNet   AppServer （ 应用服务器 ） 在 浏览器 上 实现 交互式 的 决策分析 应用 。 
 　 　 本文 以 广东省 长途 电信 线路 障碍 的 一般 统计 （ 总和 和 平均数 ） 为例 说明 如何 实现 在 网页 上 动态 生成 分析 结果 。 
 2 　 SAS 的 Web 应用 技术 
 　 　 SAS / IntrNet   为 SAS   的 Web 应用 提供数据 服务 和 计算 服务 。 一方面 ， 通过 数据服务 可以 查询 数据 集 并 按 用户 请求 返回 一定 格式 的 数据 ； 另一方面 ， 通过 计算 服务 可以 使 用户 能 在 浏览器 上 对 数据 进行 分析 ， 调用 SAS 软件 的 过程 和 函数 功能 。 下 表列出 了 SAS 的 几种 不同 Web 应用 技术 ： 
 　 　 
 服 　 务名 　 　 称作 　 　 　 　 用 
 数据 
 服务 HtmSQL 在 Browser 上 动态 查询 SAS 或 RDBMS 数据 。 
 SAS / SHARE * NET 
 Driver   for   JDBC 建立 JAVA 应用程序 或 applet 通过 SAS / SHARE * NET 进行 数据 浏览 或 更新 。 
 计算 
 服务 Application   Dispatcher 利用 该 “ 应用程序 发布 机 ” 建立 Web 动态 应用 ， 使 用户 可以 通过 Web 浏览器 调用 SAS 的 程序 。 
 　 　 其中 ， 本文 推荐 使用 Application   Dispatcher （ 应用程序 发布 机 ） 机制 ， 该 机制 是 在 应用 服务器端 启动 SAS   IntranetServer ， 通过 一个 CGI 程序 Broker . exe ， 来 接收 和 解释 请求 ， 把 请求 提交 给 SAS   APPSERVER ， 由 它 调用 指定 的 SAS 程序 来 处理 请求 和 返回 处理结果 给 浏览器 端 。 通过 这种 机制 ， 实现 了 浏览器 端 交互式 的 请求 ， 并 通过 请求 的 参数 的 变化 来 调用 相应 的 SAS 分析 功能 来 使 浏览器 端的 显示 结果 动态变化 。 
 　 　 在 实际 使用 过程 中 ， 该 机制 有 以下 优点 ： 
 　 　 1 ）   编写 和 调试程序 方便 
 　 　 只 需用 一般 的 文本编辑 器 编写 * . SAS 文件 ， 编写 后 无须 编译 即可 在 浏览器 上 调用 和 调试 ， 也就是说 只 需 文本编辑 器 和 浏览器 就 可以 编写 和 调试 SAS 程序 。 
 　 　 2 ）   运行 速度 较 快 
 　 　 采用 多层 结构 ， 数据 获取 、 数据处理 都 在 中间层 的 SAS 应用服务器 上 执行 ， 处理 完 的 信息 才 返回 浏览器 端 ， 减少 了 频繁 的 网络 数据 传送 ， 提高 了 前端 的 响应速度 。 
 　 　 3 ）   原有 系统 移植 容易 
 　 　 原有 的 SAS 系统 程序 ， 无需 从 新 编写 ， 只要 增加 输出 到 虚拟 — WebOUT ， 在 网页 上 指定 BROKER 调用 的 发布 程序 ， 就 可 动态 产生 网页 。 
 　 　 4 ）   可 调用 的 发布 程序 包括 以下 类型 ： 
 　 　 .   SAS 程序 ( 以 . SAS 为 后缀名 的 外部 文件 ) 
 　 　 .   Source 文件 ( catalog . source ) 
 　 　 .   SCL   文件 ( catalog   . scl   ) 
 　 　 .   Macro 文件 ( catalog   . macro 编译 过 的 宏 ) 。 
 3 　 Web 应用 在 电信 行业 的 实例 
 　 　 下面 以 广东省 长途 电信 线路 障碍 统计分析 系统 （ 以下 简称 长线 系统 ） 为例 ， 说明 如何 用 应用程序 发布 机 建立 SAS 决策分析 的 Web 应用 。 
 3.1 　 系统 简介 
 　 　 该 系统 所 使用 的 SAS 版本 为 6.12 ， SAS / INTRNET 模块 版本 为 1.2 ， 主要 采用 SAS 的 应用程序 发布 技术 ， 浏览器 为 IE 、 NETSCAPE 。 
 3.2 系统 功能 
 　 　 包括 数据 获取 、 数据处理 和 数据 呈现 。 
 　 　 数据 获取 ： 即 建立 SAS 的 可 操作 数据源 （ ODD ） ， 可以 建立 对应 的 SAS 数据 集 或 只 建立 与源 数据 之间 的 影射 关系 。 长线 障碍 分析 系统 从省 长途 电信 线路 业务 系统 中 获取数据 。 
 　 　 数据处理 ： 对 可 操作 数据源 进行 加工 处理 ， 包括 数据 汇总 加工 、 报表 格式 变换 、 变量 分析 和 预测 。 
 　 　 数据 呈现 ： 也 就是 处理 后 的 知识化 信息 的 呈现 ( 包括 图 , 表等 ) 。 
 3.3 　 系统 逻辑 结构 
 
 3.4 　 功能 实现 
 　 　 以下 是 通过 SAS 的 应用程序 发布 机在 浏览器 上 动态 生成 报表 的 一个 实例 ， 在 浏览器 实现 对 数据表 进行 列间 运算 、 表间 合并 、 旋转 ， 生成 所 需要 的 报表 动态 地 返回 到 浏览器 端 。 其 基本 的 流程 如下 : 
 　 　 ( 1 )   页面 将 参数 传给 并 调用 broker . exe ; 
 　 　 ( 2 )   broker . exe 调用 参数 中 指定 的 sas 程序 名称 ; 
 　 　 ( 3 )   指定 的 Sas 程序 通过 页面 参数 对 特定 数据 进行 分析 处理 ; 
 　 　 ( 4 )   指定 的 Sas 程序 调用 HTML 格式 宏 ( 如 % ds2htm ) 将要 显示 的 表 转换成 html 格式 , 并 传送 浏览器 端 。 
 　 　 鉴于 编幅 ， 这里 不 给出 详细 的 编写 过程 ， 只 给出 页面 调用 broker . exe 的 html 文本 和 相应 的 说明 ( 有 兴趣 的 读者 可 来信 索取 ) : 
 < FORM   ACTION = " / cgi - bin / broker . exe " > 
 < p > 请 输入 年份 ： < INPUT   TYPE = " TEXT "   NAME = " year " 
 VALUE = " 98 "   SIZE = 1 > < / p > 
 < P > 
 请 选择 月份   ： < SELECT   NAME = " month " > 
 < OPTION   VALUE = " 1 " >   1 
 < OPTION   VALUE = " 2 "   SELECTED >   2 
 ... ( 略 ) 
 < OPTION   VALUE = " 11 " >   11 
 < OPTION   VALUE = " 12 " >   12 
 < / SELECT > 
 < / P > 
 < p > 
 < INPUT   TYPE = " HIDDEN "   NAME = " — SERVICE " 
 VALUE = " default " > 
 < INPUT   TYPE = " HIDDEN "   NAME = " — PROGRAM " 
 VALUE = " sample . gl . sas " > 
 < / p > 
 < INPUT   TYPE = " SUBMIT "   VALUE = " 确认 " > 
 < / FORM > 
 说明 : 　   broker . exe 包含 的 主要参数 为 : 
 — SERVICE :   指定 服务 的 参数 , 取值 为 ′ default ′ 时 表示 为 系统 内定 的 参数 ； 
 — PROGRAM :   指定 调用 的 SAS 程序 名称 
 4 　 结束语 
 　 　 以 同样 方式 ， 结合 SAS 的 其他 模块 （ 如 ETS , STAT , OR ， DATAMINER 等 ） 编写 的 用于 预测 、 钻取 或 多元回归 等 复杂 的 程序 ， 就 可以 在 浏览器 上 实现 动态 地 获取 专业化 的 分析 和 预测 的 结果 。 
 作者简介 ： 关铨光 　 硕士 。 主要 研究 方向 ： 数据库 技术 、 经济 信息管理 及 数理统计 。 
 覃 英华 　 主要 从事 信息 服务 系统 开发 。 
 作者 单位 ： 关铨光 　 华南理工大学 应用 数学系 　 广东 . 广州 ( 510641 ) 
 覃 英华 　 广州 泰克 计算机软件 公司 　 广东 . 广州 ( 510665 ) 
 参考文献 
 ［ 1 ］ 　 SAS   Institute   Inc .   SAS   Software   Solutions   for   theTelecommunications   Industry .   SAS   Press , 1994 
 ［ 2 ］ 　 美国 SAS 软件 研究所 上海 办事处 编 .   SAS   基础教程 .   上海 技术 文献 出版社 , 1997 
 收稿 日期 : 1999 - 04 - 16 
