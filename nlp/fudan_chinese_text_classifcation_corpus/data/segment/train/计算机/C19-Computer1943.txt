微型机 与 应用 
 MICROCOMPUTER   &   ITS   APPLICATIONS 
 1999 年   第 18 卷   第 1 期   Vol.18   No.1   1999 
 
 
 
 连载 之五 ： WebST 安全 性能 ( 二 ) 
 那日 松 
 ( 接上 期 ) 
 6.2 　 通过 WebST 安全 网关 对 Internet 用户 进行 身份验证 
 　 　 WebST 安全 网关 可以 将 采用 其他 安全 机制 的 Internet 用户 集成 到 WebST 安全 服务 中来 。 WebST 安全 网关 是 用来 与 Internet 用户 之间 动态 地 建立 起 相互信任 的 安全 会话 过程 ， 然后 将 Internet 用户 身份 映射 到 WebST 访问控制 机制 可以 管理 的 WebST 内部 网络 用户 身份 。 目前 版本 的 WebST 安全 网关 支持 与 安全套 接字 SSL 技术 的 用户 的 集成 ， 其他 安全 技术 将 在 未来 的 版本 中 加以 支持 。 
 　 　 WebST 安全 网关 与 用户 集成 得到 的 安全 性能 取决于 用户 使用 的 浏览器 的 具体 实现 。 例如 SSL 定义 中 允许 服务器 方 和 客户 方 互相 进行 身份验证 ， 但是 目前 支持 SSL 的 商业化 产品 并 不 提供 用户 — 方 的 身份验证 。 也就是说 ， 只有 用户 能够 验证 WebST 安全 网关 而 浏览器 并 不 支持 WebST 安全 网关 对 使用 浏览器 用户 的 身份 进行 直接 的 验证 。 
 　 　 在 WebST 网关 和 使用 支持 SSL ( 未来 的 版本 中将 包括 S - HTTP ) 的 浏览器 的 Internet 用户 之间 的 身份验证 ， 是 建立 在 公开密钥 加密 数字签名 和 授权 证明 之上 的 。 数字签名 工作 如下 ： 
 　 　 . 用户 产生 一段 文字 信息 然后 对 这段 文字 信息 进行 单向 不 可逆 的 变换 。 用户 再用 自己 的 秘密 密钥 对 生成 的 文字 变换 进行 加密 ， 并 将 原始 的 文字 信息 和 加密 后 的 文字 变换 结果 传送 给 指定 的 接收者 。 这 段 经过 加密 的 文字 变换 结果 就 被称作 数字签名 。 
 　 　 . 文字 信息 和 加密 后 的 文字 变换 的 接收者 将 收到 的 文字 信息 进行 同样 的 单项 不 可逆 的 变换 。 同时 也 用 发送 方 的 公开密钥 对 加密 的 文字 变换 进行 解密 。 如果 解密 后 的 文字 变换 和 接收 方 自己 产生 的 文字 变换 一致 ， 那么 接收 方 就 可以 相信 对方 的 身份 ， 因为 只有 发送 方 的 秘密 密钥 能够 产生 加密 后 的 文字 变换 。 
 　 　 . 要 向 发送 方 验证 接收 方 的 身份 ， 接收 方 根据 自己 的 密钥 创建 一个 新 的 数字签名 然后 重复 上述 过程 。 
 　 　 一旦 两个 用户 互相 验证 了 身份 ， 他们 就 可以 交换 用来 加密 他们 交换 数据 的 密钥 ( 如 DES 加密 密钥 ) 。 ( 公开密钥 加密 方法 对于 大量 的 数据 加密 来说 速度 太慢 ) 。 图 1 的 例子 表示 了 WebST 网关 B 向 浏览器 验证 自己 身份 并且 交换 密钥 的 过程 。 浏览器 应该 能够 在 类似 的 交换 过程 中 使用 它 的 公开 / 秘密 密钥 组合 对来 验证 它 的 身份 。 但是 目前 在 WEB 上 公开密钥 加密技术 ( 即 SSL ) 的 实现 中 还 没有 出现 支持 浏览器 身份验证 的 产品 。 
 
 图 1 　 身份验证 及 交换 密钥 的 过程 
 　 　 为了 利用 数字签名 ， 接收 方 必须 拥有 发送 方 的 公开密钥 。 公开密钥 是 通过 授权 证明 ( Certificates   of   Authority , CA ) 来 发布 的 ， 在 图 1 的 例子 中 ， WebST 网关 发送 包含 有 它 的 公开密钥 的 CA 给 浏览器 ( 目前 由于 只 使用 了 服务器 方 的 身份验证 ， 所以 在 CA 中 只 需要 包含 WebST 安全 网关 的 公开密钥 ) 。 这些 授权 证明 是 由 可信赖 的 第三方 生成 的 并且 经过 可信赖 的 第三方 用 秘密 密钥 “ 数字签名 ” 的 。 
 　 　 用户 的 浏览器 ( 或者 其他 客户 方 的 程序 ) 要 接收 由受 信赖 的 第三方 签发 的 正确 的 CA 就 必须 要 配置 受 信赖 的 第三方 的 公开密钥 ( 浏览器 用户 使用 配置 好受 信赖 的 第三方 公开密钥 的 浏览器 ， 来 验证 CA 中 的 受 信赖 的 第三方 的 数字签名 ) 。 如果 该 浏览器 没有 配置 受 信赖 的 第三方 的 公开密钥 ， 它 就 无法 验证 WebST 安全 网关 的 身份 。 一些 浏览器 预先 配置 有受 信赖 的 第三方 公开密钥 ， 并且 用户 不能 增加 其他 签发 CA 的 受 信赖 的 第三方 ， 这 就 限制 了 在 无关 公司 推出 的 浏览器 用户 与 公司 拥有 的 服务器之间 建立 相互信任 关系 的 能力 。 
 　 　 需要 指出 的 是 很多 现有 的 商业 浏览器 对于 用户 来说 接受 或 拒绝 一个 由 特定 第三方 数字签名 的 CA 并 不 很 方便 。 用户 可以 移 去 第三方 密钥 来 拒绝 所有 第三方 签发 的 证明 ， 但是 无法 配置 浏览器 只 拒绝 特定 的 身份证明 。 
 　 　 目前 的 基于 SSL 的 浏览器 并 不 允许 WebST 网关 验证 浏览器 用户 的 身份 ， 或者 允许 浏览器 用户 自动 接受 并 解密 有 用户 的 公开密钥 加密 的 信息 。 使用 WebST 技术 的 企业 能够 建立 一种 辅助 的 过程 ， 来 分发 CA 并且 支持 用 用户 公开密钥 加密 信息 。 
 　 　 例如 ， 一家 公用事业 公司 可以 将 它 的 公开密钥 刊登 在 它 每个 月 的 帐单 上 。 绝大多数 用户 都 会 相信 他们 每个 月 的 帐单 及其 包含 的 信息 是 确实 由该 公用事业 公司 提供 的 。 然后 用户 就 可以 使用 公司 的 公开密钥 传送 经过 加密 的 、 包含 他们 的 帐号 、 还 可能 有 他们 自己 公开密钥 的 信息 ( 利用 其他 辅助 程序 如 PGP 等 ) 。 在 公用事业 一端 的 WebST 网关 就 能够 利用 用户 的 公开密钥 对 相应 信息 进行 加密 ， 用户 通过 浏览器 将 这些 相应 信息 下载 后 就 可以 通过 其他 辅助 程序 进行 解密 。 
 　 　 在 理论 上 说 公开密钥 加密 方法 很 适合 互相 不 熟悉 的 用户 之间 建立 相互信任 关系 。 不幸 的 是 目前 CA 管理模式 和 在 商业化 浏览器 中 的 支持 程度 限制 了 它 的 效果 。 基于 支持 CA 发展 的 根本 要求 ， WebST 产品 将 开发利用 更 多 的 公开密钥 进行 身份验证 策略 等 功能 。 到 那时 ， WebST 产品 将 使 采用 支持 公开密钥 加密 的 浏览器 用户 能够 通过 WebST 网关 公开 / 秘密 密钥 组合 进行 身份验证 ， 用 获得 的 阶段性 密钥 来 与 WebST 网关 进行 加密 通信 。 一般 情况 下 WebST 网关 并 不 对 浏览器 用户 身份 进行 验证 ， 浏览器 用户 必须 在 发送 机密信息 之前 配置 他们 的 浏览器 以 验证 来自 WebST 网关 的 CA 正确性 。 
 7 　 访问控制 
 　 　 WebST 利用 了 DCE 安全性 提供 的 访问控制 。 DCE 安全性 允许 将 访问控制 表 ( ACL ) 与 WebST   Web 服务器 上 的 每 一个 对象 元素 联系 到 一起 。 一个 ACL 规定 对 对象 元素 完成 某些 操作 的 权限 。 比如 ， 如果 目标 对象 是 一个 文件 ， ACL 能 规定 对 它 进行 读 、 写 、 执行 、 删除 或 移动 的 权限 ， 同时 也 能 规定 这个 文件 在 网络 传输 时 是否 必须 加密 。 每个 用户 都 有 一组 相关 的 权限 关系 ， 并 由 DCE 安全 服务 进行 维护 ， 当 用户 登录 WebST 系统 时 ， 用户 和 其 权限 就 被 联系 起来 。 DCE 安全 服务 确保 用户 有 足够 的 权限 去 完成 对 WebST   Web 服务器 上 目标 对象 的 操作 。 
 　 　 WebST 安全 服务 允许 将 用户 组成 用户组 ， 同 组成员 具有 相同 的 权限 ， 这 大大简化 了 访问控制 特权 的 管理 。 比如 所有 “ 普通用户 ” 组 的 成员 可以 允许 读 某些 文件 ， 但 “ 管理员 ” 组 的 成员 就 可以 修改 这些 文件 。 
 　 　 Internet 用户 通过 WebST 网关 访问 企业 内部网 的 WebST ， 也 将 由 DCE 分配 权限 。 我们 提到 在 目前 应用 公开密钥 加密 的 浏览器 实现 中 并 不 支持 WebST 网关 对 用户 的 身份验证 。 因此 ， 安全策略 规定 这 类 用户 的 特权 比 Webse 用户 的 特权 要少 得 多 。 
 　 　 WebST 安全 服务器 提供 了 管理 控制台 功能 。 采用 了 稀疏 访问控制 技术 和 基于 角色 的 访问控制 技术 。 
 　 　 访问控制 规定 了 用户 对 资源 对象 的 访问 权限 。 从 数学 上 来看 ， 访问控制 是 一个 表 ， 其行 表示 资源 对象 ， 其列 表示 用户 ， 行和列 的 交叉点 表示 某个 用户 对 某项 资源 的 访问 权限 。 当 一个 网络 有 1   000 个 用户 ， 1   000 项 资源 时 ， ACL 表有 100 万项 ， 如果 管理员 1 天能 配置 1   000 项 ( 假设 他 一直 头脑清醒 ) ， 那么 完成 所有 配置 需要 3 年 时间 ! 稀疏 访问控制 技术 模仿 了 数学 上 的 稀疏 矩阵 技术 。 WebST 稀疏 访问控制 技术 的 思想 是 ： 将 资源 按树型 结构 组织 ， 就 像 WINDOWS 的 资源管理 器 一样 ： 靠近 根 的 资源 ， 能够 访问 的 人 很多 ， 但 访问 权限 很小 ； 靠近 页 的 资源 ， 能够 访问 的 人 很少 ， 但 访问 权限 很大 。 这样 就 可以 实现 授权 继承 ， 即 用户 一旦 对 某个 资源 点 具有 某种 访问 权限 ， 他 就 对 该点 以下 的 所有 点 具有 同样 的 权限 。 这种 方式 与 WINDOWS 资源管理 器中 的 共享 设置 完全 类似 。 稀疏 访问控制 技术 大大简化 了 授权 管理 的 工作量 ， 而且 保证 一致性 。 
 　 　 角色 在 戏剧 中 定义 了 具有 一定 行为规范 的 人物 ， 即 人物 和 人物 的 行为规范 ， 这 与 网络 中 基于 用户 身份 的 授权 是 类似 的 。 WebST 中 的 角色 包括 用户 或 用户组 ， 以及 这些 用户 的 访问 权限 设置 。 在 网络 中 ， 用户 的 角色 定义 可以 根据 用户 的 职称 、 职务 、 部门 等 多种 方式 定义 ， 可以 灵活 地 反映 网络管理 的 需求 。 WebST 中 ， 角色 表示 为 一把 锁 ， 将 锁 拖动 到 资源 树 的 某 一 节点 上 ， 就 自动 实现 了 可 继承 的 访问控制 ， 大大简化 了 授权 管理 和 维护 。 
 8 　 在 WebST 中 使用 防火墙 
 　 　 防火墙 是 限制 对 传统 TCP / IP 应用服务 进行 网络 访问 的 有用 工具 。 防火墙 主要 通过 协议 过滤 来 实现 访问 限制 。 当 试图 提供 从 安全 区域 到 Internet 的 单向 访问 或者 在 地理 上 隔开 的 区域 建立 加密 通道 时 ， 这种 过滤 是 非常 有用 的 。 但是 ， 这种 特性 也 限制 了 更 广泛 的 网络 使用 ， 例如 企业 的 成员 希望 能够 从 家里 获得 和 在 办公室 里 一样 的 网络 访问 服务 时 就 会 受到限制 。 
 　 　 管理 的 重点 可以 放在 对 应用 提供 的 服务 以及 该 应用 的 用户 的 分析 上 。 经过 分析 后 可以 定义 并且 配置 基于 WebST   ACL 的 安全 模型 来 限制 网络 访问 。 对 安全 问题 更加 细致 的 控制 可以 用 基于 访问控制 的 方式 直接 构造 进 应用程序 中 。 WebST 服务器 采用 了 DCE 访问控制 作为 构造 区域 安全 政策 的 模型 以及 实现 的 基础 。 
 　 　 防火墙 和 WebST 服务 的 网络 之间 关系 非常简单 。 所有 WebST / SEAT 通信 都 是 在 底层 网络 上 使用 DCE 远程 过程 调用 RPC 进行 的 。 防火墙 不 需要 担心 在 WebST 服务器 上 实施 安全 政策 ， 因为 它们 可以 被 配置 成只 通过 RPC 端口 接受 服务 请求 。 WebST 的 网络管理员 只 需要 将 精力 集中 在 建立 访问控制 列表 数据库 上 。 
 　 　 在 区域 的 过滤器 中 ， 可以 根据 不 加 任何 处理 地 通过 所有 WebST   RPC 这一 主要 规则 对 防火墙 进行 配置 。 WebST 服务器 将 严格遵守 为 网络资源 定义 的 访问 规则 ( 这 包括 在 WebST 服务器 和 SEAT 客户 方 之间 保密 数据 的 访问 规则 ) ， 严格遵守 提供 服务 的 日期 。 如果 服务器 接收 到 SEAT 客户 相应 安全级别 的 请求 ， 它 将 只 传输 被 定义 为 秘密 的 数据 。 
 　 　 如图 2 所示 ， WebST 安全 单元 是 通过 SEAT 客户 方来 访问 的 。 在 WebST   Web 服务器 和 Webse 客户 方 之间 的 通信 是 通过 DCE   RPC 进行 的 。 这 就 减少 了 防火墙 进行 干预 的 需要 。 被 配置 成 支持 远程 Webse 访问 的 防火墙 过滤 路由器 有 一条 主要 过滤 规则 就是 允许 所有 DCE   RPC 操作 通过 而 不作 任何 干预 。 
 
 
 图 2 　 防火墙 与 WebST 的 关系 
 　 　 与 WebST 服务器 同时 使用 的 WebST 防火墙 用来 保证 在 一个 WebST 安全 单元 内 的 系统 只能 通过 DEC   RPC 协议 进行 访问 。 这一 协议 保证 客户服务器 之间 的 交互 是 在 DCE 安全 服务 和 服务器 访问控制 服务 的 控制 之下 的 。 　 　 
 　 　 通过 去除 防火墙 的 许多 对 原始数据 进行 加工 的 服务 ( 包括 加密 ) ， WebST 可以 为 需要 持续 的 数据流 的 应用服务 提供方便 。 这 也 有助于 减轻 防火墙 的 负载 ， 因为 WebST 只 对 有 加密 需求 的 访问控制 进行 数据 加密 。 它 只能 对 网络 节点 之间 或者 区域 之间 所有 数据 进行 加密 ， 或者 针对 某个 TCP 端口 的 所有 数据 进行 加密 。 
 　 　 WebST 能 与 现存 的 、 允许 对 某个 TCP 端口 采用 “ 通过 ” 规则 的 防火墙 很 好 地 结合 起来 。 典型 的 WebST 安装 时 配置 防火墙 基于 下列 两点 原因 ： 
 　 　 . 对 传统 应用 的 保护 。 
 　 　 . 限制 只能 用 DCE   RPC 访问 WebST 安全 单元 。 
 　 　 WebST 服务器 和 SEAT 客户 方 负责 端到 端的 数据保护 。 
 9 　 综述 
 　 　 概括 而言 ， WebST 利用 DCE 安全性 ， 使用 基于 DES 加密 和 用户 口令 的 审核 协议 来 互相 验证 Webse 和 WebST   Web 服务器 。 DCE 安全 服务器 也 建立 一个 基于 DES 的 阶段性 的 密钥 ， 用以 加密 在 SEAT 用户 和 WebST   Web 服务器之间 传输 的 信息 。 
 　 　 安全套 接层 ( SSL — Secure   Sockets   Layer ) 是 NetScape 或 其它 软件 使用 的 安全性 机制 ， 它用 公开密钥 加密 的 数字签名 来 验证 WebST 安全 网关 ， 并且 建立 基于 DES 的 阶段性 密钥 用来 加密 在 浏览器 和 基于 SSL 服务器之间 传输 的 信息 。 WebST 网关 允许 在 DCE 所 提供 的 集中控制 的 安全 管理 下 ， 将 SSL 或 SHTTP 安全 用户 ( 以及 建立 动态 信任 关系 的 临时 用户 ) 结合 在 一起 。 表 1 为 WebST 的 安全性 说明 。 
 表 1 　 WebST 的 安全性 
 
 　 企业 内部网 的 
 WebST 安全性 SSL 通过 WebST 安全 
 网关 的 WebST 安全性 
 大量 数据 加密 DESDES ( 可用 其它 加密 方法 ) 
 身份验证 互相 之间 。 
 基于 由 DCE 安全 服务 管理 的 口令 。 仅 服务器端 。 
 基于 由 WebST 安全 网关 批准 公共 密钥 。 
 安全 和 信任 管理 安全 WebST 管理器 和 DCE 保证 所有 用户 和 服务器 采用 一致 的 安全性 。 
 企业 用户 不必 决定 信任 与否 。 安全 WebST 管理器 和 DCE 保证 Internet 用户 访问 企业 内部 网络 时 的 安全 。 
 最终用户 必须 决定 是否 信任 WebST 安全 网关 。 
 访问控制 DCE 访问控制 表 ( ACL ) 用户 被 映射 到 DCE 并且 使用 访问控制 表 ( ACL ) 
 
 
 　 　 安全 政策 可以 基于 下列 问题 ： 
 　 　 . 客户 和 服务器之间 的 传输 安全 吗 ? 
 　 　 . 研究 开发 部门 是否 应该 能够 读 这个 URL ? 
 　 　 . URL 目录 的 内容 可以 被 非 管理 职员 阅读 吗 ? 
 　 　 由于 WebST 基于 DCE 的 访问控制 可以 使 客户 方 请求 的 安全 内容 由 服务器应用程序 来 进行 评估 ， 安全 政策 以此 为 基础 建立 模型 。 访问控制 由 WebST 管理员 集中管理 。 这样 也 使 实现 企业 安全 规则 变得 容易 。 
 　 　 这一 模型 更 接近 许多 企业 试图 联入 公共 网络 时 出现 的 商业 上 的 问题 。 与此相反 ， 只 采用 防火墙 的 模型 是 将 商业 问题 映射 到 协议 、 网络 节点 间通信 以及 不同 网络 区域 之间 通信 的 加密 。 
 　 　 WebST / SEAT 应用 到 应用 模型 提供 了 建立 以 应用 为 中心 的 安全 政策 的 工具 。 这种 以 应用 为 中心 的 安全 机制 给予 安全 区域 用户 更大 的 灵活性 。 总之 ， WebST 扩大 了 安全 区域 ， 允许 利用 协议 隧道 技术 通过 像 Internet 这样 不 安全 的 区域 并 不 受限制 地 访问 WebST 服务器 。 
 　 　 在 防火墙 领域 ， WebST 能 与 防火墙 很 好 地 结合 ， 允许 配置 成 通过 防火墙 访问 WebST 服务器 。 WebST 服务器 控制 端到 端的 安全 ， 就 像 定义 访问控制 资源 和 数据 一样 。 在 这种 配置 中 ， 防火墙 通过 阻止 对 传统 应用 的 访问 ， 并且 加强 在 传统 应用领域 中 IP 协议 层 的 保密性 。   
 ( 全文完 ) 
 作者 单位 ： 北京 清华 得实 网络安全 技术 有限公司 ( 100084 ) 
 ( 收稿 日期 ： 1998 - 08 - 10 ) 
