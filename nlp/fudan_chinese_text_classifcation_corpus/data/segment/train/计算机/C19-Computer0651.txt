自动化 学报 
 ACTA   AUTOMATICA   SINICA 
 1998 年   第 24 卷   第 1 期     Vol.24     No.1   1998 
 
 
 
 不同 天气 条件 下 自然 景物 图象 的 模拟 
 王亚东 　 丁明跃 　 彭嘉雄 　 胡修林 
 关键词 　 计算机 图形学 ， 图象处理 ， 成像 模型 ， 区域 灰度 不变性 ， 图象模拟 .   
 NATURAL   SCENE   IMAGE   SIMULATION   IN   DIFFERENT 
 WEATHER   CONDITIONS 
 WANG   YADONG 　 　 DING   MINGYUE 　 　 PENG   JIAXIONG 　 　 HU   XIULIN 
 ( Institute   of   Pattern   Recognition   &   Artificial   Intelligence , Huazhong   University   
 of   Science   and   Technology , Wuhan 　 430074 ) 
 Key   words 　 Computer   graphics , image   processing , image   formation   model , region   brightness   invariant , image   simulation . 
 1 　 引言 
 　 　 模拟 不同 光照 条件 下 的 图象 可 广泛应用 于   CAD 、 飞行 模拟 、 仿真 等 技术 之中 ， 已 成为 计算机 图形学 的 一个 重要 分支 . 在 计算机 图形学 中 ， 为了 获得 较为 逼真 的 视觉效果 ， 通常 需要 对 物体 进行 明暗 处理 ， 这 通常 用 照射 模型 来 实现 ， 如   Phong 照射 模型 ［ 1 ］ 、 Torrance   Sparrow   照射 模型 以及 全局 照射 模型 等等 . 这些 模型 ， 必须 已知 光源 特性 、 物体 表面 特性 以及 观察 角 等 条件 . 对于 自然 景物 来说 ， 这些 条件 往往 难以获得 . 因此 ， 常用 的 照射 模型 不 适于 自然 景物 图象 的 模拟 . 
 　 　 本文 研究 了 自然 景物 图象 的 成像 原理 和 成像 模型 ， 详细 地 分析 了 影响 景物 成像 的 光照 因素 、 大气环境 因素 、 物体 表面 因素 以及 光学系统 成像 因素 ， 同时 提出 区域 灰度 不变性 的 概念 ， 并 证明 了 该 不变性 仅仅 取决于 物体 表面 的 反射 系统 ， 而 与 其它 因素 无关 . 因此 通过 一幅 已知 时间 、 天气 、 景物 位置 及 光学 成像 系统 等 条件 下 的 图象 ， 可以 模拟 产生 另 一种 已知 条件 下 的 图象 . 本文 对用 CCD 像机 实际 拍摄 的 在 不同 时间 、 不同 天气 等 条件 下 的 自然 景物 图象 进行 了 模拟实验 ， 其 模拟 效果 是 令人满意 的 . 
 2 　 成像 模型 
 　 　 文献 ［ 2 ］ 给出 了 一种 成像 模型 ： 图象 上任 一点 ( i , j ) 的 灰度 值   fij 和 实际 场景 中 对应点 之间 的 成像 关系 如 
 　 　 　 　 ( 1 ) 
 　 　 从 ( 1 ) 式 看出 ， 影响 景物 成像 的 因素 可 分为 四类 ： ( 1 ) 光照 因素 　 Eij ( λ ) ; ( 2 ) 大气环境 因素 　 RA ( λ ) 和 TA ( λ ) ； ( 3 ) 物体 表面 因素 　 Lij ( λ ) 和 rij ( λ ) ； ( 4 ) 光学系统 成像 因素 　 Δ λ , K1 ( λ ) , K2 , g , Rs ( λ ) , G   和   T0 ( λ ) . 这 四类 因素 是 相互 独立 的 . 
 3 　 区域 灰度 不变性 及 反射 图 
 　 　 假定 场景 中 无 幅射 源 ， 同时 假定 较 小 的 场景 区域 上 每 一点 的 照度 和 大气环境 因素 是 相同 的 ， 并 将 天气 变化 表示 为 时间 t 的 变化 ， 则 
 　 　 　 　 　 　 　 　 ( 2 ) 
 其中   为 区域 上 的 平均 照度 . 
 　 　 一般 将 太阳光 看作 白光 ， 其 光谱 分布 均匀 ， 仅仅 强度 发生变化 . 在 此 假设 下 ， E ( λ , t ) = E ( t ) 。 S ( λ ) . 同样 可以 认为 RA ( λ , t ) 和 TA ( λ , t ) 也 满足 该 假设 . 
 　 　 在 真实世界 中 ， 可以 认为   rij ( λ ) 比 O ( λ ) ， S ( λ ) ， T ( λ ) 变化 剧烈 得 多 ， 因此 
 　 　 　 　 　 　 　 　 ( 3 ) 
 令则 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 4 ) 
 其中 分别 为 区域 灰度 和 有效 反射率 的 均值 和 均 方差 . ( 4 ) 式 表明 ， 区域 内 每 一点 的 灰度 和 该 区域 内 平均 灰度 之差 与其 灰度 均 方差 之 比值 独立 于 影响 景物 成像 的 光照 因素 、 大气环境 因素 和 光学系统 成像 因素 ， 我们 称此 性质 为 区域 灰度 不变性 . 
 　 　 根据 文献 ［ 3 ］ ， 有效 反射系数   r ( i , v , n ) 与 物体 表面 方向   n 、 反射率 ρ 、 入射光 方向 i   和 观察 方向 v 有关 ， 并 可分解 为 ρ 。 R ( i , v , n ) . 设较 小 区域 上 每 一点 的 入射光 方向 和 表面 方向 是 相同 的 ， 当 观察者 距离 该 区域 很远时 ， 可以 认为 区域 上 每 一点 的 R ( i , v , n ) 均 相同 ， 则 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 5 ) 
 其中   分别 为 区域 上 反射率 的 均值 和 均 方差 . 
 　 　 定义 图象 的 反射 图则 反射 图   P   仅仅 取决于 物体 表面 的 反射率 . 设 t1 , t2 分别 为 两种 不同 的 条件 ， 根据 ( 5 ) 式 有 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 6 ) 
 ( 6 ) 式 表明 ， 另 一种 天气 条件 下 的 图象 可以 通过 反射 图 和 这种 天气 条件 下 的 区域 灰度 均值 及 均 方差 来 模拟 . 
 4 　 模拟实验 
 　 　 实验 中将 一带 有 焦距 为 50mm 镜头 的 CCD 像机 固定 . 图 1 是 不同 时间 、 不同 天气 条件 下 拍摄 同一 场景 的 实际 图象 ， 将 整幅 场景 看作 由 多个 具有 灰度 不变性 的 较 小 区域 组成 ， 如图 2 所示 .   
 　 　 实验 中 ， 将 图 1 ( a ) 作为 基准 图象 ， 而 将 图 1 ( b ) 模拟 成和图 1 ( a ) 相同 条件 下 的 图象 ， 模拟 结果 如图 3 . 为了 检验 模拟 结果 ， 将 模拟 图象 与 真实 拍摄 的 图象 进行 相减 比较 ， 图 4 是 图 3 和 图 1 ( a ) 相减 的 结果 及其 直方图 . 从图 4 中 看出 ， 模拟 图象 与 真实 拍摄 的 图象 之间 大部分 点 相差 在 10 个 灰度级 以内 ， 从 视觉效果 来看 ， 模拟 结果 是 令人满意 的 . 
 
 
 图 1 　 不同 时间 和 不同 天气 条件 下 拍摄 的 真实 图象 
 
 
 图 2 　 区域 划分 图 
 
 
 图 3 　 图 1 ( b ) 的 图象模拟 成图 1 ( a ) 条件 下 的 图象 
 
 
 图 4 　 图 3 和 图 1 ( a ) 相减 的 结果 及其 直方图 
 5 　 讨论 
 　 　 本文 能够 将 一种 成像 条件 下 的 图象 变换 成 另 一种 成像 条件 下 的 图象 ， 这是 通过 反射 图 和 该 成像 条件 下 的 区域 灰度 均值 及 均 方差 来 实现 的 ， 这种 方法 在 区域 内部 是 可行 的 ， 模拟 效果 也 很 不错 ， 但 在 区域 边缘 处 却 不 适用 ， 图 4 ( a ) 的 差 图象 也 反映 了 这 一点 . 
 　 　 区域 灰度 不变性 是 图象 的 又 一个 不变性 ， 它 反映 了 景物 的 表面 特性 ， 而 与 其它 成像 因素 无关 ， 可以 作为 图象 灰度 和 景物 对应 关系 的 一种 描述 . 
 作者 单位 ： 华中理工大学 图象识别 与 人工智能 研究所 　 武汉 　 430074 
 参考文献 
 ［ 1 ］ 　 B   T . Illumination   for   computer   generated   pictures . Commun . of   the   ACM , 1975 , 18 ： 311 - 317 . 
 ［ 2 ］ 　 Johnson   R   P . Contrast   based   edge   deteciton . Pattern   Recogniton , 1990 , 23 : 311 - 318 . 
 ［ 3 ］ 　 Nayar   S   K , Bolle   R   M . Computing   reflectance   ratios   from   an   image . Pattern   Recognition , 1993 , 26 : 1529 - 1542 . 
 收稿 日期 　 1995 - 07 - 20 
