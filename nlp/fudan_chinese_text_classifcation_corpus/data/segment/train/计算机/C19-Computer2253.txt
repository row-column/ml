计算机 应用 研究 
 APPLICATION   RESEARCH   OF   COMPUTERS 
 2000 　 Vol.17 　 No.5 　 P.1 - 3 
 
 
 
 P 公钥 随机 矩阵 及 解决 Catch22 问题 的 方案 
 彭典祥 　 李业 清 　 彭宏祥 
 摘     要     针对 保密 通信 中 存在 的 Catch22 问题 ， 论述 了 P 公钥 随机 矩阵 的 密钥 构造 特点 和 强度 ， 提出 一个 能 无条件 解决 Catch22 问题 的 密码 方案 。 
 关键词     P 公钥     随机 矩阵     Catch22 问题       字典 攻击 法 
 1     引言 
 　 　 现有 各种 密钥 在 满足 安全 要求 条件 下 ， 很难 突破 加解密 的 多项式 长度 、 随机性 及 计算 复杂度 诸 因素 互相制约 的 难题 [ 1 , 6 ] 。 P3 - 4 公钥 采用 嵌套 多函变 、 随机 扩展 多项式 、 混合 群 运算 程序 ， 给出 一个 基于 m × n ( m < < n ) 随机 矩阵 的 不定 解方程 难度 构造 的 新型 公钥 系统 [ 2 ， 3 ] 。 本文 主要 研究 应用 P 公钥 随机 矩阵 ， 提出 解决 重要 的 秘密 通信 信道 Catch22 问题 的 密码 方案 ， 为 计算机 保密 网络 的 会 话 密钥 安全 传输 及 量子 密钥 分发 传输 等 多方面 提供 可靠 的 安全 技术 保证 。 这是 密码 体制 由单 函变 向 多 函变 发展 的 重要 进展 。 
 2   Catch22 问题 
 　 　 安全性 是 密码学 研究 追求 的 目标 ， 在 保密 通信 中 一直 存在 Catch22 问题 [ ４ ] ： 保密 通信 双方 Alice 和 Bob 在 进行 保密 通信 之前 ， 他们 首先 要 获得 密钥 ， 但 获得 密钥 的 秘密 通信 中 的 安全性 不能 得到 证明 。 说 得 更 确切 一些 Alice 和 Bab 的 密钥 是 通过 某个 安全 信道 获得 ， 仍 没有 足够 证据 能够 说明 他们 所 获得 的 密钥 是 安全 的 ， 没有 充分 理由 能 说明 密钥 未 遭到 敌手 Eve 的 截击 。 任何 单钥 密码 体制 都 无法 克服 Catch   22 问题 。 
 　 　 现代 密码学 的 公钥 密码 体制 能 在 一定 程度 上 绕过 Catch   22 问题 ， 但 存在 一些 缺陷 [ 5 ] 。 这种 密码 体制 的 安全性 依赖于 相应 的 数学 问题 难解 性 。 在 公钥 密码 体制 中 通信 者 不 需要 安全 信道 ， 从 理论 上 来说 ， 由 公开密钥 获得 秘密 密钥 在 计算 上 是 不 可能 的 ， 公钥 密码 体制 中 Catch22 问题 似乎 得到 了 解决 。 
 　 　 然而 公钥 体制 存在 几个 不 安全 的 因素 ： ① 公钥 体制 计算 是 安全 的 ， 但 敌手 能 截获 密文 Y 然后 用 公开密钥 Ek   依次 加密 每一 明文 ， 直到 他 找到 一个 满足 Y = Ek ( x ) 的 x 为止 。 因此 ， 公钥 密码 体制 永远 不能 提供 无条件 的 安全性 ， 根本 上公钥 体制 没有 解决 Catch   22 问题 。 ② 公钥 体制 越来越 受到 快速 发展 的 数学 和 计算机技术 的 威胁 。 特别 是 最近 发展 的 量子 计算技术 ， 当 这种 量子 计算机 成为 现实 时 ， 公钥 密码 将 很 容易 被 破译 。 ③ 在 公钥 体制 的 实际 应用 中 ， 通信 者 的 密钥 由密钥 管理中心 管理 ， Alice 和 Bob 进行 保密 通信 之前 仍然 需要 他们 同 管理中心 保密 通信 。 基于 以上 原因 ， 公钥 体制 不能 彻底解决 Catch   22 问题 [ ４ ] 。 
 　 　 公钥 体制 普遍存在 的 有限性 和 逆向 性是 Catch22 问题 根本 所在 ： ① 有限性 是 指 类似 RSA 、 背包 、 离散 对数 、 代数 编码 等 公钥 体制 的 多项式 长度 严格 受到 单台 计算机 运算 能力 限制 ， 不能 任意 扩展 。 另一方面 这种 有限 多项式 所 能 达到 的 有限 密钥 量 却 存在 大 范围 ( 一个 地区 或 一个 国家 ) 计算机 资源 破译 危险 ( 1997 年 联机 破译 DES 即 是 一例 ) ， 这是 一种 现有 普遍 应用 的 公钥 体制 无法 解决 的 矛盾 。 ② 逆向 性是 公钥 体制 加 密钥 Ek   与 解 密钥 Em   存在 一种 非 数学 结构 关系 的 互逆 效果 。 若 信息 m 用 Ek   加密 获得 信息 密值 ， m 必定 是 Em   解译 这 一密值 的 结果 ， 密值 与 信息 可以 用 Ek   建立 对应 关系 。 通俗 地说 就是 以 “ 以其人 之道   ， 还治其人之身 ” 。 攻击者 C 为了 攻击 A 公钥 体制 ， 先发制人 采用 Ek   加密 大量 密值 ， 建立 一种 类似 “ 字典 ” 结构 的 数据库 。 只要 A 的 密值 产生 ， 就 容易 应用 这个 数据库 检索 破译 ( 字典 攻击 法 ) 。 这种 简单 而 又 有效 的 攻击 方法 ， 在 单机 加解密 有限 能力 对应 的 “ 有限 密钥 量 ” 与 联机 破译 能力 的 “ 超级 搜索 量 ” 不 对称 抗衡 情况 下 ， 是 很 容易 成功 的 。 
 3   容错 判断 理论 
 　 　 定义 1 .   设公钥 体制 f ( Ek ， Em ) 是 一次 一密 的 。 若 = Ek ( mj ) ( ∈ R 有理数 ) 称为 一个 原密值 ， Em ( Yij ) = mj 为 一个 原解 。 
 　 　 定义 2 .   在 f 体制 中 ， 若 = Ek ( mj ) + △ mj ( ∈ R ) ， 称为 一个 容错 值 ， Em ( Yij ) = m * j 为 一个 容错 解 。 
 　 　 定义 3 .   在 f 体制 中 ， A 与 B 通信 的 第 t   ......   v 回合 的 随 机密 值 是 Yt1 = Etk ( m1   )   ...... Yv1 = ( m1 ) ； 第 1 ， 2 ， ...... ,   n 回合 的 随 机密 值 是 X11 = ( m1 ) + △ m1 ， X21 = E2k ( m1 ) + △ m2 ， ...... ， Xn1 = E2k ( m1 ) + △ mn 。 则 Em ( Yt1 ) = m1 ； Em ( Yv1 ) = m1 ； Em ( X11 ) = m * 1 ； Em ( X21 ) = m * 2 ...... Em ( Xn1 ) = m * n ， 序列 ( m * 1 ...... m * n ) 含有 大部分 非 整解 。 在 这个 数据 序列 中 ， 可以 唯一 根据 △ m1 ， △ m2 ， ...... ， △ mn 的 正负 符号 判断 ， ， ...... ，   与 m1 的 大小 关系 ， 称之为 f 的 容错 判断 功能 ， 否则 为 无 容错 判断 功能 ( 假如 A 向 B 通信 ， A 依靠 容错 判断 法 确定 m * j 与 mj 大小 关系 序列 ， B 依靠 解密 获得 同一 m * j 与 mj 大小 关系 序列 ) 。 
 　 　 定义 4 .   据 定义 3 ， 1 至 n 回合 加密 容错 法 建立 的 m * j 与 mj 大小 关系 序列 ， 规定 信息 码 产生 方式 ： m * j < mj = > 0 ， m * j > mj = > 1 ， 1 至 n 回合 信息 序列 是 a = ( a1 ， a2 ， ...... ， an ) 。 ② a 二次 随机 逻辑 变换 序列 为 最后 信息 序列 ： a1 ， a1 + a2 = a * 2 ， ...... ， a * n - 1an = a * n = > ( a1 ， a * 2 ， ...... ， a * n ) 。 
 　 　 定理 1 .     若 C 不能 破译 Ek 的 加密 算子 ， 且 Ek 可以 任意 扩张 密钥 量 ， 则 定义 3 、 4 的 容错 断 方法 建立 的 秘密 通信 方式 是 安全 的 通信 方式 。 
 　 　 证明 ： 假设 A 、 B 通信 过程 中 存在 有 巨大 计算机 能力 的 攻击者 C ， 据 定义 3 ， f 是 一次 一密 体制 ， C 无法 从 固定 信息 mj 获得 固定 密值 yj ， 第一次 字典 攻击 法 失效 。 C 仍用 集中 大量 加密 mj 获得 关于 mj 的 一次 一密值 ( Y1 ， Y2 ， ...... ， Yk ) 。 因为 A 、 B 采用 定义 2 、 3 方式 通信 ， 由 假设 知道 ， Ek 扩张 到 C 计算能力 不能 穷尽 程度 ， C 对于 A 的 系列 容错 值 X11 ， X21 ， ...... ， Xn1 无法 采用 集束 密值 ( Y1 ， ...... ， Yk ) 去 鉴别 或 猜测 △ m1 ， △ m2 ， ...... ， △ mn 的 正负 符号 。 因为 有 部分 Eim ( mj ) 增加 一个 正 的 △ mj 可能 大于 Yj ， 部分 Ekm ( mj ) 增加 一个 正 的 △ mj 可能 小于 Yj ， 也 有 部分 ( mj ) 增加 一个 正 的 △ mj 可能 等于 Yj ， 的 增大 或 减小 与 Yj 增减 △ mj 无 表面 的 数学 对应 特征 ， 这样 ， C 第二次 字典 攻击 法 失败 。 C 选择 容错 方式 集束 加密 mj ， 必须 全部 3 个 方程 的 容错 值 碰巧 全部 相同 ， 才 获得 一个 容错码 。 由于 随机 方程 元素 和 △ mj 可以 任意 选择 ， 这种 相同 概率 是 极小 的 。 另外 ， 据 定义 4 二次 序列 逻辑 随机 变换 情形 ， 偶尔 获取 的 另 一个 aj 也 是 一个 未知数 ， aj 必须 代入 逻辑 变换 序列 中 才能 求出 其值 ， C 不 可能 连续 a1 ～ aj 全猜 对 。 C 第三次 字典 攻击 法 失败 。 
 　 　 由于 C 不能 破译 ( a1 ， a2 ， ...... ， an ) = ( a1 ， a * 2 ， ...... ， a * n ) ， 不 存在 C 在 A 、 B 通信 之间 进行 替换 、 非法 修改 、 窃听 等 攻击 问题 。 所以 A 、 B 之间 的 秘密 通信 方式 是 安全 通信 方式 。 证毕 。 
 　 　 定理 2 .     若 定理 1 成立 ， 则 定义 3 、 4 的 通信 方案 是 一种 无条件 解决 Catch22 问题 的 密钥 传输 方案 。 
 　 　 证明 ： 通过 3 点易证 ： ( a ) 定理 1 的 证明 ； ( b ) A 、 B 、 C 既 是 通信 者 ， 又 是 攻击者 ， 处于 相同 条件 ； ( c ) 本 方案 通信 者 之间 不 附加 任何 通信协议 。 
 4     P 公钥 随机 矩阵 
 4.1     自由 模 函数 
 　 　 定义 5 .     模 函数 F = A . Wjmodmj ， mj 是 模值 ， Wj 为 乘法 因子 。 ( mj ， Wj ∈ Z ) ， 若 mj ， Wj 任意 选择 ( 不限 mj > Wj   ) ， F 称为 自由 模 函数 。 
 　 　 定理 3 .     若 mj < wj ， 自由 模 函数 f 是 不可 逆函数 。 
 　 　 证明 ： 当 Wj < mj ， 易知 F 存在 一个 Wj 的 逆元 , 是 可逆 函数 。 当 Wj > mj 时 ， 则 Wj = ( kj . mj ) + △ Wj ， 进行 模 mj 运算 时 ( Kj . mj ) 这部分 被 扬弃 ， 不能 恢复 ， 所以 Wj 无 逆元 。 因此 Wj > mj 时 F 是 不可 逆函数 。 
 　 　 我们 知道 含有 模 变换 密钥 的 密值 具有 高度 的 离散 特性 ， 现行 普遍推广 的 RSA 和 对数 型 密钥 都 基于 “ 模 ─ 幂 ” 方式 ， P 体制 密钥 则 基于 “ 模 ─ 加 ” 方式 。 其实 前者 也 是 “ 模 ─ 加 ” 方式 ， 只不过 它 是 依靠 高次 幂模 运算 的 离散性 及大 素数 分解 的 困难性 取得 密码 难度 。 后者 依靠 连续 分解 “ 模 ─ 加 ” NP 完全 问题 的 项 的 困难性 ， 利用 自由 模 运算 不 可逆 及 多种 函数 构造 多向 复合 函数 的 破译 困难性 三 因子 取得 密码 难度 。 
 4.2     P 随机 矩阵 构造 
 　 　 定义 6 .     各种 密码 函数 在 密钥 中 能够 独立 构造 的 代数 结构 空间 叫 一次 密钥 空间 。 
 　 　 定义 7 .     在 一次 密钥 空间 代数 构造 基础 上 , 各种 密码 函数 能够 延伸 于 其它 不同 密码 函数 复合 而成 的 新 的 代数 结构 点 ， 这些 点 所 组成 的 新 的 密码 空间 称为 二次 密钥 空间 ： 
 
 　 　 现有 各种 公钥 体制 普遍 只能 构造 一次 密钥 空间 ， 未见 有 构造 二次 密钥 空间 的 研究 内容 报道 。 P 随机 矩阵 数学模型 为 m × n 矩阵 ( m < < n ) ， n 可以 任意 扩张 。 
 
 　 　 有 并行 函数 和 串行 函数 构造 矩阵 元素 2 种 方式 ( 见图 1 、 2 ) 。 
 
 图 1 并行 构造 矩阵 元素 二次 密钥 空间 示意 于 
 
 图 2 串行 构造 矩阵 元素 二次 密钥 空间 示意 于 
 　 　 图 1 二次 密钥 空间 中 b01 , b11 , ...... , bn1 为 代数 交叉 结合点 。 图 2 二次 密钥 空间 中 所有 的 点 都 为 代数 交叉 结合点 。 
 　 　 Tn 密钥 量 P ( Ek ) = d2n ， d 为 变元 x 取值 区间 上限 ， n 表示 维数 。 Tn 密钥 强度 q ( Ev ) = emj ， e 为 fj ( x ) 函数 的 参数 取值 区间 上限 ， m 为 二次 密钥 空间 代数 结构 点 数量 ， j 是 不同 函数 的 序数 。 下面 列出 3 × 12 并行 随机 加密 矩阵 程序 应用 之一 作 容错码 构造 的 一个 实例 ，   其中 
 P ( Ek ) = 1095 ， q ( Ev ) = 1088 。 
 10   DIM   D ( 13 ) 
 20   FOR   I = 1   TO   12 
 30   RANDOM 
 40   D ( I ) = RND9999 * ( - 1 ) ∧ RND2 
 50   NEXT   I 
 60   INPUT   X , Y 
 70   A = 168 * X + 60 * D ( 1 ) + 1076 * D ( 2 ) + 2033 * D ( 3 ) - 1181 * D ( 4 ) - 458 * D ( 5 ) - 2601 * D ( 6 ) + 1451 * D ( 7 ) - 108 * D 　 ( 8 ) + 3524 * D ( 9 ) - 1147 * D ( 10 ) + 2737 * D ( 11 ) - 2769 * D ( 12 ) 
 80   B = 2 * X + 8 * D ( 1 ) + 78 * D ( 2 ) + 123 * D ( 3 ) + 9 * D ( 4 ) + 26 * D ( 5 ) + 12 * D ( 6 ) + 37 * D ( 7 ) + 75 * D ( 8 ) + 67 * D ( 9 ) + 18 * D ( 10 ) +   110 * D ( 11 ) + 79 * D ( 12 ) 
 90   C = 3 * X + 12 * D ( 1 ) - 374 * D ( 2 ) - 926 * D ( 3 ) + 1262 * D ( 4 ) + 692 * D ( 5 ) + 2709 * D ( 6 ) - 1118 * D ( 7 ) + 783 * D ( 8 ) - 2921 * D ( 9 )   + 1309 * D ( 10 ) - 1747 * D ( 11 ) + 3480 * D ( 12 ) 
 100   PRINT   A ; B ; C 
 110   D ( 13 ) = RND9999 : AI = A + RND9 * D ( 13 ) * Y : BI = B + RDN5 * D ( 13 ) * Y : CI = ( - 1 ) * RND7 * D ( 13 ) * Y + C 
 120   PRINTAI ; AI ; , ; BI ; BI ; , ; CI ; CI 
 130   END 
 　 　 正 解 、 容错 值 、 容错 解 如下 ： 
 
 4.3   安全性 分析 
 　 　 命题 ： EK 加密 算子 的 二次 密钥 空间 构造 扩张 产生 的 高强度 密码 能够 抗击 现有 计算机 总和 的 破译 能力 。 
 　 　 证明 ： a . 构造 的 安全性   首先 ， A 、 B 、 C 是 一个 高维 无定 解 方程组 ， 不能 运用 解方程 方法 破译 。 其次 从 定理 3 知道 ， 自由 模 函数 fj ( x ) 构造 加密 算子 的 参数 ， 不 存在 逆元 W - j ， 所以 是 不可 解 的 。 图 1 、 2 说明 加密 算子 的 参数 子集 和 是 NP 完全 问题 结构 ， 逐一 分解 子集 和 的 参数 ， 对 fj ( x ) 进行 结构 分析 是 不 可能 的 。 另外 复合 函数 中 包含 非线性 镜象 函数 L ( x ) ， L ( x ) 和 线性 矩阵 初等变换 函数 更 增加 逐一 分解 译 构造 参数 的 难度 ， 可见 ER 构造 方式 是 安全 的 。 
 　 　 b .   Ek 解译 方式 可行性   A 、 B 、 C 的 各自 参数 子集 和 , 组成 一个 内部 二元 一次 方程组 。   方程组 形成 条件 必须 依靠 全部 fj ( x ) 解译 产生 的 同 余值 、 大 扬弃 值 Y1 ( 模 mj 的 扬弃 倍数 ) 构成 ， 这样 保证 了 全部 fj ( x ) 的 有效性 。 每个 fj ( x ) 在 代数 结构 点内 由 L ( x ) 逆解 产生 。 而 每 一个 代数 结构 点 又 由 矩阵 初等变换 求解 获得 ， 这样 保证 了 复合 函数 的 高难度 复杂性 。 Ek 解译 方式 采用 解 若干次 三元 一次方程 ， 分别 消 去 若干个 初等变换 层次 , 用 若干个 镜值 的 减法 消 去 镜象 变换 层次 , 若干个 自由 模 变换 求 出 二元 方程组 参数 ， 最后 求解 内部 方程组 获得 信息 值 , 这些 程序 都 是 并行 或 若干 层次 串行 组成 , 解译 速度 是 非常 快 的 。 
 　 　 c .   二次 密钥 强度 构造 与 现有 计算机 资源 总和 能力 权衡 对比 首先 考察 P ( Ek ) 、 q ( Ev ) ， n 可以 任意 扩张 ， Tn 是 可变 的 ， 这 与 Ev 计算 开销 无关 。 可以 制造 超 现有 计算资源 总和 能力 的 n 个 矩阵 元素 ， 抗衡 穷举 破译 和 各种 数学分析 。 Ev 是 简单 乘 、 加法 组成 的 并行 和 若干次 串行 函数 。 据 em . j 知道 , 如果 增大 参数值 或 增加 小量 代数 结构 点 , 可 获得 抗衡 上述 破译 能力 的 Ev 密码 强度 的 几何级数 的 指数 增强 ， 而 E * 计算 开销 只是 很小 的 算术级数 增加 。 现有 公钥 体制 没有 这种 有利于 E * 能力 的 权衡 对比 ， 二者 几乎 是 均衡 对比 ， 这种 情况 ， 限制 了 密钥 构造 的 任意 增强 ， 使 之 失去 了 与 “ 计算机 资源 ” 抗衡 的 条件 。 
 5   结束语 
 　 　 Catch22 问题 是 当前 计算机 密码学 的 一个 重要 难题 ， 解决 这个 问题 ， 是 信息安全 通信 一个 重要环节 。 本文 详细 论述 P 随机 矩阵 的 构造 理论 、 技术指标 及 解决 Catch22 问题 方案 ， 这些 都 易于 在 软 、 硬件 上 实现 。 应用 P 随机 矩阵 还 可以 构成 创新型 量子 密码机 的 认证 部件 ， 应用 价值 十分 重大 。 
 本 项目 获 广西 自然科学 基金 资助 ( 9811028 ) 
 彭典祥 ( 广西 武宣县 科技局     武宣   545900 ) 
 李业 清 ( 广西 计算中心     南宁   530022 ) 
 彭宏祥 ( 广西 农业 科学院     南宁   530007 ) 
 参考文献 
 1 ， 邵祖华 .   子集 和 组 的 求解 与 真分式 背包 体制 的 攻破 .   密码学 新进展 ,   北京 : 科学出版社 ,   1994 :   7 ～ 15 
 2 ， 彭宏祥 ,   彭典祥 .   P 钥 原型 及 抗击 SHORT   VECTOR 破译 算法 研究 .   广西大学 学报 ( 自然科学 版 ) ,   1996 ,   21 ( 3 ) :   224 ～ 229 
 3 ， 彭典祥 ,   李业 清 .   P3 - 4 新型 公钥 数据 加密 标准 .   通信 保密 ,   1997 ,   71 ( 3 ) : 15 ～ 20 
 4   曾贵华 ,   王新梅 .   Catch   22 问题 及其 解决方案 .   通信 保密 ,   1999 ,   78 ( 2 ) : 1 ～ 3 
 5   Differ   W . ,   Hellman   M   E .   New   Directions   in   Cryptography .   IEEE   Trans   Inform   Theory ,   1976 ,   22 :   644 ～ 654 
 6   Chor   B . ,   and   Rivest   R .   A   Knapsack - Type   Public   Key   Cryptosystem   Based   on   Arithmetic   in   Finite   Fields .   IEEE   Trans   Inform   Theory ,   1988 ,   Vol.1   T - 34 ,   ( 5 ) :   901 ～ 909 
 收稿 日期 ： 1999 - 11 - 3 
