微型机 与 应用 
 WEIXINGJI   YU   YINGYONG 
 2000 　 Vol.19 　 No.5 　 P.40 - 41 
 
 
 
 
 邮政 图像 的 预处理 
 李源  陈 淑珍 
 摘要 ： 为 实现 邮局 给 据 函件 的 自动 抄 登及 自动化 管理 ， 提出 了 “ 给 据 函件 投递 原迹 登单 系统 ” ， 着重 讨论 了 函件 图像 的 预处理 问题 。 
 关键词 ： 给 据 函件   函件 图像   彩色 模型   模板 
 　 　 邮政 是 重要 的 社会 基础设施 ， 是 大众 的 信息 命脉 之一 ， 实现 邮政 管理 信息化 和 自动化 是 当务之急 。 目前 我国 大多数 邮局 的 业务 处理 和 数据管理 还 停留 在 手工 水平 上 ， 这 大大 制约 了 邮件 处理 的 水平 和 效率 。 为 改善目前 邮局 人工 抄登 给 据 函件 ， 人工 管理 抄登 数据 的 现状 ， 本 项目组 开发 了 “ 给 据 函件 投递 原迹 登单 系统 ” 。 
 1   开发 背景 
 　 　 邮政 处理 中 ， 每 一个 邮局 都 需要 处理 给 据 函件 。 给 据 函件 指 挂号信 件 、 邮包 、 保价 函件 等 在 收寄 时 出具 收据 、 处理 时 进行 登记 、 投递 时 要求 收件人 签收 的 函件 。 给 据 函件 的 管理 较 平常 函件 更 严格 ， 操作 流程 更 复杂 ， 责任 更 重大 。 给 据 函件 的 投递 包括 以下 几个 步骤 ： 首先 核对 需要 投递 的 给 据 函件 的 数目 是否 正确 ， 然后 按 区域 抄登 每 一封 给 据 函件 ， 抄登 过程 中 需要 抄登 函件 的 号码 、 函件 的 收寄 局 、 函件 的 收件人 地址 和 姓名 ， 抄登 完毕 后 将 抄 登 的 登单 交给 投递员 进行 投递 。 
 　 　 给 据 函件 的 投递 部分 要 解决 函件 的 地址 、 姓名 、 条码 的 抄写 问题 ， 这个 问题 用 单片机 开发 是 难以解决 的 （ 代码 的 复杂性 和 速度 都 达 不到 ） ， 用 微机 开发 也 要 解决 复杂 的 图像处理 和 图像 理解 问题 。 现有 的 系统 都 没有 解决 这个 问题 ， 它们 要么 将 这个 部分 空 了 出来 ， 要么 就 要求 操作员 用 汉字 录入 的 方式 录入 地址 、 姓名 、 条码 ， 但 汉字 录入 比较慢 、 容易 出错 ， 所以 现有 系统 在 给 据 函件 的 投递 处理 上 是 一个 空白 。 本 系统 正是 针对 目前 给 据 函件 投递 登单 需要 人工 抄登 函件 的 地址 、 姓名 、 条码 以及 查询 十分 不 方便 的 情况 ， 综合 运用 图像处理 的 方法 实现 给 据 函件 的 抄 登 的 自动化 处理 ， 提高 了 登记 处理 的 速度 和 正确率 ， 极大 地 改善 了 人工 抄登 、 人工 管理 抄登 数据 的 现状 。 
 　 　 本 系统 采用 彩色 摄像机 和 视频 捕获 卡 作为 图像 的 输入 设备 ， 从 价格 因素 考虑 ， 本 系统 只能 采用 一般 分辨率 的 摄像机 作为 图像 输入 设备 ， 这样 会 导致 图像 降质 严重 ， 所以 本 系统 需对 函件 图像 进行 预处理  去除 邮编 区域 对 后继 图像处理 的 影响 。 
 2   函件 图像 中 邮政编码 的 去除 
 　 　 挂 快 函件 图像 中 ， 邮政编码 区域 的 位置 在 人 眼看 来 ， 都 呈现 红色 ， 我们 可以 利用 这个 特征 将 这些 区域 辨识 并 去除 。 处理 步骤 如下 ： 
 　 　 （ 1 ） RGB 到 HSV 模型 的 转换 
 　 　 用 计算机 来 处理 彩色 信息 ， 必须 能够 用 定量 的 方法 来 描述 彩色 信息 ， 即 建立 彩色 模型 。 根据 不同 的 应用 场合 和 侧重 角度 ， 可 将 彩色 模型 大体 分为 3 类 ： 色度学 彩色 模型 、 工业 彩色 模型 、 视觉 彩色 模型 。 一般来说 ， 色度学 彩色 模型 ， 如 XYZ ， UCS 彩色 模型 ， 偏重于 纯理论 和 计算 方面 ， 因而 有时 称为 计算 模型 。 而 工业 彩色 模型 ， 如 RGB ， CMY ， YIQ 彩色 模型 ， 主要 用于 电视 传输 及 彩色 重现 等 实际 应用 场合 ， 侧重于 用 实际 的 方法 来 复现 彩色 的 可行性 。 而 视觉 彩色 模型 ， 如 HSI ， HLS ， HSV 彩色 模型 ， 则 侧重于 用 与 人 的 视觉 相吻合 的 亮度 、 色调 和 饱和度 来 描述 色彩 信息 。 不同 的 彩色 模型 适用 于 不同 的 应用 场合 ， 这些 模型 都 可以 通过 数学方法 来 相互 转换 。 我们 采用 24 位 真彩 格式 将 彩色 摄像机 的 输入 信号 转换 为 数字信号 ， 这样 较易 得到 图像 中 每个 像素 的 RGB 分量 ， 每个 分量 占用 1 个 字节 。 但 采用 RGB 彩色 模型 不 易于 将 图像 中 的 色彩 区分 ， 如 由于 信封 背景色 的 影响 和 信封 规格 的 不同 ， 对于 不同 信封 图像 上 的 邮政编码 边框 ， 经常 呈现 橘红 、 深红 等 深浅不同 的 颜色 ， 其 RGB 分量 差别 也 比效 大 ， 且 对于 黄色 信封 而言 ， 邮政编码 边框 的 RGB 分量 与 背景 的 RGB 分量 十分 接近 ， 采用 RGB 彩色 模型 ， 很难 直接 检测 出 邮政编码 区域 。 
 　 　 分析 原因 ， RGB 彩色 模型 是从 硬件 的 角度 提出 的 ， 并 不能 很 好 地 与 人眼 的 视觉 特性 相匹配 。 人眼 的 色彩 知觉 主要 包括 3 个 要素 ， 即 色调 、 饱和度 和 亮度 。 在 本 应用 中 ， 我们 用 计算机 模拟 人眼 对 信封 图像 进行 一定 程度 的 分割 与 识别 ， 采用 视觉 彩色 模型 比较 合适 。 我们 选用 HSV （ Hue ， saturation ， value ） 彩色 模型 ， 这是 一个 6 棱椎 模型 ， 如图 1 所示 。 具体 的 转换 关系 可 参阅 文献 ［ 1 ］ 。 
 
 图 1   HSV 模型 示意图 
 　 　 将 图像 数据 从 RGB 空间 转化 到 HSV 空间 ， 色调 分量 H 作为 1 个 独立 通道 信号 被 提取 出来 ， 不再 受 与 色调 信号 无关 分量 （ 如 光照强度 ） 的 影响 。 具体 检测 中 ， H 分量 在 1 个 固定 的 范围 内 ， 即 0 ＜ H ＜ 32 ， 我们 可 利用 这个 特征 将 邮政编码 区域 检测 出来 。 
 　 　 （ 2 ） 在 H 空间 运用 模板 增强 图像 
 　 　 模板 在 图像处理 中 发挥 着 灵活多样 的 作用 。 随着 选择 的 模板 不同 ， 可 实现 图像去噪 、 边缘 检测 、 模板 匹配 、 图像增强 等 多种 功能 。 其中 ， 如何 根据 实际 应用 场合 选择 合适 的 模板 ， 就 成 了 模板 应用 的 关键 。 
 　 　 在 本 系统 中 ， 为 检测 出 邮政编码 红色 边框 ， 需在 H 参数 空间 中 确定 1 个 阈值 ， 这里 我们 选定 阈值 为 32 ， 如果 H 值 小于 等于 32 ， 我们 则 认为 该点 色调 属于 红色 区 ， 而 对于 H 值 大于 32 的 点 ， 我们 则 不予考虑 ， 对于 图 3 中 的 原始 信封 图像 ， 在 末 经过 模板 处理 之前 ， 在 H 空间 中以 32 为 阈值 ， 经过 二值化 后 的 图像 如图 4 所示 。 由于 字迹 中 经常 含有 红色 成分 ， 使 字迹 与 邮政编码 边框 混淆 。 考虑 到 邮政编码 边框 具有 水平 或 垂直 的 特征 ， 我们 构造 了 如图 2 所示 的 归一化 模板 ， 此 模板 将 对 图像 色调 在 水平 和 垂直 方向 上 予以 增强 。 
 
 图 2   归一化 模板 
 　 　 （ 3 ） 连通 域 分析 
 　 　 对于 在 H 空间 以 32 为 阈值 进行 二值化 后 的 图像 数据 ， 为 进一步 将 邮政编码 边框 和 单位地址 从 杂散 红色 信号 中 分离 ， 我们 采用 连通 域 分析方法 。 一般来说 ， 邮政编码 边框 和 单位地址 对应 于 区域 较大 的 连通 域 。 邻域 采用 四 连通 邻域 ， 即 和 （ x ， y ） 相邻 的 像素 为 （ x ＋ 1 ， y ） 、 （ x － 1 ， y ） 、 （ x ， y ＋ 1 ） 和 （ x ， y － 1 ） ， 如果 1 个 像素 和 它 的 邻域 的 灰度 相同 ， 则 认为 它们 是 属于 同一 连通 区域 ， 而 被 聚合 到 1 个 连通 域 中 ， 反之 则 认为 是 属于 另 1 个 区域 。 将 这种 聚合 过程 反复 迭代 进行 ， 直到 图像 中 的 每 1 个 像素 都 被 遍历 为止 。 
 　 　 以 这种 方法 ， 我们 遍历 整幅 图像 ， 将 其 分为 各个 不同 的 连通 域 ， 并 标以 不同 的 标号 。 根据 各个 连通 域 的 大小 、 区域 范围 、 前 景点 的 个数 的 统计 ， 我们 可以 判别 出 图像 中 有无 邮政编码 及 邮政编码 的 具体位置 。 一旦 发现 邮政编码 边框 和 单位地址 ， 我们 就 将 这个 区域 范围 （ Mind ＜ x ＜ MaxX ， Miny ＜ y ＜ MaxY ） 内 的 图像 从原 图像 中 切除 ， 排除 了 其 对 后续 处理 的 影响 。 
 3   邮政 函件 图像处理 中 的 应用 
 　 　 以下 为 上述 处理 方法 在 一封 函件 图像 运用 的 具体 示例 。 原始 文件 图像 如图 3 。 
 
 图 3   原始 信封 图像 
 　 　 模板 处理 后 的 信封 版面 如图 4 。 
 
 图 4   模板 处理 后 的 信封 版面 
 　 　 去除 邮政编码 区域 和 右下角 单位地址 区域 后 的 信封 版面 如图 5 。 
 
 图 5   去除 邮政编码 和 右下角 地址 后 的 信封 版面 
 　 　 本 系统 作为 面向 邮政局 日常 工作 业务 的 实用 邮政 给 据 函件 处理 系统 ， 己 在 一些 中小 邮局 试行 使用 ， 函件 图像 预处理 效果 和 速度 令人满意 。 
 李源 （ 武汉大学 电信 学院  430072 ） 
 陈 淑珍 （ 武汉大学 电信 学院  430072 ） 
 参考文献 
 ［ 1 ］ Robinson   G ． Color   edge   detection ． Opt ． Eng ． ， 1997 ； （ 16 ） 
 ［ 2 ］ Shiozak   A ． Edge   extraction   using   entropy   operator ．   Computer   Vision ， Graphics   and   Image   Processing ， 1986 
 ［ 3 ］ 陈武凡 ， 鲁贤庆 ． 彩色图像 边缘 检测 的 新 算法 - 广义 模糊   算子 法 ． 中国 科学 ， 1995 ； （ 2 ） 
 收稿 日期 ： 1999 － 11 － 20 
