计算机 应用 研究 
 APPLICATION   RESEARCH   OF   COMPUTERS 
 2000 　 Vol.17 　 No.2 　 P.58 - 59 
 
 
 
 基于 Web 的 组态 技术 研究 
 熊 良才 
 摘   要   介绍 了 用 Asp 技术 实现 Web 组态 功能 的 基本原理 、 步骤 和 事例 。 
 关键词   Asp   Web   数据库   报表   组态 
 1 ．   引言 
 　 　 随着 Web 技术 的 广泛应用 ， 基于 Web 的 系统 越来越 多 ， 不仅 出现 许多 类似 于 网上 购物 之类 的 管理 与 商业 方面 的 应用 ， 而且 还 出现 了 远程 测控 类 的 工业 应用 系统 。 开发人员 面临 着 用户 需求 千变万化 的 局面 ， 在 开发 本 机 应用程序 时 ， 为了 缩短 开发周期 和 提高 软件 的 灵活性 ， 往往 采用 组态 技术 来 进行 处理 。 实际上 ， 也 可以 用 组态 的 思想 来 开发 基于 Web 的 远程 应用 系统 。 
 　 　 所谓 的 组态 ( Configuration ) 技术 就是 对于 不同 但 类似 的 应用 对象 不 需要 重新 设计 和 编程 ， 只 需 根据 系统分析 ， 应用 组态 工具 进行 简单 的 配置 和 定义 或 编写 简单 的 组态 语言 ， 即可 设计 完成 一个 特定 功能 的 新 系统 或 修改 系统 的 功能 。 
 　 　 组态 技术 的 应用 极大 地方 便 了 软件 开发人员 的 工作 ， 同时 ， 也 为 用户 将来 自行 更改 程序 功能 等 操作 提供 了 有力 的 保障 。 本文 以 开发 基于 Web 的 状态 监测 与 诊断系统 为 背景 ， 论述 利用 Asp 进行 组态 的 基本原理 、 基本 步骤 。 最后 ， 给出 实现 报表 组态 的 基本 方法 。 
 2   Asp 及其 实现 组态 ( Configuration ) 技术 的 基本原理 
 2.1   Asp 简介 
 　 　 Asp ( Active   Server   Pages ) 是 一项 由 微软 开发 的 服务器端 技术 。 它 与 客户机 方 处理 之 不同 在于 ： 在 Web 页面 开发 过程 中 ， 客户机 方 处理 有 一个 严重 的 局限性 ， 即 要求 Web 浏览器 必须 支持 在 Web 页面 中 调用 脚本语言 的 功能 。 由于 Asp 中 的 命令 和 嵌入 的 一些 脚本语言 如 VBScript 或 JavaScript 都 是 由 服务器 来 解释 执行 的 ， 并 将 执行 产生 的 动态 Web 页面 以 标准 的 HTML 格式 返回 到 浏览器 ， 所以 ， Asp 消除 了 在 Web 开发 过程 中 对于 Web 浏览器 的 依赖性 。 Asp 模型 可以 用图 1 表示 。 
 
 图 1 　 Asp 模型 
 2.2   Asp 实现 组态 技术 的 基本原理 
 　 　 基于 Web 的 组态 技术 ， 按 组态 的 要求 不同 ， 可以 分为 服务器端 组态 技术 和 客户端 组态 技术 两种 形式 。 两种 组态 技术 各有特点 ， 组态 的 方法 也 不尽相同 。 
 　 　 服务器端 的 组态 方法 是 在 服务器端 由 网络管理 人员 进行 组态 的 一种 方法 。 网络管理 人员 根据 系统 运行 的 实际 情况 和 系统 操作 使用 人员 ( 用户 ) 的 要求 ， 启动 本 机组 态 程序 或 组态 工具 进行 配置 ， 生成 需要 的 Web 动态 页面 程序 。 这种 方法 实质 上 是 一种 本地 组态 的 方法 。 它 能 在 一定 的 程度 上 提高 系统 的 开发 速度 ， 改善 系统 的 灵活性 ， 但 不能 让 用户 按 各自 的 要求 在 较大 的 范围 内 自由 组态 。 
 　 　 客户端 组态 技术 是 用户 在 客户端 通过 浏览器 自由 进行 组态 的 一种 组态 技术 。 客户 在 需要 进行 组态 时 ， 通过 Web 页面 上 的 组态 设置 进入 系统 组态 页面 ， 用户 按 组态 页面 上 的 提示 ， 输入 相应 的 组态 参数 ， 当 用户 提交 这些 参数 后 ， 系统 组态 的 任务 就 完成 。 这种 方法 实质 上 也 是 通过 在 远端 更改 系统 组态 文件 的 方式 实现 的 。 因此 ， 客户端 组态 技术 是 一种 应该 予以 采用 的 技术 。 
 　 　 Asp 作为 一种 可以 产生 和 执行 动态 的 、 交互式 、 高效率 的 Web 服务器应用程序 的 工具 ， 它 的 一些 特点 特别 适合 于 用来 开发 基于 Web 的 组态 系统 。 具体表现 在 如下 几个 方面 ： 
 　 　 ● 文件 包含 
 　 　 在 不同 的 . asp 文件 中 可能 会 有 一些 完全相同 的 部分 ， 如 函数 、 过程 等 。 为了 减少 编程 工作量 ， 往往 将 这些 部分 放在 一个 文件 内 。 当 . asp 文件 要 使用 这些 函数 或子 过程 时 ， 可以 用 Include 将 它 包含 进来 。 
 　 　 ● 内置 对象 
 　 　 Asp 提供 了 五个 内置 对象 ， 即 Response ,   Request ,   Server ,   Session ,   Application 。 其中 ， Request 对象连接 着 Web 客户机 程序 和 Web 服务器 。 通过 这一 连接 ， 可以 从 HTTP   QueryString 、 HTTP   Request 体中 的 窗体 数据 、 HTTP   Cookies 和 预定 的 ServerVariables 中 获取信息 流 ， 通常 用于 获取 用户 信息 ； Response 对象 用于 管理 服务器 和 客户机 之间 的 交互 操作 ， 最 重要 的 方法 是 Write 方法 ， 它 向 指向 客户机 的 HTML 输出 流中 写入 数据 。 用 Response ,   Request 两个 对象 可以 方便 地 实现 客户端 与 服务器之间 的 信息 传递 和 交换 。 
 　 　 ● 服务器 组件 
 　 　 Asp 支持 COM ( Component   Object   Model ) 技术 ， 在 Asp 中 带有 几个 公共 组件 ， 用户 可以 自由 使用 。 其中 ， 最 著名 的 组件 有 数据 访问 组件 ADO 和 文件 访问 组件 FileSystemObject 。 ADO 支持 对 任意 ODBC 数据源 的 操作 ， 对 数据库 的 访问 和 操作 简便 。 FileSystemObject 支持 对 文本文件 的 读写操作 。 
 　 　 因此 ， 用 Asp 进行 组态 ， 可以 利用 文件 包含 的 特性 将 公共 的 功能 和 操作 以 子函数 或子 过程 的 形式 保存 在 一个 文本文件 内 ， 然后 ， 可 在 组态 文件 中 ， 将 包含 有 函数 或 过程 的 文件 包含 进去 ； 利用 内置 对象 可以 很 方便 地 实现 客户 与 服务器进行 信息 交换 ， 使得 用户 的 组态 信息 易于 获取 和 处理 ； 利用 ADO 组件 可以 方便 地 提取 数据库 基本操作 ， 生成 基本 的 数据库 操作 函数 ， 并 将 其 标准化 ， 有利于 实现 数据库 操作 的 组态 ； 利用 FileSystemObject 组件 可以 对 文本文件 进行 读写操作 ， 有利于 组态 文件 的 生成 与 修改 。 
 　 　 用 Asp 实现 组态 的 基本原理 和 基本 过程 可以 用图 2 予以 表示 。 
 
 图 2 　 用 Asp 组态 原理 与 基本 过程 框图 
 3   基于 Web 组态 程序设计 步骤 
 　 　 设计 一个 基于 Web 的 组态 程序 ， 一般 有 如下 几个 步骤 。 
 　 　 第一步 ： 设计 用户 请求 页面 。 在 设计 用户 请求 页面 时 ， 分清 系统 组态 的 类型 ， 并 将 其 罗列 在 页面 中 ， 供 用户 选择 。 同时 ， 设计 用户 身份验证 与 组态 权限 的 确认 程序 ， 以 保证 只有 拥有 组态 权限 的 用户 才能 使用 组态 功能 。 验证 合格 后 ， 向 服务器发送 组态 请求 信息 ， 启动 服务器 动态 生成 组态 页面 程序 。 
 　 　 第二步 ： 设计 服务器 动态 生成 组态 页面 程序 。 该 程序 在 接收 用户 组态 请求 后 ， 按 组态 的 类型 不同 动态 返回 不同 的 组态 页面 ， 以便 向 用户 提供 填写 组态 参数 的 表单 等 。 
 　 　 第三步 ： 设计 组态 文件 生成 程序 。 该 程序 用于 接收 用户 组态 信息 ， 并 按 组态 信息 动态 生成 组态 文件 。 在 设计 前 ， 对系统 需要 组态 的 基本操作 予以 提炼 ， 形成 基本 的 一系列 标准 函数 或 过程 ， 放在 一个 文本文件 中 。 这是 组态 程序设计 好坏 的 关键所在 。 
 　 　 第四步 ： 设计 组态 文件 管理程序 。 该 程序 的 目的 在于 管理 组态 文件 ， 以 避免 组态 文件 过多 。 有 管理 组态 权限 的 用户 发 管理文件 请求 后 ， 系统 提供 文件 管理 操作 。 用户 可以 选择 要 删除 的 组态 文件 进行 删除 ， 以 保证 组态 文件 的 数量 适当 。 
 4   事例 
 　 　 作者 在 “ 热轧 机状态 监测 与 故障诊断 系统 ” 的 研制 过程 中 ， 完成 了 一套 基于 Web 的 组态 系统 。 现将 其中 的 故障 报表 组态 的 设计 方法 作 一个 简单 的 介绍 。 
 
 　 　 当 用户 进入 报表 组态 页面 时 ， 有关 轧机 故障 信息 的 所有 表及 各表中 字 段 及其 含义 用 Asp 列出 ， 在 各表及 字 段 旁 还有 复选 控件 用于 选中 表与 字 段 。 用户 选择 表名 和 字 段 ， 并 输入 条件 和 排序 方式 后 ， 按 “ 下 一步 ” 按钮 ， 完成 对 报表 的 查询 语句 进行 组态 ， 并 进入 报表 格式 组态 页面 。 用户 可 输入 报表 标题 、 字体 和 “ 制表 日期 ” 、 “ 制表 人 ” ， 选择 报表 排版 方式 ( 如 是否 分页 、 是 横排 还是 竖排 等 ) 。 当 用户 组态 完成 后 ， 可以 选择 保存 组态 的 文件名 进行 保存 ， 以便 以后 使用 。 通过 这种 方式 ， 任何 有 组态 权限 的 客户 都 可 在 远端 ( 客户端 ) 对 报表 的 形式 及 内容 进行 自由 组态 。 具有 组态 文件 管理权限 的 客户 还 可 从 远端 对 废弃 的 组态 文件 进行 删除 等 管理 操作 ， 以免 组态 文件 过多 。 
 5   结束语 
 　 　 用 Asp 实现 基于 Web 的 组态 技术 ， 在 原理 上 易于 理解 ； 在 实现 方法 上 简单 、 直观 ； 并且 实现 组态 的 效果 比较满意 。 由于 目前 Asp 只 适应 于 部分 Web 服务器 ， 其 应用 范围 受到 一些 限制 ， 但 文中 关于 基于 Web 的 组态 技术 的 基本思路 是 值得 借鉴 的 。 
 本文 得到 国家 “ 九五 ” 攀登 预选 项目 资助 ( 编号 ： PD9521908 ) 
 熊 良才 （ 华中理工大学 机械 学院 信息 所   武汉   430074 ） 
 参考文献 
 1 ， 周治平 .   ADO 数据 存取 技术 .   计算机 应用 ,   Vol.19 .   No.7 
 收稿 日期 ： 1999 年 9 月 13 日 
