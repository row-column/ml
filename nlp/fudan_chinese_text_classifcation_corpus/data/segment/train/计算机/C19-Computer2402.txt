计算机 研究 与 发展 
 JOURNAL   OF   COMPUTER   RESEARCH   AND   DEVELOPMENT 
 1999 年 　 第 36 卷 　 第 10 期 　 Vol.36 　 No.10 　 1999 
 
 
 
 FCT 网络 的 并发 错误 检测 结构 
 陈禾 　 毛志刚 　 叶以 正 
 　 　 摘 　 要 　 文中 提出 了 一种 快速 离散 余弦 变换 ( FCT ) 电路 的 并发 错误 检测 ( CED ) 结构 . 为了 达到 100% 的 故障 覆盖率 ， FCT 采用 基于 第 3 类 离散 余弦 变换 的 B . G . Lee 算法 蝶型 结构 实现 . 检测 采用 的 方法 是 基于 算法 的 并发 错误 检测 容错 方法 ， 因为 基于 算法 的 容错 ( ABFT ) 技术 的 硬件 冗余 量 较 少 . 对 所 提出 的 结构 ， 文中 证明 了 其 100% 的 故障 检测 能力 . 但 在 实际 应用 中 ， 由于 有限 字长 效应 会 带来 误差 ， 因此 文中 分析 了 有限 字长 效应 对系统 的 吞吐量 及 故障 覆盖率 的 影响 ， 并 给出 了 结论 . 
 　 　 关键词 　 快速 离散 余弦 变换 ， 并发 错误 检测 ， 基于 算法 的 容错 技术 ， 吞吐量 ,   故障 覆盖率 
 　 　 中图法 分类号 　 TP306 
 A   CONCURRENT   ERROR   DETECTION   SCHEME 
 FOR   FCT   NETWORKS 
 CHEN   He ,   MAO   Zhi - Gang ,   and   YE   Yi - Zheng 
 ( Microelectronics   Center ,   Harbin   Institute   of   Technology ,   Harbin   150001 ) 
 　 　 Abstract 　 A   concurrent   error   detection ( CED )   design   is   proposed   for   fast   discrete   cosine   transform ( FCT ) .   To   achieve   the   goal   of   100   percent   fault   coverage ,   FCT   is   realized   by   using   a   butterfly   architecture   of   the   B . G . Lee   fast   algorithm   based   on   DCT - III .   Algorithm - based   fault   tolerance ( ABFT )   is   used   for   error   detection   because   ABFT   is   a   low - cost   system - level   concurrent   error   detection   and   fault   location   scheme .   The   error   detection   capability   of   this   scheme   is   analyzed .   When   the   FCT   is   implemented   with   hardware ,   errors   due   to   finite   word   length   is   unavoidable .   So   the   influence   of   large   truncation   errors   on   the   throughput   and   fault   coverage   is   discussed   and   a   conclusion   is   obtained . 
 　 　 Key   words 　 fast   discrete   cosine   transform ,   concurrent   error   detection ,   algorithm - based   fault   tolerance ,   throughput ,   fault   coverage 
 1 　 引言 
 　 　 离散 余弦 变换 ( DCT ) 提出 以来 ， 发展 很快 ， 目前 FCT 已 被 广泛应用 在 数字 信号处理 中 ， 特别 是 语音 及 图像 数据压缩 、 滤波 、 通信 系统 等 领域 . VLSI 技术 的 发展 为 FCT 有效 地 实现 提供 了 条件 . 但是 大量 处理单元 集成 在 同一 芯片 上来 完成 高速 计算 ， 单元 中 的 故障 将会 影响 整个 系统 的 工作 . 因此 为了 保证系统 正常 工作 ， 在 计算 中 考虑 容错 是 必要 的 . 本文 提出 了 一种 基于 算法 的 FCT 并发 错误 检测 系统 ， FCT 结构 采用 B . G . Lee 算法 蝶型 结构 ［ 1 ］ . 采用 基于 算法 的 容错 （ ABFT ） 技术 是因为 ABFT 技术 是 一种 利用 系统 的 结构 特性 实现 容错 的 低 耗费 的 系统 容错 技术 ， 此 技术 的 硬件 冗余 量 较 少 . 
 　 　 在 过去 几年 里 ， 人们 利用 基于 算法 的 容错 思想 提出 了 几种 快速 傅立叶 变换 ( FFT ) 并发 错误 检测 方案 ［ 2 ～ 4 ］ . 由于 FCT 蝶型 结构 不如 FFT 规则 ， 误差 分析 理论 发展 不 完善 ， 因此 还 没有 人 提出 过 关于 FCT 的 基于 算法 的 容错 结构 . 本文 是 在 分析 几种 FFT 的 CED 设计 后 ， 根据 FCT 结构 的 特点 提出 了 FCT 网络 的 CED 设计 . 
 2 　 基于 B . G . Lee 算法 的 FCT 结构 及 故障 模型 
 2.1 　 基于 B . G . Lee 算法 的 FCT 结构 
 　 　 设 数据 序列 x ( n ) ,   n = 0 , 1 , … N - 1 ,   则 x ( n ) 的 DCT 定义 为 
 
 ( 1 ) 
 在 这里 ， ， x ( k ) 是 第 k 个 DCT 系数 . 
 　 　 逆 离散 余弦 变换 （ IDCT ） 定义 为 
 
 ( 2 ) 
 　 　 为了 有效 地 计算 DCT ， 人们 提出 了 许多 快速 算法 ， 其中 B . G . Lee 算法 为 有 代表性 的 快速 算法 之一 . 若 不 考虑 比例 因子 ε ( k ) ， 则 基于 B . G . Lee 算法 的 8 点 FCT 结构 框图 如图 1 所示 . 
 
 
 ( a ) 系统 框图 
 
 ( b ) 蝶形 单元 
 图 1   基于 B . G . Lee 算法 的 8 点 FCT 系统 框图 
 　 　 如图 1 所示 ， 对于 N 点 FCT 网络 可 分为 v + log2N - 1 级 ( N = 2v ) 、 v 级蝶型 运算 、 log2N - 1 级 加法 运算 . 本文 将 以 8 点 FCT 为例 进行 有关 论证 ， 但 对 N 点 FCT 同样 适用 . 从图 1 中 可 看出 ， 网络 中有 两种 运算 单元 ， 一种 是 后 加法 运算 单元 （ 以 + 表示 ） ， 一种 是 蝶型 运算 单元 （ 以 Ci 表示 ） . 蝶型 运算 单元 结构 见图 1 ( b ) ， 设 输入 为 a ， b ， 输出 为 c ， d ， 则 蝶型 运算 单元 的 计算 为 
 c = a + b 
 d = ( a - b ) × Ck 
 其中 
 　 　 　 
 2.2 　 故障 模型 
 　 　 对 基于 单元 的 VLSI 技术 来说 ， 传统 的 门级 故障 模型 由于 处理 困难 、 精确性 差 已 不再 适用 . 在 这 篇文章 中 我们 采用 模块 级 故障 模型 ［ 2 ］ ， 这样 一个 蝶型 单元 中有 9 种 故障 ， 其 故障 模型 见图 1 ( b ) . 图中 9 种 故障 人为 分为 4 个 子集 ： { 1 } 、 { 2 } 、 { 3 、 6 、 8 } 、 { 4 、 5 、 7 、 9 } . 对于 后 两个 故障 集 ， 从蝶型 运算 结果 看 ， 我们 不能 区分 任意 两个 故障 ， 例如 ， 对 减法 和 乘法 运算 我们 有 如下 关系式 ： p4 = ( p7 - p9 ) × p5 , 其中 pi 为 输入 / 输出 数据 端 ， 对 由 p7 ， p9 ， p5 中任 一端 引起 的 故障 ， 通过 运算 最终 可 导致 端 p4 有 故障 . 因此 ， 对 每 一蝶型 模块 我们 只 需 考虑 4 个 故障 { 1 } 、 { 2 } 、 { 3 } 、 { 4 } ， 我们 用 表示 FCT 网络 中 第 i 级 第 j 个 输入 端的 故障 . 将个 加法 模块 及 2log2N 个蝶型 模块 放在 一起 构成 FCT 网络 ， 我们 只 需 考虑 每个 蝶型 模块 及 加法 模块 的 输入 、 输出 故障 ， 即到 ， j = 0 , 1 … 7 . 
 3 　 FCT 网络 的 并发 错误 检测 系统 （ concurrent   error   detection ， CED ) 
 3.1 　 FCT 网络 的 CED 容错 系统 设计 
 　 　 在 这节 将 讨论 基于 B . G . Lee 算法 的 FCT 并发 错误 检测 结构 . 我们 的 目标 是 用 较 少 冗余 获得 具有 容错 能力 的 FCT 结构 . 1984 年 Wang 将 离散 余弦 变换 分为 4 类 ［ 5 ］ ， 对于 DCT - Ⅲ ， 忽略 比例 因子 ， 则 
 
 ( 3 ) 
 
 ( 4 ) 
 因而 有 
 
 ( 5 ) 
 　 　 用式 ( 5 ) 通过 将 x ( 0 ) 与 输出 校验 和 比较 ， 可 建立 一个 简单 的 故障 检测 结构 ， 见图 2 . 
 
 
 图 2   基于 Lee 算法 的 8 点 DCT - Ⅲ 的 CED 系统 框图 
 　 　 但经 计算 在 此 模型 中有 59% 的 故障 检测 不到 ， 因为 对于 DCT - Ⅲ 其蝶型 关系式 为 
 
 则 在 b 端 发生 的 错误 ， 校验 和 检测 不到 ， 因而 此 故障 是 不可 测 的 . 为此 我们 选用 DCT - Ⅱ 算法 结构 ， 对于 DCT - Ⅱ 忽略 比例 因子 ， 则 有 
 
 ( 6 ) 
 
 ( 7 ) 
 由此 公式 可 得 
 
 ( 8 ) 
 用式 ( 8 ) 我们 可 构造 DCT - Ⅱ 网络 的 CED 系统 ， 见图 3 . 由图 3 可见 ， 此 CED 系统 是 在 原 无 容错 系统 的 输出 端 加上 译码 乘法器 、 输出 校验 和 加法器 及 TSC 比较 器 . x ( 0 ) 端 加上 一个 延迟 是 为了 保持 时间 上 的 一致性 . 
 
 
 图 3   基于 DCT - Ⅱ 的 CED 系统 框图 
 3.2 　 CED 系统故障 检测 能力 分析 
 　 　 我们 定义 由 发生 在 FCT 网络 中 第 i 级 的 第 j 个 输入 端的 一个 错误 引起 的 、 在 译码 乘法器 之前 的 第 k 个 输出 端 得到 的 增益 为 GK ( ) ［ 2 ］ ， 即 当 第 i 级 的 第 j 输入 端为 1 ， 其它 输入 端为 0 时 ， 在 译码 乘法器 前 第 k 个 输出 端 得到 的 结果 ， 例如 : 
 　 
 　 　 让 我们 定义 e 为 故障 引起 的 错误 . 因 校验 和 加法器 的 输出 为 ， 对 e ≠ 0 , 如果 , 则 ， 说明 故障 是 不可 测 的 . 因此 我们 必须 保证 任一 故障 将 引起 . 对于 e ≠ 0 , 设 ， 若 保证 所有 故障 可测 ， 则 . 
 　 　 在 本文 中 ， 为了 证明 方便 ， 我们 多用 三位 二进制 表示 数据 ， 例如 i 用 s1s2s3 表示 ， j 用 d1d2d3 表示 ， 则 可 表示 为 . 
 　 　 引理 1 .   
 　 　 证明 .   
 　 　 引理 2 .   3 < i < 6 时 ， 
 　 　 证明 .   从图 3 中经 逐级 推导 可 得出 
 　 　 由 引理 1 知 ， 所以 ， 因而 
 　 　 引理 3 .   i ≤ 3 时 ， 
 　 　 证明 .   从图 3 中 可 得出 
 　 　 　 由于 对于 i ≤ 3 各级 为 规则 蝶型 结构 ， 因此 推广 到 一般 情况 ， 对于 i ≤ 3 有 
 
 　 　 　 其中 
 　 　 　 当 d3 = 0 时 ， 由 引理 1 、 2 可知 ， 
 　 　 　 当 d3 = 1 时 ， 如果 我们 将 及 展开 ， 根据 引理 1 、 2 则 很 容易 证明 任意 . 
 　 　 　 因此 对于 i ≤ 3 ， . 
 　 　 定理 1 .   如果 FCT 网络 内有 任一 故障 、 任一 译码 乘法器 有 故障 或 校验 和 加法器 的 任一 输出 端 有 故障 时 ， 基于 式 ( 8 ) 的 CED 设计 可 检测 出由 这些 故障 引起 的 逻辑 错误 . 
         证明 .   由 引理 1 、 2 、 3 我们 可知 ， 对于 FCT 网络 内部 的 任一 故障 ， 本 系统 均 可 检测 出来 . 而 对于 发生 在 译码器 及 校验 和 加法器 输出 端的 任一 故障 ， 均 可 由 TSC 比较 器 检测 出来 . 因此 在 理论 上 ， 此 CED 系统 可 达到 100% 的 故障 覆盖率 . 
 3.3 　 CED 系统 的 硬件 冗余 分析 
 　 　 对于 N 点 FCT ， 其实 数 运算量 为 
 　 　 　 乘法 ： M = N / 2log2N ；   加法 ： A = 3N / 2log2N - N + 1 . 
 因此 与 无 容错 系统 相比 ， 对于 乘法 运算 冗余度 为 ， 对于 加法 运算 冗余度 为 因为 加法 的 硬件 复杂度 较 乘法 硬件 复杂度 小得多 ， 因此 系统 的 硬件 冗余 只 考虑 乘法 硬件 冗余度 即可 ， 即 
 　 　 本 系统 因 译码 乘法器 及 校验 计算 与 FCT 网络 计算 不 在 同一 通路 上 ， 因此 对 FCT 计算 来说 无 时间 上 的 冗余 . 但本 系统 有 一级 乘法 及 三级 加法 的 故障 延时 ， 因此 传播 故障 检测 信号 的 延时 为   TM + 3TA ， 其中 TM 与 TA 分别 为 乘法 及 加法 运算 时间 . 
 4 　 截断误差 处理 
 　 　 在 FCT 网络 实际 应用 中 ， 由于 有限 字长 效应 ， 会 带来 误差 ， 由于 此 误差 的 引入 ， 当 FCT 网络 无 错误 时 ， TSC 比较 器 的 两个 输入 也 可能 不 相等 . 为了 解决 此 问题 ， 我们 允许 TSC 比较 器 的 两个 输入 端 有 一 偏差 η . 当 TSC 比较 器 的 两个 输入 端的 差 大于 η 时 ， 重试 ( retry ) 策略 将 被 采用 ， 即 重新 输入 一组 数据 ， 以 决定 此差 是 由 网络 中 的 功能 故障 引起 的 ， 还是 由于 有效 字长 效应 引起 的 . 一个 小 的 η 可能 会 影响 网络 的 吞吐量 ， 因为 很多 重试 会 执行 ， 但 一个 大 的 η 又 可能 使 一些 功能 故障 不可 测 ， 因此 下面 我们 将 讨论 此 CED 系统 的 吞吐量 及 故障 覆盖率 . 在 分析 前 我们 假设 此 系统 是 以 定点 制 实现 ， 采用 的 码制 为 二进制 补码 ， 数 的 量化 字长 处理 为 截断 处理 . 其它 工作制 （ 例如 浮点 制 ） 、 码制 （ 原码 、 反码 ） 及 字长 处理 （ 舍入 处理 ） 均 可 按 同样 的 方法 进行 分析 . 
 4.1 　 吞吐量 
 　 　 设 F ( k ) 为 第 k 个 FCT 系数 的 截断误差 ， 则 根据 文献 ［ 6 ］ 中 结果 ， 此 噪声 的 方差 为 平均值 为 其中 δ ( k ) 为 单位 抽样 序列 ， 为 量化 误差 的 方差 ， q = 2 - b ， b 为 字长 . 因此 TSC 比较 器 输入 端 总 的 量化 噪声 为 所以 有 = 对于 F ′ ( 0 ) ， 随着 b 的 增加 平均值 为 . 因此 F ′ ( 0 ) ， F ′ ( 1 ) … ， F ′ ( N - 1 ) 是 一组 独立 的 随机变量 ， 其 平均值 为 0 ， 方差 为 . 根据 中心 极限 定理 ， 可 认为 F 是 一个 以 正态分布 的 随机变量 ， 其 平均值 为 0 ， 方差 为 因此 的 分布 就是 一个 标准 正态分布 . 系统 的 吞吐量 定义 如下 ［ 2 ］ ： 
 
 表 1 列出 了 不同 的 时 系统 的 吞吐量 . 
 表 1 　 系统 的 吞吐量 
 
 0.00 . 51.01 . 52.02 . 53.03 . 5 
 吞吐量 0.50 . 6180.7590 . 8820.9560 . 9880.99731 . 000 
 
 　 　 由表 1 可 看出 ， 系统 的 吞吐量 与 η 的 选择 有关 ， 大 的 η 意味着 高 的 吞吐量 ， 但 η 增大 ， 不可 测 故障 增多 ， 因此 下面 讨论 故障 覆盖率 问题 . 
 4.2 　 故障 覆盖率 
 　 　 故障 覆盖率 定义 为 可测 故障 数 与 系统 中 发生 的 故障 数之比 . 设由 功能 故障 引发 的 功能 错误 e ( i ) 是 一个 在 ［ - 1 ， 1 ］ 内 均匀分布 的 白 噪声 ， 则 且 假设 e ( i ) 在 FCT 网络 中 每 一级 都 可能 发生 . 设 G ( k ) 为 由 e ( i ) 引发 的 第 k 个 FCT 系数 的 噪声 ， 则 其 平均值 为 0 ， 其 方差 为 设在 第 i 级 的 功能 故障 可 影响 Mi 个 输出 ， 因此 在 FCT 网络 中 ， 表 2 是 不同 N 时 的 值 . 
 表 2 　 的 值 
 
 N4816 
 0.1720 . 13450.1299 
 
 设 S = F + G ， 其中 则 S 表示 TSC 比较 器 输入 端 总 的 误差值 ， 因此 S 的 平均值 是 0 ， 方差 为 其中 因此 故障 覆盖率 为表 3 列出 了 不同 的 N 值 、 字长 、 η 、 系统 的 故障 覆盖率 . 
 表 3 　 系统 的 故障 覆盖率 
 
 　 η =   
 吞吐量 = 0.759 η = 2 . 
 吞吐量 = 0.956 η = 3 . 
 吞吐量 = 0.9973 
 bN481648164816 
 40.9440 . 9961.000 . 8930.9921 . 000.8410 . 991.00 
 80.92040 . 9941.000 . 83360.991 . 000.7570 . 9841.00 
 160.8860 . 9921.000 . 77180.9861 . 000.66720 . 9781.00 
 
 　 　 从表 3 中 可 看出 ： 当 N ， b 相同 时 ， η 越大 ， 系统故障 覆盖率 越低 . 而 当 η 相同 时 ， 对 相同 的 N ， 字长 b 越大 ， 故障 覆盖率 越大 ， 而 b 相同 时 ， N 越大 ， 故障 覆盖率 越低 . 所以 若想 提高 系统 的 故障 覆盖率 ， 可 从 N ， b ， η 入手 ， 但 故障 覆盖率 的 提高 会 带来 吞吐量 的 降低 ， 因此 在   N ， b ， η 的 选择 上要 注意 折中 . 
 　 　 对 实时 系统 来说 ， 因为 N 为 固定值 ， 因此 比较 好 的 解决办法 是 增加 b . 另外 ， 我们 还 可 看出 ， 对 实时 系统 来说 ， 不可 测 故障 的 几率 很 低 ， 这 是因为 的 比值 很 高 ， 所以 功能 故障 给 输出 带来 的 误差 通常 要 比 截断 带来 的 误差 大得多 . 因此 一般 情况 下 ， 只要 网络 中有 功能 故障 ， CED 系统 就 可 检测 出 .   
 5 　 总   结 
 　 　 在 本文 中 ， 对 基于 B . G . Lee 算法 蝶型 结构 的 FCT 网络 ， 我们 提出 了 一种 基于 算法 的 并发 错误 检测 容错 系统 . 本 系统 有 较 高 的 故障 覆盖率 ， 且 冗余度 较 低 ， 有 实际 应用 价值 . 
 作者简介 ： 陈禾 ， 女 ， 1970 年 3 月生 ， 博士 ， 主要 研究 方向 为 ASIC 设计 、 容错 电路设计 、 DSP . 
 　 　 　 　 　 毛志刚 ， 男 ， 1961 年 9 月生 ， 教授 ， 主要 研究 方向 为 ASIC 设计 、 容错 电路设计 、 集成电路 测试 、 计算机硬件 安全 . 
 　 　 　 　 　 叶以 正 ， 女 ， 1937 年 2 月生 ， 博士生 导师 ， 主要 研究 方向 为 电子设计 自动化 技术 、 集成电路 设计 等 . 
 作者 单位 ： 哈尔滨工业大学 微电子 中心 　 哈尔滨 　 150001 
 参考文献 
 　 1 　 　 Lee   B   G .   A   new   algorithm   to   compute   the   discrete   cosine   transform .   IEEE   Trans   Acoust   Speech   Signal   Process ,   1984 ,   32 ( 12 ) :   1243 ～ 1245 
 　 2 　 　 Jou   J   Y ,   Abraham   J   A .   Fault - tolerant   FFT   networks .   IEEE   Trans   Comput ,   1988 ,   37 ( 5 ) :   548 ～ 561 
 　 3 　 　 Wang   S   J ,   Jha   N   K .   Algorithm - based   fault   tolerance   for   FFT   networks .   IEEE   Trans   Comput ,   1994 ,   43 ( 7 ) :   849 ～ 854 
 　 4 　 　 Oh   C   G ,   Youn   H   Y .   On   concurrent   error   detection ,   location ,   and   correction   of   FFT   networks .   In :   Proc   IEEE   FTCS ' 93 ，   Toulouse ,   France ,   1993 .   596 ～ 605 
 　 5 　 　 Wang   Z .   Fast   algorithms   for   the   discrete   W   transform   and   for   the   discrete   Fourier   transform .   IEEE   Trans   Acoust   Speech   Signal   Process ,   1984 ,   32 ( 4 ) :   803 ～ 816 
 　 6 　 　 Yun   I   D ,   Lee   S   U .   On   the   fixed - point - error   analysis   of   several   fast   DCT   algorithms .   IEEE   Trans   Circuits   Syst   Video   Technol ,   1993 ,   3 ( 1 ) :   27 ～ 41   
 原稿 收到 日期 ： 1997 - 12 - 29 ; 
 修改稿 收到 日期 ： 1998 - 03 - 23 . 
