自动化 学报 
 ACTA   AUTOMATICA   SINICA 
 1999 年 　 第 25 卷 　 第 5 期 　 Vol.25   No.5   1999 
 
 
 
 基于 信息 几何 的 统计 回馈 神经网络 非线性 自 适应 预测 控制 1 ) 
 戴宪华 
 摘 　 要 　 研究 统计 回馈 神经网络 ( SRNN ) 的 非线性 自 适应 预测 控制 . 基于 混合 统计 模型 ， 利用 信息 几何 的 处理 方法 ， 将 SRNN 的 参数估计 转化 为 一般 的 线性 ARMA 系统 的 最小 均方 误差 参数估计 算法 ， 最终 获得 SRNN 参数估计 . 获得 RNN 预测 的 参数估计 以后 ， 可以 十分 方便 地 利用 线性 ARMA 系统 的 控制 规律 来 设计 SRNN 的 预测 控制 规律 ， 解决 了 非线性 SRNN 预测 参数估计 、 复杂 非线性 系统控制 规律 设计 等 问题 . 在 研究 单隐元 SRNN 的 基础 上 ， 进一步 探讨 了 多 隐元 SRNN 的 自 适应 预测 控制 问题 . 
 关键词 　 统计 回馈 神经网络 ， 信息 几何 ， 线性 近似 . 
 RECURRENT   NEURAL   NETWORK   PREDICTION   CONTROLLER   BASED   ON   THE   INFORMATION   GEOMETRY 
 DAI   Xianhua 
 ( Dept . of   Electronic   Eng . , Shantou   University , Guangdong 　 515063 ) 
 Abstract 　 The   paper   primarily   investigates   the   adaptive   predication   controller   modeled   by   the   statistic   recurrent   neural   network ( SRNN ) . Using   a   mixed   statistic   model   to   approximate   single   neuron   of   the   SRNN , one   can   easily   obtain   both   parameter   estimation   and   control   rule   of   the   adaptive   controller   based   on   the   procedure   of   information   geometry . On   the   basis   of   adaptive   controller   of   single   hidden   unit , the   paper   further   investigates   the   controller   problems   of   the   complicated   SRNN   with   multiple   hidden   units . 
 Key   words 　 Statistic   recurrent   neural   network ,   information   geometry ,   linear 
 approximation . 
 1 　 引 　 言 
 　 　 在 实际 工程 应用 中 ， 经常 遇到 的 许多 实际 物理 系统 或多或少 地 存在 非线性 特性 . 在 众多 的 非线性 模型 中 ， 统计 回馈 神经网络 是 一类 十分 有效 的 非线性 系统 描述 方法 ， 它 的 研究 以及 在 控制 、 信息处理 等 方面 的 应用 一直 是 众多 学者 研究 的 重点 . 
 　 　 与 线性系统 的 预测 误差 控制技术 相比 ， 非线性 系统 自 适应控制 的 研究 一直 处于 初期 发展 阶段 . 目前 ， 尚无 普遍 适用 的 控制 方法 可 有效 地 解决 一般 非线性 控制 问题 的 全局 收敛性 等 问题 . 
 　 　 在 处理 非线性 问题 的 众多 方法 中 ， 基于 局部 线性化 或 局部 线性 近似 的 处理 方法 一直 是 十分 有效 的 处理 方法 . 它 的 最大 优点 是 ， 非线性 系统 局部 线性化 后 ， 可以 直接 利用 大量 成熟 的 线性系统 控制技术 方法 ， 解决 非线性 系统 的 自 适应控制 问题 . 本文 就是 基于 这一 思想 ， 结合 信息 几何 的 处理 方法 ， 将 非线性 系统控制 问题 转化 为 一系列 线性系统 的 控制 问题 ， 最终 利用 线性系统 的 自 适应控制 方法 解决 非线性 RNN 的 自 适应控制 问题 . 
 2 　 单隐元 RNN 的 预测 控制 
 2.1 　 单隐元 RNN 预测 的 线性 近似 模型 
 　 　 考虑 如下 具有 单隐元 的 简单 RNN 系统 
 　 ( 1 ) 
 其中 x ( t ) , y1 ( t ) 分别 为 RNN 的 输入 和 输出 信号 ； ai ( t ) , bm ( t ) 为 受控系统 的 参数 ， 它们 是 未知 的 ， 需要 在 预测 中 估计 ； g ( . ) 为 RNN 的 激励函数 ； n ( t ) 为 加性 噪声 ， 这里 假定 它 满足 高斯分布 . 
 　 　 采用 单隐元 RNN 预测 模型 ， 式 ( 1 ) 所 描述 系统 的 预测 输出 为 
 　 ( 2 ) 
 其中 参数 ( t ) , ( t ) 为 非线性 RNN 预测 的 待 估计 参数 . 
 　 　 在 式 ( 1 ) ， ( 2 ) 中 ， 由于 g ( . ) 为 非线性 算子 ， 直接 根据 式 ( 2 ) 计算 控制器 的 控制 输入 信号 通常 也 是 十分困难 的 . 但 根据 式 ( 1 ) ， ( 2 ) 可知 ， 当 g ( . ) 为 线性 算子 时 ， 单隐元 RNN 退化 为 线性 ARMA 系统 . 在 一定 的 条件 下 ， 线性 ARAM 系统 预测 的 参数估计 可以 收敛 于 全局 最优 解 ［ 2 ， 3 ， 4 ］ . 而 基于 线性 ARMA 系统 的 预测 控制 设计 也 较为简单 ， 可 直接 利用 预测 控制 或 极点 配置 控制 设计 方法 来 获得 全局 收敛 的 控制 规律 ［ 4 ］ . 因此 ， 若能 将 单隐元 RNN 转化 为 线性 ARMA 系统 ， 将 可能 获得 较 好 的 参数估计 收敛 结果 及 简单 的 预测 控制 规律 . 下面 研究 如何 将式 ( 2 ) 转化 为 线性系统 . 
 　 　 当 激励函数 为 连续 泛函时 ， 它 在 定义域 的 充分 小 区域 将 可 利用 它 的 一阶 Taylor 展开 近似 . 因此 ， RNN 的 激励函数 取为 软 非线性 函数 ， 如 Sigmodial 函数 时 ， 式 ( 2 ) 可用 下面 一系列 线性系统 近似 
 　 ( 3 ) 
 　 ( 4 ) 
 　 ( 5 ) 
 其中 ， Ak 表示 g ( . ) 定义域 中以 y01 , k 为 中心 的 小 邻域 ， 并且 满足 ， 
 为 g ( . ) 的 定义域 . k 称为 RNN 的 状态 指标 . 
 　 　 从 上面 模型 描述 可以 看出 ， 当 线性 近似 的 数目 K 充分 大时 ， 公式 ( 3 ) — ( 5 ) 描述 的 线性系统 将 完全 可以 近似 预测 系统 ( 2 ) ， 近似 误差 随着 K 的 增大 而 趋于 零 . 这样 ， 就 可以 将 非线性 RNN 预测 转化 为 一系列 线性 ARMA 系统 的 预测 问题 . 
 2.2 　 单隐元 RNN 线性 近似 模型 的 几何 
 　 　 在 SRNN 预测 模型 的 训练 学习 中 ， 训练 数据 或 指导 信号 为 y1 ( t ) . 根据 上面 的 线性 近似 模型 ， 若 已知 训练 数据 y1 ( t ) 可 作为 式 ( 3 ) — ( 5 ) 描述 的 线性系统 的 指导 信号 ， 那么 参数估计 即 为 一般 的 线性 ARMA 系统 预测 的 参数估计 问题 ［ 2 ， 3 ， 4 ］ . 但是 ， 通常 并 不能 预先 知道 训练 数据 y1 ( t ) 可 作为 K 个 线性系统 中 的 哪 一个 线性系统 的 指导 信号 . 因此 ， 模型 参数估计 是 一 不 完全 观测 数据 ( incompletedata ) 的 参数估计 问题 . 那么 参数估计 包含 如下 两个 方面 ： 1 ) 确定 当前 训练 数据 y1 ( t ) 可能 作为 哪 一个 线性系统 的 指导 信号 或 期望 信号 ， 即 定位 或 状态 指标 k 的 确定 问题 ， 这是 离散 概率 事件 的 模式 辨识 问题 . 2 ) 确定 每个 线性系统 的 训练 数据 后 ， 利用 线性 ARMA 系统 预测 算法 估计 ( t ) , ( t ) . 
 　 　 为 解决 上面 的 两个 问题 ， 将 引入 混合 统计 模型 . 根据 线性 近似 模型 ( 3 ) — ( 5 ) 知道 在 某 一 时刻 RNN 的 训练 数据 y1 ( t ) 将 作为 K 个 线性 近似 系统 中 的 一个 线性系统 的 指导 信号 . 同时 ， 由于 RNN 的 输出 包含 高斯 加性 噪声 干扰 ， 那么 受控系统 的 输出 y1 ( t ) 可以 利用 如下 统计 模型 来 描述 ［ 1 ， 5 ， 6 ］ 
 　 ( 6 ) 
 　 ( 7 ) 
 其中 . 根据 上面 的 分析 ， 知道 状态 指标 k 是 一 离散 随机变量 ( 也 称为 隐含 变量 ) ， 为此 引入 变量 ， 那么 单隐元 RNN 的 联合 统计 分布 可写 为 
 　 ( 8 ) 
 对应 的 对数 似然 函数 为 
 　 ( 9 ) 
 令 
 r1 , k ( t ) = δ k ( z ) , 　 r2 , k ( t ) = y1 ( t ) δ k ( z ) , 　 r3 , k ( t ) = y21 ( t ) δ k ( z ) , 　 ( 10 ) 
 　 ( 11 ) 
 r ( t ) = ［ r1 , 1 ( t ) , … ， r1 , K ( t ) , r2 , 1 ( t ) , … , r2 , K ( t ) , r3 , 1 ( t ) , … , r3 , K ( t ) ］ T , 
 θ ( t ) = ［ θ 1 , 1 ( t ) , … ， θ 1 , K ( t ) , θ 2 , 1 ( t ) , … , θ 2 , K ( t ) , θ 3 , 1 ( t ) , … , θ 3 , K ( t ) ］ T . 　 ( 12 ) 
 那么 ， 联合 统计 分布式 ( 8 ) 可写 为 
 pr ( t ) , θ ( t ) = py1 ( t ) , z = exp θ T ( t ) r ( t ) - φ θ ( t ) . 　 ( 13 ) 
 显然 ， 观测 量 r ( t ) 在 自然 参数 θ ( t ) 下为 一 指数 族 分布 . 但 参数 θ ( t ) 为 SRNN 参数 ( t ) , ( t ) 的 非线性 函数 ， 因此 ， SRNN 参数 构成 的 集合 为 自然 参数 流形 的 子 流形 ， 是 一曲 指数 族 ［ 1 ， 7 ］ . 
 　 　 在 分布 函数 ( 13 ) 式 中 ， 观测 量 r ( t ) 包含 隐含 变量 ， 观测 量 的 统计 期望 η 为 另 一 与 θ ( t ) 对 等 的 参数 坐标 系统 ， 有关 指数 族 与 曲 指数 族 的 几何 性质 可 参见 文献 ［ 1 ， 7 ］ . 
 2.3 　 RNN 参数估计 
 　 　 从 以上 的 分析 ， 可 利用 最大 似然 估计 方法 获得 自然 参数 θ ( t ) 的 估计 . 然后 ， 再 利用 θ ( t ) 与 参数 ( t ) , ( t ) 的 关系 获得 RNN 参数估计 . 但是 ， 在 上面 的 指数 族 分布 中 ， 观测 量 r ( t ) 包含 隐含 变量 ， 因此 ， 不能 直接 利用 最大 似然 估计 方法 估计 参数 . 这里 采用 基于 信息 几何 的 em - 投影 算法 . 
 　 　 a ) e - 投影 
 　 　 根据 上面 的 观测 矢量 ， 其中 状态 指标 k 为 隐含 未知 的 ， y1 ( t ) 是 已知 可 观测 的 . 那么 利用 t 时刻 的 自然 参数估计 ( t ) ， 可 求得 观测 量 r ( t ) 的 估计 为 
 　 ( 14 ) 
 　 ( 15 ) 
 其中 α k = pk ｜ y1 , k ( t ) 表示 训练 数据 y1 ( t ) 可 作为 第 k 个 线性 ARMA 系统 指导 信号 的 概率 ， 由下式 估计 
 　 ( 16 ) 
 　 　 b ) m 投影 
 　 　 根据 信息 几何 的 理论 ， 知道 在 指数 族 分布 中 ， 观测 量 的 期望 参数 为 一 充分 统计 量 ， 因此 ， 可以 利用 期望 参数 来 获得 自然 参数 的 估计 . 根据 观测 量 的 表示 式 ， 观测 量 的 期望 参数估计 为 
 　 ( 17 ) 
 当 ρ = 0 时 ， 式 ( 17 ) 为 无 记忆 的 期望 参数估计 . 那么 ， 自然 参数估计 为 
 　 ( 18 ) 
 其中 GT 为 Fisher 信息 矩阵 G 的 逆 矩阵 ， η ( θ ( t ) ) 为 参数估计 ( t ) 下 的 期望 参数 . 
 　 　 令 
 
 为 RNN 预测 的 参数估计 ， 并设 参数 与 自然 参数 ( t ) 的 关系 为 . 那么 ， 参数 的 估计 为 
 　 ( 19 ) 
 　 　 根据 文献 ［ 1 ， 7 ］ ， 式 ( 2 ) — ( 10 ) ， 式 ( 19 ) 中 的 . 当式 ( 17 ) 中 的 ρ = 0 ， 即 观测 量 的 期望 参数 取为 无 记忆 估计 时 ， 式 ( 19 ) 的 可 展开 为 
 = y ( t ) e ( t ) , 　 ( 20 ) 
 其中 y ( t ) = ［ y1 ( t ) , … , y1 ( t - I ) , x ( t ) , … , x ( t - M + 1 ) ］ T . 
 　 　 将式 ( 20 ) 代入 式 ( 19 ) ， 并 与 文献 ［ 2 ， 3 ， 4 ］ 中 的 一般 线性 ARMA 系统 预测 参数估计 算法 比较 ， 可以 看到 SRNN 预测 参数估计 公式 与 一般 的 线性 ARMA 系统 预测 的 参数估计 基本相同 ， 只是 其中 的 误差 与 线性 ARMA 系统 稍 有 不同 . 因此 ， 通过 近似 处理 ， 将 非线性 SRNN 预测 转化 为 线性 ARMA 系统 预测 问题 . 线性 ARMA 系统 预测 参数估计 的 各种 算法 和 算法 收敛 性质 分析 可 直接 应用 到 m - 投影 参数估计 中 . 同样 利用 信息 几何 的 批处理 方法 ， 可以 求得 π k , σ 2 的 估计 ［ 1 ， 6 ， 7 ］ . 注意 这里 的 em - 投影 算法 是 交替 迭代 获得 参数估计 的 ［ 1 ， 7 ］ . 
 2.4 　 RNN 最小 均方 预测 误差 控制 规律 
 　 　 在 上述 线性 近似 模型 及 信息 几何 的 描述 下 ， 有 两种 方法 可以 计算 RNN 的 最小 均方 预测 误差 控制 规律 . 设 RNN 控制器 的 期望 信号 为 d1 ( t ) . 
 　 　 方法 1 . 在 获得 了 RNN 参数估计 后 ， RNN 预测 可写 为 
 　 ( 21 ) 
 令 , 那么 式 ( 21 ) 可简化 为 
 　 ( 22 ) 
 显然 ， 式 ( 22 ) 为 一 具有 时变 系数 的 线性 ARMA 系统 ， 因此 它 的 控制 规律 ， 如 控制 输入 信号 可 采用 线性 ARMA 系统 的 自 适应 预测 控制 规律 的 设计 方法 来 获得 ［ 4 ］ . 
 　 　 方法 2 . 在 上面 的 RNN 预测 训练 数据 的 分布 ( 13 ) 式 中 ， 自然 参数 θ ( t ) 为 受控系统 输入 信号 x ( t ) 的 函数 . 因此 ， 可 通过 先 估计 自然 参数 ， 然后 利用 自然 参数 与 受控系统 输入 信号 的 关系 ， 求出 RNN 控制器 的 输入 信号 . 
 　 　 将 指数分布 ( 13 ) 式 中 的 观测 量 r ( t ) 改造 为 
 r ( t ) = ［ α 1 , … ， α K , α 1d1 ( t ) , … ， α Kd1 ( t ) , α 1d21 ( t ) , … ， α Kd21 ( t ) ］ T . 　 ( 23 ) 
 利用 上面 的 em - 投影 算法 可求 出 y1 , k ( t ) , k = 1 , … ， K ( 它们 为 受控系统 输入 x ( t ) 的 函数 ) ， 然后 根据 关系式 ( 4 ) ， 即可 求出 RNN 控制系统 的 输入 信号 . 
 　 　 从 上面 的 讨论 看出 ， 非线性 RNN 的 控制 问题 完全 转化 为 线性 ARMA 系统 的 预测 控制 问题 . 同时 ， 也 可 根据 线性 ARMA 系统 的 稳定性 分析方法 分析 非线性 RNN 控制系统 的 稳定性 问题 . 关于 稳定性 分析 ， 限于 篇幅 ， 本文 不再 讨论 . 
 3 　 具有 多隐元 的 复杂 RNN 预测 控制 
 　 　 根据 单隐元 SRNN 模型 ， 多隐元 的 RNN 预测 的 局部 线性 近似 模型 示于 图 1 . 对于 多隐元 RNN 的 预测 若能 分解 为 多个 单隐元 RNN 预测 ， 那么 多隐元 RNN 的 预测 控制 问题 也 就 转化 为 多个 单隐元 RNN 的 预测 控制 问题 . 
 
 
 图 1 　 多隐元 的 RNN 预测 局部 线性 近似 模型 
 
 　 　 在 上面 的 模型 中 ， 多个 单隐元 RNN 的 输出 合成 作为 RNN 预测 的 输出 . 因此 ， 如果 RNN 每一 隐元 对应 的 训练 数据 或 期望 信号 确知 ， 那么 多隐元 RNN 的 参数估计 、 自 适应控制 即 为 多个 单隐元 RNN 的 分别 控制 及 参数估计 . 但是 ， 多隐元 RNN 预测 每一 隐元 的 训练 数据 、 期望 信号 并 没有 给出 ， 需要 在 参数估计 的 过程 中 估计 每一 隐元 的 训练 数据 、 期望 信号 . 这里 ， 采用 如下 简单 的 估计 方式 给出 各隐元 的 训练 数据 、 期望 信号 . 第 l 隐元 在 t + 1 时刻 的 训练 数据 、 期望 信号 分别 为 
 　 ( 24 ) 
 其中 为 利用 t 时刻 参数估计 的 第 i 隐元 的 一步 前后 预测 输出 信号 ［ 4 ］ . 
 　 　 在 多 隐元 RNN 的 每 一隐元 获得 了 训练 数据 及 期望 信号 后 ， 多隐元 RNN 预测 的 参数估计 以及 预测 控制 也 就 转化 为 多个 单隐元 的 参数估计 、 控制 问题 ， 可 利用 本文 第二 部分 提出 的 方法 解决 . 
 　 　 注意 在 多 隐元 RNN 转化 为 多个 单隐元 控制 问题 以后 ， 它 是 一个多 输入 、 多 输出 ( MIMO ) 的 线性 ARMA 系统 ， 需 利用 MIMO 线性 ARMA 系统 的 参数估计 、 控制 方法 来 解决 参数估计 及 控制 问题 ［ 4 ］ . 
 4 　 计算机 模拟实验 结果 
 　 　 实验 模型 如下 
 　 ( 25 ) 
 y ( t ) = y ′ ( t ) + n ( t ) , 　 ( 26 ) 
 其中 n ( t ) = 0.8 n ( t - 1 ) + w ( t ) , w ( t ) 为 零 均值 高斯 白 噪声 . RNN 预测 取与式 ( 25 ) ， ( 26 ) 同阶 的 预测 形式 ， 每一 隐元 的 局部 线性化 数目 取为 11 . RNN 控制 的 期望 信号 取为 方波 . 
 　 　 图 2 为 部分 实验 结果 ， 其中 ( a ) 为 RNN 控制 的 期望 信号 d ( t ) 和 受控系统 ( 25 ) ， ( 26 ) 的 控制 输出 信号 ； ( b ) 为 RNN 控制器 控制 输入 信号 ； ( c ) RNN 预测 系统 的 参数估计 学习曲线 ， 它 是 30 次 独立 的 计算机 模拟 结果 的 平均 ， 曲线 表征 了 RNN 预测 参数估计 或 系统 辨识 的 收敛 性能 . 从图 2 可 看出 ， 本文 提出 的 RNN 预测 控制器 的 设计 方法 是 完全 可行 的 . 
 
 
 图 2 　 预测 控制 实验 结果 
 5 　 结 　 论 
 　 　 本文 利用 SRNN 的 非线性 激励函数 的 分段 局部 线性 近似 方法 ， 将 非线性 SRNN 转化 为 混合 统计 模型表示 的 统计 预测 问题 . 利用 信息 几何 的 em - 投影 算法 ， SRNN 预测 转化 为 线性 ARMA 系统 的 预测 问题 ， 最终 利用 线性 ARMA 系统 预测 控制 的 结论 解决 非线性 SRNN 的 预测 控制 问题 . 
 作者简介 ： 戴宪华 　 1992 年 毕业 于 东南大学 ， 获 博士学位 . 1993 — 1994 年 在 华南理工大学 通信 与 电子系统 博士后 流动站 工作 ； 1995 年 至今 ， 在 汕头大学 电子 工程系 任教 ， 同年 获得 副教授 任职 资格 . 主要 科研 领域 ： 非线性 信号处理 ， 语音 信号处理 ， 通信 系统 均衡 ， 自 适应控制 等 . 
 作者 单位 ： 汕头大学 电子 工程系 　 广东 　 515063 
 参考文献 
 1 　 Shuninch   Amari . Information   geometry   of   the   EM   and   em   algorithms   for   neural   networks . Neural   Network , 1995 , 8 ( 9 ) : 1379 — 1408 
 2 　 Anderson   B   D   O . Stability   of   adaptive   systems : passivity   and   averaging   analysis . Cambridge , London , The   MIT   Press , 1984 
 3 　 Kumar   P   R . Stochastic   systems   estimation , identificaion   and   adaptice   control .   Englewood   Cliffs , NJ : PrenticeHall , Inc.1986 
 4 　 Graham   C . Goodwin   Adaptive   filtering   prediction   and   control . Englewood   Cliffs , NJ : PrenticeHall , Inc.1984 
 5 　 Xuan   J . Information   geometry   of   maximum   partial   likelihood   estimation   for   channel   equalization . In : ICASSP ' 96 : 3533 — 3566 
 6 　 Roy   L . Streit   maximum   likelihood   training   of   probabilistic   neural   network . IEEE   Trans . Neural   Network , 1994 , 5 ( 5 ) : 764 — 783 
 7 　 Shuninch   Amari . Differential   geometry   of   curved   exponential   familycurvature   and   information   loss . The   Annual   of   statistics , 1982 , 10 ( 2 ) : 357 — 385 
 收稿 日期 ： 1997 - 06 - 04 
 修稿 日期 ： 1998 - 02 - 06 
