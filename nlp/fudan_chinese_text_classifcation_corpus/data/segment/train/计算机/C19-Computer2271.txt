计算机 应用 研究 
 APPLICATION   RESEARCH   OF   COMPUTERS 
 2000 　 Vol.17 　 No.5 　 P.44 - 47 
 
 
 
 对 基于 TCP / IP 协议 的 几个 网络安全 问题 的 分析 与 讨论 
 赵季 中 　 宋政湘 　 齐勇 
 摘     要     从 对 TCP / IP 协议 的 分析 出发 ， 针对 TCP / IP 协议 本身 存在 的 安全隐患 ， 讨论 了 几种 可能 的 攻击 策略 ， 并 给出 了 针对 这些 攻击 的 一些 防范措施 ， 为 基于 TCP / IP 协议 的 网络安全 建设 提供 了 建设性 的 参考 。 
 关键词     TCP / IP 协议     网络安全 
 1     引言 
 　 　 目前 ， 网络 技术 得到 日益 广泛 的 使用 。 网络 在 带给 人们 方便 的 同时 ， 网络 上 的 不 安全 因素 也 给 人们 带来 不少 麻烦 。 
 　 　 根据 美国 FBI 的 调查 ， 美国 每年 因为 网络安全 造成 的 经济损失 超过 170 亿美元 。 75% 的 公司 报告 财政 损失 是 由于 计算机系统 的 安全 问题 造成 的 。 超过 50% 的 安全 威胁 来自 内部 ； 只有 17% 的 公司 愿意 报告 黑客 入侵 ， 其它 的 由于 担心 负面影响 而 未 声张 。 59% 的 损失 可以 定量 估算 。 平均 每个 组织 损失 402 , 000 美元 。 
 　 　 入侵 的 来源 首先 是 内部 心怀不满 的 员工 ， 其次 为 黑客 ， 另外 还有 竞争者 。 
 　 　 无论是 有意 的 攻击 ， 还是 无意 的 误操作 ， 都 会 给 系统 带来 不可估量 的 损失 。 攻击者 可以 窃听 网络 上 的 信息 ， 窃取 用户 的 口令 、 数据库 的 信息 ； 还 可以 篡改 数据库 的 内容 ， 伪造 用户 身份 ， 更有甚者 ， 攻击者 可以 删除 数据库 的 内容 ， 摧毁 网络 节点 ， 释放 计算机病毒 。 
 网络系统 的 安全 威胁 主要 来自 以下 几个 方面 ： 
 　 　 ( 1 ) 操作系统 的 安全性 ， 目前 流行 的 许多 操作系统 均 存在 网络安全 漏洞 ； 
 　 　 ( 2 ) 防火墙 的 安全性 ， 防火墙 产品 自身 是否 安全 ， 是否 设置 错误 ， 需要 经过 认真 检验 ； 
 　 　 ( 3 ) 来自 内部网 用户 的 安全 威胁 ； 
 　 　 ( 4 ) 缺乏 有效 的 手段 监视 网络系统 的 安全性 ； 
 　 　 ( 5 ) 采用 的 TCP / IP 协议 簇 本身 的 安全隐患 。 
 　 　 由于 TCP / IP 协议 在 网络 中 的 广泛应用 以及 TCP / IP 协议 本身 在 安全性 上 的 缺陷 ， 大多数 攻击 都 是 基于 TCP / IP 协议 的 。 为了 讨论 基于 TCP / IP 协议 的 网络安全 问题 ， 有 必要 首先 了解 TCP / IP 协议 。 
 2     TCP / IP 协议 简介 
 　 　 TCP / IP 是 一个 允许 不同 软硬件 结构 计算机 进行 通信 的 协议 族 ， Internet 就是 建立 在 TCP / IP 协议 之上 的 。 一个 协议 族 通常 是 由 不同 的 层次 所 组成 ， 对于 TCP / IP 协议 来说 ， 通常 可 分为 四层 如表 1 。 
 表 1 
 
 应用层 
 WWW ， EMAIL ， FTP 等 
 传输层 
 TCP ， UDP 
 网络层 
 IP 
 网络 访问 层 
 ARP ， RARP ， Hardware   Interface 
 
 　 　 ． 网络 访问 层 ： 又 称为 数据 链路层 、 网络接口 层 ， 负责 处理 不同 通信 媒介 的 细节 问题 ， 与 具体 设备 如 以太网 、 令牌环 网 、 网卡 等 有关 。 
 　 　 ． 网络层 ： 负责 网络 中 的 数据包 传送 ， 并 定义 了 通用 数据包 格式 和 IP 协议 ； IP 提供 了 非 面向 连接 的 、 非 可靠 的 数据 报 服务 ； 每 一个 Internet 上 的 接口 都 必须 有 一个 唯一 的 IP地址 ； 网络层 同时 处理 数据包 路由 和 拥塞 避免 等 事务 。 
 　 　 ． 传输层 ： 与源 主机 和 目的 主机 之间 的 进程 通信 提供 数据流 ( 一个 无 报文 丢失 、 重复 和 失序 的 正确 的 数据 序列 ) 。 当 一个 源 主机 上 运行 的 应用程序 要 和 目的 主机 联系 时 ， 它 就 向 传输层 发送信息 ， 以 数据包 的 形式 送到 目的 主机 ； 传输层 同时 还 处理 流控 ， 拥塞 控制 等 事务 。 在 传输层 有 两个 端到 端的 协议 ： TCP 和 UDP 。 TCP 为 通信 应用 提供 了 可靠 的 数据流 。 UDP 和 TCP 不 一样 的 是 它 提供 的 是非 可靠 的 ， 非 面向 连接 的 数据 报 传送 。 它 不 提供 确认 、 发送 排序 和 数据流 控制 ， UDP 信息 可能 会 丢失 、 重复 和 次序 颠倒 ， 所以 在 应用层 必须 增加 所 需 的 可靠性 。 
 　 　 ． 应用层 ： 这 一层 包括 所有 的 高层 协议 ； 例如 ： Telnet ， 一个 远程 登录 的 虚拟 终端 协议 。 Ftp ， 负责 机器间 的 数据传输 。 
 　 　 传输层 与 网络层 在 功能 上 的 最大 区别 就是 前者 提供 进程 通信 能力 ， 后者 不 提供 。 在 进程 通信 的 意义 上 ， 网络通信 的 最终 地址 不仅仅 是 主机 地址 ， 还 包括 可以 描述 进程 的 某种 标识符 。 为此 ， TCP / UDP 提出 协议 端口 ( Protocol   port ) 的 概念 ， 用于 表示 通信 的 进程 端口 是 一种 抽象 的 软件结构 ( 包括 一些 数据结构 和 I / O 缓冲区 ) 。 应用程序 ( 即 进程 ) 通过 系统 调用 与 某些 端口 建立 联 编后 ， 传输层 传给 该 端口 的 数据 都 被 相应 进程 所 接收 。 端口 操作 类似 一般 的 I / O 操作 ， 可以 用 一般 的 读写 原语 ( Read 、 Write ) 访问 。 每 一个 端口 都 有 一个 叫 端口号 的 整数 标识符 ， TCP 和 UDP 都 允许 长达 16 位 的 端口 值 。 TCP 使用 一种 介于 集中 和 动态分配 之间 的 端口 分配 方法 ， 将 端口 分为 保留 端口 和 自由 端口 两 部分 。 
 　 　 通过 对 TCP / IP 协议 的 了解 ， 下面 我们 来 分析 和 讨论 几种 基于 TCP / IP 协议 的 攻击 及 可能 的 对策 。   
 3     链路层 上 的 攻击 及 对策 
 3.1     嗅探 
 　 　 网络 嗅探 就是 利用网络 上 的 接口 接收 不 属于 本 主机 的 数据 。 因为 为 每 一对 主机 建立 专门 的 连接 线路 代价 太高 ， 计算机网络 通常 建立 在 共享 信道 上 ， 在 这种 网络 上 嗅 探 特别 方便 。 以太网 就是 这样 一个 共享 信道 的 网络 ， 其 数据 报头 包含 目的 主机 的 硬件 地址 ， 只有 硬件 地址 匹配 的 机器 才 会 接收 该 数据包 。 一个 能 接收 所有 数据包 的 机器 ( 或 接口 ) 被 称为 杂错 节点 。 通常 账户 和 口令 等 信息 都 以 明文 的 形式 在 以太网 上 传输 。 一旦 被 黑客 在 杂错 节点 上 嗅 探到 ， 用户 就 可能 会 遭到 损害 。 
 3.2     对策 
 　 　 网络 分段 ： 一个 网络 段 包括 一组 共享 低层 设备 和 线路 的 机器 ， 如 交换机 ， 动态 集线器 和 桥 等 设备 ， 可以 对 数据流 进行 限制 ， 从而 达到 防止 嗅探 的 目的 。 
 　 　 加密 ： 如果 数据流 中 被 加密 部分 过多 ， 必须 采用 特殊 的 协议 ， 则 与 现有 的 标准 网络 不相容 。 如果 只 对 应用层 加密 ， 则 大部分 与 网络 和 操作系统 有关 的 敏感 信息 未 被 保护 。 
 　 　 一次性 口令 技术 ： 口令 并 不 在 网络 上 传输 而是 在 两端 进行 字符串 的 匹配 ， 客户端 利用 从 服务器 上 得到 的 Challenge 和 自身 的 口令 计算 出 或 从 列表 中 选择 一个 新 的 字符串 并 将 之 返回 给 服务器 。 在 服务器 上 利用 比较 算法 进行 匹配 ， 如果 匹配 ， 连接 就 被 允许 建立 ， 所有 的 Challenge 和 字符串 都 只 使用 一次 。 
 　 　 禁用 杂错 节点 ： 安装 不 支持 杂错 的 网卡 ， 通常 可以 防止 IBM 兼容机 进行 嗅探 。 
 4     网络层 和 传输层 上 的 攻击 及 对策 
 4.1     ICMP 通道 
 　 　 ICMP   ( Internet   Control   Message   Protocol ) 是 IP 层 的 一部分 。 它 在 IP 软件 和 机器 ( 主机 或 路由器 ) 间 传送 出错 和 控制 信息 的 无 连接 协议 。 ICMP 数据包 被 放置 在 IP 数据 报文 中 。 ICMP 的 报头 都 有 三个 相同 的 域 ： 种类 ( 一个 字节 ) 、 代码 ( 一个 字节 ) 、 校验 和 ( 两个 字节 ) 。 ICMP 报文 结构 如下 ： 
 
 　 　 PING 命令 发送 一个 ICMP 回应 请求 ( 种类 8 ) 。 任何 收到 回应 请求 的 主机 都 会 返送 一个 回应 回答 给源 主机 ， 此 命令 可用 来 检验 一个 目的 主机 是否 可 到达 。 请求 和 回答 信息 都 包括 一个 可选 的 数据 域 ， 因为 PING 命令 普遍存在 于 TCP / IP 网络 以及 其子 网中 ， 所以 防火墙 和 网络 都 允许 PING 通过 而 忽略 了 它 的 危险性 — 可 被 用来 进行 服务 拒绝 攻击 。 同时 没有 设备 可以 对 PING 报文 中 的 数据 域 内容 进行 检测 ， 利用 PING 还 可以 在 得到 允许 的 网络 中 建立 秘密 通道 。 有 工具 可以 利用 这 一点 在 系统 中开 一个 后门 ， 搜集 目标 上 的 信息 ， 并 进行 秘密 通信 。 
 4.2     检测 和 防止 
 　 　 如果 ICMP 回应 被 允许 的话 ， 那么 数据包 过滤 将 无法 检测 是否 有 秘密 通道 的 存在 。 对 ICMP 这样 一个 无 连接 的 协议 ， 伪装 的 主机 ( 利用 伪造 的 IP地址 ) 仍然 可以 将 含有 秘密 数据 的 回应 请求 发到 目标 主机 ， 引起 该 主机 的 回应 ， 所以 限定 ICMP 回应 到 信任 主机 是 没有 用 的 。 现在 已经 有 了 只能 数据包 过滤器 可以 检测 数据 域 的 内容 是否 合法 ， 但 应用 不是 很 广泛 ， 也 不能 完全 防止 欺骗 。 最好 的 办法 就是 拒绝 网络 上 的 所有 ICMP 回应 。 
 5     IP 欺骗 及 对策 
 　 　 TCP / IP 协议 的 信任 机制 十分 方便 、 有用 ， 但 对 攻击者 来说 却是 十分 脆弱 的 ， 因为 身份 确认 机制 只是 基于 IP地址 的 。 IP 欺骗 攻击 充分利用 了 确认 的 弱点 ， 攻击者 可以 把 他 的 主机 EVIL . COM 伪装成 被 主机 TARGET . COM 信任 的 主机 FRIEND . COM 。 具体做法 是 在 发出 的 所有 数据包 中 都 用 信任 主机 FRIEND . COM 的 IP地址 代替 他 的 主机 IP地址 。 被 攻击 主机 就 相信 入侵者 就是 信任 主机 FRIEND . COM 。 
 5.1     ARP 欺骗 
 　 　 ARP   ( Address   Resolution   Protocol ) 用来 进行 32 位 的 IP地址 和 物理地址 ( 如 以太网 地址 ) 的 互相 映射 。 该 协议 大致 工作 过程 如下 ： IP 数据包 发送 时会 被 发送到 同一个 子网 中 的 主机 或 利用网关 作 第一个 驿站 。 无论 哪 种 情况 ， 都 需要 以太网 物理地址 用来 发送 包含 IP 数据包 的 以太网 物理 帧 。 首先 源 主机 先 在 ARP   Cache 中 进行 查询 ， 如果 找 不到 与 IP地址 相对 应 的 物理地址 ， 就 会 向 网络 上 的 所有 主机 广播 一个 包含 目的 主机 IP地址 、 本机 的 物理地址 和 IP地址 的 特殊 物理 帧 。 每 一个 收到 此帧 的 主机 都 会 刷新 自身 ARP   Cache 中 的 IP － 物理地址 联编 ， 同时 ， 目的 主机 还会 向源 主机 发送 一个 包含 自身 IP地址 和 硬件 地址 的 ARP 回答 。 源 主机 收到 此 回答 后 就 会 刷新 Cache ， 此时 就 可以 发送数据 报 了 。 
 　 　 Cache 中 的 数据 通常 几分钟 后 就 会 过期 ， 攻击者 就 可以 伪造 IP － 物理地址 联系 。 攻击者 可以 暂时 使用 不 工作 的 主机 的 IP地址 ， 源 主机 可能 关机 、 未 与 网络连接 或 被 攻击者 改变 了 原来 的 IP地址 。 过 了 几分钟 后 ， Cache 中 的 原 数据 过期 后 ， 攻击者 就 可以 入侵 信任 服务器 。 
 防止 ARP 欺骗 ： 信任 主机 可以 使得 被 信任 主机 的 硬件 地址 常驻 Cache ， 常驻 Cache 的 数据 不会 在 几分钟 后 过期 ， 并 可以 用 ARP 等 命令 手工 加入 。 
 　 　 另外 ， 可 使用 专门 的 安全 ARP 服务器 来 回答 ARP 请求 ； 最后 ， 由于 路由器 可以 防止 子网 之间 的 ARP 欺骗 ， 要 将 被 信任 主机 和 不 安全 的 子网 分开 。 
 　 　 检测 ARP 欺骗 ： 服务器 可以 通过 向 RARP   ( Reverse   Address   Resolution   Protocol ) 服务器 询问 来 检测 客户 的 ARP 欺骗 ， RARP 服务器 保留 着 网络 中 硬件 和 相关 IP地址 的 信息 。 
 5.2     路由 欺骗 
 　 　 每 一个 IP 数据 报 或 物理 帧 都 在 主机 的 网络层 被 检查 ， 决定 是 转发给 同一个 子网 中 的 主机 ( 包括 它 自身 ) 还是 下 一个 驿站 。 
 　 　 路由 欺骗 有 几种 方法 ， 都 是 通过 伪造 路由表 ， 错误引导 非 本地 的 数据 报 实现 。 
 　 　 基于 ICMP 的 攻击 ： 当 一个 源 的 数据 报 必须 发给 另 一个 路由器 时 ， 当前 路由器 会 给 此源 发送 一个 ICMP 重定向 错误信息 。 当源 主机 收到 此 信息 时 ， 会 更新 路由表 。 这样 ， 通过 发送 非法 的 Redirect 信息 就 可以 进行 路由 欺骗 。 但是 ， 因为 忽略 重定向 信息 并 不 影响 数据 报 的 发送 ， 可以 通过 设置 主机 忽略 重定向 信息 来 防止 路由 欺骗 。 另外 ， 检测 本机 的 常驻 ARP 数据 ， 看此 信息 是否 来自 合法 的 路由器 ， 也 可以 防止 路由 欺骗 。 
 　 　 基于 RIP 的 攻击 ： 现代 计算机网络 通常 使用 动态 路由 算法 ， 普遍 采用 的 算法 是 距离 — 向量 算法 ： 每 一个 路由器 保留 一个 向量 表 指出 到达 目的 主机 的 距离 和 路线 ， 距离 度量 值 由 驿站 的 个数 、 延时 、 预期 拥塞 程度 或 数率 决定 ， 路由器 累加 编程 进 每个 路由 接口 所 花费 的 距离 度量 值 并 选择 累加 值 最小 的 路由 。 网络 中 包括 Active 和 Passive 节点 ， Active 节点 周期性 发送 RIP 报文 到 所有 与其 连接 的 Passive 节点 ， 通知 它们 当前 的 路由 代价 ( 距离 度量 值 ) ， 对 每条 路由 ， 路由器 一般 只 记忆 在 RIP 更新 路由 过程 中 检测 到 的 最小 度量 值 。 当 发现 一条 较 短路 由时 ， 则 利用 这 条 新路 由 代替 先前 的 最 短路 由 。 因此 ， 通过 使用 RIP 特权 的 主机 的 520 端口 广播 非法 路由 信息 就 可以 达到 欺骗 的 目的 。 所有 的 Passive 节点 都 会 受到 影响 。 如果 Passive 节点 中 包括 路由器 ， 错误信息 还会 被 扩散 。 防止 RIP 路由 欺骗 的 方法 就是 禁止 路由器 被动 使用 RIP 和 限制 被动 使用 RIP 的 范围 。 
 　 　 基于 源 路由 的 攻击 ： 一般来说 ， IP 路由 过程 中是 由 路由器 来 动态 决定 下 一个 驿站 。 但是 IP 可以 选择 源 路由 ， 即 由 发送者 指定 路由 。 有 以下 两种 形式 ： 
 　 　 严格 源 路由 ： 给出 完整 的 路径 ； 
 　 　 非 严格 源 路由 ： 发送者 只是 给出 几个 数据 报 必须 经过 的 IP地址 。 
 　 　 下面 的 例子 给出 这种 攻击 的 形式 ： 
 　 　 服务器 TARGET . COM 扩展 信任 到 包含 FRIEND .   COM ( 合法 IP 为 vvv . xxx . yyy . zzz ) 的 数个 主机 。 攻击者 想 利用 他 的 主机 EVIL . COM 冒充 FRIEND . COM 从 TARGET . COM 获得 某些 服务 。 首先 ， 攻击者 修改 距离 EVIL . COM 最近 的 路由器 ， 使得 到达 此 路由器 的 包含 目的 地址 vvv . xxx . yyy . zzz 的 数据 报以 EVIL . COM 所在 的 网络 为 目的地 ； 然后 ， 攻击者 将 EVIL . COM 的 IP地址 改为 vvv .   xxx . yyy . zzz ； 最后 ， EVIL . COM 利用 IP 欺骗 向 TARGET .   COM 发送 源 路由 ( 指定 最近 的 路由器 ) 数据包 。 当 服务器 回送 数据包 时 ， 就 传送 到 被 更改 过 的 路由器 。 只要 在 TARGET . COM 的 网络 禁用 此 路由 就 可以 防止 这种 攻击 。 
 5.3     DNS 欺骗 
 　 　 当 主机 必须 将 一个 域名 转化 为 IP地址 时 ， 它会 向 DNS 名字 服务器发送 一个 查询 请求 。 同样 ， 当要 把 IP地址 转化成 域名 时 ， 会 发送 一个 反向 查询 请求 。 
 　 　 当 DNS 服务器 中 的 数据 被 攻击者 破坏 时 ， DNS 欺骗 就 会 发生 。 因为 网络 上 的 主机 都 信任 DNS 服务器 ， 所以 一个 被 破坏 的 DNS 服务器 可以 将 客户 引导 到 非法 的 服务器 ， 也 可以 欺骗 服务器 相信 一个 IP地址 确实 属于 一个 被 信任 客户 。 
 　 　 通过 在 本 机上 保留 一个 域名 和 相应 IP地址 的 数据库 ， 可以 部分 防止 DNS 欺骗 。 每 一个 服务器 至少 要 保留 信任 主机 的 信息 。 此外 ， 一个 冒充 被 信任 客户 的 攻击者 通常 要 进入 负责 保留 攻击者 的 IP地址 的 DNS 服务器 ， 修改 反向 查询 表 。 然而 ， 合法 域名 和 IP地址 的 联系 通常 由 负责 客户 域名 的 DNS 服务器 保存 。 这 两个 服务器 可以 在 物理 上 是 独立 的 ， 就算 不 独立 ， 正向 和 反向 查询 表 也 要 保存 在 不同 的 文件 中 。 这样 ， 即使 是 反向 查询 表 被 破坏 ， 也 可以 利用 未 受损 的 正向 查询 表 进行 检验   ( 这种 方法 尤其 适用 于 对付 来自 外部 网络 的 进攻 )   。 下面 的 例子 将 说明 DNS 欺骗 是 如何 进行 的 。 
 　 　 一个 攻击者 修改 DNS 服务器 ( COMPROMISED .   DNS . COM ) 上 指向 它 的 主机 EVIL . COM 的 反向 查询 入口 ， 使得 他 的 主机 看起来 像 被 TARGET . COM 信任 的 主机 FRIEND . COM 。 当 EVIL . COM 向 TARGET . COM 发送 请求 时 ， TARGET . COM 会 去 查询 COMPROMISED .   DNS . COM 上 的 反向 查询 表 ， 得到 FRIEND . COM 的 假象 。 使用 正向 和 反向 查询 表 进行 交叉 查询 可以 防止 这 一类 的 攻击 。 
 5.4     TCP 连接 欺骗 和 盲 攻击 
 　 　 远程 过程 调用 ( Remote   Procedure   Call ) 可以 使 用户 在 不 需 输入 密码 的 情况 下 执行 远程 操作 ， 如 UNIX 系统 下 的 rlogin 、 rcp 、 rsh 等 命令 。 主机 间 的 信任 关系 可以 很 方便 地 设定 。 这样 ， 用户 就 可以 用 rlogin 、 rsh 等 RPC 命令 从 一台 主机 远程 访问 另一台 主机 而 不 需要 在 此 输入 口令 。 这些 RPC 命令 是 一些 基于 客户机 / 服务器 的 TCP 应用 。 如果 主机 之间 建立 了 上述 的 信任 关系 ， 它们 就 仅仅 通过 TCP 包中 的 信源 IP地址 来 进行 用户 身份 的 确认 。 RPC 在 带来 方便 的 同时 ， 也 带来 潜在 的 安全 问题 。 TCP 连接 欺骗 攻击 就是 一种 利用 这种 信任 关系 的 ( 基于 IP 欺骗 ) “ 盲 ” 攻击 。 
 　 　 防止 TCP 连接 欺骗 的 方法 包括 ： 不 使用 基于 IP地址 的 身份 确认 ， 关闭 所有 的 RPC 命令 ， 或者 让 用户 在 使用 RPC 时 输入 口令 。 修改 TCP 模块 ， 选择 更好 的 ISN 算法 ， 使得 TCP 发送 序号 空间 的 增加 和 改变 是 随机 的 也 是 很 好 的 方法 。 
 6     拦截 及 对策 
 　 　 上述 攻击 都 是 基于 信任 主机 机制 的 ， 当 要求 口令 确认 时 ， 这些 欺骗 方法 就 失效 了 。 拦截 就是 一种 基于 嗅探 和 IP 欺骗 的 新 攻击 方法 ， 攻击者 通过 在 确认 后 拦截 的 方法 来 躲避 一次性 口令 或 其它 严格 的 身份 确认 。 当 合法 用户 通过 登录 进入 一个 远程 站点 ， 攻击者 可以 拦截 此 连接 来 攻击 站点 。 如果 是 管理员 的 连接 被 拦截 ， 攻击者 有 可能 更改 超级 口令 或 增加 一个 特权 帐户 。 
 攻击者 可以 使 TCP 连接 两端 进入 不 同步 状态 ， 此时 ， 这 两端 就 不能 再 进行 数据交换 ， 入侵者 的 主机 就 会 向 两端 发送 伪造 的 数据包 。 
 　 　 最好 的 防止 拦截 的 方法 就是 利用 基于 加密 的 终端 协议 ， 这些 协议 可以 降低 拦截 的 威胁 。 因为 ， 尽管 拦截 者 可能 获得 了 正确 的 数据 ， 但 由于 不能 解密 ， 并 不能 知道 其 内容 。 
 7     服务 拒绝 攻击 及 对策 
 　 　 在 服务 拒绝 攻击 中 ， 一个 用户 占用 了 太 多 的 公用 资源 ， 使得 没有 资源 留给 其他 用户 。 有 两种 服务 拒绝 攻击 ： 第一种 是 攻击者 破坏 资源 ， 使得 其他 用户 无法 使用 ； 另 一种 是 攻击者 加载 过多 的 服务 将 资源 全部 使用 ， 同样 使得 其他 用户 无法 使用 。 主要 有 以下 几种 攻击 形式 。 
 7.1     服务 过载 
 　 　 当 从 一个 主机 向 服务器发送 太多 的 服务 请求 时 ， 就 会 发生 服务 过载 。 在 某些 情况 下 ， 系统 有 可能 会 崩溃 。 一个 典型 的 例子 就是 Finger 炸弹 。 客户机 用 Finger 来 搜集 主机 上 的 用户 信息 ， 如果 John 在 主机 VICTIM .   COM 上 有 一个 帐户 ， 那么 SNOOP . COM 上 的 用户 就 可以 执行 以下 的 命令 来 攻击 Finger   John 的 帐户 。 
 　 　 SNOOP   > finger   John @ victim . com 
 　 　 此时 finger 命令 被 认为 是从 SNOOP 主机 上来 的 。 如果 以 如下 的 形式 ： 
 　 　 SNOOP > finger   John @ victim . com @ third . com 
 　 　 就 会 被 认为 是从 third . com 上 传来 的 finger 命令 。 
 　 　 SNOOP & gt ;   finger   John @ @ @ @ @ @ ...... @ @ victim .   com 就 会 让 victim . com 重复 finger 自身 。 如果 重复 次数 足够 多 的话 ， 内存 、 缓冲区 、 硬盘 等 都 会 被 充满 ， 使得 机器 崩溃 。 防止 攻击 的 方法 就是 禁用 finger 服务 。 
 7.2     信息 淹没 
 　 　 当 一个 用户 使得 网络 上 的 某个 系统 速度 降低 ， 防止 它 以 正常 的 速度 处理 当前工作 时 ， 就 会 发生 信息 淹没 ， 向 服务器发送 上 千个 ICMP 回应 请求 ( 使用 ping 命令 ) 就 可以 达到 目的 。 这种 手段 通常 用来 攻击 确认 服务器 ， 使得 确认 服务器 工作 过载 ， 无法 正常 响应 客户 的 请求 。 这 就 使得 攻击者 能够 冒充 合法 的 确认 服务器 ， 回答 伪造 的 信息 ， 从而 获得 特权 帐户 。 信息 淹没 也 可以 用来 阻塞 网络 。 在 两个 提供 标准 TCP / UDP 服务 的 端口 间 来回 传送 数据包 也 可以 达到 此 目的 。 关掉 可能 产生 无限 序列 的 服务 就 可以 防止 这种 攻击 。 
 7.3     阻塞 
 　 　 TCP 用来 建立 连接 的 三次 握手 协议 可 被 用来 进行 一种 服务 拒绝 攻击 ， 即 前面 提到 的 TCP 连接 欺骗 中 用来 阻塞 FRIEND 的 方法 。 服务器 ( FRIEND ) 向 客户机 ( EVIL 冒充 的 UNREACH ) 发送 一个 SYN / ACK 信息 但 却 收不到 ACK 信息 ， 建立 了 一个半 连接 。 服务器 在 内存 中 建立 一个 队列 用来 放置 所有 的 等待 连接 ， 这个 队列 的 大小 是 有限 的 ， 当 等待 连接 过多时 就 会 溢出 。 尽管 半 连接 一段时间 后 就 会 被 清除 ， 但 只 需 不断 给 服务器发送 伪造 的 SYN 请求 就 可以 抵消 清除 的 效果 。 为了 防止 这 类 攻击 ， 可以 增加 等待 连接 的 队列 的 长度 并 减少 半 连接 的 保存 时间 。 
 8     结论 
 　 　 综上所述 ， 由于 TCP / IP 协议 本身 存在 的 一些 缺陷 ， 给 网络安全 带来 了 一些 隐患 ， 必须 采取 一些 附加 的 安全 防范措施 。 我们 这里 仅 讨论 了 一些 针对 TCP / IP 协议 的 安全 问题 ， 而 由 操作系统 和 防火墙 所 带来 的 网络安全 问题 是 大家 需要 另外 注意 的 问题 。 
 赵季 中 ( 西安交通大学 计算机科学 与 技术 系     西安   710049 ) 
 宋政湘 ( 西安交通大学 计算机科学 与 技术 系     西安   710049 ) 
 齐勇 ( 西安交通大学 计算机科学 与 技术 系     西安   710049 ) 
 参考文献 
 1 ， 周 明天 ,   汪文勇 .   TCP / IP 网络 原理 与 技术 .   北京 :   清华大学出版社 ,   1993 
 2 ， D .   Brent   Chapman .   构筑 因特网 防火墙 .   北京 :   电子 工业 出版社 ,   1998 
 收稿 日期 ： 1999 - 12 - 16 
