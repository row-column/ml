计算机 应用 研究 
 APPLICATION   RESERCH   OF   COMPUTERS 
 2000     Vol.17 　 No.1 　 P.21 - 22 ， 64 
 
 
 
 
 基于 Agent 的 工作 流 模型 与 应用 
 王东 　 任午 令 　 何志均 
 摘   要   CIMS 应用 集成 平台 是 企业 实施 CIMS 的 有效 支持 工具 ， 而 MIS 系统 则 是 整个 CIMS 集成 平台 的 重要 组成部分 。 主要 研究 了 基于 Agent 的 工作 流 模型 及其 在 MIS 系统 中 的 应用 。 在 WFMS 参考模型 的 基础 上 ， 提出 了 一个 基于 Agent 的 、 易于 扩展 和 移植 的 、 以 浏览器 作为 用户界面 的 工作 流 管理系统 ： ABs _ WFMS ， 并 介绍 了 系统 的 运作 方式 。 基于 Agent 的 工作 流 管理系统 在 浙江 好来 西 CIMS 系统 的 开发 中作 了 有益 的 尝试 。 
 关键词   CIMS   工作 流 管理   Agent   Web   Browser 
 1 　 引言 
 　 　 当今 企业 在 激烈 的 市场竞争 中 寻求 生存 和 发展 ， 在外 主要 依靠 准确 抓住 市场 机会 ， 在内 则 需要 企业 能 快速 灵活 地 适应 市场 的 发展 变化 。 近年来 ， 在 国家 863 / CIMS 工程技术 研究 中心 的 大力推广 下 ， 国内 许多 制造 性 企业 都 在 开发 与 实施 计算机 集成 制造 系统 ( CIMS ) ， 而 集成化 信息管理系统 ( MIS ) 则 是 整个 CIMS 应用 的 关键 。 然而 作为 整个 CIMS 开发 关键 的 MIS 开发 却 有 一些 令人 感到 棘手 的 问题 ， 这些 问题 有 ： 扩展 能力差 、 难以 维护 、 可 重用 性差 ， 企业 内部 较 小 的 变化 可能 引起 系统 的 重大 修改 。 
 　 　 工作 流 管理系统 ( Work   Flow   Management   System ， WFMS ) ， 作为 一种 对 常规性 事务 进行 管理 、 集成 的 技术 ， 它 可以 改进 和 优化 业务流程 ， 提高 业务 工作效率 ， 在 企业 内部 实现 更好 的 业务 过程 控制 和 业务 监督机制 ， 从而 减少 企业 对 市场需求 变化 的 反应时间 。 工作 流是 指 根据 一组 定义 的 顺序 规则 ， 对 生产 经营 过程 的 部分 或 全部 实现 自动化 。 当前 的 工作 流 管理系统 大多 是 基于 事务处理 机制 的 ， 通过 扩展 E - mail 功能 或者 定义 规则 库来 实现 工作 流程 。 本文 提出 了 一种 用 全球网 浏览器 ( Web   Browser ) 作为 用户 的 统一 界面 ， 通过 Agent 来 实现 工作 流 服务 的 制定 、 管理 和 监控 的 工作 流 管理系统 。 与 基于 E _ mail 或 基于 规则 的 工作 流 管理信息系统 相比 ， ABs _ WFMS 有 以下 优点 。 
 　 　 ( 1 ) 通过 消除 各 工作站 间 的 直接 数据 传送 ， 减少 了 网络 的 通信量 。 
 　 　 ( 2 ) 将 工作 流 的 流程 描述 从 对 工作 流 的 控制 中 分离出来 ， 提高 了 系统 的 可 扩展 能力 。 
 　 　 ( 3 ) 对 工作 流 的 局部 改动 可以 在 任何 时候 进行 ， 从而 大大 地 减少 了 系统维护 的 工作量 。 
 　 　 这些 优点 很 好地解决 了 MIS 系统 开发 中 遇到 的 问题 。 本文 的 第 2 和 第 3 部分 介绍 了 此 基于 Agent 的 工作 流 管理系统 ( Agent   Based   WFMS ， ABs _ WFMS ) 的 设计 和 实现 思想 ， 第 4 部分 通过 对 一个 新 产品开发 流程 的 演示 来 进一步 介绍 实现 细节 。 
 2 　 ABs _ WFMS 中 的 Agent 概念模型 
 2.1 　 ABs _ WFMS 中 Agent 的 工作 机制 
 　 　 Agent 是 一组 定义 精良 的 数据 和 程序 体 ， 它 能够 根据 自身 携带 的 信息 自主 地 完成 预定 义 的 操作 。 从 生产 经营 过程 的 角度 出发 ， 一个 企业 可以 被 视为 由 多个 相互 关联 的 不同 层次 的 流程 组成 的 网络 。 企业 中 每个 流程 都 可以 是 一个 独立 的 Agent ， 如新 产品 的 开发 Agent 、 产品设计 Agent 、 产品 制造 Agent 、 产品销售 Agent 等 。 每种 Agent 都 由 Agent   Server 根据 流程 描述 图来 生成 ， 每 一个 Agent 可以 根据 预定 义 的 工作 流程 自主 地 通过 网络 从 一个 流程 岗位 转到 另 一个 流程 岗位 ， 收集 信息 并 完成 其 自身 的 任务 。 也就是说 Agent 能 在 某 一点 暂停 自己 的 执行 ， 迁移 到 另一台 机器 ， 然后 恢复 执行 ， 如此 循环 直到 生产 经营 过程 的 正确 完成 或 异常 终止 。 当 一个 活动 的 Agent 从 一个 岗位 传到 另 一个 岗位 时 ， 它 自带 有 执行 本 岗位 所 需要 的 数据 和 代码 ， 不 需要 从 数据库 服务器 中 读取数据 。 同时 Agent 还有 自 学习 的 功能 ， 当 一个 Agent 在 它 的 处理过程 中 发生 了 异常 错误 时 ， Agent 能 访问 异常 处理 服务器 ， 在 异常 处理 服务 中 定义 的 规则 能够 指导 此 Agent 修改 它 的 工作 流程 并 保存 到 Agent   Server 的 流程 描述 库中 。 当下 一次 同 一种 异常 发生 时 ， 就 不 需要 再 访问 异常 处理 服务器 而 直接 到 下 一个 流程 岗位 。 
 　 　 Agent 知道 如何 在 一个 工作 流 内部 的 岗位 上 流转 ， 它 储存 着 关于 此 流程 的 内部 状态 和 行为 的 一些 基本知识 ( 如图 1 ) 。 
 
 图 1 　 WA - WFMS 中 的 Agent 
 　 　 Agent 携带 有 整个 流程图 和 工作 流程 上 每 一步 所 需 的 基本 对象 信息 ， 包括 状态变量 和 特定 对象 类 的 方法 以及 成功 完成 每 一个 岗位 的 商业 规则 。 
 2.2 　 Agent 的 自主 传送 功能 
 　 　 为了 实现 Agent 的 自动 流转 功能 ， 需要 在 Agent 上 定义 一组 原子 函数 ， 这些 函数 为 Agent 提供 了 诸如 网络 传送 、 成组 通信 、 失败 控制 以及 访问控制 等 服务 。 其中 一个 重要 的 函数 是 agent _ jump (   ) ， 它 实现 将 此 Agent 从 一台 工作站 传送 到 另一台 工作站 。 agent _ jump (   ) 捕获 Agent 的 内部 状态 ， 将 数据 加密 ， 然后 传送 到 目标 工作站 ， 目标 工作站 重新启动 此 Agent ， 并 从 断点 继续 此 Agent 的 流程 ( 如图 2 ) 。 
 
 图 2 　 Agent 在 两台 主机 之间 传送 
 3 　 ABs _ WFMS ： 基于 Agent 的 工作 流 管理系统 
 3.1 　 ABs _ WFMS 系统 的 体系结构 
 　 　 ABs _ WFMS 体系结构 的 设计 参照 WFMS 参考模型 ( Workflow   Management   Coalition   Reference   Model ) 进行 ， 从 CIMS 应用 集成 平台 出发 ， 增强 了 任务 队列 管理器 的 功能 ， 由 它 统一 负责 整个 系统 的 工作 流 任务 队列 的 管理 。 ABs _ WFMS 由 4 大部分 组成 ： 人机界面 、 活动 Agents 、 Agent 服务器 、 任务 队列 管理器 。 它们 之间 的 关系 如图 3 所示 。 
 
 图 3 　 ABs _ WFMS 系统 体系结构 
 　 　 下面 简要地 介绍 一下 ABs _ WFMS 体系结构 中 四个 主要 部分 的 功能 。 
 　 　 。 人机界面 ： 
 　 　 ABs _ WFMS 系统 的 人机界面 采用 环球网 浏览器 ( Web   Browser ) ， 用来 显示 等待 本 岗位 处理 的 任务 ( Agent 描述 信息 ) 、 用户 输入 信息 和 系统 反馈 信息 等 。 当 用户 以 用户名 和 密码 通过 浏览器 登录 工作 流 系统 后 ， 系统 数据库 服务器 根据 用户名 查询 对应 的 岗位 号 ， 并 以 三元组 ( WKST ， User ， ST _ id ) 的 形式 提供 给 任务 队列 管理器 ， 由 任务 队列 管理器 更新 用户界面 。 
 　 　 。 活动 Agents ： 
 　 　 活动 Agents 是 系统 的 工作 部件 ， 企业 中 的 一切 生产 经营 活动 都 是 通过 活动 Agents 来 完成 的 。 每个 Agent 都 对应 着 一个 流程 ， 在 Agent 服务器 和 任务 队列 管理器 的 帮助 下 自主 地 完成 整个 流程 。 
 　 　 。 Agent 服务器 ： 
 　 　 作为 系统 的 核心部件 ， Agent 服务器 保存 有 企业 的 商业 规则 、 流程 描述 等 信息 ， 负责 协调 、 控制 整个 系统 的 正常 运转 ， 同时 为 Agent 提供 信息 查询 、 异常 处理 等 服务 。 在 Agent 的 整个 生命周期 中 ， 需要 许多 不同 的 Agent 服务器 来 提供 信息 支持 ， 最 主要 的 两个 是 系统 服务器 和 跟踪 服务器 。 
 　 　 ( 1 ) 系统 服务器 ： 存放 基本 的 工作 流 信息 和 企业 的 结构 信息 。 每 一个 新 生成 的 Agent 都 要 通过 系统 服务器 来 获得 对应 类型 工作 流 流程 的 基本 流程 信息 ， 包括 流程图 和 初始状态 等 。 
 　 　 ( 2 ) 跟踪 服务器 ： 保存 并 跟踪 系统 中 所有 活动 的 工作 流 Agent ， 当 任何 一个 Agent 服务器 中 的 信息 发生变化 时 ， 通过 任务 队列 服务器 通知 相应 的 活动 Agent 到 对应 的 Agent 服务器 去 更新 数据 。 
 　 　 。 任务 队列 管理器 ( 兼作 WWW 服务器 ) ： 
 　 　 管理 一个 任务 队列 ， 更新 系统 中 活动 Agent 的 处理结果 信息 ， 通知 活动 Agent 到 相应 Agent 服务器 更新 数据 以及 根据 活动 Agent 的 处理结果 更新 相应 岗位 人机界面 的 信息 ， 同时 兼作 系统 的 WWW 服务器 。 Agent 的 每个 岗位 处理 完后 都 要 访问 任务 队列 管理器 ， 用 Agent 的 当前 状态 更新 任务 队列 管理器 保存 的 信息 ， 然后 由 任务 队列 管理器 来 更新 此 Agent 下 一个 岗位 的 用户界面 。 
 3.2 　 ABs _ WFMS 中 工作 流 的 组织 和 运行 
 　 　 ABs _ WFMS 的 体系结构 使 用户 修改 工作 流程 和 增加 新 的 工作 流 变得 非常容易 ， 图 4 展示 了 工作 流 的 运行 情况 。 
 
 图 4 　 ABs _ WFMS 动作 方式 
 　 　 流程 1 ： 就绪 的 Agent 将 流程 类型 和 开始 流程 的 工作站 编号 送到 系统 服务器 。 
 　 　 流程 2 ： 系统 服务器返回 工作 流程图 和 初始状态 。 
 　 　 流程 3 ： Agent 在 跟踪 服务器上进行 登记 。 
 　 　 流程 4 ： 在 工作 流 Agent 的 一个 岗位 结束 后 ， 通知 任务 队列 管理器 。 
 　 　 流程 5 ： 任务 队列 管理器 更新 用户界面 信息 。 
 　 　 流程 6 ： 用户 提交 数据 ， 返回 流程 4 
 　 　 直到 流程 正常 完成 或 异常 退出 。 
 　 　 当 用户 修改 系统 服务器 中 的 流程 信息 时 ： 
 　 　 流程 A ： 系统 服务器 通知 跟踪 服务器 修改 所 影响 的 用户 和 流程 。 
 　 　 流程 B ： 跟踪 服务器 通知 任务 队列 管理器 修改 所 影响 的 Agents 。 
 　 　 流程 C ： 当受 影响 的 Agent 访问 任务 队列 服务器时 ， 任务 管理器 通知 Agent 对应 的 系统 服务器 已经 被 改动 。 
 　 　 流程 D ： Agent 访问 对应 的 系统 服务器 。 
 　 　 流程 E ： 系统 服务器 用 改动 后 的 信息 更新 Agent 。 
 4 　 应用 与 总结 
 　 　 在 国家 CIMS 应用 示范 工程 浙江 好来 西 CIMS 项目 的 MIS 子系统 中 ， ABs _ WorkFlow 作 了 有益 的 尝试 ， 这里 以新 产品 的 开发 为 例来 简要 说明 一下 。 
 　 　 新 产品开发 的 流程 如图 5 。 
 
 图 5 　 新 产品开发 流程 说明 
 　 　 当新 产品开发 任务书 的 单据 填好 并 提交 后 ， 系统 产生 一个 类型 为 新 产品开发 的 Agent ， 此 Agent 从 系统 服务器 得到 如上 的 新 产品开发 流程 并 在 跟踪 服务器 上 登记 后 ， 生成 两个 子 Agent ， 在 任务 队列 管理器 的 帮助 下 分别 转 到 岗位 2 和 岗位 4 执行 各自 的 子 任务 ， 岗位 2 上 的 子 Agent 在 完成 采样 、 确样 和 材料 档案 的 更新 后 返回 父 Agent ， 并 向 父 Agent 给出 一个 完成 的 信息 ， 然后 删除 自己 ， 父 Agent 在 岗位 2 和 岗位 4 的 子 Agent 都 向 他 提供 了 完成 信息 后 ， 从 跟踪 服务器 上 注销 ， 新 产品开发 流程 就 完成 了 。 
 　 　 本文 就 基于 Agent 工作 流 管理系统 的 设计 进行 了 讨论 ， 给出 了 它 的 基本 体系结构 和 运作 方式 。 使用 了 两种 基本 技术 ： Browse / Server 技术 和 Agent 技术 。 着重 讨论 了 工作 流 管理系统 下 Agent 是 如何 自主 地 完成 工作 流 任务 的 。 基于 Agent 的 工作 流 管理系统 的 应用 ， 将 大大 地 缩短 企业 CIMS 系统 的 开发 时间 ， 提高 CIMS 系统 的 灵活性 和 可靠性 。 
 王东 （ 浙江大学 人工智能 研究所   杭州   310027 ） 　 
 任午 令 （ 浙江大学 人工智能 研究所   杭州   310027 ） 　 
 何志均 （ 杭州 商学院 计算机系   杭州   310035 ） 
 参考文献 
 1 ， 李芳芸 ,   柴跃廷 .   CIMS 环境 下 椉  苫  芾 硇 畔 ⑾ 低车姆治 觥 ⑸ 杓 朴胧凳 ?   北京 ： 清华大学出版社 ,   1997 年 6 月 
 2 ， Munindar   P .   Singh ,   Formal   Aspects   of   Workflow   Management ,   Department   of   Computer   Science   North   California   State   University ,   June   18 ,   1997 
 3 ， Jablonski ,   S .   A   Software   Architecture   for   workflow   management   system ,   Los   Alamitos ,   CA ,   USA ,   Conf .   Date :   26 ~ 28   Aug .   1998 
 4 ， Hermans ,   B .   Intelligent   software   agents   on   the   Internet ,   Munksgaard   International   Publishers ,   3   March ,   1997 
 收稿 日期 ： 1999 年 7 月 1 日 
