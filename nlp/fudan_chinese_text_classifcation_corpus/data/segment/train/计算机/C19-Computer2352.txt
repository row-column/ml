计算机 研究 与 发展 
 JOURNAL   OF   COMPUTER   RESEARCH   AND   DEVELOPMENT 
 1999 年   第 36 卷   第 8 期   Vol.36   No.8   1999 
 
 
 
 动态 系统 的 演化 建模 
 曹宏庆 　 康立山 　 陈毓屏 
 摘 　 要 　 针对 采用 传统 方法 解决 动态 系统 的 微分方程 建模 问题 所 遇到 的 困难 和 存在 的 不足 ， 文中 设计 了 将 遗传 程序设计 与 遗传算法 相 嵌套 的 混合 演化 建模 算法 ， 以 遗传 程序设计 优化 模型 结构 ， 以 遗传算法 优化 模型 参数 ， 成功 地 实现 了 动态 系统 的 常 微分方程 组建 模 过程 自动化 ． 计算 实例 表明 ： 采用 此 算法 能 在 合理 的 运行 时间 内 由 计算机 自动 发现 多个 较优 的 常微分 方程组 模型 ， 和 现有 的 建模 方法 ( 如 灰色 系统 方法 ) 相 比较 ， 它 具有 建模 过程 智能化 与 自动化 、 模型 结构 更加 灵活多样 、 方法 适用性 更广 、 数据 拟合 和 预测 的 精度 更 高等 优点 ． 
 关键词 　 常微分 方程组 ， 演化 建模 ， 遗传 程序设计 ， 遗传算法 ， 灰色 系统 
 中图法 分类号 　 TP301.6 
 A   HYBRID   EVOLUTIONARY   MODELING   ALGORITHM   FOR   DYNAMIC   SYSTEMS 
 CAO   Hong - Qing ,   KANG   Li - Shan ,   and   CHEN   Yu - Ping   
 ( State   Key   Laboratory   of   Software   Engineering ,   Wuhan   University ,   Wuhan   430072 ) 
 Abstract 　 To   overcome   the   difficulties   and   drawbacks   in   modeling   the   dynamic   systems   by   using   traditional   methods ,   a   hybrid   evolutionary   modeling   algorithm   ( HEMA )   is   proposed   to   model   the   dynamic   system   with   a   system   of   ordinary   differential   equations   ( ODEs )   whose   main   idea   is   to   embed   genetic   algorithm   ( GA )   in   genetic   programming   ( GP )   where   GP   is   employed   to   optimize   the   structure   of   a   model ,   and   GA   is   employed   to   optimize   the   parameters   of   a   model .   It   has   succeeded   in   automating   the   modeling   process   of   systems   of   ODEs   for   dynamic   systems .   The   computational   experiments   indicate   that ,   by   running   the   HEMA ,   the   computer   can   search   out   multiple   superior   ODEs   models   in   a   reasonable   time .   Compared   with   most   available   modeling   methods ,   such   as   the   grey   systems   method   ( GSM ) ,   this   algorithm   possesses   the   advantages   of   automation   of   the   modeling   process ,   more   flexible   and   various   model   structures ,   wider   range   of   applications ,   and   higher   precision   of   fitting   and   predicting   data .   
 Key   words 　 system   of   ordinary   differential   equations ,   evolutionary   modeling ,   genetic   programming ,   genetic   algorithm ,   grey   systems 
 1 　 引 　 言 
 　 　 在 工程技术 、 经济 管理 、 自然科学 和 社会科学 等 领域 普遍存在 着 许多 随 时间 而 变化 的 复杂 系统 和 非线性 现象 ， 如 物价 的 波动 、 产品 销售量 的 增减 、 天气 的 变化 、 人口 的 增长 等 ． 人们 通常 需要 根据 动态 系统 的 观测 数据 建立 合理 的 微分方程 模型 ( 动力学 模型 ) ， 为 系统分析 、 设计 和 未来 状态 的 预报 提供 依据 ， 而 这 通常 是 一件 非常 重要 而 又 十分困难 的 事情 ． 传统 的 建模 方法 是 凭直觉 或 经验 事先 假定 一种 微分方程 的 形式 ， 然后 采用 一些 数值 方法 确定 其中 的 未知 参数 ［ 1 ～ 3 ］ ． 而 面对 纷繁复杂 的 数据 ， 如何 选择 合适 的 微分方程 模型 结构 通常 是 很 困难 的 ， 尤其 是 当 微分方程 中 的 变量 个数 增多 时 ． 
 　 　 目前 在 经济 、 社会 、 农业 等 系统 的 预测 中 ， 国内 采用 较 多 的 是 邓 聚龙 的 灰色 系统 建模 方法 ［ 4 ］ ， 其中 用 微分方程 描述 的 典型 模型 包括 GM ( n , 1 ) 和 GM ( 1 , h ) 模型 ． 采用 这种 方法 同样 存在 着 模型 的 结构 选择 问题 ， 即 对于 同一 数据 集 ， 选取 不同 的 n ， h 值得 到 的 模型 不同 ， 因而 拟合 和 预测 的 效果 也 不同 ， 并且 模型 的 结构 也 比较 单一 和 固定 ． 除此之外 ， 还 存在 着 两点 不足 ： ① 　 对于 复杂 的 动态数据 ， 模型 的 拟合 和 预测 的 精度 不高 ， 要 反映 摆动 的 过程 还 需 通过 残差 辨识 建立 多次 残差 模型 来 作 补充 修改 ； ② 　 作为 状态 模型 的 GM ( 1 , h ) 模型 只能 反映 其它 h - 1 个 变量 对 某 一 变量 的 一阶 导数 的 影响 , 不能 反映 多 因素 系统 内 各 变量 之间 的 相互作用 ， 而 自然界 中 普遍存在 着 相互 制约 、 相互作用 的 系统 ， 如 物种 之间 的 共生 和 竞争 关系 、 国家 之间 的 军备竞赛 等 ， 这些 都 需要 通过 微分方程 组来 描述 ． 
 　 　 针对 这些 问题 ， 本文 利用 演化 算法 的 自 适应 、 自 组织 、 自 学习 的 特性 ， 设计 了 将 遗传 程序设计 与 遗传算法 相 嵌套 的 混合 演化 建模 算法 ， 以 遗传 程序设计 优化 模型 结构 ， 以 遗传算法 优化 模型 参数 ， 成功 地 实现 了 动态 系统 的 常 微分方程 组建 模 过程 自动化 ， 即 完全 由 计算机 自动 地 从 动态 系统 的 观测 数据 中 发现 描述 该 系统 的 常微分 方程组 ． 
 2 　 问题 的 数学 描述 
 　 　 首先 定义 矩阵 的 模为 
 
 　 　 假设 一 动态 系统 是 由 n 个 相互 关联 的 函数 加以 描述 的 ． 已 观测 到 该 系统 在 时间 的 一系列 数据 为 
 
 其中 t0 为 起始 时刻 ， Δ t 为 时间 间隔 ， 表示 变量 xj 在 ti 时刻 的 观测 值 ． 
 记 
 
 其中   是 由 初等 函数 的 复合 函数 来 表示 的 ． 记 这类 函数 组成 的 空间 为 F ． 
 　 　 常微分 方程组 的 建模 问题 就是 求 
 
 使得 最小 ． 其中 
 
 并 可 由此 预报 系统 的 未来 状态 . 
 3 　 混合 演化 建模 算法 
 　 　 演化 算法 是 模拟 自然界 的 生物 演化过程 ， 借鉴 生物界 的 自然选择 和 自然 遗传 机制 而 发展 起来 的 一类 问题 求解 的 策略 和 方法 ． 它 采用 简单 的 编码 技术 来 表示 各种 复杂 的 结构 ， 并 通过 对 一组 编码表示 进行 简单 的 遗传操作 和 优胜劣汰 的 自然选择 来 指导 学习 和 确定 搜索 的 方向 ． 由于 演化 算法 本身 具有 的 自 组织 、 自 适应 和 自 学习 等 智能 特征 以及 本质 的 并行性 和 易于 操作 、 通用性 强 等 特点 ， 目前 已 被 成功 地 应用 于 机器 学习 、 模式识别 、 经济 预测 、 优化 控制 及其 并行处理 等 领域 ［ 5 , 6 ］ ． 演化 算法 最初 具有 3 个 分支 ： 遗传算法 ( GA ) 、 演化 规划 ( EP ) 和 演化 策略 ( ES )   ． 90 年代 初 ， 在 遗传算法 的 基础 上 又 发展 了 遗传 程序设计 这 一新 的 分支 ［ 7 ～ 9 ］ ， 它用 树结构 来 表示 不同 的 计算机程序 ， 由叶 结点 形成 终端 集 ， 通常 包括 变量 、 常数 和 无参 函数 ， 由 中间 结点 形成函数 集 ， 通常 包括 算术 操作 和 一些 带 参数 的 初等 函数 ， 采用 遗传算法 的 基本 思想 ， 通过 使用 一些 遗传操作 ( 包括 再生 、 杂交 、 变异 等 遗传 算子 ) 动态 地 改变 这些 结构 ， 并且 一代代 演化 下去 ， 直到 找到 满足 问题 要求 的 解 ． 
 　 　 采用 传统 的 遗传 程序设计 方法 来 实现 常微分 方程组 的 演化 建模 ， 虽然 模型 的 结构 较 传统 方法 有 更 大 的 灵活性 ， 但 同时 也 存在 着 一个 问题 ， 即 在 种群 进化 过程 中 ， 一些 结构 较 好 的 模型 有 很大 概率 会 因 其 随机 产生 的 参数 不 合适 致使 其 适应 值低 而 被 淘汰 出 种群 ， 使得 最终 搜索 到 的 模型 精确度 不高 ， 并且 演化 速度慢 ， 还会 出现 “ 过早 收敛 ” 的 现象 . 为此 本文 在 用 遗传 程序设计 演化 建模 的 每 一代 嵌入 模型 的 参数 优化 过程 ， 使得 进化 过程 明显 加快 并且 所得 模型 更优 . 由于 传统 的 一些 非线性 参数估计 的 算法 ， 如 直接 搜索 法 、 Hooke - Jeeves 法 、 Nelder - Mead 法 、 梯度 法和变 尺度 法 ［ 10 ］ 等 ， 通常 只 对 某 一类 特定 问题 才 有效 ， 而且 对模型 的 限制 条件 较强 ， 如 要求 模型 具有 连续 、 可导 、 单峰 等 特性 ， 而 演化 建模 算法 产生 的 模型 复杂 多样 ， 并且 可能 由 多个 方程 组成 ， 包含 多组 参数 且 参数 的 维数 也 不 固定 ， 用 这些 方法 根本无法 获得 其 参数估计 ． 为此 我们 采用 实数 编码 的 遗传算法 实现 对 任意 模型 的 参数 优化 ． 
 　 　 以 遗传 程序设计 优化 模型 结构 ， 以 遗传算法 优化 模型 参数 ， 并 与 数据 的 预处理 、 模型 的 简洁 化 和 规范化 、 系统 的 预测 等 辅助 步骤 相结合 ， 便 构成 了 本文 的 混合 演化 建模 算法 ． 算法 的 结构 描述 如下 ： 
 PROCEDURE 　 　 　 混合 演化 建模 算法 
 begin   
 　 　 输入 原始数据 矩阵 X ( 0 ) ； 
 　 　 数据 预处理 得到 X ( 1 ) ； 
 　 　 随机 初始化 常微分 方程组 种群 P ( 0 ) ； 
 　 　 计算 P ( 0 ) 中 个体 的 适应 值 ； 
 　 　 s ∶ =   0 ; 
 　 　 repeat 
 　 　 　 　 模型 的 简洁 化 和 规范化 ； 
 　 　 　 　 optimized   ∶ 　 =   Φ ； 
 　 　 　 　 for   i ∶ =   1   to   popsize   do   
 　 　 　 　 begin 
 　 　 　 　 　 　 if ( 个体 pi 的 结构 optimized ) 
 　 　 　 　 　 　 begin 
 　 　 　 　 　 　 　 　 分离 个体 pi 中 各 微分方程 中 所 包含 的 参数 ； 
 　 　 　 　 　 　 　 　 随机 初始化 参数 种群 Q ( 0 ) ； 
 　 　 　 　 　 　 　 　 计算 Q ( 0 ) 中 个体 的 适应 值 ； 
 　 　 　 　 　 　 　 　 t ∶ =   0 ； 
 　 　 　 　 　 　 　 　 repeat 
 　 　 　 　 　 　 　 　 　 　 按 适应 值 大小 和 选择 策略 从 Q ( t ) 中 选择 生成 下一代 的 父体 Q ( t + 1 ) ； 
 　 　 　 　 　 　 　 　 　 　 执行 杂交 、 变异 和 再生 操作 来 重组 Q ( t + 1 ) ； 
 　 　 　 　 　 　 　 　 　 　 计算 Q ( t + 1 ) 中 个体 的 适应 值 ； 
 　 　 　 　 　 　 　 　 　 　 t ∶ =   t + 1 ； 
 　 　 　 　 　 　 　 　 until 　 　 　 满足 终止 条件 Ⅱ ； 
 　 　 　 　 　 　 　 　 用 Q ( t ) 中 的 最好 个体 替换 pi 中 各 方程 的 对应 参数 项 ； 
 　 　 　 　 　 　 　 　 optimized ∶ =   optimized ∪ {   pi 的 结构   } ； 
 　 　 　 　 　 　 end 
 　 　 　 　 end 
 　 　 　 　 按 适应 值 大小 和 选择 策略 从 P ( s ) 中 选择 生成 下一代 的 父体 P ( s + 1 ) ； 
 　 　 　 　 执行 杂交 、 变异 和 再生 操作 来 重组 P ( s + 1 ) ； 
 　 　 　 　 计算 P ( s + 1 ) 中 个体 的 适应 值 ； 
 　 　 　 　 s ∶ =   s + 1 ； 
 　 　 until 　 　 　 满足 终止 条件 Ⅰ ； 
 　 　 用 P ( s ) 中 的 最好 个体 作 系统 的 预测 ； 
 end 
 4 　 算法 的 详细描述 
 4.1 　 数据 的 预处理 
 　 　 采用 多维 离散 傅立叶 变换 后 ， 再 通过 低 通滤波 消除 高频 成分 以 消除 原始数据 的 部分 噪声 ． 
 4.2 　 自 适应 的 演化 建模 过程 
 　 　 ( 1 )   编码表示 
 　 　 基于 传统 遗传 程序设计 所 特有 的 树形 编码方式 ， 我们 将 其 个体 的 单树 表示 扩展 成由 一组 二叉树 构成 的 向量 形式 ， 其中 n 为 常微分 方程组 的 方程 个数 ． 例如 ： 含 3 个 未知 函数 的 常微分 方程组 ： 
 
 可 表示 成如图 1 的 一组 二叉树 的 形式 ． 我们 限定 树 的 最大 深度 为 D ,   用 个体 中 每个 二叉树 所 包含 的 结点 数来 描述 其 复杂度 ． 
 
 
 图 1 　 常 微分方程 的 二叉树 表示 
 　 　 ( 2 )   适应 值 的 度量 
 　 　 假设 提供 如 ( 2 ) 式 的 观测 数据 ， 数据 预处理 后 得到 矩阵 ， 个体 可 表示 为 如下 的 常微分 方程组 形式 
 
 则 计算 其 适应 值   fit ( pi )   的 过程 如下 ： 
 PROCEDURE 　 　 　 计算 pi 的 适应 值 
 begin 
 　 　 假设 X * 和 Δ X 为 m × n 阶 矩阵 ， 将 X ( 1 ) 的 第一行 元素 赋给 X * 的 第一行 ； 
 　 　 for   i ∶ =   2   to   m   do 
 　 　 begin 
 　 　 　 　 以 X ( 1 ) 的 第 i - 1 行 元素 为 初始值 ， 采用 数值 算法 对 ( 6 ) 式 积分 一步 ， 生成 X * 的 第 i 行 元素 ； 
 　 　 end 
 　 　 Δ X ∶ =   X ( 1 ) -   X * ； 
 　 　 fit ( pi ) ∶ = ‖ Δ X ‖ ； 
 end 
 　 　 显然 ， 这里 适应 值越 小 ， 个体 的 性能 越 好 ． 同时 ， 在 计算 适应 值 的 过程 中 , 一些 随机 生成 的 常微分 方程组 的 解 可能 不 满足 稳定性 要求 ， 致使 在 迭代 过程 中 会 出现 数值 的 溢出 ， 这时 可令 其 返回 一个 较大 的 适应 值 作为 惩罚 ， 从而 使得 它 在 进行 选择 时 很快 被 淘汰 出 种群 ． 在 适应 值 的 评估 过程 中 我们 采用 的 是 固定 步长 为 0.01 的 改进 的 欧拉 法 ． 
 　 　 ( 3 )   模型 的 简洁 化 和 规范化 
 　 　 模型 的 简洁 化即 化简 模型 种群 中 每个 个体 的 树结构 ， 用 可 计算出来 的 值 替代 掉 树 的 某些 部分 ， 不 改变 个体 的 适应 值 ． 它 在 每 一 演化 代 作用 于 所有 个体 ， 这一 过程 直接 影响 到 模型 被 优化 的 参数 的 个数 ． 
 　 　 模型 的 规范化 即 调整 模型 的 树 分量 中以 “ + ” 或 “ × ” 为根 结点 ， 左子 树 或 右子 树为 一 常数 的 子树 的 结构 ， 使得 所有 模型 的 S - 表达式 中 常数 项均 位于 “ + ”   、 “ × ” 运算符 的 右边 ． 这样 有利于 对 同类 模型 结构 的 识别 ， 不至于 在 模型 的 参数 优化 时 将 a + x 和 x + a 或 a × x 和 x × a 判断 成 不同 的 模型 结构 而 重复 进行 优化 ． 
 　 　 ( 4 )   选择 策略 和 遗传 算子 的 设计 
 　 　 采用 规模 为 4 的 锦标赛 选择 策略 并 采用 了 择优 策略 ， 即将 上代 最好 个体 保留 在 当前 新 的 群体 中 ． 
 　 　 设两 杂交 个体 和 , 杂交 操作 可 分成 向 量级 和 树 分量 级 两级 进行 ． 向 量级 的 杂交 即 依次 从中 随机 选择 一树 分量 作为 杂交 后代 的 树 分量 ； 树 分量 级 的 杂交 则 对 父代 向量 的 每 对 分量 作 如下 操作 ： 随机 选择 两 杂交 点 ， 交换 以 杂交 点为 根 结点 的 相应 子树 得到 两个 新树 ， 以树深 不 超过 D 为 原则 ， 选择 任一 合理 的 二叉树 作为 杂交 后代 的 树 分量   ．   
 　 　 个体 在 变异 时 依据 其 适应 值 不同 采取 自 适应 地 动态 调节 变异 概率 的 方式 ［ 11 ］ ， 使得 对于 较 好 的 解 只 在 其 局部 进行 搜索 ， 而 对于 较差 的 解则 在 较大 的 范围 内 搜索 ． 设 个体 ， 则 其 变异 概率 为 
 
 其中 fmin   为 当前 代 最好 个体 的 适应 值 ， fi 为 个体 i 的 适应 值 ． 进行 变异 操作 时先 随机 选择 一树 分量 ， 再 对作 如下 操作 ： 随机 选择 一 变异 点 ， 删除 以 变异 点为 根 结点 的 子树 ， 并 插入 一 随机 生成 的 子树 ， 生成 新 的 树 分量 和 原来 的 树 分量 一起 构成 了 变异 后代 
 4.3 　 模型 的 参数 优化 过程 
 　 　 ( 1 )   编码表示 
 　 　 首先 对模型 的 结构 进行 判别 ， 若 属于 已 优化 过 的 结构 则 不再 优化 ． 模型 在 进行 参数 优化 前要 先 分离 出 每个 树 分量 Ti ( i 从 1 至 n ) 中 的 参数 ， 计算 其 个数 li 并 记录 相应 位置 ， 则 参数 种群 Q ( t ) 中 的 每个 个体 可 表示 成 n 个维数 分别 为 li 的 行向量 形式 ： 
 
 其中 行向量 Ci 中 的 每个 分量 cij 均 采用 实数 编码 的 方式 ． 
 　 　 ( 2 )   适应 值 的 度量 
 　 　 将 个体 所含 的 n 个 行向量 一一对应 地代 回原 模型 的 相应 树 分量 中 ， 采用 和 4.2 节 ( 2 ) 同样 的 过程 计算 其 适应 值 的 大小 ． 
 　 　 ( 3 )   选择 策略 和 遗传 算子 的 设计 
 　 　 采用 和 4.2 节 ( 4 ) 相同 的 选择 策略 ． 
 　 　 设两 杂交 个体 
 
 进行 杂交 时 依次 对 每 对 ( i 从 1 至 n ) 作 如下 操作 ： 先 随机 选取 一 杂交 位置 k   ( 1 ≤ k ≤ li ) ， 再 采用 整体 算术 杂交 方法 ， 对 分量 生成 一 ( 0 , 1 ) 区间 的 随机数 α ， 则 两 后代 分量 定义 为 
 
 从而 形成 的 两 杂交 后代 为 
 
 　 　 变异 算子 采用 多级 变异 ［ 12 , 13 ］ ． 设 个体 ． 进行 变异 时 依次 对 每个 Ci ( i 从 1 至 n ) 作 如下 操作 ： 先 随机 选取 一 变异 点 k ( 1 ≤ k ≤ li ) ， 再 对 分量 cik 先生 成 0 至 15 间 的 一 随机 整数 j ， 设 参数 cik 的 定义域 为 ［ min ， max ］ , 则 变异 后 的 分量 定义 为 
 
 从而 形成 的 变异 后代 为 
 4.4 　 系统 的 预测 
 　 　 采用 演化 建模 过程 得到 理想 的 模型 后 便 可用 常微分 方程组 的 一些 数值 解法 , 如 欧拉 法 、 龙格 - 库塔 法等 ， 以 X ( 1 )   的 最后 一 行为 其 初始条件 积分 数步 得到 预测 序列 ． 
 5 　 计算 实例 
 5.1 　 实验 设置 
 　 　 为 检验 本文 算法 的 有效性 ， 我们 分别 选取 了 一维 实例 和 一个二维 实例 进行 了 实验 ， 对 每个 实例 采用 此 算法 独立 运行 40 次 ， 将 结果 与 灰色 系统 作 了 比较 ． 所有 实验 在 奔腾 586 微机 ( 166MHz ) 上 进行 ． 实验 的 参数设置 为 
 　 　 ( 1 )   自 适应 的 演化 建模 过程 ： 
 　 　 函数 集 ， 终端 集 ( n 为 常微分 方程组 中 方程 的 个数 ， c 为 常数 ) ， 种群 规模 为 100 ， 最大树 深为 4 ， 算法 运行 100 代 停止 ． 
 　 　 ( 2 )   模型 的 参数 优化 过程 ： 
 　 　 种群 规模 为 20 ， 杂交 、 变异 和 再生 概率 分别 为 0.6 、 0.3 和 0.1 ， 种群 中 最好 个体 的 适应 值 连续 3 代无 变化 时 停止 优化 ． 
 5.2 　 计算 实例   1 
 　 　 ( 1 )   实例 描述 
 　 　 数据 引自于 文献 ［ 2 ］ ， 见表 1 中 的 “ 实际 数据 ” 一栏 ( 人口 xi 的 单位 为 百万 )   ． 要求 以 美国 1790 ～ 1930 年 的 人口 为 实际 数据 建立 数学模型 并 预报 1940 年 和 1950 年 的 人口 值 ． 
 　 　 ( 2 )   实验 结果 及 分析 
 　 　 采用 灰色 系统 建立 的 灰色 GM ( 1 , 1 ) 模型 为   dx / dt   =   8.951490 + 0.205366 x 
 　 　 采用 演化 算法 独立 运行 40 次 ， 得到 的 几个 较 好 模型 为 
 　 　 模型 Ⅰ :   dx / dt   =   ( 1.384360 - ( x × t ) ) × ( ( x + 1.548616 ) × 20.574356 )   
 　 　 模型 Ⅱ :   dx / dt   =   x × ( 30.912327 - ( x × 0.151000 ) ) 
 　 　 　 　 　 　 简化 形式 ：   dx / dt   =   30.912327 x - 0.151000 x2 
 　 　 模型 Ⅲ :   dx / dt   =   ( ( x × 21.926580 ) + 111.811684 ) × cos ( x × t ) 
 　 　 各 模型 的 建模 结果 见表 1 ． 
 表 1 　 实例 1 ( 灰色 系统 建模 和 演化 建模 结果 比较 表 ) 
 
 实际 数据 灰色 模型 演化 模型 Ⅰ 演化 模型 Ⅱ 演化 模型 Ⅲ 
 年 　 份 序号   ixiiiii 
 1790   
 1800 
 1810 
 1820 
 1830 
 1840 
 1850 
 1860 
 1870 
 1880 
 1890 
 1900 
 1910 
 1920 
 19301 
 2 
 3 
 4 
 5 
 6 
 7 
 8 
 9 
 10 
 11 
 12 
 13 
 14 
 153.9 
 5.3 
 7.2 
 9.6 
 12.9 
 17.1 
 23.2 
 31.4 
 38.6 
 50.2 
 62.9 
 76.0 
 92.0 
 106.5 
 123.23 . 9000000 
 10.826068 
 13.294112 
 16.324833 
 20.046478 
 24.616570 
 30.228523 
 37.119865 
 45.582245 
 55.973862 
 68.734436 
 84.404175 
 103.646179 
 127.274902 
 156.2903443 . 535357 
 5.156120 
 7.570995 
 9.915323 
 13.087546 
 17.293678 
 22.678036 
 30.352379 
 40.267639 
 49.184601 
 62.618629 
 76.934494 
 91.309525 
 107.662506 
 122.2022553 . 535357 
 4.768738 
 7.238487 
 9.632812 
 12.867659 
 17.148132 
 22.613745 
 30.378368 
 40.369537 
 49.320061 
 62.753670 
 77.020882 
 91.324280 
 107.611816 
 122.1573793 . 535357 
 5.634524 
 7.929233 
 10.166016 
 13.206610 
 17.261953 
 22.490780 
 30.010643 
 39.829693 
 48.743813 
 62.287102 
 76.814316 
 91.436218 
 108.040558 
 122.736099 
 1940 
 195016 
 17131.7 
 150.7191 . 920593 
 235.673523131 . 699997 
 150.699997137 . 396286 
 150.477142137 . 936386 
 151.287262 
 拟合 误差 46.3847813 . 0694543.0915223 . 350870 
 预测 误差 104.1490335 . 6461935.7006466 . 263979 
 演化 算法 的 统计 结果 ( 平均值 ) 拟合 误差 = 4.165328 　 预测 误差 = 12.368071 　 结点 数 = 9.575 　 运行 时间 = 1336   s 
 
 
 　 　 由表 1 可见 ， 采用 文中 演化 算法 可 得到 多个 较优 的 微分方程 模型 ， 不仅 模型 的 结构 形式多样 ， 并且 模型 的 拟合 误差 和 预测 误差 也 比 灰色 模型 小得多 ． 
 　 　 更 有趣 的 是 ， 模型 Ⅱ 的 简化 结果 与 文献 ［ 2 ］ 中 采用 经典 的 阻滞 增长 模型 ( Logistic 模型 ) 得到 的 结果 是 一致 的 ． 文献 ［ 2 ］ 按照 Logistic 模型 假设 ： ， 由 实际 数据 确定 其中 的 常数 r = 0.31 ,   xm = 197 ， 则 得到 模型 
 
 　 　 由于 模型 的 形式 与 时间 t 的 单位 选取 有关 ， 故对 同一 数据 集 ， 不同 的 时间 单位 建立 的 模型 可能 不同 ． 本文 算法 采用 的 是 起始 时刻 为 0 、 步长 为 0.01 的 欧拉 法 进行 数值积分 ， 其 时间 单位 t 与 Logistic 模型 相差 100 倍 ， 故 两 微分方程 右端 也 相差 100 倍 ， 而 实质 结果 是 完全一致 的 ， 即 两个 模型 相同 ． 模型 Ⅱ 是 完全 由 计算机 自动 地 从 动态 系统 的 观测 数据 中 发现 的 ， 而 模型 ( 11 ) 是 根据 经典 模型 建立 的 ， 二者 的 一致 说明 了 本文 的 演化 建模 算法 为 动态数据 客观规律 的 自动 发现 提供 了 一个 有力 的 工具 ． 
 5.3 　 计算 实例   2 
 　 　 ( 1 )   实例 描述 
 　 　 数据 引自于 文献 ［ 14 ］ ， 见表 2 中 的 “ 实际 数据 ” 一栏 ， x1 和   x2 分别 为 中国 1978 ～ 1983 年 的 社会 总产值 和 农业 总产值 ( 单位 为 亿元 ) ． 要求 以前 5 年 的 数据 建立 数学模型 并 预测 1983 年 的 社会 总产值 ． 
 　 　 ( 2 )   实验 结果 及 分析 
 　 　 文献 ［ 14 ］ 建立 的 灰色 GM ( 1 , 2 ) 模型 为   dx1 / dt   +   4.0879 x1   =   14.9226 x2 
 　 　 采用 演化 算法 建立 一阶 微分方程 组 模型 ， 独立 运行 40 次 得到 的 几个 较 好 模型 为 
 　 　 模型 
 　 　 模型 
 　 　 模型 
 　 　 各 模型 的 建模 结果 见表 2 ． 
 表 2 　 实例 2 ( 灰色 系统 建模 和 演化 建模 结果 比较 表 ) 
 
 实际 数据 灰色 模型 演化 模型 Ⅰ 演化 模型 Ⅱ 演化 模型 Ⅲ 
 年份 序号 ix1ix2i1i1i2i1i2i1i2i 
 1978 
 1979 
 1980 
 1981 
 19821 
 2 
 3 
 4 
 56.846 
 7.642 
 8.531 
 9.071 
 9.9631 . 567 
 1.896 
 2.180 
 2.460 
 2.7856 . 846 
 5.698 
 8.052 
 8.983 
 10.1676 . 841975 
 7.662210 
 8.499115 
 9.084071 
 9.9684371 . 563206 
 1.890477 
 2.186530 
 2.467112 
 2.7749666 . 841975 
 7.661316 
 8.498152 
 9.083347 
 9.9680461 . 563206 
 1.876022 
 2.196958 
 2.472951 
 2.7718246 . 841975 
 7.659248 
 8.508387 
 9.114331 
 9.9111771 . 563206 
 1.868178 
 2.200855 
 2.464535 
 2.769078 
 1983611.0523 . 12111.39310 . 9143243.15119410 . 9165093.08618411 . 0205423.084314 
 拟合 误差 2.01440 . 0433050.0518520 . 082981 
 预测 误差 0.34100 . 1409480.1398930 . 048327 
 统计 结果 ( 平均值 ) 拟合 误差 = 0.191258 　 预测 误差 = 0.317860 　 结点 数 ： T1 = 8.9   T2 = 8.65   运行 时间 = 2062   s 
 
 　 　 其中 ， 灰色 模型 ： 拟合 误差   ， 　 预测 误差   
 　 　 演化 模型 ： 拟合 误差 ，   预测 误差 .   
 　 　 对比 表 2 中 结果 可见 ， 采用 文中 算法 得到 的 模型 对 x1 的 拟合 和 预测 精度 均 比 灰色 模型 要 高得 多 ． 同时 由于 灰色 系统 建立 的 是 关于 x1 的 一阶 微分方程 ， 它 不能 反映 x2 的 动态变化 情况 ， 因而 无法 对 x2 的 值 进行 拟合 和 预测 ， 并且 在 预测   1983 年 的 社会 总产值 时 必须 先 知道 1983 年 的 农业 总产值 ， 这 就 需要 用 其它 方法 如 GM ( 1 , 1 ) 或 自 回归 模型 报出 ， 这 显然 是 很 不 方便 的 ． 而 采用 演化 方法 建立 的 常微分 方程组 模型 不仅 可 同时 反映 x1 和 x2 随 时间 t 的 变化 关系 ， 并且 依 此 模型 还 可 对 其作 进一步 的 预测 ， 预测 效果 也 较 灰色 系统 更好 ．   
 6 　 结束语 
 　 　 针对 采用 传统 方法 解决 动态 系统 的 微分方程 建模 问题 所 遇到 的 困难 和 存在 的 不足 ， 本文 利用 演化 算法 的 自 适应 、 自 组织 、 自 学习 的 特性 ， 设计 了 将 遗传 程序设计 与 遗传算法 相 嵌套 的 演化 建模 算法 ， 以 遗传 程序设计 优化 模型 结构 ， 以 遗传算法 优化 模型 参数 ， 成功 地 实现 了 动态 系统 的 常 微分方程 组建 模 过程 自动化 ． 计算 实例 表明 ： 采用 此 算法 能 在 合理 的 运行 时间 内 由 计算机 自动 发现 多个 较优 的 常微分 方程组 模型 ， 和 现有 的 建模 方法 ( 如 灰色 系统 方法 ) 相 比较 ， 它 具有 建模 过程 智能化 与 自动化 、 模型 结构 更加 灵活多样 、 方法 适用性 更广 、 数据 拟合 和 预测 的 精度 更 高等 优点 ． 本 算法 的 研究 为 实现 动态数据 的 知识 发现 过程 自动化 提供 了 一个 有力 的 工具 ， 可望 在 天气预报 、 市场预测 、 生态 预测 等 与 时间 序列 与 时间 场 相关 的 实际 问题 中 得到 推广 和 应用 ． 
 
 基金项目 : 本 课题 得到 国家自然科学基金 （ 项目编号 69635030 ） 和 国家 “ 八 六三 ” 高技术 项目 （ 项目编号 863 - 306 - ZT06 - 06 - 3 ） 基金 资助 
 作者简介 ： 曹宏庆 ， 女 ， 1972 年 1 月生 ， 博士 研究生 ， 主要 研究 方向 为 遗传 程序设计 、 演化 建模 和 并行计算 . 康立山 ， 男 ， 1934 年生 ， 教授 ， 博士生 导师 ， 主要 研究 方向 为 计算机科学 理论 、 演化 计算 和 并行计算 . 陈毓屏 ， 女 ， 1942 年生 ， 主要 研究 方向 为 计算机软件 和 计算机科学 理论 . 
 作者 单位 ： 曹宏庆 　 康立山 　 陈毓屏 　 武汉大学 软件工程 国家 重点 实验室 　 武汉 　 430072 
 参考文献 
 1 　 　 Lucas   W   F .   Differential   Equation   Models .   New   York ： Springer - Verlag ,   1983 
 2 　 　 姜启源 ． 数学模型 ,   第二 版 ． 北京 ： 高等教育出版社 ,   1993 
 　 　 　 ( Jiang   Qiyuan .   Mathematical   Models ( in   Chinese ) ,   Edition   Ⅱ .   Beijing :   Education   Press ,   1993 ) 
 3 　 　 贺建勋 ． 系统 建模 与 数学模型 ． 厦门 ： 福建 科学技术 出版社 ， 1995 
 　 　 　 ( He   Jianxun .   System   Modelling   and   Mathematical   Models ( in   Chinese ) .   Xiamen :   Fujian   Science   &   Technology   Press ,   1995 ) 
 4 　 　 邓 聚龙 ． 灰色 控制系统 ． 武汉 ： 华中 工学院 出版社 ， 1985 
 　 　 　 ( Deng   Julong .   Grey   Control   Systems ( in   Chinese ) .   Wuhan :   Huazhong   University   of   Science   and   Technology   Press ,   1985 ) 
 5 　 　 Goldberg   D   E .   Genetic   Algorithms   in   Search ,   Optimization   and   Machine   Learning .   Reading ,   MA ： Addison   Welsey ,   1989 
 6 　 　 Mitchell   M .   An   introduction   to   genetic   algorithms .   Cambridge ,   MA :   MIT   Press ,   1996 
 7 　 　 Koza   J   R .   Genetic   Programming ： on   the   Programming   of   Computers   by   Means   of   Natural   Selection .   Cambridge ,   MA ： MIT   Press ,   1992 
 8 　 　 Koza   J   R .   Genetic   Programming   II ： Automatic   Discovery   of   Reusable   Programs .   Cambridge ,   MA ： MIT   Press ,   1994 
 9 　 　 Banzhaf   W ,   Nordin   P ,   Keller   R   E ,   Francone   F   D .   Genetic   Programming :   An   Introduction   on   the   Automatic   Evolution   of   Computer   Programs   and   Its   Applications .   San   Mateo ,   CA :   Morgan   Kaufmann ,   1997 
 10 　 　 Nash   J   C ,   Walker - Smith   M .   Nonlinear   Parameter   Estimation .   New   York :   Marcel   Dekker   Inc ,   1987 
 11 　 　 Hinterding   Robert ,   Michalewicz   Zbigniew ,   Eiben   Agoston .   Adaptation   in   evolutionary   computation :   A   survey .   In :   Baeck   Thomas ,   Michalewicz   Zbigniew ,   Yao   Xin   eds .   Proceedings   of   the   4th   Int ' l   Conference   on   Evolutionary   Computation .   Piscataway ,   NJ :   IEEE   Press ,   1997 .   65 ～ 69 
 12 　 　 Mhlenbein   H ,   Schomisch   M ,   Born   J .   The   parallel   genetic   algorithm   as   function   optimizer .   Parallel   Computing ,   1991 ,   17 ,   619 ～ 632 
 13 　 　 Mhlenbein   H ,   Schlierkamp - rose   D .   Predictive   models   for   the   breeder   genetic   algorithm .   Evolutionary   Computation ,   1993 ,   1 ( 1 ) :   25 ～ 49 
 14 　 　 曹鸿兴 ， 郑耀文 ， 顾今 ． 灰色 系统 理论 浅述 ． 北京 ： 气象 出版社 , 1988 
 　 　 　 ( Cao   Hongxing ,   Zheng   Yaowen ,   Gu   Jin .   A   Brief   Introduction   to   Grey   System   Theory ( in   Chinese ) .   Beijing :   Meteorology   Press ,   1988 ) 
 收到 日期 ： 1998 - 10 - 15 
 修改 日期 ： 1999 - 04 - 26 
