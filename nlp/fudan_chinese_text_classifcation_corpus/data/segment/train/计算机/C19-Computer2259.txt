计算机 应用 研究 
 APPLICATION   RESEARCH   OF   COMPUTERS 
 2000 　 Vol.17 　 No.5 　 P.18 - 19 
 
 
 
 网络 环境 下 的 工程 CAD 实时 协同 研究 
 储备 　 杨庆丽 　 蔡青 
 摘     要     随着 设计 要求 的 不断 提高 ， 实现 实时 协同 设计 的 条件 已经 成熟 。 CSRCD 技术 的 需求 也 日益 迫切 。 介绍 了 网络 环境 下 一个 应用 于 工程 CAD 的 计算机 实时 协同 系统 。 实践 表明 ， 提出 的 模型 完全 可行 。 
 关键词     计算机 支持 的 协同工作     实时 协同 设计       CAD 
 　 　 计算机 支持 的 协同工作 ( CSCW ) 是 80 年代 后期 兴起 的 一个 新 的 研究 领域 。 主要 研究 如何 利用计算机 支持 群体 成员 之间 的 协同工作 ， 共同完成 相关 任务 。 计算机 支持 的 实时 协同 设计 ( CSRCD   Computer   Supported   Real - time   Cooperative   Design ) 是 CSCW 在 设计 工作 中 的 一项 重要 应用 。 它 主要 支持 群体 并发 工作 ， 及时 交流思想 、 协调 工作进展 情况 、 发现 工作 过程 中 出现 的 矛盾 和 冲突 等 ， 防止 、 避免 或 尽可能减少 设计 过程 中 反复 修改 的 问题 [ 1 ～ 4 ] 。 
 　 　 随着 设计 要求 的 不断 提高 ， CSRCD 技术 的 需求 也 日益 迫切 。 我们 在 局域网 上 设计 并 实现 了 一个 应用 于 工程 CAD 的 CSRCD 原型 系统 。 实践 表明 ， 此 系统 能够 满足 群体 成员 在 协同 设计 时 实时 交互 的 需要 。 
 1     支持 实时 协同 设计 的 支撑 环境 
 　 　 系统 设计 的 一个 主要 原则 是 ： 利用 成熟 软件 与 柔性 接口 提供 支持 用户 协作 的 使 能 技术 ， 而 不是 专门 研制开发 一个 通用 的 实时 协同 系统 。 所以 在 选择 软 、 硬件平台 时 主要 从 用户 的 可选择性 、 可 使用 性 、 可接受性 等 几 方面 来 考虑 。 计算机 支持 的 实时 协同 设计 系统 必须 支持 设计者 之间 的 协同工作 。 我们 采用 客户 / 服务器 ( Client / Server ) 模式 建立 的 局域网 ， 以 高速 以太网 为 骨干 ， 通过 TCP / IP 协议 连接 到 客户端 ， 访问速度 可达 100   Mbps 。 见图 1 。 
 
 图 1CSRCD 系统 支撑 平台 体系 简图 
 　 　 多用户 的 实时 交互 要求 一定 的 CSCW 技术支持 。 如果 重新 编写 新 的 支持 协同工作 的 设计 系统 ， 则 工作量 太大且 现有 的 成熟 软件资源 也 无法 得到 继承 。 我们 采取 在 现有 系统 加入 支持 协同工作 的 模块 ， 大大减少 了 开发 时间 ， 也 保持 了 前后 软件 的 连续性 和 兼容性 。 实践证明 这种 思路 是 可行 的 。 我们 使用 Winpopup 和 Microsoft   NetMeeting2.1 软件 在 局域网 内 进行 远程 呼叫 和 语音 交互 ， 并 与 IE   5.0 上 的 有关 控件 最终 实现 了 共享 白板 、 共同 编辑 、 电子邮件 等 功能 。 
 2     工程 CAD 实时 协同 模型 
 2.1     实时 协同 设计 信息 
 　 　 工程 CAD 实时 协同 设计 信息 主要 指 设计 图形 数据 信息 。 在 微机 和 工作站 上 用于 数据交换 的 图形文件 标准 主要 有 ： AutoCAD 系统 的 DXF 、 美国 标准 IGES 及 国际标准 STEP 文件 。 AutoCAD 的 DXF 图形 数据 交换文件 主要 用于 实现 高级 语言 编写 的 程序 与 AutoCAD 系统 的 连接 ， 或 其它 CAD 系统 与 AutoCAD 之间 的 图形文件 交换 。 但 由于 DXF 文件 开发 较 早 ， 存在 很多 的 不足 ， 所以 Autodesk 公司 近来 强调 用 二进制 的 DWG 和 网络 上 的 DWF 格式 作为 它 的 数据传输 标准 ， 但 两者 的 格式 都 不 公开 ， 因此 很难 为 其它 CAD 系统 所 利用 。 这 就 需要 考虑 异构 环境 下 不同 CAD 系统 间 文件 的 共享 与 交换 。 
 　 　 由于 AutoCAD 在 世界 范围 内 的 应用 极为 广泛 ， 已经 深入 到 各行各业 之中 ， 所以 它 的 数据 文件格式 已经 成为 一种 事实上 的 工业 标准 。 目前 国内 工程 上 基于 微机 的 CAD 系统 仍以 Autodesk 公司 的 AutoCAD 及其 二次开发 软件 为 主流 。 
 2.2     实时 协同 设计 过程 
 　 　 我们 将 设计 成员 按 角色 划分 为 设计 主持人 和 参与 人 。 设计 主持人 是 主持 实时 协同 设计者 ， 他 有权 通过 服务器 发起 实时 协同 设计 ， 从而 主持 该 设计 。 设计 主持人 可 在 协同 过程 中 变更 。 设计 参与 人 是 其他 参加 实时 协同 设计 的 群体 成员 。 当 设计 人员 登录 到 服务器 后 ， 就 可以 通过 远程 呼叫 组织 CAD 实时 协同 。 一旦 组织 成功 ， 设计 主持人 与 设计 参与 人 就 开始 进行 协同 设计 。 如图 2 所示 。 与 计算机 会议 系统 不同 的 是 ， 群体 成员 的 窗口 有 很大 的 不同 。 设计 主持人 的 主 窗口 是 CAD 软件 运行 窗口 ， 另外 一个 辅助 窗口 则 显示 出 所有 参与 人员 表 、 部分 CSCW 工具 ( 语音 、 白板 、 电子邮件 ) 等 信息 。 设计 参与 人 的 主 窗口 是 一个 能 阅读 图形文件 的 Web 浏览器 窗口 ， 辅助 窗口 与 主持人 的 一样 。 设计 主持人 通过 语音 技术 告知 所有 参与者 打开 某 ( 些 ) 图形文件 ， 然后 就 实际 出现 的 问题 展开讨论 。 在 协同工作 中 ， 设计 主持人 可 随时 在 主 窗口 ( CAD 软件 窗口 ) 修改 、 编辑 图形文件 ， 然后 动态 地 存储 在 临时 工作 区 ， 并 通过 触发器 刷新 会议 参与 人 的 主 窗口 信息 ， 达到 实时 同步 显示 的 效果 。 而 设计 参与 人 就 所 关心 的 问题 与 主持人 进行 讨论 ， 当 需要 控制 图形 信息 资源 ， 则 可 通过 消息 转发 申请 成为 设计 主持人 。 在 设计 过程 中 ， 设计 主持人 可以 根据 需要 随时 变更 ， 所有 成员 能 同步控制 操作 对象 和 结果 。 当 设计 主持人 变更 后 ， 新 、 旧 的 设计 主持人 所用 的 CAD 软件 并不一定 是 统一 的 。 这样 也 便于 不同 平台 下 的 CAD 软件应用 共享 。 
 
 图 2 工程 CAD 实时 协同工作 过程 简图 
 3     工程 CAD 实时 协同 的 触发器 
 　 　 工程 CAD 实时 协同 中 的 触发器 主要 实现 两种 方式 的 实时 同步 ： 事件驱动 同步 和 定时 连续 同步 。 事件驱动 同步 是 一种 通知 某一 事件 或 事件 集 已经 发生 ， 通过 触发器 导致 有关 操作 或 操作 集 发生 的 同步操作 。 即 设计 主持人 对 设计 信息 编辑 完成 后 ， 激活 触发器 完成 类 实时 同步 。 定时 连续 同步 是 指 同步 表现 为 一系列 事件 或 操作 自动 定时 连续 的 执行 。 触发器 在 事先 被 启动 ， 并 实时 监控 、 定时 工作 ， 从而 保持 协同 设计 成员 间 的 周期性 同步 。 为了 保证 设计 成员 都 能 对 图形文件 进行 操作 ， 我们 利用 触发器 首先 对 图形文件 进行 转换 ， 再 储存 操作 对象 和 结果 ， 然后 转发 消息 ， 通知 并 实现 其他 协同 成员 的 同步操作 。 触发器 分两 部分 ： 一个 是 主件 ， 在 设计 主持人 CAD 系统 端 ， 依照 事件 / 时间 驱动 来 控制 产品 信息 实时 协同 的 操作 进程 。 绝大部分 工作 是 靠 主件 在 后台 完成 的 ； 另 一个 是 辅件 ， 在 设计 参与 人 浏览器 端 ， 用来 接收 消息 ， 在 临时 工作 区内 读取 中性 文件 ， 刷新 显示 界面 。 触发器 的 关键在于 事件 / 定时 消息 的 传递 与 接收 。 没有 将 触发器 主件 置于 网络 服务器 上 是因为 要 考虑 设计 主持人 的 变更 。 
 4     结论 
 　 　 我们 在 局域网 上 成功 实现 了 一个 工程 CAD 实时 协同 原型 系统 。 在 此 系统 上 开发 出 触发器 、 远程 指针 等 一些 关键 控件 ， 基本 达到 了 异构 分布 环境 下 的 实时 协同 设计 。 其 体系结构 见图 3 。 整个 系统 实用性 强 ， 易于 使用 。 这里 我们 没有 过多地 采用 计算机 会议 系统 其它 技术 ， 特别 是 共享 视频 。 
 
 图 3 工程 CAD 实时 协同 原型 系统结构 简图 
 　 　 这里 需要 指出 的 是 ： 工程 CAD 设计 信息 以 DWG 、 DXF ， DWF 文件格式 为主 ， 由于 DWG 、 DWF 的 不 公开性 与 DXF 的 不 完善 性 ， 大大 地 增加 了 系统 中 协同 模块 开发 的 难度 。 因此 ， 对于 工程 CAD 共享 信息 模型 的 构造 及 协同 方式 的 研究 是 今后 努力 的 重点 方向 。 
 储备 ( 西北工业大学 CAD / CAM 研究 中心     西安   710072 ) 
 蔡青 ( 西北工业大学 CAD / CAM 研究 中心     西安   710072 ) 
 杨庆丽 ( 新疆 工学院     乌鲁木齐   830000 ) 
 参考文献 
 1 ， Milad   S   et   a1 .   Shared   Understanding   in   Computer - Supported   Collaborative   Design .   Computer - Aided   Design ,   1996 ,   28 ( 3 ) :   183 ～ l92 
 2 ， Stefik   M   et   al .   WYSIWIS   Revised :   Early   Experiences   with   Multiuser   Interface .   ACM   Trans   on   Office   Information   System ,   1987 ,   5 ( 2 ) :   147 ～ 167 
 3 ， Alex   P   et   a1 .   Collaborative   3D   Visualization   with   Cspray .   IEEE   Computer   Graphics   and   Applications ,   Mar / Apr .   1997 :   32 ～ 41 
 4 ， Rodger   L   et   al .   Virtual   Society :   Collaboration   in   3D   Spaces   on   the   Internet .   Computer   Supported   Cooperative   Work :   The   Journal   of   Collaborative   Computing ,   1997 ,   6 :   117 ～ l40 
 收稿 日期 ： 1999 - 12 - 19 
