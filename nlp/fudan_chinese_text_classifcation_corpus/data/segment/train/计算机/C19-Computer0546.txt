自动化 学报 
 ACTA   AUTOMATICA   SINICA 
 1997 年 　 第 23 卷 　 第 4 期 　 Vol.23 　 No.4 　 1997 
 
 
 
 随机 过程 在 指定 坐标 下 的 最优 截断 1 ） 
 鲍荣浩 　 徐博侯 
 　 　 摘 　 要 　 提出 了 随机 激励 下 的 一种 模型 降阶 方法 . 在 指定 坐标 下 ， 选择 使 输出 误差 性能指标 最小 的 分量 ， 并 对 输出 矩阵 作 最优 修正 ， 指出 了 这种 最优 截断 法 的 几何 正交 性 ， 为 降阶 控制器 设计 提供 了 基础 . 最后 给出 了 一个 可行 算法 和 算例 . 
 　 　 关键词 　 模型 降阶 ， 随机 分量 ， 最优 截断 ， 最小 正交 化 . 
 OPTIMAL   TRUNCATION   FOR   RANDOM   PROCESS 
 IN   THE   PRESPECIFIED   COORDINATE 
 BAO   RONGHAO 　 XU   BOHOU 
 ( Mechanics   Department   of   Zhejiang   University ,   Hangzhou 　 310027 ) 
 Abstract 　 An   optimal   method   to   truncate   the   components   of   a   stable   random   output   process   in   the   prespecified   coordinate   is   presented   in   this   paper , which   is   based   on   the   performance   criterion   of   output   error . It   is   pointed   out   that   this   optimal   truncaion   is   also   a   minimal   orthogonal   projection   of   the   truncated   components . Several   properties   for   such   truncation   are   introduced . A   numerical   example   is   given   in   the   end . 
 Key   words 　 Model   reduction , random   component , optimal   truncation , minimum   orthogonalization . 
 1 　 问题 背景 和 描述 
 　 　 模型 降阶是 复杂 结构 系统 进行 动力学 分析 和 控制 设计 时所 必须 考虑 的 一个 问题 . 对于 诸如 柔性 飞行器 这样 的 一个 高阶 系统 ( 几百 甚至 几千 阶 ) ［ 1 ］ ， 用 全阶 模型 来 分析 和 设计 往往 会 遇到 计算 上 的 困难 ， 其中 包括 算法 本身 、 计算速度 以及 对 计算机 外存 的 要求 等 ， 当然 更 不用说 系统 本身 可能 就是 无限 维 的 . 因此 ， 如何 简捷 地 获得 一个 较佳 的 降阶 近似 模型 是 个 很 现实 也 很 有 价值 的 问题 . 
 　 　 模型 降阶 的 方法 很多 ， 也 有 许多 文献 对此 进行 过 概括 和 总结 ［ 2 ， 3 ］ 。 这些 方法 从 模型 对象 来讲 ， 可以 分为 开环 ［ 4 ］ 和 闭环 ［ 5 ］ 两种 ； 从 降阶 系统 所处 的 输入 环境 来讲 ， 又 可 分为 确定 输入 系统 的 降阶 和 随机 输入 系统 的 降阶 ［ 6 ］ ； 从 降阶 方法 最后 得到 的 结果 来看 ， 则 又 可以 分为 性能指标 最优 的 降阶 ［ 7 ］ 和 次优 的 降阶 ［ 8 ］ . 本文 要 讨论 的 是 系统 在 随机 环境影响 下 的 一种 开环 次优 降阶 方法 . 
 　 　 事实上 ， 有 一类 系统 往往 工作 在 不 确定 的 随机 环境影响 之中 ， 如 在 太空 中 漂游 的 空间 柔性 飞行器 、 核反应堆 等 ， 即使 进行 了 闭环 设计 后 ， 其 外界影响 也 是 随机性 的 . 对于 这 类 系统 ， 开环 降阶 往往 是 很 关键 的 ， 其 结果 的 好坏 直接 影响 到 控制系统 的 精度 问题 . 随机 系统 的 降阶 方法 很多 ， 其中 有 保留 主 模态 的 模态 集结 法 ， Wilson 参数 优化 法 ， 性能 最优 的 优化 投影 法 ［ 7 ］ ， 平衡 随机 降阶法 ［ 6 ］ ， 分量 化费 分析法 ( CCA ) ［ 4 ］ 等 . 其中 尤 以 分量 花费 法在 柔性 空间结构 降阶中 的 力学 意义 最为 明确 ， 而 优化 投影 法 虽然 有 很 好 的 数学 结果 ， 但 由于 其 计算 上 太 过于 复杂 ( 四个 耦合 的 李雅普 方程 和 黎卡 的 方程 的 求解 ) 而且 需要 一个 能 事先 确定 降阶阶次 的 准则 而 受到限制 . 本文 则 是从 输出 误差 的 性能指标 出发 ， 讨论 系统 输出 过程 在 指定 坐标 下 截断 部分 分量 的 一个 最优 方法 . 
 　 　 记 集合 X0 = { x1 , x2 , … , xn } , 其中 每个 元素 xi , i ∈ n 　 ( 表示 i = 1 , 2 , … ， n ， 下同 ) 是 随机 的 稳态 过程 . 由 X0 中 所有 元素 生成 的 一个 输出 过程 为 
 
 ( 1 ) 
 定义 与 系统 输出 ( 1 ) 相关 的 一个 ( 稳态 ) 性能指标 为 
 J = E ∞ ［ y ( t ) T ∪ y ( t ) ］ . 
 ( 2 ) 
 这里 ， E ∞ = E 表示 系统 趋于 稳态 时 的 数学 期望 ( 以下 都 一样 ) ， U 是 体现 系统 输出 中 每个 分量 重要性 的 一个 正定 对称 权 矩阵 ， 一般 都 是 事先 选定 . 记 集合 X0 中 所有 元素 的 下标 所 组成 的 一个 数集 Ω = { 1 , 2 , … , n } , Ω 中 任意 r ( ≤ n ) 个 元素 组成 的 一个 子集 Ω r 和 这个 子集 在 Ω 上 的 补集 分别 为 
 
 ( 3 ) 
 = Ω - Ω r . 
 ( 4 ) 
 则 在 X0 上以 Ω r 和 中 元素 作为 下 标的 子集 分别 为 
 
 ( 5 ) 
 
 ( 6 ) 
 　 　 所谓 随机 过程 在 指定 坐标 中 的 最优 截断 ， 是 指 给定 了 一个 正整数 r ≤ n 后 ， 在 Ω 上 找到 上面 这样 的 子集 Ω r ， 使得 输出 误差 性能指标 J Δ 最小 
 
 ( 7 ) 
 这里 ， yr 为 截断 r 个 分量 后 的 输出 ， ( y - yr ) 是 截断 后 的 输出 误差 ， 
 
 ( 8 ) 
 其中 ， η i ( η i ∈ ) 是 维数 合适 的 待定 矩阵 . 
 2 　 对 X0 中 单个 分量 的 最优 截断 
 　 　 把 集合 X0 中 元素 写成 向量 形式 为 
 
 ( 9 ) 
 假如 我们 在 系统 中要 截断 的 是 第 i 个 分量 xi ， 记 x 截断 分量 xi 后 的 向量 为 
 
 ( 10 ) 
 那么 输出 方程 ( 1 ) 可以 表示 为 下面 的 形式 
 y = L1 + L2xi , 
 ( 11 ) 
 L1 = [ C1 , C2 , … , Ci - 1 , Ci + 1 , … , Cn ] , L2 = Ci , 
 ( 12 ) 
 取 系统 截断 分量 xi 后 得到 的 截断 输出 方程 为 
 y1 = L * , 
 ( 13 ) 
 这里 L * 是 具 合适 维数 ， 且 使 输出 误差 指标 σ ( xi ) 最小 的 矩阵 
 σ ( xi ) = minE ∞ ( y - y1 ) TU ( y - y1 )   . 
 ( 14 ) 
 　 　 因为 系统 是 稳定 的 ， 我们 可以 记 一个 相关矩阵 
 
 ( 15 ) 
 Qij ( i , j = 1 , 2 ) 是 矩阵 的 i 行 j 列 元素 . 根据 等式 ( 7 ) ， 输出 误差 的 性能指标 可以 表示 为 
 
 ( 16 ) 
 这里 tr ( . ) 为 矩阵 求迹 算子 ， Δ L = L1 - L * . 要求 ( 16 ) 的 最小值 ， 令 J Δ 1 / L * = 0 , 可以 得到 
 
 ( 17 ) 
 相应 地 截断 分量 xi 后 的 最小 误差 性能指标 为 
 
 ( 18 ) 
 为了 更加 明显 地 看到 这种 截断 方法 的 几何 意义 ， 我们 不妨 引入 一个 新 的 分量 u ， 
 u = xi - Q21 , 
 ( 19 ) 
 此时 输出 方程 ( 11 ) 可以 分解 为 
 y = L * + L2u . 
 ( 20 ) 
 比较 表达式 ( 20 ) 及 截断 分量 xi 后 的 表达式 ( 13 ) 我们 可以 看到 ， ( 20 ) 中 第二项 L2u 就是 对 分量 xi 进行 最优 截断 后 所 产生 的 输出 误差 ， 因此 严格 地 讲 ， 系统 真正 要 截断 的 是 分量 u 而 不是 xi . 计算 分量 u 和 的 稳态 协方差 矩阵 为 
 Qu1 = E ∞ u ( ) T   = 0 . 
 ( 21 ) 
 这 也就是说 ， u 和 中 每个 分量 是 正交 的 ， 即 分量 表达式 ( 20 ) 中 第二项 是 xi 在 所 张成 的 子 空间 上 的 正交投影 ， 而 u 则 是 xi 到 该子间 的 距离 . 因此 ， 截断 分量 xi 而 使 输出 误差 指标 最优 问题 ， 实际上 也 就是 对 指定 分量 xi 向 其它 分量 所 生成 的 子 空间 的 正交 分解 或 投影 过程 . 
 　 　 上面 我们 得到 了 对 X0 中 最优 截断 某个 指定 分量 xi 后 所 产生 的 输出 误差 性能指标 ， 因此 ， 只要 当 i 遍历 Ω ( 也 就是 取遍 Ω 中 所有 元素 ) 时 ， 我们 总 可以 在 X0 中 找到 这样 的 一个 分量 xj1 ∈ X0 来 ， 使得 对 该 分量 最优 截断 后 产生 的 输出 误差 指标 在 所有 这些 误差 性能指标 中是 最小 的 一个 ， 即 
 
 ( 22 ) 
 我们 称 截断 上面 这个 分量 xi1 的 过程 为 系统对 集合 X0 中 不 指定 的 单个 分量 的 最优 截断 过程 ， λ i1 是 截断 单个 分量 的 最优 误差 性能指标 . 在 找到 了 这样 的 分量 xi1 后 ， 它 实际上 也 就 变成 了 对 指定 分量 的 最优 截断 问题 . 
 3 　 对 X0 中 r 个 分量 的 最优 截断 
 　 　 从 以上 分析 来看 ， 在 集合 X0 中 ， 我们 总是 可以 找到 一个 使 输出 误差 性能指标 最小 的 截断 变量 xi1 ， 记 X0 中 截断 分量 xi1 后 剩余 分量 所 组成 的 集合 为 X1 = X0 - { xi1 } ， 相应 的 截断 输出 过程 为 y1 ( 这里 y 的 下标 不 表示 分量 ， 只 表示 截断 的 序号 y0 = y ) . 然后 我们 总是 又 可以 和 上面 一样 在 X1 中 再 进行 单个 分量 的 最优 截断 过程 ， 得到 剩余 分量 所 组成 的 新 集合 X2 ， 相应 的 由 集合 X2 中 元素 所 生成 的 截断 输出 过程 为 y2 ， 这样 一步步 下去 ， 直到 截断 了 r 个 分量 为止 ， 最后 得到 要 保留 分量 的 集合 Xr ， 由 Xr 中 每个 分量 组成 的 截断 输出 yr 即 为 原 系统 截断 r 个 分量 后 的 最优 截断 输出 . 
 　 　 不失 一般性 ， 假设 我们 要 截断 的 分量 依次 是 系统 的 最后 r 个 分量 ， 即 
 Xi = { x1 , x2 , … , xn - r } , 0 ≤ i ≤ r ， 
 ( 23 ) 
 则 第 i 步 截断 中 所 产生 的 输出 截断误差 为 
 Δ i = yi - yi - 1 , i ≥ 1 . 
 ( 24 ) 
 从 前面 的 讨论 中 我们 已经 知道 ， 每步 截断 过程 中 的 输出 误差 和 要 保留 分量 生成 的 子 空间 是 正交 的 ， 因此 成立 
 
 ( 25 ) 
 
 ( 26 ) 
 这里 Mij 是 对 xi 进行 最优 截断 后 求得 的 系数 . 对于 第 k 步 和 m 步 截断 成立 
 
 ( 27 ) 
 这 也就是说 ， 任何 不同 的 两步 最优 截断 所 产生 的 输出 误差 是 互不 相关 的 ( 指 系统 到达 稳态 时 ) ， 因此 我们 可以 得到 以下 一些 性质 . 
 　 　 性质 1 . 　 最优 截断 总体 误差 性能指标 是 每步 截断 产生 误差 性能指标 的 累加 ， 即 
 
 ( 28 ) 
 　 　 性质 2 . 　 原 系统 的 输出 性能指标 是 截断 后 输出 的 性能指标 与 被 截断 部分 的 性能指标 的 和 . 
 　 　 性质 3 . 　 系统对 任何 两个 分量 依次 进行 指定 分量 的 最优 截断 所 产生 的 误差 性能指标 的 和 与 系统对 两个 分量 一起 截断 所 产生 的 误差 性能指标 是 相等 的 . ( 证明 略 ) 
 　 　 从 上面 的 分析 过程 中 我们 可以 看到 ， 在 指定 坐标 中 对 随机 过程 的 最优 截断 过程 实际上 也 就是 对要 被 截断 分量 不断 进行 最小 正交 化 过程 ， 使得 真正 要 被 截断 部分 分量 所 对应 的 性能指标 最小 . 当 事先 不 知道 所 要 截断 的 分量 个数 时 ， 我们 可以 先 计算 输出 性能指标 ( 2 ) 中 的 J 值 ， 然后 根据 截断 某个 分量 后 所 产生 的 误差 指标 和 J 的 比值 是否 足够 小来 判断 截断 的 结果 . 
 4 　 算例 与 结果 
 　 　 以上 我们 只 讨论 了 输出 过程 的 降价 ， 为了 同时 得到 保留 分量 的 变化 方程 ， 结合 模型 的 状态方程 ， 来 考虑 一个 线性 稳定 系统 
 = Ax ( t ) + Bw ( t ) , 
 ( 29 ) 
 y ( t ) = Cx ( t ) . 
 ( 30 ) 
 这里 ， x ∈ Rn , y ∈ Rm 分别 是 系统 的 状态 和 输出 向量 ，   w ∈ Rp 是 和 系统 初始状态 不 相关 的 高斯 零均 白 噪声 ， A ， B ， C 分别 为 具有 合适 维数 的 系统 矩阵 ， 其中 A 是 稳定 矩阵 . 其 模型 降价 可以 按 以下 步骤 完成 ： 
 　 　 ( 1 ) 对原 系统 进行 模态 变换 ( 只 计算 系统 的 实 模态 坐标 ) ， 每个 模态 作为 一个 分量 . 
 　 　 ( 2 ) 计算 模态 的 相关矩阵 ， 并 根据 式 ( 2 ) 计算 系统 的 输出 性能指标 J . 
 　 　 ( 3 ) 分别 计算 最优 截断 每个 模态 所 产生 的 输出 误差 性能指标 . 
 　 　 ( 4 ) 判断 ( 3 ) 中 最小值 和 J 的 比值 ， 如果 不是 足够 小 ， 则 截断 最小值 所 对应 的 模态 分量 ， 由 剩余 的 模态 组成 一个 新 集合 继续 转 到 过程 ( 3 ) ； 如果 比值 足够 小 ， 则 由 剩余 的 模态 组成 降阶 模型 ， 结束 计算 . 
 　 　 作为 算例 ， 考虑 有 如下 传递函数 在 单位 强度 高斯 白 噪声 驱动 下 的 一个 线性系统 ［ 9 ］ ， 
 
 其 在 模态 坐标 下 的 一个 实现 为 
 A = diag ( - 1 , - 3 , - 5 , - 10 ) , 
 B = [ 0.0417 　 - 0.0357 　 - 0.0250 　 0.0190 ] T , 
 C = [ 1 　 1 　 1 　 1 ] . 
 　 　 如果 用 传统 模态 截断 法 简单 截断 后面 三阶 、 两阶 和 一阶 模态 ， 其 输出 误差 百分比 ( 定义 为 输出 误差 性能指标 和 输出 性能指标 的 比值 ) 分别 为 
 δ 3 = 129.30% , 　 δ 2 = 6.37% , 　 δ 1 = 6.73% . 
 计算 系统 用 传统 模态 截断 法 截断 后面 三阶 和 两阶 模态 后 得到 的 一阶 和 两阶 降阶 模型 输出 误差 ， 分别 画 在 图 1 和 图 2 上 ， 和 系统 输出 仿真 值相 比较 后 可以 看到 ， 用 传统 模态 截断 法是 无法 得到 一个 比较满意 结果 的 . 如果 我们 对原 系统 进行 本文 所述 的 最小 正交 化 过程 ， 那末 用 本文 最优 截断 法 得到 的 一阶 、 两阶 和 三阶 降阶 模型 所 对应 的 输出 误差 百分比 分别 为 
 δ 3 = 33.42% , 　 δ 2 = 0.22% , 　 δ 1 = 0.07% . 
 同时 计算 最优 截断 法 得到 的 一阶 和 两阶 降阶 模型 的 输出 误差 仿真 值画 在 图 3 和 图 4 中 . 
 
 
 图 1 　 一阶降 阶 模型 输出 误差 
 
 
 图 2 　 两阶 降阶 模型 输出 误差 
 
 
 图 3 　 修正 后 一阶降 阶 模型 输出 误差 
 
 
 图 4 　 修正 后 两阶 降阶 模型 输出 误差 
 　 　 同样 ， 如果 我们 把 系统 输入 矩阵 的 每 一列 按 次序 分别 乘以 ( 4 ， 3 ， 2 ， 1 ) ， 使得 前面 几阶 模态 对 输出 贡献 值 增大 . 和 上面 一样 ， 用 传统 模态 截断 法 简单 截断 后面 三阶 、 两阶 和 一阶 模态 后 的 输出 误差 百分比 分别 为 
 δ 3 = 52.74% , 　 δ 2 = 2.41% , 　 δ 1 = 0.31% . 
 用 本文 的 最优 截断 法 得到 的 一阶 、 两阶 和 三阶 降阶 模型 的 输出 误差 百分比 分别 为 
 δ 3 = 14.56% , 　 δ 2 = 0.020% , 　 δ 1 = 0.006% . 
 　 　 从 以上 输出 误差 百分比 的 计算结果 及 输出 误差 仿真 图中 我们 可以 看到 ， 用 模态 坐标 下 的 最优 截断 法 不仅 能够 用来 挑选 降阶 模型 所 要 保留 的 模态 分量 ， 同时 对 传统 模态 截断 法有 非常明显 的 误差 补偿 效果 . 和 性能指标 最优 的 降阶法 ［ 7 ］ 相 比较 ， 指定 坐标 下 最优 截断 法 的 结果 是 次优 的 ， 但是 它 有 以下 三个 计算 上 的 优点 ： ( 1 ) 不 需要 求解 复杂 的 非线性 代数方程 组 ； ( 2 ) 在 降阶 模型 阶次 变化 时 不必 重新 进行 计算 ； ( 3 ) 当 系统 具有 比较 接近 的 特征值 ( 这是 柔性 结构 控制 中 比较 常见 的 密频 现象 ) 时 ， 本 方法 由于 没有 病态 方程 的 求解 ， 使得 问题 简单化 ， 我们 在 讨论 柔性 结构 模型 降阶 的 另 一篇 论文 中 对此 作 了 进一步 的 阐述 . 要 真正 解决 系统 的 降阶 问题 ， 还 需要 考虑 更 多 的 因素 ， 如 模型 降阶后 控制器 的 设计 ， 模型 降阶 对系统 性能 的 影响 等等 ， 这 有待于 我们 进一步 的 研究 . 
 1 ) 　 国家自然科学基金 资助 项目 . 
 作者简介 ： 鲍荣浩 　 1969 年 12 月 出生 ， 1995 年 获 固体 力学 博士学位 ， 现为 浙江大学 力学 系 讲师 . 目前 研究 方向 为 ： 柔性 结构 的 模型 降阶 与 控制 ， 固体 力学 中 的 数值 方法 ， 计算机 应用 与 软件开发 ， 非线性 理论 的 应用 等 . 
 　 　 徐博侯 　 1946 年 出生 ， 丹麦 科技 大学 应用 数学 物理 专业 博士 ， 现为 浙江大学 力学 系 教授 ， 博士 导师 . 目前 研究 方向 为 ： 柔性 结构 的 模型 降阶 与 控制 ， 固体 力学 中 的 数值 方法 ， 复杂 结构 的 稳定性 分析 ， 非线性 理论 的 应用 等 . 
 作者 单位 ： 浙江大学 力学 系 　 杭州 　 310027 
 参考文献 
 ［ 1 ］ 　 Balas   M   J . Trends   in   large   space   structures   control   theory : fondest   hopes , wildest   dreams . IEEE . Trans . Automat . Contr , 1982 , 27 : 522 — 535 . 
 [ 2 ] 　 詹姆希迪 ， 大 系统 理论 ， 北京 ： 科学出版社 ， 1986 . 
 [ 3 ] 　 Rao   S   S , Pan   T   S , Vekayya   V   B . Modeling , control , and   design   of   flexible   structures : A   Survey . Appl . Mech . Rev.1990 , 43 : 99 — 117 . 
 [ 4 ] 　 Skelton   R   E , Huges   P   C , Halbani   H   B . Order   reduction   for   models   of   space   structures   using   modal   cost   analysis . J . Guidance.1982 , 15 : 351 — 357 . 
 [ 5 ] 　 Yousuff   A , Controller   reduction   by   component   cost   analysis . IEEE . Trans . Automat . Contr.1984 , 29 : 668 — 682 . 
 [ 6 ] 　 Green   M , A   relative   error   bound   for   balanced   stochastic   truncation . IEEE . Trans . Automat . Contr , 1988 , 33 : 961 — 965 . 
 [ 7 ] 　 Hyland   D   C , Bernstein   D   S . The   optimal   projection   equations   for   model   reduction   and   the   relationship   among   the   methods   of   wilson , skelton , and   moore . IEEE . Trans . Automat . Contr . , 1985 , 30 : 1201 — 1211 . 
 [ 8 ] 　 Moor   B   C . Principle   component   analysis   in   linear   systems : controll   ability , observability , and   model   reductioin . IEEE . Trans . Automat . Contr.1981 , 26 : 17 — 32 . 
 [ 9 ] 　 Liu   Y , Anderson   B   D   O . Singular   perturbation   approximation   of   balanced   system . Int . J . Contrl.1989 , 50 ( 4 ) : 1379 — 1405 . 
 收稿 日期 　 1995 - 05 - 29 
