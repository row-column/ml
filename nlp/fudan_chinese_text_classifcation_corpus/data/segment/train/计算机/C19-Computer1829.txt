微型机 与 应用 
 MICROCOMPUTER   &   ITS   APPLICATIONS 
 2000   Vol.19   No.2   P.17 - 18 
 
 
 
 
 IC卡 系统 设计 中 的 安全性 考虑 
 张 吉文 　 郭圣文 
 摘   要 ：   对 从 最初 选择 IC卡 直到 完成 IC卡 系统 设计 的 整个 过程 中 所 涉及 到 的 安全性 问题 作 了 探讨 。 
 关键词 ：   IC卡 系统   安全 控管 机制   安全 报文   防拨 特性   攻击 测试   密钥 管理 
 　 　 IC卡 与 磁卡 相比 ， 具有 存储容量 大 、 保密性 好及 独立性 强 等 显著 优点 ， 使用 发展前景 广泛 。 
 　 　 从 系统工程 的 角度 来看 ， IC卡 系统 不仅仅 只是 卡片 与 读卡机 之间 的 信息 交换 。 由于 IC卡 可 实现 脱机 交易 ， 其 系统 的 复杂程度 要 远远 超过 磁条卡 ， 因而 幻想 仅仅 通过 IC卡 的 高 保密性 来 实现 整个 系统 的 安全性 要求 是 幼稚 且 错误 的 ， IC卡 本身 提供 的 高 保密性 能 还 需要 整个 系统 的 安全 管理 以及 安全 设计 来 支持 。 怎样才能 全面 保证 IC卡 系统 的 高 保密性 、 安全可靠 地 坚实 运作 ？ 本文 从 选卡 、 系统 设计 到 运作 管理 等 方面 来 对此 问题 作一 论述 。 
 1   选卡时 的 安全性 考虑 
 　 　 IC卡 行业 近年 在 我国 发展 迅猛 ， 但 由于 刚 起步 不久 ， 整个 IC卡 市场 基本上 还 处于 一种 无 规范 无 统一 管理 的 状态 ， 在 尚无 相关 规范 约束 ， IC卡 的 测试 及 质量 认证 还 只能靠 商家 自己 来 保证 的 情况 下 ， 作为 设计 的 第一步 ， 在 具体 选择 某一 商家 的 IC卡 时 ， 必须 要 经过 认真 的 调查 与 严格 的 专家论证 与 测试 。 具体 要 从 2 个 方面 考虑 ： ① IC卡 本身 的 性能 安全 测试 ； ② 卡片 操作系统 的 安全性 分析 与 论证 。 
 1 ． 1   IC卡 的 性能 安全 测试 
 　 　 IC卡 的 安全性 中 ， 芯片 的 质量 具有 至关重要 的 作用 。 所 选择 的 卡片 使用 的 芯片 必须 通过 国际 上 独立 的 检测 权威机构 的 认证 。 通常 这些 机构 将会 对 芯片 进行 全面 的 攻击 测试 ， 确保 卡片 能够 防范 外界 的 攻击 。 
 　 　 IC卡 可 分为 接触式 与非 接触式 2 种 ， 其 最 重要 的 性能 ： ① 存储容量 要 大 ； ② 保密性 要强 。 一般 要求 写入 IC卡 上 的 数据格式 是 保密 的 ， 卡中 信息 加密 后 ， 不可 非法 修改 或 复制 ， 从而 保证 数据安全 ； ③ 具有 强 的 抗干扰 功能 ， 能 很 好 地 防伪 、 防磁 、 防静电 ； ④ 重复 使用寿命 要 高 。 
 1 ． 2   卡片 操作系统 的 安全性 分析 与 论证 
 　 　 对于 卡片 操作系统 ， 要 从 3 个 方面 来 考虑 ， 以 保证 其 安全性 。 
 　 　 1 ． 文件 及 应用 管理机制 。 对于 具有 微 处理 芯片 的 IC卡 ， 其 文件 及 应用 管理系统 的 设计 是 整个 操作系统 的 核心 。 一个 性能 可靠 的 操作系统 ， 其 在 文件 管理 上应 能够 做到 简单 明晰 、 易于 初学者 掌握 ； 过于 复杂 的 系统 设计 ， 往往 会 降低 系统 的 可靠性 ， 也 使 系统 设计者 在 系统 设计 中 容易 出现 漏洞 。 在 文件类型 上 ， 一个 好 的 操作系统 应 能够 区分 公共数据 文件 及 系统文件 的 管理 。 系统文件 通常 是 卡片 的 密匙 文件 、 PIN 文件 、 钱包 文件 等 一系列 存放 敏感数据 的 文件 ， 这 类 文件 在 管理 及 操作 上 不同于 一般 公共数据 文件 。 好 的 操作系统 应对 存放 此类 数据 的 安全性 有 严格 的 控制 。 
 　 　 2 ． 安全 控管 控制 。 IC卡 的 高 可靠 及 高 保密性 通常 可 从 4 个 方面 来 衡量 ： 文件 的 存储 权限 、 安全 报文 、 防拨 特性 、 抗 外界 攻击 。 
 　 　 （ 1 ） 文件 存储 权限 。 在 设计 IC卡 系统 过程 中 ， 大多数 设计者 会 将 整个 系统 的 安全性 集中 在 IC卡 本身 ， 其实 对于 IC卡 系统 ， 系统 的 安全性 分布 在 主机 、 前置 机 、 脱机 终端 、 联机 终端 以及 通信线路 等 各个 部分 。 因此 文件 存储 权限 的 控制 ， 既 要 做到 对 文件 操作 不同 级别 的 安全控制 ， 同时 做到 对 卡片 的 不同 生命周期 的 安全控制 。 
 　 　 通常 1 个 IC卡 生命周期 分为 3 个 阶段 ： 个人化 阶段 、 使用 阶段 、 终止 阶段 ， 这 3 个 阶段 对于 系统 的 安全性 要求 是 不同 的 。 在 个人化 阶段 ， 卡片 操作 权限 将 全部 控制 在 发卡 中心 ， 这 阶段 对 卡片 的 安全性 要求 最高 ， 外界 不可 对 一个 未 进入 使用 阶段 的 卡片 进行 操作 。 在 使用 阶段 ， 操作系统 应 能够 保证 卡片 完成 基本 的 交易 指令 ， 而 对于 系统 在 个人 阶段 的 指令 则 要 禁止 使用 。 在 使用 阶段 ， 操作系统 还应 能够 判定 卡片 是否 将 进入 终止 阶段 ， 一旦 卡片 进入 终止 阶段 ， 任何 指令 将 被 禁止 使用 。 
 　 　 （ 2 ） 安全 报文 。 安全 报文 在 IC卡 操作系统 中 通常 是 用于 敏感 指令 的 执行 ， 以及 防止 敏感数据 在 传输 、 交互 中 的 泄露 。 
 　 　 （ 3 ） 防拨 特性 。 一个 性能 可靠 的 操作系统 ， 应 具有 良好 的 防拨 特性 ， 即 卡片 在 任何 掉电 的 情况 下 或 人为 地 交易 操作过程 中 故意 拨卡时 ， 能够 保证 内部 数据 的 不 丢失 ， 以及 操作系统 的 状态 不 改变 ， 这 在 实际 使用 环境 中是 很 重要 的 。 
 　 　 3 ． 指令 。 在 金融 IC卡 操作系统 中 一般 存在 三大类 指令 ： 个人化 指令 、 交易 指令 和 管理 指令 。 在 IC卡 操作系统 中 ， 并 不是 指令 越多越好 。 好 的 操作系统 的 指令 应越 少越 好 ， 且 功能 清晰 ， 与 国际 的 标准 相 兼容 。 
 
 图 1 　 IC卡 系统 框图 
 2   IC卡 系统 设计 时 的 安全性 设计 
 　 　 有 了 IC卡 与 IC卡 操作系统 后 ， 如何 设计 一个 安全 的 IC卡 系统 ， 这是 第一次 设计 IC卡 系统 的 工程 技术人员 经常 面临 的 问题 。 在 IC卡 系统 设计 过程 中 ， 从始至终 都 应 考虑 系统 安全性 。 从 整体 上 来讲 ， IC卡 系统 的 设计 分为 以下 几个 方面 ： ① 卡片 内部结构 设计 与 操作系统 设计 ； ② 密钥 管理 设计 ； ③ IC卡 网络 设计 。 包括 发卡 系统 设计 、 终端 系统 设计 、 前置 机系统 设计 、 后台 主机 系统 设计 、 结算 系统 设计 。 
 　 　 IC卡 系统 的 这 几个 方面 是 相辅相成 的 ， 每 一部分 的 设计 都 是 相互影响 的 。 系统 的 安全性 设计 更是 渗透 在 这 几个 方面 。 
 2 ． 1   密钥 管理 设计 
 　 　 要 保证 IC卡 系统 具有 足够 的 安全性 ， 系统 设计者 在 设计 整个 IC卡 系统 的 同时 要 着手 设计 一个 密钥 管理系统 。 密钥 管理系统 是 IC卡 系统安全 的 核心 ， 严谨 的 密钥 管理 是 整个 系统安全 的 重要 保障 。 
 　 　 密钥 管理系统 中 所 设计 的 密钥 不仅仅 是 指 管理 IC卡 本身 存放 的 密钥 ， 还 应该 包括 系统 内部 的 信息 传递 通信密钥 、 传输 敏感数据 的 传输 密钥 等 。 
 　 　 通常 一个 密钥 管理系统 由 以下 2 部分 组成 ： 密钥 生成 系统 、 密钥 存放 及 下装 系统 。 密钥 生成 系统管理 从 种子 数据 到 主 密钥 的 生成 过程 。 如果 是 多级 发卡 结构 ， 应 考虑 如何 完成 多级 密钥 管理 和 卡片 通用 的 问题 ， 在 密钥 生成 的 过程 中 ， 应 保证 必要 的 安全性 以及 密钥 的 强度 ， 而且 从 任何 一个 主 密钥 都 不可 推出 种子 数据 ， 即 生成 算法 必须 是 不 可逆 的 。 
 　 　 在 密钥 存入 及 下装 系统 中 ， 必须 保证 密钥 的 不 被 泄露 。 在 IC卡 系统 中 ， 密钥 必须 根据 功能 的 不同 存放 在 不同 地方 ， 例如 密钥 可 分为 联机 密钥 和 脱机 共享 密钥 ， 通常 联机 密钥 必须 存放 在 主机 的 硬件 加密 模块 中 ， 而 脱机 共享 密钥 则 存放 在 终端 的 芯片 中 或者 是 SAM 卡中 。 
 2 ． 2   网络系统 设计 
 　 　 一个 较完整 的 IC卡 系统 应 包括 后台 主机 系统 、 发卡 系统 、 结算 系统 、 前置 机系统 、 终端 系统 等 。 图 1 是 1 个 可 参照 的 IC卡 系统 框图 。 
 　 　 后台 主机 系统 是 整个 IC卡 网络系统 的 中枢 ， 它 提供 整个 网络 的 所有 控制 与 重要 服务 ， 保存 或 备份 所有 重要性 数据 。 由于 其 重要性 ， 必须 采取 各种 隔离 保护 技术 ， 防止 任何 非法 入侵 ， 如 防火墙 技术 、 数据 加密传输 等 ， 有 条件 的 还 可 对 其 在 物理 实体 上 加以 封闭性 隔离 。 主 服务器 上 数据 要 实行 同步 备份 ， 备份 机不 直接 接入 网络 ， 而是 在 主 服务器 发生 故障 时 自动 接入 网络 运行 。 若 对 数据 的 安全性 要求 更高 ， 甚至 可以 采取 异地 备份 及 双 备份 的 方式 。 
 　 　 发卡 系统 是 IC 系统 中 与 安全性 紧密 相关 的 一个 部分 。 发卡 系统 首先 必须 保证 发卡 环境 的 安全性 ， 不能 发生 丢卡及 重卡 的 现象 ， 同时 要 保证 在 发卡 过程 中 敏感数据 不 被 泄露 。 
 　 　 财务 结算 系统 的 数据库 完整 一致性 维护 与 安全 审核 同样 是 系统 安全性 的 一个 重要 部分 。 在 发卡 系统 与 结算 系统 等 软件 上 进行 的 操作 需要 有 相应 的 操作 权限 ， 各种 权限 操作 须 有 对应 的 操作员 口令 及 管理卡 配合 进行 。 
 　 　 在 前置 机与 终端 部分 中 ， 首先 是 要 防止 传输 时 的 数据 泄密 ， 以及 终端 数据 的 电磁 泄漏 。 其次 ， 常见 的 恶意 攻击 往往 从 这里 入手 ， 例如 搭线 窃听 、 非法 终端 等 。 最后 ， 各种 病毒 也 往往 从此 环节 入侵 ， 因此 ， 线路 干扰 也 要 考虑 。 
 　 　 总之 ， 设计 一个 IC卡 系统 ， 需要 进行 周密 的 考虑 ， 不 允许 在 安全 系统 上 出现 大 的 漏洞 ， 防止 系统 的 崩溃 。 对于 初次 设计 IC卡 系统 的 设计 人员 ， 在 设计 完成 后 ， 应由 IC卡 专家 对系统 进行 评审 ， 以 确保 系统 的 可靠性 。 同时 ， 对于 不 成熟 的 IC卡 系统 ， 不 提倡 在 未 进行 大量 测试 的 情况 下 ， 就 大量 发卡 。 
 张 吉文 （ 广东 工业 大学 计算机 应用 研究室  510090 ） 
 郭圣文 （ 广东 工业 大学 计算机 应用 研究室  510090 ） 
 参考文献 
 1 ， 亚科 希 资讯 ． 智能卡 应用 全书 ． 亚社 国际 出版 
 2 ， 葛湘 ． 计算机 局域网络 的 安全性 和 保密 技术 ． 微电子学 与 计算机 ， 1998 ； 6 
 收稿 日期 ： 1999 － 09 － 01 
