自动化 学报 
 ACTA   AUTOMATICA   SINICA 
 1999 年 　 第 25 卷 　 第 5 期 　 Vol.25   No.5   1999 
 
 
 
 Kalman 滤波 的 抗野值 修正 1 ) 
 胡 　 峰 　 孙 国基 
 摘 　 要 　 分析 了 动态 测量 系统 中 异常 数据 对 Kalman 滤波 的 不利 影响 . 提出 了 一组 具有 良好 容错 能力 的 修正 型 滤波 算法 . 该 滤波 算法 既 可以 充分利用 正常 新息 确保 滤波 的 精度 ， 又 可以 有效 拟制 异常 新息 的 不利 影响 提高 滤波 估计 可靠性 ， 达到 对 故障 数据 的 容错 能力 . 最后 ， 通过 仿真 计算 验证 了 该 算法 的 有效性 . 
 关键词 　 Kalman 滤波 ， 动态 测量 系统 ， 野值 ， 容错 滤波 . 
 FAULT - TOLERANT   IMPROVEMENT   ON   KALMAN   FILTER 
 HU   Feng 　 　 SUN   Guoji 
 ( System   Engineering   Institute , Xi ' an   Jiaotong   University , Xi ' an 　 710049 ) 
 Abstract 　 The   influence   of   outliers   on   the   Kalman   filter   is   analysed , and   a   new   set   of   modified   algorithms , which   are   fault - tolerant   to   outliers   is   built .   These   new   algorithms   can   not   only   sufficiently   absorb   good   innovations   to   increase   filtering   precision   but   also   efficiently   restrain   bad   influence   coming   from   outliers . These   new   filters   have   high   security   and   fault - tolerant   capability   when   abrupt   faults   take   place . Simulation   results   show   that   the   modified   filtering   algorithms   are   practical   and   efficiently   resistant   to   outliers   in   sampling   data . 
 Key   words 　 Kalman   filter ,   dynamic - measurement   system ,   outlier ,   fault - tolerant   filter . 
 1 　 引 　 言 
 　 　 本世纪 60 年代 初期 随 状态 空间 理论 发展 起来 的 Kalman 滤波 技术 是 一组 以 递推 关系 给出 的 随机 系统 状态 最优 线性 滤波 算法 ， 它 具备 优良 的 数学 性质 ［ 1 ］ ， 并 在 随机 控制 、 信号处理 、 过程 监控 和 故障诊断 ［ 2 ］ 等 诸多 领域 中 有着 十分 广泛 的 应用 . 
 　 　 但是 ， 近 十几年来 大量 的 研究 结果 揭示 ［ 3 — 6 ］ ： Kalman 滤波 算法 缺乏 对 测量 数据 过失 误差 的 抗扰性 和 对 传感器 突发性 故障 的 容错 能力 . 应用 Kalman 滤波 算法 处理 工程 实际 问题 的 经验 也 证实 ， 测量 数据 中 即使 包含 少量 的 过失 误差 对 Kalman 滤波 效果 也 会 产生 严重 的 不利 影响 ， 甚至 导致 目标 状态 估计 明显 地 偏离 系统 真实 状态 . 
 　 　 工程 领域 中称 传感器 发生 突发性 故障 时 的 采样 信息 或 含 过失 误差 的 测量 数据 为 野值 ( Outliers ) . 本文 从 过程 控制 和 随机 信号处理 的 实际 出发 ， 系统分析 野值 对 Kalman 滤波 的 不利 影响 ， 并 建立 一组 具有 抗野值 干抗 能力 的 修正 型 递推 算法 . 
 2 　 野值 对 Kalman 滤波 的 影响 分析 
 　 　 对于 线性 动态 测量 系统 
 　 ( 1 ) 
 状态 向量 的 Kalman 滤波 算法 为 ［ 1 ］ 
 　 ( 2 ) 
 式 中 样本 新息 , 滤波 增益 Kk + 1 = Σ k + 1H τ k + 1 ｛ Hk + 1 Σ k + 1H τ k + 1 + R η ( k + 1 ) ｝ - 1 ; Σ k + 1 = Ak + 1 ( I - KkHk ) Σ kA τ k + 1 + R ε ( k ) , R η ( k ) = cov ( η k , η k ) , R ε ( k ) = cov ( ε k , ε k ) . 
 　 　 从式 ( 2 ) 可以 看出 ， 新 增加 样本 点 yk + 1 所 带来 的 新息 ( innovations ) 是 以 线性组合 的 方式 对 Kalman 滤波 估值 产生 影响 的 . 因此 ， 当 样本 点 yk + 1 为 “ 正常值 ” 时 ， 新息 会 对 tk + 1 时刻 的 滤波 估计值 进行 正确 的 修正 ( 修正 倍数 为 滤波 增益 Kk + 1 ) ； 如果 新增 样本 点 yk + 1 为 “ 异常 值 ” ( 即野值 ) 时 ， 带来 的 异常 新息 也 会 以 Kk + 1 倍 地 对系统 的 状态 预报 进行 错误 修正 ， 使 滤波 估计值 发生 偏移 . 
 3 　 含野值 数据 序列 的 处理 对策 
 　 　 在 序贯 处理 和 实时 测控 过程 中 ， 对 大量 实测 数据 进行 野值 点 统计 诊断 是 比较 困难 的 . 因此 ， 为了 提高 Kalman 滤波 的 容错 能力 ， 有 必要 对 滤波 算法 进行 容错 改进 或 适当 修正 ， 并 要求 
 　 　 1 ) 修正 后 的 滤波 算法 有 简洁 的 递推 关系 ， 便于 工程 应用 ； 
 　 　 2 ) 当 观测 数据 序列 中 含有 少量 野值 时 ， 能 有效 克服 其 不利 影响 ， 或者 至少 能 将 其 影响 控制 在 某 预先 给定 界限 内 ， 以 确保 滤波 估计值 尽可能 接近 系统 真实 状态 ； 
 　 　 3 ) 当 数据 集合 中 不 包含 野值 时 ， 能 充分利用 有效 新息 提高 滤波 精度 . 
 　 　 基于 上述 设想 ， 本文 构造 出 一组 类似 于 Kalman 滤波 的 修正 算法 
 　 ( 3 ) 
 式 中 Φ k + 1 ( . ) 为 适当 选取 的 按 段 光滑 的 函数 ， 称为 压缩 影响 函数 ； Kk + 1 为 滤波 增益 ， Gk + 1 为权 矩阵 . 
 　 　 显然 ， 式 ( 3 ) 描述 的 是 一个 滤波 族 ， 随着 Φ k + 1 ( . ) 取法 的 不同 ， 可以 得到 具有 不同 统计 性质 的 滤波 算法 . 
 　 　 可以 证明 ， 当选 取 Φ k + 1 ( . ) = 1 , Gk + 1 = I ( 单位矩阵 ) 时 ， 式 ( 3 ) 给出 的 即 为 Kalman 滤波 . 但是 ， 序列 ｛ Φ k + 1 ( . ) = 1 ｝ 作用 的 直接 效果 是 同等 看待 正常 新息 和 异常 新息 ， 导致 滤波 算法 缺乏 抗野值 干扰 的 能力 . 
 　 　 鉴于 此 ， 一种 合理 的 容错 处理 策略 是 通过 适当 选取 Φ k + 1 ( . ) 使得 当 rk + 1 增大 时 Φ k + 1 ( . ) 减小 或接 近于零 . 
 4 　 最佳 Φ k ( . ) 函数 的 选取 
 　 　 基于 第 3 节 的 分析 ， 为 削弱 野值 数据 对 状态 滤波 的 不利 影响 ， 可以 通过 适当 选取 压缩 影响 函数 Φ k + 1 ( . ) 来 限制 滤波 修正 项 
 　 ( 4 ) 
 的 大小 . 即 对 适当 给定 的 门限 常数 ck + 1 ， 通过 合理 地 选取 压缩 影响 函数 Φ k + 1 ( . ) ， 使得 下 式 成立 ： 
 　 ( 5 ) 
 式 中 的 最大 特征值 . 
 　 　 不难看出 ， 满足条件 ( 5 ) 的 Φ k + 1 ( . ) 函数 序列 有 很多 ， 可 形成 集合 S 
 　 ( 6 ) 
 下面 ， 具体 讨论 从 集合 S 中 选取 最优 压缩 影响 函数 序列 Φ k ( . ) 的 方法 . 
 　 　 定理 . 当 线性 随机 系统 ( 1 ) 的 基本 随机 序列 ｛ x0 , ε 0 , ε 1 , … , η 1 , η 2 , … ｝ 为 服从 正态分布 且 互不 相关 时 ， 如果 选取 权 矩阵 序列 Gk + 1 = Hk + 1 Σ k + 1H τ k + 1 + R η ( k + 1 ) ， 则 在 函数 族 S 中使 滤波 误差 均 方差 最小 的 Φ 函数 为 
 　 ( 7 ) 
 其中 Ck 为 适当 选取 的 门限 常数 或 常数 序列 . 
 　 　 证明 . 由式 ( 3 ) ， ( 2 ) 有 
 　 ( 8 ) 
 问题 转化 为 关于 集合 S 的 极小 化 问题 . 由式 ( 2 ) ， ( 3 ) 有 
 　 ( 9 ) 
 结合 S 的 定义 知 ， 式 ( 7 ) 给定 的 ｛ Φ k ( . ) ｝ 在 S 中使 上式 ( 9 ) 达到 最小 . 
 证毕 . 
 　 　 实际 应用 中 ， 为 简化 计算 也 可 采用 如下 形式 的 ｛ Φ k ( r ) ｝ 函数 序列 
 　 ( 10 ) 
 式 中 C * 1 为 适当 选取 的 非负 常数 . 
 　 　 下面 ， 对 门限 常数 Ck + 1 的 选取 方法 做 一 简单 讨论 . 
 　 　 在 上述 定理 条件 下 ， 可以 证明 ω ( k + 1 ｜ k ) 服从 标准 的 多元 正态分布 . 因此 , ‖ rk + 1 = ω ( k + 1 ｜ k ) ‖ 2 服从 自由度 为 m 的 χ - 分布 . 取该 χ - 分布 的 置信度 为 ( 1 - α ) × 100% 的 上分 位点 为 c α （ m ) ( α 常取 0.05 或 0.025 ) ， 则 门限 常数 Ck + 1 的 合理 取值 可 采用 下 式 给定 ： 
 Ck + 1 = ( λ k + 1c α ( m ) ) 1 / 2 　 ( 11 ) 
 在 工程 问题 的 具体 应用 中 ， 门限 Ck + 1 也 可 凭 经验 选取 . 
 5 　 仿真 计算 
 　 　 设定 线性 随机 系统 模型 ( 1 ) 的 系数 阵 和 误差 协方差 阵 分别 为 
 
 并 选取 系统 的 初态 为 x ( 0 ｜ 0 ) = ( 1.3 ， 1.5 ， 2.3 ) τ , Σ ( 0 ｜ 0 ) = 0.01 I3 ， I3 表示 s 阶 单位矩阵 . 
 　 　 采用 Monte   Carlo 方法 产生 100 组 仿真 “ 测量 ” 数据 ( 记 为 集合 S ) . 将 集合 S 中 第 50 ， 60 ， 75 点 分别 引入 偏移量 ( Δ y1 , Δ y2 ) = ( - 1 ) i ( 100 , - 5 ) ( i = 50 , 60 , 75 ) 形成 含 3 个 野值 点 的 数据 集合 S * . 利用 S * 中 的 数据 ， 分别 按式 ( 2 ) ， ( 3 ) 计算 状态 的 滤波 估计 ， 结果 如图 1 和 图 2 所示 ： 
 
 
 图 1 　 3 维 状态 空间 Kalman 滤波 
 
 
 图 2 　 3 维 状态 空间 的 容错 滤波 
 　 　 从图 1 、 2 可以 看出 ， 野值 对 Kalman 滤波 有 十分 明显 的 不利 影响 ， 本文 提出 的 容错 修正 算法 能够 有效 地 克服 野值 点 的 不利 影响 ， 提高 滤波 估计 的 可靠性 . 
 致谢 　 本文 曾 得到 张 殷龙 副 总工程师 、 李济生 院士 和 范金 城 教授 的 指导 ， 谨致 谢忱 . 
 1 ) 西安交通大学 研究生院 博士学位 论文 基金 ( DFXJU1998 - 10 ) 资助 项目 . 
 作者简介 ： 胡 　 峰 　 男 ， 1964 年生 ， 1989 年 硕士 毕业 . 现为 西安交通大学 系统工程 研究所 博士 研究生 ， 西安卫星测控中心 某 技术 室 副 主任 、 高级 工程师 、 中国 宇航 学会 会员 、 《 飞行器 测控 学报 》 编委 . 近年来 承担 科研课题 7 项 ， 参加 大型 航天 试验 任务 30 多次 ， 发表 研究 论文 50 多篇 ( 其中 11 篇 论文 获奖 ) ， 获 部委级 科技进步 二 、 三等奖 6 项 . 主要 研究 方向 为 复杂 系统 建模 与 仿真 、 大 系统 控制论 、 数据 诊断 与 稳健 - 容错 处理 技术 . 
 　 　 　 　 　 孙 国基 　 1936 年生 ， 1966 年 获得 苏联 科学技术 系统 仿真 副 博士学位 ， 历任 西安交通大学 副校长 和 该校 工程 与 科学 研究院 院长 . 现为 博士生 导师 、 全国 系统 仿真 学会 副理事长 、 《 系统 仿真 学报 》 等 学术期刊 的 编委 . 近年来 ， 主要 从事 CIMS 仿真 和 虚拟现实 在 仿真 中 的 应用 研究 ， 先后 承担 “ 863 ” 国家 高技术 计划 等 攻关 课题 多项 ， 获 全国科学大会奖 及 多项 部委级 科技 进步奖 ， 并 发表 研究 论文 50 多篇 . 
 作者 单位 ： 西安交通大学 系统工程 研究所 　 西安 　 710049 
 参考文献 
 1 　 韩崇昭 ， 王月娟 ， 万 百五 . 随机 系统 理论 ， 西安 ： 西安交通大学 出版社 ， 1987 
 2 　 Isermann   R . Process   fault   detection   based   on   modeling   and   estimation   methods - a   survey .   Automatica , 1984 ， 20 ( 4 ) ： 387 — 404 
 3 　 Martin   C   J , Mintz   M . Robust   filtering   and   prediction   for   linear   systems   with   uncertain   dynamics : a   game - theoretic   approach . IEEE   Trans   on   Automatic   Control , 1983 , 28 ( 9 ) : 888 - 896 
 4 　 胡 　 峰 ， 范金 城 . 动态 测量 系统 有 界 影响 滤波 . 控制 理论 与 应用 ， 1993 ， 10 ( 1 ) ： 36 — 45 
 5 　 胡 　 峰 ， 范金 城 . 动态 测量 系统 抗扰性 预报 算法 . 宇航学 报 ， 1995 ， 16 ( 1 ) ： 93 — 96 
 6 　 胡 　 峰 ， 范金 城 . 动态 - 测量 系统 抗扰性 技术 研究 的 发展 综述 . 数理统计 与 应用 概率 ， 1996 ， 11 ( 3 ) ： 244 — 248 
 收稿 日期 ： 1997 - 09 - 01 
 修稿 日期 ： 1998 - 06 - 23 
