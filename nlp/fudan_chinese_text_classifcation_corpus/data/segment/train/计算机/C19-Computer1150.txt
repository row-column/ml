自动化 学报 
 ACTA   AUTOMATICA   SINICA 
 1999 年   第 25 卷   第 6 期   Vol.25   No.6   1999 
 
 
 
 基于 区域 一致性 测度 的 多 尺度 边缘 检测 方法 
 杨 　 　 梁德群 
 摘 　 要 　 在 多 尺度 边缘 检测 方法 中 ， 滤波器 的 滤波 尺度 的 选取 非常 重要 ， 该文 提出 了 区域 一致性 测度 的 概念 以 度量 当前 像素点 所处 的 区域 是 平滑 区 还是 边缘 区 ， 并 以此 测度 来自 适应 调整 滤波 尺度 . 实验 结果 和 分析表明 ， 这种 方法 可以 得到 令人满意 的 结果 ， 同时 具有 较 好 的 抗噪 能力 . 
 关键词 　 滤波 ， 边缘 检测 ， 小 波 变换 . 
 MULTISCALE   EDGE   DETECTION   BASED   ON 
 REGION   HOMOGENEITY   MEASURE 
 YANG   Xuan 
 ( Institute   of   Electronics   Engineering ,   Xidian   University ,   Xi ' an 　 710071 ) 
 LIANG   Dequn 
 ( Dalian   Marine   University ,   Dalian 　 116026 ) 
 Abstract 　 The   most   important   thing   in   multiscale   edge   detection   is   the   filter   scale .   Region   homogeneity   measure   is   defined   to   distinguish   homogenous   region   from   edge   region .   The   cubic   B   spine   wavelet   whose   scale   is   adjusted   by   the   region   homogeneity   measure   is   used   to   detect   edge .   The   experiment   results   and   comparisons   show   that   this   method   is   effective   and   feasible . 
 Key   words 　 Filtering ,   edge   detection ,   wavelet   transform . 
 1 　 引言 
 　 　 边缘 检测 在 计算机 视觉 中 具有 重要 的 意义 . 经典 的 边缘 检测 方法 中 最具 代表 的 有 Marr - Hildreth ［ 1 ］ 边缘 检测 方法 与 Canny ［ 2 ］ 最优 算子 . 随着 小 波 研究 的 深入 ， 小 波 边缘 检测 方法 ［ 3 ］ 得到 了 越来越 多 的 应用 . 这些 方法 都 属于 线性 滤波 的 方法 ， 因而 都 需要 解决 一个 关键 的 问题 — — 滤波 尺度 的 选择 . 小 尺度 滤波 可以 得到 较 准确 的 边缘 定位 ， 同时 反映 更 多 的 边缘 细节 ， 但 对 噪声 较为 敏感 ； 而 大 尺度 滤波 ， 在 边缘 定位 上会 有 一定 的 偏差 ， 同时 只能 反映 大 的 边缘 轮廓 ， 但 对 噪声 具有 较强 的 抑制 . 对 图像 进行 边缘 检测 ， 如何 同时 满足 边缘 定位 的 精度 ， 又 有效 抑制 噪声 ， 其 关键在于 滤波 尺度 的 自 适应 选取 . 滤波 尺度 的 选取 与 当前 像素点 所处 的 区域 是 平滑 区 还是 边缘 区 有关 ， 文献 ［ 4 ］ 采用 模糊推理 方法 判定 平滑 区 和 边缘 区 ， 文献 ［ 5 ］ 定义 局部 熵 来 分析 噪声 的 情况 . 我们 希望 能够 得到 一个 度量 来 反映 当前 区域 的 特征 ， 本文 将 从 边缘 的 特征 入手 ， 定义 区域 一致性 测度 作为 判定 是 平滑 区 和 边缘 区 的 依据 ， 并 以此 来自 适应 调整 滤波 尺度 ， 进而 进行 多 尺度 边缘 检测 . 
 
 2 　 区域 一致性 测度 
 　 　 传统 的 边缘 定义 为 图像 中 灰度 的 突变 ， 这样 的 定义 过于 简单 了 . 由于 噪声 的 影响 ， 仅 从 灰度 的 突变 上 ， 常常 无法 区分 真正 的 边缘 和 噪声 . 事实上 ， 有效 边缘 往往 具有 以下 特征 ： 1 ) 灰度 突变 ， 2 ) 是 不同 区域 之间 的 边界 ， 3 ) 具有 方向性 . 也就是说 ， 有效 边缘 不仅 在 局部 反映 出 灰度 突变 的 特征 ， 同时 也 是 图像 中 轮廓 结构 的 一部分 . 因此 ， 判断 所 关心 的 区域 ， 其 特征 是否 存在 差异 ， 就 可以 判断 是否 有 存在 边缘 的 可能 . 如果 区域 内 特征 是 一致 的 ， 就 认为 是 平滑 区 ； 如果 特征 有 差异 ， 则 判定 为 边缘 区 . 本文 定义 的 区域 一致性 测度 就是 对 区域 内 特征 是否 存在 差异 的 度量 . 
 2.1 　 区域 一致性 测度 
 　 　 对于 邻域 R = ｛ ( i , j ) ｜ ｜ i - ci ｜ ≤ L , ｜ j - cj ｜ ≤ L ｝ ， ( ci , cj ) 是 邻域 中心 像素点 ， L 是 邻域 的 长度 . 取过 中心点 ( ci , cj ) 、 方向 为 θ 的 一条 直线 l ， 将 R 划分 为 两半 S1 和 S2 ， 如图 1 所示 . 令 
 
 
 图 1 　 邻域 划分 图示 
 
 其中 gij 是 像素点 ( i , j ) 的 灰度 值 . 将 l 绕 ( ci , cj ) 从 0 ° 旋转 到 180 ° ， 得到 N 个 方向 θ k 的 划分 结果 ， 每 一次 划分 得到 一个 g θ k 　 ， k = 1 , 2 , … , N . 令 
 　 　 ( 2 ) 
 Rh 的 值 可以 反映 区域 内 特征 是否 一致 ， 也 就是 存在 边缘 的 可能性 . 若 ( ci , cj ) 是 有效 边缘 点 ， 则 l 的 N 个 方向 中必 有 一个 方向 θ k 是 边缘 存在 的 方向 ， S1 和 S2 是 具有 不同 灰度 值 的 两个 区域 ， 此时 g θ k 的 值 最大 ， 而 其它 方向 g θ k 的 值 较之 为 小 ， 也就是说 ， 在 边缘 方向 上 ， 灰度 的 变化 最大 ， 此时 Rh 的 值 就 反映 了 边缘 方向 的 灰度 变化 ； 若 ( ci , cj ) 处在 平滑 区内 ， 则 l 的 N 个 方向 都 是 将 同一个 区域 划分 为 两半 ， 其 g θ k 都 比较 小 ， 从而 Rh 的 值 也 就 比较 小 ， 此时 Rh 的 值 就 反映 了 平滑 区内 的 灰度 变化 . 
 　 　 对于 加噪 的 图像 ， 由于 噪声 的 分布 是 随机 的 ， 因此 无论 ( ci , cj ) 是 有效 边缘 点 还是 处在 平滑 区内 ， l 所 旋转 的 N 个 方向 中 ， S1 和 S2 的 噪声 分布 以及 噪声 强度 ， 在 概率 上 都 是 相同 的 . 由于 g θ = ｜ gS1 - gS2 ｜ ， 噪声 的 影响 相应 地被 抵消 了 ， 不会 对 Rh 的 值 产生 较大 的 影响 ， 因此 Rh 具有 较 好 的 抗噪 能力 ， 这 一点 正是 克服 了 传统 边缘 定义 中仅 考虑 灰度 突变 的 缺点 ， 而是 同时 考虑 了 灰度 突变 以及 边缘 方向 的 结构 信息 ， 体现 了 前述 的 边缘 本质特征 ， 是 一种 有效 、 合理 的 定义 . 
 　 　 定义 . 对于 邻域 R = ｛ ( i , j ) ｜ i - ci ｜ ≤ L , ｜ j - cj ｜ ≤ L ｝ ， 过 中心点 ( ci , cj ) 以 方向 θ k ( 0 ° ≤ θ k ≤ 180 ° ， k = 1 , 2 , … , N ) 将 R 划分 为 两半 S1 和 S2 ， 令 
 
 则 Rh 称为 区域 一致性 测度 . 
 　 　 邻域 大小 L 的 选取 取决于 图像 的 特点 ， 如果 图像 中 边缘 分布 较为 分散 ， L 取值 可以 较大 ； 如果 图像 中 边缘 分布 密集 ， L 取值 相应 较 小 . 一般 地 ， 取 L = 3 . 
 2.2 　 侧向 抑制 
 　 　 前面 考虑 了 ( ci , cj ) 为 边缘 点及 在 平滑 区 的 情况 ， 还有 一种 情况 就是 ( ci , cj ) 处在 边缘 的 附近 . 假设 区域 S1 和 S2 中 的 灰度 值 分别 为 g1 和 g2 ， 则 当划 直线 l 与 边缘 平行 时 ， g θ 　 最大 ； 若 划分 直线 l 距 边缘 距离 为 d ， 则 
 　 　 ( 3 ) 
 　 　 ( 4 ) 
 　 　 ( 5 ) 
 也就是说 ， 在 有效 边缘 附近 的 点 ， 其 Rh 比 边缘 点 的 Rh 值 小 ， 但 相对 平滑 区 的 Rh 较大 ， 这些 点 需要 去掉 ， 以 避免 错判 ， 所以 侧向 抑制 就是 将 有效 边缘 点 附近 的 这些 点 的 Rh 值 减小 . 其 方法 是 ， 首先 求 出 图像 中 所有 像素点 在 邻域 内 的 Rh 值 ， 在 整图 中求 一次 局部 极值 ， 并 以 这些 局部 极值 作为 侯选 的 边缘 点 ， 进而 判定 附近 无效 点 ， 将 其 Rh 的 值置 0 。 
 3 　 滤波 尺度 自 适应 调整 
 　 　 自 适应 调整 滤波 尺度 就是 在 平滑 区内 进行 大 尺度 的 滤波 ， 而 在 边缘 区 进行 小 尺度 滤波 ， 这样 既 可以 抑制 噪声 ， 同时 又 较 好 地 保留 了 有效 边缘 . 有 了 区域 一致性 测度 这一 度量 ， 自 适应 调整 滤波 尺度 就 成为 可能 . 本文 使用 小 波 边缘 检测 方法 ［ 3 ］ ， 采用 二次 样条 小 波 进行 小 波 变换 ， 平滑 函数 θ ( x ) = B3 ( x ) ， 小 波函数 ， 对于 信号 f ( x ) ， 尺度 s 下 的 小波 变换 为 
 　 　 ( 6 ) 
 其中 ， 需要 自 适应 调整 的 就是 滤波 尺度 s . 
 　 　 首先 要 解决 的 问题 是 滤波 尺度 s 的 取值 范围 . 尺度空间 ［ 6 ］ 的 思想 中 s ∈ ［ 0 ， ∞ ) ， 但 在 实际 应用 中 ， s 是 有 一个 有限 的 范围 ， 即 s0 ≤ s ≤ smax ， smax 是 用于 平滑 区 的 大 尺度 参数 ， 其 目的 是 为了 抑制 噪声 ， 所以 smax 的 取值 应 尽量 大 ， 我们 取 smax = 24 ； s0 是 用于 边缘 区 的 小 尺度 参数 ， 其 目的 是 为了 准确 定位 边缘 ， s0 的 取值 应 尽量 小 ， 但 并 不是 越小越 好 . 对于 斜坡 状 的 边缘 ， 大 尺度 下 的 小波 变换 结果 中 存在 局部 极值 ， 而 小 尺度 的 变换 结果 中 没有 局部 极值 ， 因而 ， 尺度 过 小 ， 就 不能 检测 这种 斜坡 边缘 . 
 　 　 设 斜坡 边缘 高度 为 A ， 宽度 为 d , u ( x ) 是 阶跃 函数 ， 其 一维 模型 为 
 　 　 ( 7 ) 
 　 　 ( 8 ) 
 　 　 ( 9 ) 
 由 B 样条 性质 知 
 　 　 ( 10 ) 
 其中 平滑 函数 θ ( x ) 的 支集 为 ［ - w ／ 2 , w ／ 2 ］ ， 对于 三次 B 样条 ， w = 3 . 当 s > d / 3 时 ， 在 x = 0 处才 有 局部 极值 ， 边缘 定位 才 是 准确 的 ， 否则 检测 不 出 边缘 . 也就是说 ， 滤波 尺度 的 选取 与 边缘 宽度 有关 ， 若 边缘 宽度 为 d ， 则 相应 的 滤波 尺度 为 . 
 　 　 下面 讨论 如何 确定 边缘 宽度 . 如果 存在 一个 邻域 ， 恰好 使 边缘 的 灰度 变化 完全 在 该 邻域 内 表现 出来 ， 则 该 邻域 的 长度 就是 边缘 的 宽度 . 若取 的 邻域 小于 边缘 宽度 ， 则 其 区域 一致性 测度 将 随 邻域 增大 而 增大 ； 而 当 邻域 大于 边缘 宽度 时 ， 其 区域 一致性 测度 就 不再 发生 大 的 变化 . 对于 判定 为 边缘 区 的 邻域 R ， l 是 可变 的 领域 长度 . 令 Rhl 是 领域 长度 为 l 时 的 区域 一致性 测度 ， 则 边缘 宽度 d 为 
 　 　 ( 11 ) 
 其中 l1 是 某 一 领域 长度 ， 满足 ｜ Rhl1 ／ Rhl2 - 1 ｜ ≤ β ， l2 = l1 + 1 ， 取 β = 0.05 . 这里 可以 确定 的 最大 边缘 宽度 为 3 × 22 ， 此时 的 滤波 尺度 为 s = 22 ， 可以 适用 于 大多数 图像 的 情况 . 
 　 　 构造 尺度 确定 函数 s = f ( Rh ) ， 以 确定 每 一个 像素点 的 滤波 尺度 . 若 当前 像素点 是 在 边缘 区 ， 则 区域 一致性 测度 Rh 值 较大 ， 此时 应 采用 相应 的 小 尺度 进行 滤波 ； 若 当前 像素点 是 在 平滑 区 ， 则 Rh 的 值 较 小 ， 此时 应 采用 大 尺度 进行 滤波 . 
 　 　 判定 Rh 的 值 大小 程度 时 ， 需 要求 一个 判定 阈值 T ， 采用 高斯 峰拟 和 的 方法 来 确定 T . 将 整图 Rh 的 值 离散 化到 ［ 0 ， 255 ］ ， 统计 整图 的 Rh 值 ， 得到 相应 的 Rh 直方图 ， 判定 阈值 T 就是 取该 直方图 的 分割 阈值 . 一般来讲 ， 边缘 在 整图 中 所 占 的 比例 比较 小 ， Rh 的 值 大多 分布 在 值 较 小 的 地方 . 整图 中 ， Rh 值较 小 的 部分 其 分布 可以 假设 为 一个 高斯分布 ， 阈值 T 可以 取 在 高斯 峰 结束 的 地方 . 令 hi 是 整图 中 Rh = i 的 像素点 的 个数 ， 则 
 T = a + 3 σ * ， 　 　 ( 12 ) 
 　 　 ( 13 ) 
 其中 . 且 
 　 　 当然 ， 这样 确定 的 阈值 T 不 一定 是 最佳 的 ， 但是 可以 保证 是 比较 理想 的 . 实验 表明 ， 阈值 T 的 小 变化 ， 对 判定 结果 不会 产生 过大 影响 . 由 上述 分析 ， 得到 尺度 确定 函数 
 　 　 ( 14 ) 
 4 　 实验 结果 分析 
 　 　 我们 对 本文 提出 的 多 尺度 边缘 检测 方法 进行 实验 ， 将 该 方法 应用 于图 2 ( a ) 和 图 3 ( a ) . 图 2 ( a ) 是 人造 图像 ， 图 3 ( a ) 是 实际 图像 Lena 图 ， 这 两幅 图 都 是 在 原图 的 基础 上 添加 了 分布 为 N ( 0 ， 102 ) 的 噪声 ， 然后 分别 使用 σ = 1.6 的 LOG 算子 和 Canny 算子 以及 本文 方法 进行 边缘 检测 . 图 2 ( a ) 的 右上角 灰度 值为 160 ， 相邻 区域 灰度 值为 128 ， 中间 区域 灰度 值为 66 ， 左下角 灰度 值为 210 . 图 2 ( a ) 和 图 3 ( a ) 的 判定 阈值 T 分别 取 32 和 25 . 图 2 ( a ) 中 右上角 的 区域 在 Canny 算子 中 没有 检测 出来 ， 如果 被 检测 出来 ， 则 相应 的 噪声 会 非常 多 ， 而 本文 中 的 方法 效果 很 好 . Lena 图加噪 之后 ， LOG 算子 的 检测 结果 中 噪声 比较 多 ， Canny 算子 的 检测 结果 也 较差 ， 本文 方法 在 有效 边缘 和 噪声 之间 可以 得到 较 好 的 折衷 . 
 
 
 ( a ) 加噪图 
 
 
 ( b ) LOG 算子 检测 结果 
 
 
 ( c ) Canny 算子 检测 结果 
 
 
 ( d ) 本文 方法 检测 结果 
 图 2 　 加噪 人造 图像 边缘 检测 结果 
 
 
 ( a ) 加噪图 
 
 
 ( b ) LOG 算子 检测 结果 
 
 
 ( c ) Canny 算子 检测 结果 
 
 
 ( d ) 本文 方法 检测 结果 
 图 3 　 加噪 Lena 图 边缘 检测 结果 
 5 　 结论 
 　 　 多 尺度 边缘 检测 方法 中 滤波 尺度 的 选取 是 关键 ， 而 判断 当前 像素点 所处 的 区域 是 边缘 区 还是 平滑 区 是 选取 尺度 的 依据 . 本文 定义 的 区域 一致性 测度 定量 地 反映 了 当前 像素点 所 处 邻域 是 平滑 区 或是 边缘 区 的 可能 ， 同时 该 测度 具有 较 好 的 抗噪 能力 ， 可以 作为 滤波 尺度 自 适应 调整 的 依据 . 本文 给出 了 滤波 尺度 的 选取 原则 ， 实验 结果表明 ， 该 方法 是 可行 和 有效 的 . 
 作者简介 ： 杨 　 　 西安电子科技大学 电子 工程学院 博士后 . 主要 从事 计算机 视觉 、 模式识别 方向 的 研究 . 
 　 　 　 　 　 梁德群 　 西安交通大学 电信 学院 图像 所 博士 导师 ， 现在 大连海事大学 工作 . 主要 从事 图像处理 、 模式识别 、 工业 图像 检测 等 方向 的 研究 . 
 作者 单位 ： 杨 　 　 西安电子科技大学 电子 工程学院 　 西安 　 710071 
 　 　 　 　 　 梁德群 　 大连海事大学 　 大连 　 116026 
 参考文献 
 1 　 Marr   D ,   Hildreth   E .   Theory   of   edge   detection .   In :   Proc .   Roy .   Soc . ,   London ,   1980 , B207 ： 187 ～ 217 
 2 　 Canny   J .   A   computational   approach   to   edge   detection .   IEEE   Trans .   Pattern   Anal .   &   Mach .   Intell . ， 1986 ， 8 ( 6 ) ： 679 ～ 698 
 3 　 Mallat   S ,   Zhong   S .   Characterization   of   signals   from   multiscale   edges .   IEEE   Trans .   Pattern   Anal .   &   Mach .   Intell . ,   1992 ， 14 ( 9 ) ： 710 ～ 732 
 4 　 Law   T ,   Itoh   H ,   Seki   H .   Image   filtering ,   edge   detection   and   edge   tracing   using   fuzzy   reasoning .   IEEE   Trans . ,    Pattern   Anal .   &   Mach .   Intell . , 1996 ， 18 ( 5 ) ： 481 ～ 491 
 5 　 Beghdadi   A ,   Khellaf   A .   A   noise - filtering   method   using   a   local   information   measure .   IEEE   Trans .   Image   Process . ,   1997 ， 6 ( 6 ) : 879 ～ 882 
 6 　 Witkin   A .   Scale - space   filtering .   In :   Int .   Joint   Conf .   Artifical   Intelligence ,   Karlsruhe ,   Germany ,   1983 , 1019 ～ 1021 
 收稿 日期 　 1997 - 09 - 15 　 收 修改稿 日期 　 1998 - 09 - 15 
