计算机 应用 研究 
 APPLICATION   RESERCH   OF   COMPUTERS 
 2000     Vol.17 　 No.1 　 P.71 - 73 
 
 
 
 
 一种 对 胃窦 B超 图象 进行 自动 分割 的 方法 
 张艳 　 费耀平 　 伍晓平 　 廖志宁 　 常小荣 
 摘   要   提出 了 一种 对 胃窦 B超 序列 图象 进行 自动 分割 的 方法 。 我们 综合利用 传统 的 图象 分割 技术 ， 提出 了 一套 自动 提取 胃窦 初始 轮廓 的 方法 。 在 此基础 之上 ， 运用 活动 轮廓 模型 ， 进行 边缘 轮廓 的 逼近 ， 从而 获得 比较 精确 的 胃窦 边缘 轮廓 。 实验 的 结果 证明 了 该 方法 的 有效性 。 
 关键词   图象 分割   活动 轮廓 模型   胃窦   B超 图象 
 1   引言 
 　 　 图象 的 分割 是 医学 图象处理 中 的 关键环节 ， 本文 所 研究 的 胃窦 分割 问题 是 中医 经络 与 肺腑 相关 研究课题 撟 阊 裘 骶  胛 赶 喙 毓 媛 傻 难 芯 繑 的 重要 组成部分 。 撟 阊 裘 骶  胛 赶 喙 毓 媛 傻 难 芯 繑 是 通过 针刺 足 阳明经 不同 部位 ， 来 观察 进针 前后 三分钟 胃窦 上下 径 、 前后 径 以及 面积 的 变化规律 。 
 　 　 由于 B超 具有 无损 性 的 优点 ， 而且 操作 简便 ， 形象 直观 。 在 研究 过程 中 采用 了 B超 显像 来 观测 胃窦 的 变化 。 从 图象处理 的 角度 来看 ， 医学 图象 由于 其 信噪比 低 、 运动 模糊 等 特性 ， 是 图象 分割 中 的 一个 难点 。 而 B超 图象 是 医学 图象 中 质量 最差 的 一种 ， 与 其它 图象 ( 显微镜 成像 、 CT 、 MR 等 ) 相比 ， B超 图象 分割 显得 更为 困难 。 目前 ， 医学 图象 分割 研究 较 多 的 是 显微镜 成像 、 CT ( computed   tomography ) 、 MR ( magnetic   resonance ) 等 ， 而 对 B超 图象 研究 较 少 。 同时 ， 由于 胃 的 舒张 和 收缩 及其 蠕动 ， 使得 胃窦 是 一个 不规则 运动 的 非 刚性 的 物体 ， 在 一定 程度 上 加大 了 边缘 的 模糊性 ， 增大 了 分割 的 难度 。 对于 胃窦 B超 图象 的 分割 ， 还 未 见 国内外 有 这方面 的 研究 报道 。 
 　 　 目前 对于 医学 图象 的 分割 ， 国内外 一般 是 通过 人工干预 ， 采用 半自动 的 方法 来 实现 。 本文 对 胃窦 B超 图象 的 分割 进行 了 深入 地 研究 ， 在 活动 轮廓 模型 ( Active   Contour   Models ) 的 基础 上 提出 了 一个 从 初始 轮廓 提取 到 精确 轮廓 逼近 的 完整 的 分割 方案 ， 该 方法 实现 了 自动 分割 ， 减少 了 分割 时间 ， 提高 了 分割 的 准确性 。 
 　 　 本文 结构 安排 ： 第二 部分 介绍 初始 轮廓 的 获取 ， 第三 部分 介绍 轮廓 的 优化 ， 第四 部分 介绍 采用 本 方法 进行 胃窦 B超 图象 分割 的 结果 ， 第五 部分 为 结论 部分 。 
 2   初始 轮廓 的 自动 获取 
 应用 活动 轮廓 模型 进行 分割 ， 通常 的 做法 是 人工 在 真实 边缘 附近 选择 若干点 ， 然后 用 直线 或 曲线 将 这些 点 连接起来 ， 以此 作为 初始 轮廓 。 在 这里 我们 给出 了 一个 自动 提取 胃窦 初始 轮廓 的 方案 。 
 　 　 我们 提出 的 初始 轮廓 的 提取 方法 是 一种 基于 灰度 的 方法 。 针对 不同 的 图象 质量 ， 我们 综合 运用 了 二值化 处理 、 形态学 处理 、 多 分辨率 等 图象处理 方法 ， 并 提出 了 一个 判定 是否 成功 提取 了 初始 轮廓 的 准则 ， 利用 该 判定 准则 ， 将 多种 处理 方法 有机 地 结合 起来 ， 从而 实现 初始 轮廓 自动 提取 。 
 2.1   判定 准则 
 根据 胃窦 本身 的 特点 ， 其 图象 近似 为 一 椭圆 。 我们 采用 如下 两条 规则 作为 判定 准则 。 
 f1 = B > TB 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　   ( 1 ) 
 f2 = C > TC   　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 2 ) 
 　 　 其中 B 和 C 分别 为 轮廓 跟踪 所 获得 的 轮廓 的 面积 和 圆度 ，   TB 和 TC 分别 为 根据 经验值 选取 的 面积 和 圆度 的 判定 门限 。 如果 ( 1 ) 、 ( 2 ) 两式 均 成立 ， 我们 就 认为 初始 轮廓 提取 成功 。 
 2.2   二值化 处理 
 　 　 从 胃窦 B超 图象 的 整体 来看 ， 包含 了 两类 对象 物 ： 器官 组织 ( 含肝尖 、 胃窦 等 ) 和 背景 。 因此 我们 可以 通过 二值化 处理 来 作 初步 分割 。 
 　 　 二值化 处理 的 阀值 选择 有 两类 方法 ： 通过 实验 确定 一 固定 阀值 和 自 适应 选择 阀值 。 自 适应 方法 中 最 常用 的 是 双峰 法 ， 它 要求 灰度 直方图 有 较 明显 的 双峰 。 但 B超 图象 质量 较差 ， 无法 得到 有 明显 双峰 的 直方图 。 这里 我们 利用 大 津 阀值 选择 法 实现 阀值 的 自动 选择 。 
 　 　 大 津 阀值 选择 法是 在 判别 与 最小 二 乘法 原理 的 基础 上 推导 出来 的 。 其 基本原理 是 ： 把 直方图 在 某 一 阀值 处 分割 成 两组 ， 当 被 分割 的 两组 间 方差 为 最大 时 ， 取该 灰度 值为 阀值 。 采用 该 方法 对 胃窦 图象 进行 二值化 处理 ， 我们 成功 地 将 原始 图象 分成 了 器官 组织 与 背景 两 部分 。 
 　 　 进行 二值化 处理 后 ， 如果 目标 物 ( 胃窦 ) 已 形成 封闭 区域 ， 便 可 直接 使用 轮廓 跟踪 技术 来 分割 目标 物 ， 获得 初始 轮廓 。 否则 就 需 进行 形态学 或 多 分辨率 分析 。 
 2.3   数学 形态学 处理 与 多 分辨率 分析 
 　 　 对 原始 图象 进行 二值化 处理 后 ， 有 一部分 图象 的 目标 物 并未 封闭 ， 对于 缺口 较 小 的 ， 我们 采用 数学 形态学 ( Mathematical   Morphology ) 处理 ， 这样 可以 使 一些 较 小 的 缺口 弥合 ， 形成 封闭 轮廓 。 对于 缺口 较大 的 情况 ， 则 采用 金字塔 在 较 低 的 分辨率 下 处理 。 
 　 　 数学 形态学 是 一门 建立 在 集论 基础 上 的 学科 ， 是 几何 形态 分析 和 描述 的 有力 工具 。 形态学 处理 定义 了 两个 基本操作 ： 腐蚀 ( erosion ) 与 膨胀 ( dilation ) 。 膨胀 是 一个 扩张 的 过程 ， 这种 变换 使得 目标 肢体 扩张 ， 孔洞 收缩 。 腐蚀 是 一种 收缩 的 过程 ， 该 变换 使得 目标 肢体 收缩 ， 孔洞 扩张 。 通常 腐蚀 与 膨胀 是 结合 起来 使用 的 。 按照 腐蚀 与 膨胀 的 先后顺序 构成 了 开闭 运算 ： 开 运算 是 先 腐蚀 后 膨胀 ， 闭 运算 是 先 膨胀 后 腐蚀 。 开 运算 使 目标 轮廓 光滑 ， 并 可 去掉 毛刺 和 孤立 点 。 闭 运算 则 添平 了 目标 内部 的 小沟 、 孔洞 和 裂缝 。 
 　 　 我们 使用 形态学 变换 的 目的 是 将 胃窦 与 其它 器官 组织 ( 如肝尖 等 ) 分开 ， 使 目标 轮廓 断裂 的 部分 连接起来 ， 因而 采用 了 开 运算 。 先对 二值化 图象 进行 腐蚀 ， 使得 胃窦 轮廓 有 缩小 的 趋势 ， 可以 使 胃窦 轮廓 封闭 ， 然后 进行 膨胀 操作 ， 以 尽量 使 其 恢复 到 原始 的 轮廓 。 
 　 　 金字塔 是 一种 对 输入 信息 逐层 提炼 的 数据结构 ， 通常 逐层 所 提炼 的 信息 为原 图象 的 灰度 ， 金字塔 的 各层 就是 对原 图象 降低 分辨率 而 生成 的 ， 金字塔 的 层数 越高 ， 分辨率 越低 。 金字塔 具有 一种 “ 距离 效应 ” ， 因此 可以 使得 原始 图象 中 目标 区域 不 相连 的 部分 在 金字塔 的 高层 连续 。 
 　 　 我们 将 胃窦 B超 的 二值化 图象 作为 金字塔 的 输入 图象 ， 将 目标 区域 视为 1 ， 背景 区域 视为 0 ， 采用 与 ( AND ) 金字塔 ， 2 × 2 的 窗口 ， 则 第 k 层 象素 与 第 k - 1 层 象素 之间 的 关系 可 表示 为 ： 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 3 ) 
 　 　 使用 该 方法 ， 我们 成功 地使 原始 图象 中 不 封闭 的 目标 区域 在 金字塔 上层 得以 封闭 。 从而 可以 在 金字塔 的 顶层 用 轮廓 跟踪 的 方法 获得 目标 区域 的 轮廓 ， 再 将 金字塔 顶层 的 轮廓 映射 到 金字塔 图象 的 底层 即可 。 
 2.4   B 样条 拟合 
 　 　 由于 原始 图象 本身 的 质量 极差 ， 经过 上述 方法 提取 出 的 初始 轮廓 形状 复杂 。 而 胃窦 本身 的 边缘 是 平滑 的 ， 为了 平滑 初始 轮廓 ， 我们 采用 了 工程 上 常用 的 三次 B 样条 曲线 来 拟合 初始 轮廓 。 
 　 　 以上 我们 分别 述 叙 了 在 初始 轮廓 提取 阶段 所 采取 的 各种 方法 。 在 实际 使用 中 ， 我们 将 其 有机 地 结合 起来 ， 形成 一个 如图 1 所示 的 自动 处理 流程 。 
 3   轮廓 的 优化 
 　 　 在 得到 胃窦 的 初始 轮廓 之后 ， 我们 使用 活动 轮廓 模型 ( Active   Contour   Models ) 对 初始 轮廓 进行 优化 ， 使 其 逼近 真实 轮廓 。 
 　 　 活动 轮廓 模型 又 称为 蛇行 模型 ( Snakes ) 。 在 几何 上 可以 将 其 描述 为 一个 图象 平面 ( x ， y ) 上 的 参数 化 曲线 ： 
 r ( s ) = ( x ( s ) , y ( s ) )   s ∈ [ 0 , 1 ]   　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 4 ) 
 　 　 在 实际 的 实现 过称 中 ， 活动 轮廓 是 由 一组 蛇点 组成 ， 每个 蛇点 用 它 在 图象 中 的 坐标 ( x ， y ) 来 表示 ， 把 这些 蛇点 用 直线 或 曲线 连接起来 即 构成 了 整个 轮廓 。 这样 ， 整个 轮廓 就 可以 只用 这些 蛇点 来 表示 ， 而 活动 轮廓 的 变形 也 就 通过 蛇点 的 运动 来 完成 。 
 
 图 1 　 初始 轮廓 提取 流程图 
 　 　 活动 轮廓 模型 实质 上 是 一个 能量 最小化 模型 ， 其 变形 过程 就是 活动 轮廓 在 外部 能量 ( 模拟 外力 ) 和 内能 ( 内力 ) 的 作用 下向 物体 边缘 靠近 的 过程 ， 外力 推动 活动 轮廓 向着 物体 边缘运动 ， 而 内力 则 保持 活动 轮廓 的 光滑性 和 拓扑 性 ； 到达 平衡位置 时 ( 对应 于 能量 最小 ) 的 活动 轮廓 收敛 到 所要 检测 的 物体 边缘 。 
 　 　 活动 轮廓 模型 的 能量 E ( r ) 由 内部 能量 Eint ( r ) 和 外部 能量 Eext ( r ) 构成 ： 
 E ( r ) = Eint ( r ) + Eext ( r ) 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 5 ) 
 　 　 内部 能量 用于 保持 轮廓 的 平滑 性 ， 而 外部 能量 则 用来 将 轮廓 吸引 到 真实 的 轮廓 边缘 。 
 　 　 内部 能量 又 由 两 部分 构成 ： 
 Eint = α Emembrane + β Ethin _ plate   　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 6 ) 
 　 　 其中 ， α ， β 为 弹性 参数 ，   Emembrane 为 弹性 能量 ， 主要 是 用于 抗 拉伸 ， 将 其 定义 为 ： 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 7 ) 
 　 　 Ethin _ plate 为 弯曲 变形 能量 ， 主要 用于 抵抗 活动 轮廓 的 弯曲 变形 ， 将 其 定义 为 ： 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 8 ) 
 　 　 外部 能量 定义 为 ：   　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 9 ) 
 　 　 Eext   ( ri ) 为蛇点 ri 处 的 外部 能量 。 由于 在 胃窦 B超 图象 分割 中 ， 所 要 利用 的 胃窦 边缘 信息 ， 我们 将 Eext   ( ri ) 定义 为 ： 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 10 ) 
 　 　 即先 对 图象 进行 中 值 滤波 ， 以 滤除 噪音 ， 然后 用 Sobel 算子 来 提取 边缘 信息 。 
 　 　 我们 选取 初始 轮廓 上 均匀分布 的 点 作为 初始 蛇点 的 位置 ， 采用 梯度 下降 法 实现 轮廓 的 变形 。 并 采用 固定 迭代 次数 与 能量 变化 量 相结合 的 方法 作为 迭代 终止 条件 。 即 ， 设定 一个 最大 的 迭代 次数 ， 如果 两次 迭代 的 能量 变化 小于 给定 门限 ， 则 终止 迭代 ， 否则 迭代 到 最大 迭代 次数 终止 。 轮廓 逼近 的 算法 可 描述 如下 。 
 　 　 按 ( 5 ) 式 计算 初始 轮廓 的 内部 能量 
 　 　 按 ( 9 ) 式 计算 初始 轮廓 的 外部 能量 
 While   不 满足 终止 条件   Do 
 　 　 for   每个 蛇点   Do 
 　 　 　 　 利用 梯度 下降 法 计算 蛇点 的 新 位置 
 　 　 按 ( 5 ) 式 计算 轮廓 的 内部 能量 
 　 　 按 ( 9 ) 式 计算 轮廓 的 外部 能量 
 End 
 4   实验 结果 
 　 　 我们 采用 上述 方法 进行 了 胃窦 B超 序列 图象 的 分割 ， 取得 了 满意 的 结果 。 如图 2 中 所示 ， a1 、 b1 分别 为 两个 实验 对象 的 一幅 原始 B超 图象 ， a2 、 b2 是 自动 提取 出 的 初始 轮廓 ， a3 、 b3 分别 为 相应 的 经过 轮廓 逼近 所 获得 的 最终 分割 结果 。 
 5   结论 
 　 　 我们 利用 传统 的 图象 分割 技术 和 近年来 引起 广泛 研究 兴趣 的 活动 轮廓 模型 ， 对 胃窦 B超 图象 的 分割 进行 了 深入 地 研究 。 在 活动 轮廓 模型 的 基础 上 提出 了 一个 完整 的 从 初始 轮廓 提取 到 精确 轮廓 逼近 的 完整 的 分割 方法 ， 它 实现 了 胃窦 轮廓 的 自动 分割 ， 无需 人工干预 。 实验 所用 原始 图象 是 使用 国产 B超 仪 获得 的 胃窦 图象 ， 采用 本文 所叙 自动 分割 方法 ， 其 分辨率 可达 92% 。 在 实际 应用 中 ， 采用 日产 ALOKA - SSD - 630 B型 超声 显像 仪 ， 此时 原始 图象 的 质量 有 明显 的 提高 ， 相应 分割 的 分辨率 也 会 有 明显提高 。 该 方法 虽 是 针对 胃窦 图象 的 分割 提出 的 ， 但 同时 对于 目标 轮廓 光滑 、 边缘 特性 较差 的 类似 的 图象 的 分割 亦 有 一定 的 指导意义 。 
 国家 攀登 计划 项目 ( 98 - 211 ) 资助 
 张艳 （ 长沙 铁道 学院 信息技术 研究 中心   长沙   410075 ） 　 
 费耀平 （ 长沙 铁道 学院 信息技术 研究 中心   长沙   410075 ） 
 伍晓平 （ 长沙 铁道 学院 信息技术 研究 中心   长沙   410075 ） 　 
 廖志宁 （ 长沙 铁道 学院 信息技术 研究 中心   长沙   410075 ） 　 
 常小荣 （ 长沙 铁道 学院 信息技术 研究 中心   长沙   410075 ） 
 参考文献 
 1 ， M .   Kass ,   A .   Witkin ,   and   D .   Terzopoulos .   Snakes :   Active   contour   models .   International   Journal   of   Computer   Vision ,   Volume   1 ,   number   4 ,   1987 ,   321 ~ 331 
 2 ， Barbara   Levienaise - Obadia   and   Andrew   Gee .   Adaptive   Segmentation   of   Ultrasound   Images .   http : / / www . jaist . ac . jp 
 3 ， Kok   Fung   Lai .   Deformable   contour :   Modeling ,   Extraction ,   Detection   and   Classification .   http : / / iris . usc . edu 
 4 ， Tim   McInerney ,   Demetri   Terzopoulos .   Deformable   models   in   medical   image   analysis : a   survey .   Medical   image   Analysis ,   Volume   1 ,   number   2 ,   91 ～ 108 
 5 ， 王省富 主编 .   样条 函数 及其 应用 .   西北工业大学 出版社 ,   1989 
 6 ， 郑 南宁 .   计算机 视觉 与 模式识别 .   国防工业 出版社 ,   1998 
 7 ， 王 积分 ,   张新荣 .   计算机 图象识别 .   中国 铁道 出版社 ,   1998 
 8 ， 夏 利民 ,   谷士文 ,   沈新权 .   基于 模糊 形变 模型 的 3D 表面 自 适应 重建 .   长沙 铁道 学院 学报 ,   1999 年 ,   第 3 期 
 9 ， 夏 利民 ,   谷士文 ,   沈新权 .   基于 活动 轮廓 的 运动 目标 的 动态 分割 .   中国 图象 图形学 报 ,   ( 已 录用 ) 
 10 ， 常小荣 等 .   B超 显像 观察 针刺 足 阳明经 四肢 段 穴位 对 胃窦 面积 的 影响 ,   湖南 中医学院 学报 ,   1997 年 第 3 期 
 收稿 日期 ： 1999 年 9 月 6 日 
