计算机 工程 
 COMPUTER   ENGINEERING 
 1999 年   第 25 卷   第 8 期   Vol.25   No.8   1999 
 
 
 
 面向对象 的 程序设计 模拟 细胞 有丝分裂 
 王 ， 傅廷亮 ， 管 菅 
 摘要 ： 介绍 了 在 微机 上 编程 模拟 细胞 生长 及 周期 分裂 过程 ， 提出 了 一个 面积 对象 的 细胞 类 结构 ， 为 利用 计算机辅助 研究 细胞分裂 作 了 一次 新 的 探讨 。 
 关键词 ： 细胞 有丝分裂 ； 细胞周期 ； 位 图 
 An   Object   Oriented   Simulation   on   Karyokinesis 
 Wang   Chong , Fu   Tingliang , Guan   Jian 
 ( Department   of   Computer , University   of   Science   and   Technology   of   China , Hefei   230027 ) 
 【 Abstract 】 An   OOP   simulation   on   karyokinesisi   and   upgrowth   of   cell   is   provided   in   this   paper . We   put   forward   a   Cell - class   and   a   progress   model   for   centrosome   and   chromosome   in   cell   division . The   Visual   C++   is   used   n   this   object   oriented   simulation   program . 
 【 Key   words 】 Karyokinesis ;   Split   cycle ; Bitmap 
 　 　 本文 建立 了 细胞 主要 结构 形态 及 运动 的 计算机 模型 ， 提   模拟 了 细胞 生长 和 有丝分裂 的 全部 过程 及 细胞 内部 一些 调控 因子 对 细胞 生命周期 的 影响 ， 也 是 计算机 在 细胞 生物学 领域 应用 的 一次 新 的 尝试 和 探讨 。   
 1   基本 设计 思想   
 　 　 本 仿真 系统 采用 基于   Windows   95   操作系统 的   Microsoft   Visual   C++   4.2   作为 开发工具 。   Win32   平台 具有 强大 的 内存 管理 功能 ，   Visual   C++   提供 了 面向对象 的 编程 工具 ， 同时 其 灵活 强大 的 基本 类库 及   Windows   消息 映射 也 为 我们 的 开发 提供 了 极大 的 方便 。   
 　 　 采用 面向对象 的 程序设计 技术 ， 首先 要 为 模拟 的 对象 定义 一个 完整 的 类 ， 类 是 对 一组 性质 相同 的 对象 的 程序 描述 ， 它 由 概括 了 一组 对象 共同 性质 的 数据 和 函数 组成 。 类 结构 具有 良好 的 数据 封装 性及 继承 、 派生 、 多态性 等 特征 ， 不但 可以 清晰 有效 地 封装 内联 数据 和 操作 ， 更 可以 利用 它 继承 和 派 生出 相关 的 类 结构 ， 也 为 程序 维护 和 进一步 扩充 打好 了 基础 。 系统 各 对象 之间 的 关系 如图   1   所示 ， 其中   CCellApp   是 应用 的 全程 对象 ，   CMainFrame   和   CChildFrame   是 系统 应用 主 框架 和子 框架 。   
 
 图 1   类及 对象 关系 
 　 　 本 系统 采用 单 文档 多视 的 结构 ， 视分 两种 ： 细胞分裂 及 显示   ( CCellView )   和 数据 监测 及 统计分析   ( CChartView )   ， 其 共用 的 文档 模板   CCellDoc   完成 对 公用 的 数据 区及 数据 对象 进行 转储 等 操作 。   
 　 　 系统 在 内存 中 申请 分配 点阵 位 图 作为 细胞 生长 分裂 的 环境 ， 我们 采用 的 是   Windows256   色   BITMAP   位 图 ， 因为 通过   Bitmap   位 图 可以 方便快捷 地 进行 图形 显示 及 数据 复制 、 转储 粘贴 等 操作 ， 并且   256   色位 图以 字节 存放 颜色 值 ， 可以 方便 地 编写 存取 函数 。 系统 中 定义 的   CellDib   类 完成 了 对 内存 位 图 对象 的 各种 操作 。   
 　 　 系统 中 细胞 类   ( CellCls )   是 仿真 系统 的 核心 对象 ， 它 定义 了 一个 完整 的 细胞 完成 生长 、 分裂 过程 的 数据 和 操作 函数 ， 其中 包括 嵌套 说明 的 细胞核 、 染色体 及 中心 体 。 我们 将   CellCls   定义 为   CObList   集合 类 的 派生 ， 这种 列表 对象 封装 了 内部 数据结构 ， 支持 指向   CObList   类 派生 出来 的 各种 不同 对象 的 混合 匹配 ， 这样 可以 方便 地 应用   CObList   类 的 对象 指针 列表 等 功能 。   
 2   仿真 系统结构 及 流程   
 　 　 细胞 周而复始 的 生长 分裂 过程 即 细胞周期 ， 其 组成 及 动态 过程 如图   2   所示 ， 各 期 细胞 形态 和 功能 上 的 变化 本文 不再 详述 。   
 
 图 2   细胞周期 动态图 
 2.1   数据结构 及 操作 层次   
 　 　 系统 数据 和 操作 函数 分   3   个 层次 ：   
 　 　 ( 1 )   低层 ： 系统 中 的 资源   ( Cell . rc )   、 内存   Bitmap   类   ( CellDib )   及 文档 模板   ( CCellDoc )   中 的 大部分 函数 都 属于 低层 数据 操作 ， 它们 是 其它 功能性 操作 的 基础 ， 主要 包括 ：   1 ) Windows   DIB   位图 的 内存 分配 、 结构 建立 、 数据 读取 、 屏幕显示 及 调色板 的 颜色 设置 等 ；   2 )   对 内存 的 图形 数据 区 进行 格式化 ： 建立 坐标 、 周期 边界条件 及 点阵 的 邻居 ；   3 )   细胞 对象 链表 及其 它 公用 数据 区 的 定义 、 数据 转储 、 根据 数据 存放 格式 编写 位图 在 内存空间 的 存取 函数 ；   4 )   系统资源 及 常量 定义 。   
 　 　 ( 2 )   中层 ： 介于 低层 和 高层 之间 不 直接 与 模拟 对象 有关 的 用于 完成 某些 辅助 操作 功能 的 函数 。 主要 包括 ：   1 )   消息传递 、 计时器 触发 ；   2 )   公用 堆栈 、 数据 区 操作 ；   3 )   基于 内存   Bitmap   位图 的 基本 图形 函数 。   
 　 　 ( 3 )   高层 包括 ：   1 )   封装 定义 的 细胞 类及 进行 细胞周期 各 阶段 功能 的 数据 和 模拟 函数 ；   2 )   细胞分裂 仿真 过程 中 的 辅助 操作 函数 如 逻辑 坐标 与 为了 坐标 映射 变换 ；   3 )   数据分析   (   监测 及 统计图表   )   模块 。   
 　 　 每个 细胞 以   Bitmap   位图 的 颜色 值 表示 的 本 细胞 的 区分 标志 ， 此外 位图 的 颜色 还 用来 区别 细胞 内 其它 各种 物质 ， 将 细胞周期 离散 化为 一系列 的 时间段 ， 细胞周期 的 不同 阶段 都 根据 时间 的 长短 对应 某些 时间段 ， 在 每个 细胞 对象 中有 一个 基因 控制 因子   ( CDC )   来 确定 此 细胞 当前 所处 的 时间段 位置 。 细胞 类 对象 的 主要 内容 还 包括 ：   
 　 　 1 )   细胞 形态 及 环境模拟   
 　 　 细胞 面积 、 细胞 边界 周长 及其 计算 函数 ； 细胞 大致 区域 、 细胞核 大致 区域 及 核仁 位置 ； 相邻 细胞 的 数量 及 邻居 细胞 的 标志 链表 、 与 其它 细胞 相邻 的 边界 长度 ； 细胞 类 的 构造函数 、 析构 函数 ； 细胞 对象 初始化 、 有丝分裂 各 期 仿真 操作 函数 ； 分裂 间期 细胞 生长 、 有丝分裂 末期 的 细胞 分离 等 辅助 操作 函数 。   
 　 　 2 )   细胞 仿真 控制变量 及其 变化 控制 函数   
 　 　 细胞 生长 促进 因子   细胞分裂 抑制 因子 ；   DNA   的 含量   DNA   聚合酶 含量   ； 有丝分裂 因子   ( Mitotic   Factors )   有丝分裂 抑制 物   ( Inhibitor   Mitotic   Factors )   。   
 　 　 3 )   嵌套 中心 体 对象   
 　 　 中心粒 初始 位置 、 中心粒 移动 曲线 参数   (   采用 二次曲线 仿真   )   ； 中心粒 的 目标 位置 、 随机 确定 细胞分裂 极及 分裂 方向 的 函数 ； 中心 体 运动 函数 及 运动 中 的 中心粒 当前 位置 、 运动 的 上 一点 位置 ； 纺锤 丝 定义 参数   (   采用 抛物线 仿真   )   及 纺锤 丝 的 形成函数 等 。   
 　 　 4 )   嵌套 染色体 对象   
 　 　 染色体 着丝点 或 染色质 定位点 及其 随机 定位 函数 ； 染色体 的 运动 轨迹 、 染色体 移动 时 的 形态 控制参数 ； 模拟 各 期 染色质 、 染色体 的 形态 及 运动 函数 等 。   
 2.2   系统 流程 及 仿真 程序   
 　 　 仿真 开始 先 建立 系统模拟 的 环境 ， 在 内存 中 产生 一个   256   色   Bitmap   位图 并 对 其 进行 必要 的 格式化 ， 然后 确定 初始 种子 细胞 的 位置 、 标志 区域 及 细胞 内部 环境 。 本 仿真 系统 用 一条 对象 链表 连接 不同 的 细胞 对象 ， 系统 计时器 定时 激活 随机 选择 细胞 链中 的 一个 细胞 对象 ， 根据 细胞 的 基因 控制 因子 每次 执行 当前 时间段 的 仿真 操作 ， 完成 本 段 仿真 后 保存 细胞 当前 状态 ， 等待 下 一次 随机 激活 继续 下 一 时间段 的 仿真 。 经过 若干次 时间段 完成 一个 细胞周期 操作 后 分裂 成 两个 细胞 ， 将 其 加入 细胞 对象 链表 中 ， 从而 周而复始 地 开始 新 细胞 的 生长 分裂 过程 。   
 　 　 在 有丝分裂 的   G1   期 开始 细胞 生长 过程 ， 当 某个 方向 遇到 别的 细胞 时此 方向 停止 生长 ，   G1   期 存在 一个 细胞 增殖 控制点   R   ， 细胞 增殖 的 限制 与 许多 因素 有关 ， 比如 当 细胞 密度 较大 时 分裂 抑制 因子 随着 接触抑制 的 增加 而 增大 ， 阻止   G1   期向   S   期 过渡 从而 抑制 细胞分裂 ， 这时 细胞 离开 增殖 周期 处于 休止 期 ， 在 一定 条件刺激 下 或 细胞 密度 等 条件 符合 时 又 可   返回 增殖 周期 。 对 每个 细胞周期 经历 模拟 的 详细 流程 见图   3   。   
 
 图 3   细胞分裂 周期 
 3   结论 及 探讨   
 　 　 通过 对 细胞分裂 的 仿真 ， 可以 借助 计算机 研究 探讨 细胞 的 某些 变化 对 生长 分裂 的 影响 ， 如 在 系统 中令 某些 细胞 在   G1   期 丧失 接触抑制 ， 细胞 增殖 到 一定 密度 后 仍 无法 停止 分裂 ， 这是 产生 肿瘤 甚至 细胞 癌变 的 重要 原因 之一 。 计算机 提供 了 一个 极好 的 研究 此类 问题 的 工具 。   
 作者 单位 ： 中国科技大学 计算机系 ， 合肥   230027 
 参考文献   
 1   鲁润龙 ， 顾 月华   .   细胞 生物学   .   合肥 ： 中国 科学技术 大学 出版   社 ，   1991   
