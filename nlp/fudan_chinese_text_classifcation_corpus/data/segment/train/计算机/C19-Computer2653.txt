软件 学报 
 JOURNAL   OF   SOFTWARE 
 1999 年 　 第 10 卷 　 第 9 期 　 Vol.10 　 No.9 　 1999 
 
 
 
 相似 顺序 图 用于 视频 镜头 的 组织 * 
 白雪 生 　 徐光 祐 　 史 元春 
 摘要 　 在 对 视频 进行 基于 内容 检索 时 , 对 由 分割 得到 的 镜头 进行 有效 的 组织 是 提高 检索 效率 的 一种 重要 手段 . 在 绝大多数 情况 下 , 传统 的 自动 组织 方法 不能 给出 令人满意 的 结果 , 而 需要 通过 人机交互 来 进行 组织 . 文章 提出 了 相似 顺序 图 的 概念 , 即 对 镜头 代表 帧 重新 排序 ， 使得 感官 上 相近 的 代表 帧 在 新 序列 中 位置 相近 , 以便 于 用户 的 交互 组织 . 文章 还 提出 了 相似 距离 的 概念 以 作为 对 序列 中 相近 代表 帧 相似性 的 度量 , 并 采用 了 改进 的 遗传算法 来 进行 求解 . 文章 阐述 了 相似 顺序 图 、 相似 距离 和 求解 采用 的 改进 遗传算法 的 基本 思想 , 并 给出 了 实验 结果 和 分析 . 
 关键词 　 视频 检索 , 相似 距离 , 相似 顺序 , 相似 顺序 图 , 遗传算法 . 
 中图法 分类号 　 TP311 
 Using   Similarity   Sequence   for   Shot   Organization   in   Video   Retrieval 
 BAI   Xue - sheng , XU   Guang - you , SHI   Yuan - chun 
 ( Department   of   Computer   Science   and   Technology   Tsinghua   University   Beijing   100084 ) 
 ( National   Key   Laboratory   of   Intelligent   Technology   and   Systems   Tsinghua   University   Beijing   100084 ) 
 Abstract 　 Shot   organization   is   very   important   in   content - based   video   retrieval ,   but   in   most   cases   automatic   shot   organization   methods   fail   to   give   satisfactory   results ,   thus   human - involved   interactive   organization   is   required .   In   this   paper ,   a   new   shot   organization   method   called   similarity   sequence   is   proposed ,   which   reorders   the   r - frames   of   shot   and   makes   similar   r - frame   appear   near   each   other   in   the   generated   sequence ,   thus   provides   an   effective   interactive   organizing   interface .   To   compare   the   performance   of   different   sequences ,   a   distance   measure   called   similarity   distance   is   proposed ,   upon   which   a   gene   algorithm   calculating   similarity   sequence   is   developed   and   applied   to   r - frame   sequence   reordering   in   shot   organization .   Basic   ideas   and   algorithm   modules   are   given   in   detail ,   also   with   experimental   results   and   analysis . 
 Key   words 　 Video   retrieval ,   similarity   distance ,   similarity   order ,   similarity   sequence ,   gene   algorithm . 
 　 　 随着 数字化 时代 的 到来 和 多媒体技术 的 发展 , 视频 信息 也 摆脱 了 以 模拟信号 形式 在 磁性 介质 ( 录像带 ) 上 进行 存储 的 时代 , 而 代之以 易于 计算机 处理 的 数字化 存储 方式 . 在 信息 社会 里 , 每天 都 有 大量 的 视频信号 产生 , 这些 信号 的 存储 和 检索 也 就 成为 人们 需要 解决 的 问题 . 
 　 　 视频信号 的 检索 要求 有别于 传统 数据库 , 在 多数 情况 下 ， 人们 希望 能够 根据 信号 内容 来 进行 检索 . 在 检索 视频信号 时 , 由于 视频 的 流 特性 , 需要 将 其 分割 为 具有 独立 语义 信息 的 片段 — — 镜头 来 作为 检索 的 基本 单元 ［ 1 ］ . 但 当 信号 中 含有 大量 镜头 时 , 直接 对 镜头 浏览 检索 较为 困难 , 往往 需要 对 镜头 进行 组织 并 建立 更 高层 的 索引 结构 . 目前 常用 的 方法 是 , 对 这些 镜头 先 在 内容 描述 空间 聚类 ， 再 在 时间轴 上 聚类 ［ 2 ］ . 但 基于 目前 图像 理解 技术 的 水平 , 自动 组织 的 结果 往往 难以 令人满意 . 相比之下 , 若能 提供 一种 简便 的 方法 使 用户 可 通过 交互 更快 地 完成 镜头 组织 , 也 就 具有 更为重要 的 意义 了 . 
 　 　 在 本文 中 , 我们 提出 了 一种 新 的 镜头 组织 方法 — — 相似 顺序 图法 . 与 基于 聚类 的 自动 组织 方法 不同 , 该 方法 根据 镜头 的 内容 描述 进行 组织 后 并 不 给出 聚类 结果 , 而是 给出 一个 按 镜头 内容 描述 距离 远近 构成 相邻 关系 的 一维 序列 — — 相似 顺序 图 . 在 序列 中 , 内容 描述 相近 的 镜头 位置 相近 , 内容 描述 相差 较大 的 镜头 位置 相距 较远 . 这样 , 用户 通过 简单 的 交互 就 可以 完成 正确 的 镜头 组织 . 
 　 　 为了 对 不同 序列 中 相近 代表 帧 的 相似性 进行 比较 , 我们 引入 了 相似 距离 的 概念 , 从而 将 相似 顺序 图 的 求解 转化 为 一个 优化 问题 . 在 此基础 上 , 我们 采用 遗传算法 来 求解 相似 顺序 图 . 在 遗传算法 的 求解 中 , 我们 除了 采用 传统 的 重组 和 变异 算子 之外 , 还 提出 根据 知识 的 染色体 片段 迁移 来 产生 新 个体 的 算法 , 以 加快 算法 的 收敛 . 
 　 　 本文 第 1 节对 视频 镜头 的 组织 问题 作 简要 的 介绍 . 第 2 节 详细 说明 相似 顺序 图 的 含义 、 相似 距离 的 定义 以及 求解 相似 顺序 图 的 遗传算法 的 基本 思想 . 第 3 节 给出 了 相似 顺序 图 的 模拟 仿真 和 对 实际 视频流 镜头 组织 的 实验 结果 . 
 1 　 视频 镜头 的 组织 问题 
 1.1 　 视频流 的 分割 与 镜头 描述 
 　 　 根据 视频信号 的 产生 原理 和 编辑 特性 可知 ， 一般 的 视频信号 本身 是 由 多 段 （ 摄像机 从 RECORD 到 STOP 期间 所 获得 的 ） 连续 视频信号 通过 拼接 编辑 而成 . 在 镜头 转换 处 , 帧 特性 会 发生 改变 . 通过 采用 针对 此 特性 而 设计 的 检测 算法 , 可 将 连续 的 视频流 分割 成 一组 镜头 序列 . 
 　 　 在 完成 分割 后 , 需要 对 每个 镜头 建立 内容 描述 以便 于 检索 . 一种 有效 的 方法 是 ， 用 一幅 或 多幅 图像 — — 代表 帧 来 代表 镜头 , 从而 给 用户 一个 直观 的 、 可视化 的 浏览 检索 界面 . 代表 帧 是 一幅 能 充分反映 镜头 内容 的 图像 , 一般 通过 选择 镜头 视频 序列 中 的 图像 或 对 视频流 进行 拼接 （ mosaic ） 而 得到 ［ 3 ］ . 
 1.2 　 视频 镜头 的 组织 
 　 　 直接 对 镜头 浏览 检索 仅 适用 于 镜头 较少 的 情况 , 对于 较长 或 内容 丰富 的 视频信号 , 分割 视频流 可能 会 产生 大量 的 镜头 . 在 这种 情况 下 , 若 仍 对 镜头 进行 浏览 检索 , 将会 面对 大量 代表 帧 而 变得 困难 , 因此 , 对 镜头 进行 组织 并 建立 高层 索引 结构 就 显得 十分必要 了 . 
 　 　 镜头 组织 的 常用 方法 是 , 对 每个 镜头 根据 建立 的 内容 描述 先 在 内容 描述 空间 进行 聚类 （ 如对 代表 帧 的 差设 阈值 ） , 再 通过 时间轴 上 的 聚类 以 形成 高层 组织 结构 . 内容 描述 一般 是 通过 图像 理解 技术 得到 的 , 但 就 目前 的 技术水平 而言 , 建立 的 镜头 内容 描述 还 不能 贴切 地 反映 其 内容 , 自动 聚类 得到 的 组织 结果 也 往往 与 人 的 要求 相距甚远 . 从 实用性 出发 , 镜头 组织 将 不可避免 地 需要 人工 交互 以 保证 组织 的 正确性 . 这样 , 提供 一种 方法 以便 于 用户 交互 地 完成 镜头 组织 则 具有 十分 重要 的 意义 . 
 　 　 聚类 算法 的 缺点 在于 分类 结果 由 计算机 决定 , 而 分类 准则 仅 是 对 人 的 感知 的 一个 近似 . 针对 这 一点 , 我们 提出 如下 思想 ： 对 镜头 的 内容 描述 （ 代表 帧 ） 重 排序 形成 一个 新 序列 , 使得 感官 意义 上 相近 的 代表 帧 在 序列 中 位置 相距 较近 , 相差 较 多 的 代表 帧 的 位置 相距 较远 . 这样 所 形成 的 新 序列 就 提供 给 用户 一个 可视化 的 、 易 调整 的 组织 界面 , 用户 只 需 简单 的 交互 就 可 完成 镜头 的 组织 工作 . 
 2 　 相似 顺序 图 及其 求解 方法 
 2.1 　 相似 距离 与 相似 顺序 图 
 　 　   从 第 1 节 的 分析 可知 , 问题 实质 上 是 对 镜头 序列 重排 ， 使 内容 描述 相近 的 镜头 在 新 序列 中 位置 相近 . 为 便于 对 序列 中 相近 代表 帧 的 相似性 进行 定量 比较 , 我们 引入 如下 的 相似 距离 概念 . 
 　 　 定义 1 （ 相似 距离 ） .   已知 空间 点集 { Pi , i = 0 , 1 , ... , N } , 根据 给定 距离 定义 , 对 一条 遍历 非 封闭 路径 Pi0 , Pi1 , ... , PiN , 路径 长度 L1 = | Pil - 1Pil | 称为 该 路径 的 一阶 相似 距离 . 显然 , 一阶 相似 距离 仅 考虑 了 序列 中 相邻 点 （ 1 邻域 ） 的 距离 . 进一步 地 , 考虑 了 序列 中 n 邻域 点 距离 的 度量 ， 称为 该 路径 的 n 阶 相似 距离 , 其中 Wm （ m = 1 , 2 , ... , n ） 分别 为 对应 于 序列 中 位置 相差 m 的 点间 距离 的 权重 . 
 　 　 在 引入 相似 距离 定义 后 , 我们 可用 一个 序列 相应 路径 的 n 阶 相似 距离 来 作为 序列 中 相邻 代表 帧 相似 程度 的 度量 . 这样 , 序列 重排 问题 就 可 形式化 地 描述 如下 . 
 　 　 定义 2 （ 最优 相似 顺序 , 最优 相似 顺序 图 ） .   已知 内容 描述 空间 中 的 点集 { Pi , i = 0 , 1 , ... , N } , 根据 给定 相似 距离 定义 , 计算 一条 遍历 非 封闭 路径 Pi0Pi1 ... Pin , 使得 相应 的 n 阶 相似 距离 最短 . 顺序 i0i1 ... in 称为 此点集 在 此 相似 距离 定义 下 的 最优 相似 顺序 , 对应 的 代表 帧 序列图 称为 最优 相似 顺序 图 . 
 　 　 最优 相似 顺序 的 计算 是 一个 比较复杂 的 问题 . 但 由于 镜头 组织 的 目的 是 提供 一个 方便 用户 交互 组织 的 界面 , 因而 并 不 要求 得到 的 必须 是 最优 相似 顺序 , 往往 次优 相似 顺序 （ 次 短 路径 对应 的 顺序 ） 就 已 给出 了 相当 好 的 组织 结果 . 基于 这个 原因 , 我们 将 在 下面 的 讨论 中 用 相似 顺序 和 相似 顺序 图来 笼统 地 称呼 所 得到 的 排列 顺序 和 代表 帧 序列图 . 
 2.2 　 求取 相似 顺序 图 遗传算法 的 基本 思想 
 　 　 通过 上述 分析 , 序列 重排 转化 为 一个 优化 问题 . 我们 采用 遗传算法 来 进行 求解 , 每个 解 直接 用 其 路径 对应 的 序列 来 表示 . 对于 群体 中 新 个体 的 产生 方法 , 我们 除了 采用 传统 的 重组 和 杂交 之外 , 还 提出 了 根据 知识 的 染色体 片段 迁移 的 方法 . 下面 我们 将 对 这 3 种 方法 进行 详细 说明 . 
 　 　 （ 1 ）   重组 
 　 　 本 算法 引入 了 两种 重组 方式 . 
 　 　 ( a )   定位 重组   从 染色体 1 中 随机 选择 一些 片段 （ 点数 和 位置 随机 ） , 复制到 其子 染色体 的 对应 位置 . 从 染色体 2 中 去除 已 选中 的 点 , 将 剩余 点 按 其 在 染色体 2 中 的 顺序 依次 填入 子 染色体 中 . 图 1 给出 了 片段 中 包含 3 点 （ B , E , F ） 的 定位 重组 示意图 . 
 
 图 1 　 定位 重组 示意图 
 　 　 ( b )   定位 连续 重组 　 从 染色体 1 中 随机 选择 一 连续 片段 （ 长度 和 起始 位置 随机 ） , 复制到 其子 染色体 的 对应 位置 . 从 染色体 2 中 去除 已 选中 的 点 , 将 剩余 点 按 其 在 染色体 2 中 的 顺序 依次 填入 子 染色体 中 . 图 2 显示 了 片段 DEFG 的 定位 连续 重组 情形 . 
 
 图 2 　 定位 连续 重组 示意图 
 　 　 （ 2 ）   变异 
 　 　 变异 包括 以下 两种 方式 . 
 　 　 ( a )   基因 片段 镜像 　 从 染色体 中 随机 选择 一 连续 片段 （ 长度 和 起始 位置 随机 ） , 镜像 后 复制到 子 染色体 对应 位置 . 其他 基因 不变 , 复制到 子 染色体 中 . 图 3 显示 了 片段 DEF 的 镜像 变异 . 
 
 图 3 　 基因 片段 镜像 变异 示意图 
 　 　 ( b )   染色体 移位 　 将 整个 染色体 循环 移位 一个 随机 长度 , 从而 得到 子 染色体 . 图 4 给出 了 长度 为 2 的 染色体 的 移位 变异 . 
 
 图 4 　 染色体 移位 变异 示意图 
 　 　 （ 3 ）   根据 知识 的 染色体 片段 迁移 
 　 　 在 重组 和 变异 中 , 新 个体 的 产生 是 随机 的 , 性能 较优 的 片段 也 是 随机 产生 并 在 群体 中 迁移 的 . 为了 加快 算法 的 收敛 速度 , 我们 提出 了 根据 知识 进行 染色体 片段 迁移 的 新 个体 产生 方法 . 其 基本 思想 是 , 随机 选择 点 P 和 长度 n , 将点 P 与 距 其 最近 的 n - 1 个点 按 下面 的 算法 1 形成 一个 连续 片段 . 对 某 一 染色体 , 随机 选择 一个 起始 位置 , 将 此 片段 复制到 其子 染色体 中 , 并 将 父 染色体 中 不 在 此 片段 内 的 点 按 其 原有 顺序 依次 填入 子 染色体 中 . 图 5 显示 了 染色体 片段 迁移 的 情形 , 其中 片段 ADG 为 根据 算法 1 得到 的 性能 较优 （ 即 相互间 距离 较 小 ） 的 迁移 片段 . 
 
 图 5 　 根据 知识 的 染色体 片段 迁移 变异 示意图 
 　 　 给 定点 P 和 长度 n , 连续 片段 的 生成 算法 如下 . 
 　 　 算法 1 （ 求取 含 指定 点 具有 指定 长度 的 迁移 片段 ） . 
 　 　 输入 ： 空间 点集 { Pi , i = 0 , 1 , ... , N } , 指定 点 Pm , 指定 长度 L 
 　 　 输出 ： 含点 Pm 的 长度 为 l 的 连续 片段 
 　 　 算法 ： 
 　 　 （ 1 ）   建立 一个 2 * L - 1 大小 的 缓冲区 , 将点 Pm 填入 L 处 , 并 初始化 spos = L , epos = L + 1 . 
 　 　 （ 2 ）   在 点集 剩余 点中 选择 距 Pm 最近 的 点 , 记为 Q . 分别 计算 点 Q 与 缓冲区 中 spos 和 epos - 1 处点 的 距离 , 并 将 其 记为 dist1 和 dist2 . 
 　 　 （ 3 ）   若 dist1 ＜ dist2 , 将点 Q 填入 spos - 1 处 , 同时 , spos 减 1 . 转 （ 5 ） . 
 　 　 （ 4 ）   将点 Q 填入 epos 处 , 同时 , epos 加 1 . 
 　 　 （ 5 ）   若 epos - spos 小于 指定 长度 l , 转 ( 2 ) . 否则 , 将 从 spos 开始 至 epos 的 片段 返回 . 
 2.3 　 求取 相似 顺序 图 的 遗传算法 
 　 　 根据 上 节 提出 的 新 个体 产生 方式 , 我们 实现 了 求取 相似 顺序 图 的 遗传算法 . 在 算法 中 , 每个 个体 的 评 价值 等于 群体 中 其他 个体 相似 距离 之 和 . 对于 重组 个体 的 选择 , 我们 采用 了 轮盘 选择 策略 ( roulette   wheel   selection   scheme ) . 群体 的 更新 采用 了 稳定 更新 （ steady   delete ） 方式 . 具体 算法 如下 . 
 　 　 算法 2 （ 求取 最小 n 阶 相似 距离 路径 的 遗传算法 ） . 
 　 　 输入 ： 空间 点集 { Pi , i = 0 , 1 , ... , n } , 相似 距离 定义 , 群体 大小 s 及 循环 次数 
 　 　 输出 ： 具有 最小 或次 小 n 阶 相似 距离 的 路径 
 　 　 算法 ： 
 　 　 （ 1 ）   通过 随机 产生 个体 来 初始化 群体 , 并 对 每个 个体 进行 评价 . 
 　 　 （ 2 ）   按 概率 选择 重组 个体 , 根据 随机 长度 和 位置 对 群体 中 其他 个体 进行 定位 重组 . 
 　 　 （ 3 ）   按 概率 选择 重组 个体 , 根据 随机 长度 和 起始 位置 对 群体 中 其他 个体 进行 定位 顺序 重组 . 
 　 　 （ 4 ）   随机 选择 片段 长度 和 起始 位置 , 对 群体 中 所有 个体 进行 基因 片段 镜像 变异 . 
 　 　 （ 5 ）   随机 选择 移位 长度 , 对 群体 中 所有 个体 进行 染色体 移位 变异 . 
 　 　 （ 6 ）   随机 选择 点 和 长度 , 利用 算法 1 生成 迁移 片段 . 据此 片段 和 随机 起始 位置 , 对 群体 中 所有 个体 进行 片段 迁移 . 
 　 　 （ 7 ）   对 生成 的 所有 子 个体 进行 评价 , 并 将 其 加入 群体 中 . 
 　 　 （ 8 ）   根据 相似 距离 大小 对 群体 中 所有 个体 重新 排序 , 去除 重复 个体 , 并 仅 保留 前 s 个 个体 . 
 　 　 （ 9 ）   若 未 达到 循环 次数 , 转 （ 2 ） . 否则 , 将 具有 最小 相似 长度 的 个体 返回 , 即 为 所求 路径 . 
 3 　 算法 实现 与 分析 
 　 　 利用 本文 中 提出 的 相似 顺序 计算方法 , 我们 对 随机 点集 进行 了 仿真 计算 . 图 6 给出 了 对 二维 情况 下 由 3 个 随机 点集 得到 的 最小 相似 距离 路径 . 其中 相似 距离 为 三阶 距离 , 权重 均 为 1 . 点 集中 有 30 个 随机 点 , 染色体 群体 大小 选为 20 , 循环 2   000 次取 具有 最小 相似 距离 的 路径 作为 结果 . 
 
 图 6 　 对 3 个 二维 随机 点集 求取 最小 距离 相似 路径 的 仿真 结果 
 　 　 利用 此 算法 , 我们 对 实际 视频信号 分割 得到 的 镜头 序列 进行 了 组织 . 实验 结果 如图 7 所示 . 
 
 （ a ）   原始 代表 帧 序列 
 
 （ b ）   得到 的 相似 顺序 图 
 图 7 　 视频 镜头 进行 组织 
 　 　 图 7 ( a ) 为 利用 视频 分割 算法 得到 的 镜头 代表 帧 序列 , 各 代表 帧 按 其 出现 的 先后 次序 排列 . 利用 在 本文 中 提出 的 算法 , 我们 对 其 进行 了 重排 . 其中 , 我们 采用 对 直流 DC 图像 计算 相关 差 （ 即 代表 帧 对应点 RGB 差 之 和 ） 作为 代表 帧 间 距离 的 度量 , 相似 距离 仍为 三阶 , 各阶 对应 的 权重 均 为 1.0 ， 群体 大小 仍为 20 , 循环 1   000 次 . 图 7 ( b ) 为 重排 后 得到 的 相似 顺序 图 . 可见 , 在 此 序列 中 ， 感官 上 相似 的 代表 帧 在 序列 中排 到 了 一起 , 从而 为 用户 提供 了 一个 极好 的 交互 组织 界面 . 序列 中 唯一 与 感知 不符 的 排列 是 图 7 ( a ) 中 的 2 、 4 帧 未 在 图 7 ( b ) 中排 在 相邻 位置 , 但 这 在 很大 程度 上 是 由于 采用 了 相关 差 作为 距离 度量 的 缘故 . 由于 这 两 帧 间 运动 的 存在 , 导致 了 帧 间 具有 较大 的 相关 差 , 即 具有 较大 的 距离 . 采用 对 运动 鲁棒 的 度量 （ 如 颜色 直方图 差 ） 可以 避免 这个 问题 . 除此之外 , 相似 顺序 图 都 给出 了 令人满意 的 结果 . 
 * 　 本文 研究 得到 国家 863 高科技 项目 基金 和 国家 “ 211 ” 学科 建设项目 基金 资助 . 
 本文 通讯联系 人 ： 白雪 生 ， 北京   100084 , 清华大学 计算机科学 与 技术 系 信息 教研组 
 作者简介 ： 白雪 生 , 1972 年生 , 博士生 , 主要 研究 领域 为 基于 内容 检索 , 计算机 视觉 . 
 　 　 　 　 　 徐光 祐 , 1940 年生 , 教授 , 博士生 导师 , 主要 研究 领域 为 计算机 视觉 , 多媒体技术 . 
 　 　 　 　 　 史 元春 , 女 , 1967 年生 , 在职 博士生 , 副教授 ， 主要 研究 领域 为 计算机 支持 的 协同工作 , 多媒体技术 . 
 作者 单位 ： 白雪 生 ， 徐光 祐 ， 史 元春 （ 清华大学 计算机科学 与 技术 系 　 北京   100084 ) 
 　 　 　 　 　 白雪 生 ， 徐光 祐 ， 史 元春 ( 清华大学 智能 技术 与 系统 国家 重点 实验室 　 北京   100084 ） 
 参考文献 ： 
 ［ 1 ］ Zhang   H   J ,   Kankanhalli   A ,   Smoliar   S   W .   Automatic   partitioning   of   animate   video .   Technical   Report ,   Institute   of   Systems   Science ,   National   University   of   Singapore ,   1992 
 ［ 2 ］ Yeung   M   M ,   Yeo   B   L ,   Liu   B .   Extracting   story   units   from   long   programs   for   video   browsing   and   navigation .   In : IEEE   Computer   Society   ed .   Proceedings   of   the   International   Conference   on   Multimedia   Computing   and   Systems .   Los   Alamitos : IEEE   Computer   Society   Press ,   1996 .   291 ～ 305 
 ［ 3 ］ Irani   M ,   Anandan   P ,   Hsu   S .   Mosaic   based   representations   of   video   sequences   and   their   applications .   In : IEEE   Computer   Society   ed .   Proceedings   of   the   5th   International   Conference   on   Computer   Vision .   Los   Alamitos : IEEE   Computer   Society   Press ,   1995 .   605 ～ 611 
 收稿 日期 ： 1998 - 06 - 16 ， 修改 日期 ： 1998 - 09 - 17 
