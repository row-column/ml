自动化 学报 
 ACTA   AUTOMATICA   SINICA 
 1998 年   第 24 卷   第 4 期   Vol.24   No.4   1998 
 
 
 
 
 基于 分形 理论 的 一种 图象 分割 方法 1 ) 
 刘文萍 　 吴 立德 
 摘 　 要 　 介绍 了 一种 基于 分形 特征 进行 人造 目标 分割 的 方法 . 它 是 用 分形 模型 描述 自然 场景 ， 基于 人   造 目标 和 自然 背景 在 分形 特征 上 的 差别 ， 并 利用 概率 松弛 的 思想 增强 这种 差异 ， 从而 自 适应 分割 出 目标 图象 . 实验 结果 验证 了 这种 方法 的 有效性 和 可行性 . 
 关键词 　 分形 ， 图象 分割 ， 概率 松弛 . 
 A   METHOD   FOR   IMAGE   SEGMENTATION   BASED   ON   FRACTAL   THEORY 
 
 LIU   WENPING   WU   LIDE 
 ( Dept . of   Computer   Science , Fudan   University , Shanghai   200433 ) 
 Abstract   Based   on   fractal   characters , a   method   for   segmenting   man － made   objects   is   presented , in   which   fractal   model   is   used   to   describe   the   n   atural   background . The   difference   between   man － made   objects   and   the   natural   scene   in   fractal   characters   is   enhanced   by   using   the   probabilistic   relaxation , and   the   difference   is   also   employed   to   segment   man － made   objects   adaptively . Experiments   have   shown   the   effectiveness   and   feasibility   of   the   approach . 
 Key   words   Fractal , image   segmentation , probabilistic   re   laxation . 
 1 　 引言 
 　 　 图象 分割 是 图象处理 中 的 关键技术 ， 目前 的 分割 方法 大都 利用 人造 目标 及 自然 背景 之间 的   灰度 及 几何 特性 上 的 差异 ， 从 自然 景物 中 提取 目标 . 但 由于 实际 成 象 条件 和 环境 等 因素 的 影响 ， 通常 所 摄取 的 图象 中 上述 特性 发生 了 变化 ， 基于 这些 差别 进行 分割 ， 势必会 造成 较 高 的 错 分率 和 漏检 率 . 因此 ， 如何 在 不同 的 自然环境 下 分割 出 人造 目标 ， 仍然 是 人们 不断 探索 的 课题 . 
 　 　 分形 理论 的 创立 为 图象 分割 技术 开辟 了 新 的 途径 ［ 1 ］ ， 但 由于 实际 环境 变化 、 不同 目标 类型 等 因素 的 影响 ， 传统 的 基于 分形 理论 的 图象 分割 方法 ， 用于 实际 图象 所 取得 的 效果 并 不 理想 . 本文 在 基于 分形 特征 用于 人造 目标 图象 分割 的 基础 上 ， 利用 松驰 法 改善 分割 性能 ， 获得 了 较 好 的 实验 结果 . 
 2 　 分形 模型 及 特征参数 提取 
 　 　 本文 选择 一种 公认 较 好 的 描述 自然 背景 的 模型 - - 分数 布朗 随 机场   FBR ［ 1 ］ ， 下面 先对 有关 概念 作一 简述 ［ 1 ， 2 ］ . 
 　 　 定义 1 . 　 设   0 ＜ H ＜ 1 , b0 为 任意 实数 ， 随机 过程 满足 
 
 称 BH ( t ) 为 分数 布朗运动 ( Fractional   Brownian   Motion , 简记 为   FBM ) . H 为 分形 参数 ， H = 0.5 时为 通常 的 布朗运动 ， b0 为 初始值 . FBM 是 一个 非 平稳 的 自 仿射 随机 过程 ， 即 对 c , BH ( ct ) - BH ( 0 ) ≈ cH ｛ BH ( t ) - BH ( 0 ) ｝ . 
 　 　 TH 定律 . 　 设   BH ( t ) 为 分数 布郎 运动 ( 均值 为 0 ) ， 则 其 满足 
 E ｜ ［ BH ( t + T ) - BH ) ］ ｜ = CHTH , 
 E ｜ ［ BH ( t + T ) - BH ( t ) ］ 2 = CHT2H , 
 其中   CH   为 一 常数 . 该 定律 表明   FBM   场 增量 的 一 、 二阶 绝对 矩 具有 各向同性 . 
 　 　 定义 2 . 　 如果 对 任意 t , T , 随机 函数   B ( t ) 满足 
 
 称 B ( t ) 为 分形 布朗 随机 函数 ， F ( y ) 为 零 均值 随机变量 的 分布 函数 . 
 　 　 分形 模型 满足 性质 
 A ( r ) ～ r2 - D , 　 　 ( 1 ) 
 其中 D 为 分维 数 ， A ( r ) 是 尺度 为 r 时分 形 布朗 函数 的 表面积 . 
 　 　 Mandelbrot 基于 性质 ( 1 ) 提出 了 一种 计算 分形 维数 的 思想 ［ 3 ］ ， 将 图象 视为 一座 山丘 ， 高度 为 图象 的 灰度 值 ， 在 距 该 表面 为 ε 的 两侧 形成 了 一厚 为 2 ε 的 毯子 ( 图 1 ) ， 表面积 
 A ( ε ) = F ε 2 - D , 　 　 ( 2 ) 
 则 　 　 　 　 　 　 　 　 　 　 　 logA ( ε ) = c1   log ε + c0 ， 　 　 　 　 　 ( 3 ) 
 其中   c1 = 2 - D   为 图 2 拟合 直线 的 斜率 ， 并 进而 求 出 分形 维数 D . 具体 算法 如下 ： 
 　 　 设 毯子 的 上 、 下 表面 分别 为 u ε , b ε ， 灰度 函数 为 g ( i , j ) , u0 ( i , j ) = b0 ( i , j ) = g ( i ,   j ) ， 对 所有 ε = 1 , 2 , 3 ， … ， 定义 
 
 式 中   d ( i , j , m , n ) 为点 ( i , j ) 和 ( m , n ) 之间 的 距离 . 
 
 
 图 1 　 “ 毯子 ” 示意图 
 
 
 图 2 　 直线 拟合 求 D 
 　 　 毯子 的 体积 , 表面积 A ( ε ) = ( v ε - v ε - 1 ) / 2 ， 求 不同 ε 对应 的 表面积   A ( ε ) ， 再 由 ( 3 ) 式 得 拟合 直线 斜率 2 - D ， 进而 得到 分形 维数 D . 
 3 　 分形 用于 图象 分割 及其 改进 方法 
 　 　 基于 分形 特性 的 图象 分割 方法 的 步骤 如下 ： 
 　 　 1 ) 对 一幅   N × N   的 图象 ， 从 图象 的 起点 开始 ， 沿 水平 和 垂直 方向 滑动 - - M × M 的 窗口 ， 计算 窗口 内 图象 的 分形 维数 作为 窗 中心点 处 图象 的 分形 特征值 . 利用 上述 算法 ， 求取 输入 的 灰度 图象 中 各点 的 局部 分形 维数 ， 得到 分维 数 分布 图象 ， 简称 分形 图象 . 
 　 　 2 ) 由于 自然 背景 符合 DFBR 场 模型 ， 有 2 ＜ D ＜ 3 ； 人造 目标 不 具有 统计 意义 上 的 自 相似性 ， 不 满足 分形 模型 ， 所得 的 分形 维数 可能 小于 2 ， 利用 这种 分形 特征 差异 来 区分 自然 背景 和 人造 目标 ， 是 基于 分形 理论 分割 人造 目标 的 基本 思想 . 
 　 　 实际 的 自然 景物 并 不是 完全 自 相似 的 理想 分 形体 ， 加上 图象 采集 装备 和 采集 过程 中 各 因素   的 影响 ， 仅 根据 分形 维数 区分 目标 和 景物 并 不 可靠 ， 还 需 做 进一步 的 处理 . 将 分维 数   D   图象   归一化 后 影射 成分 形 灰度 图象    ， 然后 将  作为 输入 ， 利用 概率 松弛法 增强 背景 和 目标 的   分形 特征 差异 ， 最后 用 固定 阈值 进行 分割 . 
 　 　 有关 松弛法 的 算法 较 多 ， 本文 采用 梯度 松弛法 ［ 4 ］ ， 它 是 根据 最大 梯度 优化 准则   函数 来 确定 松弛 迭代 过程 的 . 按 梯度 投影 法 导出 概率 迭代 公式 
 P ( n + 1 ) i ( λ k ) = P ( n ) i ( λ k ) + ρ ( n ) i ( 2qi ( λ k ) - 1 ) , k   = 1 , 2 . 
 其中 λ 1 和 λ 2 分别 为 具有 高 和 低 D 值 ( 背景 和 目标区 ) 的 象素 类 的 标记 ； 
 　 　 　 　 ｛ ［ pi ( λ 1 ) , pi ( λ 2 ) ］ T , i = 0 , 1 , … ， 255 ｝ 是 与 灰度 有关 的 概率 向量 集 ； 
 　 　 　 　 ｛ ［ qi ( λ 1 ) , qi ( λ 2 ) ］ T , i = 0 , 1 , … ， 255 ｝ 是 相容 向量 集 . 实际上 ， qi ( λ k ) 是 象素 xi 邻域 中 各 象素 概率 的 均值 ， 即 
 
 　 　 参数 a1 ， a2 及 概率 初值 可 控制 松弛 过程 . 实验 中 发现 ， 松弛法 仅 需 几次 迭代 ， 就 可用 一 固定 概率 阈值 来 分离 所 对应 的 人造 目标 和 背景 区域 . 
 4 　 实验 结果 及 分析 
 　 　 我们 对 38 幅 实际 图象 进行 了 仿真 实验 . 在 具体 实现 中 注意 到 以下 三点 ： 
 　 　 1 ) 滑窗 大小 的 选取 . 如果 窗过 大 ， 则 影响 运算 速度 和 直线 拟合 的 精度 ； 过 小 ， 则 不能 准确 地 反映 图象 的 统计 特性 ， 实验 中窗 大小 为 9 × 9 ； 
 　 　 2 ) 尺寸 ε 的 取值 范围 . 理论 上 分形 具有 尺度 不变性 ， 在 所有 尺度 上均 满足 自 相似性 ， 但 实际 的 自然 场景 仅 在 一小 尺度 范围 上 呈现 分形 特征 ， 实验 中 取值   1 ≤ ε ≤ 9 ； 
 　 　 3 ) 概率 松弛 过程 中 概率 初值 的 选择 . 实验 按下式 赋 初值 ， 
 
 　 　 其中 i , I 分别 表示 图象 的 灰度 及 灰度 均值 ； INI 是 一 灰度 函数 ， 当 i ＞ I 时 ， INI = 1 ; 当 i ＜ I 时 ， 0.7 ＜ INI ＜ 1 . 
 　 　 我们 对 38 幅 真实 图象 作 了 大量 实验 ， 均 取得 了 较 好 的 分割 结果 ， 部分 实验 结果 如图 3 和 图 4   所示 ( 各图 中 上 为 原始 图象 ， 下 为 分割 结果 ) . 实验 参数 为 ： 原始 图象 灰度级 ［ 0 ， 255 ］ ； 图象 大小   100 × 100 ； 滑窗 尺寸   9 × 9 ； 松弛 次数 3 ； 概率 阈值   p = 0.5 ； PC机 型   486DX   / 33 ； 运行 时间 约 16s . 
 
 
 图 3 　 对空 目标 的 分割 ( 背景 为 云层 ) 
 　 　 分割 结果 图为 多值 图 ， 背景 的 灰度 置 为 零 ， 分割 出 的 区域 灰度 值同 原始 图 . 实验 结果表明 该   方法 可 对 自然环境 中 的 人造 目标 进行 较 好 的 分割 . 其中 ， 图 3 ( a ) ， ( b ) 是 灰度 极性相反 的 两幅 飞行器 图象 ； 图 4 ( a ) , ( b ) 为 极性相反 且 大小 不同 的 舰船 图象 ； 图 3 ( c ) 是 处于 强 噪声 背景 中 的 飞机 ； 图 4 ( c ) 是 夜间 拍摄 的 多艘 船 图象 . 本文 方法 针对实际 采集 到 的 图象 ， 自动 进行 全 视场 搜索 ， 单帧 即可 准确 分割 出 处于 自然 背景 中 的 人造 目标 ， 且 不受 人造 目标 的 运动 姿态 、 速度 、 灰度 极性 变化 等 因素 的 影响 ， 对 海洋 、 空中 等 不同 自然 背景 中 的 不同 目标 均 可 得到 较 好 的 结果 ， 还 可 用于 多 目标 分割 ， 是 一种 性能 较为 优良 的 图象 分割 方法 . 
 
 
 图 4 　 对 舰船 的 分割 ( 背景 为 海面 和 天空 ) 
 5 　 结论 
 　 　 本文 提出 的 分割 方法 是 以 DFBR 场 作为 描述 自然 背景 的 分形 模型 ， 结合 松弛法 增强 分形 特征 以 提高 分割 精度 和 自适应性 ， 利用 增强 后 的 分形 特征 分割 人造 目标 ， 实验 结果 证实 了 它 的 有效性 和 可行性 . 
 　 　 1 ) 　 国家 “ 八 六三 － 三一七 ” 资助 项目 . 
 作者 单位 ： 复旦大学 计算机系 　 上海 　 200433 
 参考文献 
 1 　 Pentland   A   P . Fractal － based   description   of   natural   scenes . I   EEE   Trans . PAMI , 1984 , PAMI － 6 ( 6 ) : 661 - 674   
 2 　 Fortin   C   et   al . Fractal   dimension   in   the   analysis   of   medical   ima   ges . IEEE   Engineering   in   Medicine   and   Biology.1992 , 6 : 173 -   181 
 3 　 Chaudhuri   B   B , Sarkar   N .   An   efficient   approach   to   estimate   fractal   dimension   of   textural   images .   Pattern   Recognition ,   1992 ,   25 ( 9 ) : 1035 - 1041 
 4 　 Bhanu   B , Faugeras   O   D . Segmentation   of   images   having   unimodal   distributions . IEEE   Trans . PAMI , 1982 , PAMI － 4 ( 4 ) : 408 - 419 
 收稿 日期 　 1996 - 09 - 17 
