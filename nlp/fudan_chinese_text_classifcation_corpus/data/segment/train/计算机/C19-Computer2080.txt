计算机 工程 
 Computer   Engineering 
 1999 年 　 第 25 卷 　 第 9 期 　 Vol.25   No.9     1999 
 
 
 
 大中型 工业 企业 DCS 和 MIS 集成 的 实现 与 应用 
 严 　 华 　 李建国 　 李中志 　 王 劲松 
 　 　 摘 　 要 ： 得出 了 在 大中型 工业 企业 中将 DCS 与 MIS 系统集成 的 基本思路 ， 讨论 了 与 DCS 和 MIS 密切相关 的 生产 住处 管理系统 的 实现 方法 ， 并 给出 具体 的 应用 实例 ． 
 　 　 关键词 ： 分布式 计算机 控制系统 ； 管理信息系统 ； 集成 
 Application   and   Realization   of   Intergating   DCS   and   MIS   in   Large   and   Medium   Scale   Industry   Enterprises 
 Yan   Hua   Li   Jianguo   Li   Zhongzhi   Wang   Jingsong 
 ( Electronical   Information   College   of   Scichuan   University ,   Chengdu   610064 ) 
 　 　 Abstract 　 The   thought   of   integrating   DCS   and   MIS   in   Large   and   medium   scale   industry   enterprises   is   introduced   in   this   paper .   The   method   of   realizing   production   information   management   system   ( PIMS )   which   is   relative   to   DCS   and   MIS   closely   is   provided .   Apractical   example   is   also   offered   in   this   paper . 
 　 　 Key   words 　 DCS ;   MIS ;   Integration 
 　 　 许多 大中型 企业 在 建立 或 规划 MIS 时 往往 会 忽略 DCS ( 分布式 计算机 控制系统 ) 的 各类 信息 ， 使 DCS 与 MIS 脱节 成为 一个 信息 " 孤岛 " 。 这 必然 会 导致 ： ( 1 ) 企业 决策 时 ， 缺乏 准确 、 及时 的 原始数据 和 情况 分析 ； ( 2 ) 企业 管理 中 的 信息冗余 、 准确性 差 、 不 畅通 ； ( 3 ) 企业 计划 能力差 ， 导致 生产 不 均衡 ， 影响 产品质量 和 能源 的 合理 利用 。 因此 ， 企业 已 不能 再 满足 DCS 的 孤立 应用 ， 应 将 DCS 与 MIS 紧密 地 结合 起来 ， 达到 信息 集成 与 决策 ， 以便 解决 企业 中 的 许多 复杂 问题 。 为此 ， 设计 了 一种 将 DCS 与 MIS 集成 的 计算机 生产 信息管理系统 ， 并 从 1997 年 12 月 在 辽宁抚顺 洗涤剂 化工厂 应用 、 实施 。 
 1 　 系统 主要 功能 
 　 　 企业 计算机 生产 信息管理系统 利用 Client / Server 结构 ， 通过 计算机网络 环境 及 相应 的 软件系统 ， 使 企业 内部 的 微机 工作站 都 能 及时 准确 地 显示 DCS 实时 数据 ， 并 能够 根据 实时 数据 动态显示 工艺流程 图 等 画面 ； 同时 形成 实时 数据库 ， 并 按 指定 条件 选择 实时 数据 存入 历史 数据库 ， 实现 企业 生产 控制 、 监测 、 管理 一体化 。 它 具有 的 功能 主要 有 ： ( 1 ) 生产 系统 的 数据 采集 ； ( 2 ) 实时 数据 和 状态 显示 ； ( 3 ) 报警 产生 及 处理 ； ( 4 ) 过程 数据 运算 ； ( 5 ) 各类 画面 及 图形 显示 ； ( 6 ) 生成 并打印 各类 报表 ； ( 7 ) 存储 数据 及 查询 、 生产 调度 ； ( 8 ) 提供 标准 软件 接口 与 企业 MIS 系统 进行 连接 ， 提供 DCS 数据 ， 以便 MIS 系统 能 进一步 实现 质量 管理 、 计划 调度 、 班组 考核 、 质量 分析 、 成本核算 、 能耗 统计 和 质量 评定 。 
 2   计算机 生产 信息管理系统 的 实现 
 2.1   系统 特点 
 　 　 生产 信息管理系统 的 设计 、 开发 涉及 的 因素 很多 ， 各种因素 之间 的 关系 很 复杂 ， 难度 高 、 工作量 大 ， 主要 表现 在 ： . 系统 服务器 及 有关 子系统 需要 连续 运行 ； . 系统 实时性 要求 高 ， 从而 对 通信 速度 及 系统 处理速度 的 要求 也 很 高 ； . 系统 收集 信息 要 全面 ， 使 系统 数据量 和 数据 流量 均 相当 大 ， 系统 负荷 重 ； . 系统软件 需 跨越 多个 平台 进行 设计 ； . 系统 要求 的 管理 功能 多 而且 复杂 ， 需 设计 大量 图表 ； . 系统 要求 的 可靠性 高 ， 相应 地 对 硬 、 软件 的 选型 、 设计 的 质量 要求 也 很 高 ； . 系统 在 安装 、 调试 、 运行 时 不能 影响 企业 生产 系统 的 正常 工作 。 
 　 　 这 就 要求 计算机 生产 信息管理系统 应 具有 如下 特点 ： 
 　 　 ( 1 ) 技术 先进性 ； ( 2 ) 良好 的 开放性 和 互操作性 ； ( 3 ) 灵活 的 可扩充性 ； ( 4 ) 高度 的 可靠性 和 安全性 。 
 2.2   系统结构 
 　 　 系统 采用 分层 结构 ， 即 通信 层 、 数据仓库 层 和 监控 管理层 的 3 级 结构 。 监控 管理层 与 数据仓库 层 、 MIS 系统 与 数据仓库 层 、 数据仓库 层 与 通信 层均 为 Client 与 Server 的 关系 ， 采用 Client / Server 结构 。 如图 1 所示 。 
 
 图 1 　 系统结构 示意图 
 　 　 ( 1 ) 通信 层 ： 运用 通信软件 ， 通过 标准 通信接口 和 研制 的 设备 ， 获取 DCS 所 采集 的 生产 现场 信息 ， 它 包括 ： 各种 流量 、 压力 、 液位 、 温度 等 模拟量 当前 数值 ； 各种 开关 量 当前 状态值 ； 各 控制 回路 的 回路 信息 ； DCS 的 组态 信息 ； 各种 报警 信息 ； 各 I / O 点 当前 数据 ； 每个 I / O 点 的 名称 、 上 下限 、 状态 等 信息 。 
 　 　 ( 2 ) 数据仓库 层 ： 根据 生产 具体情况 建立 实时 数据库 , 分配 存储空间 ， 并 做 相应 的 设置 。 通信 层 从 DCS 获取 的 生产 信息 ， 进行 计算 和 处理 以后 ， 按 数据库 的 要求 存储 在 实时 数据库 中 。 建立 历史 数据库 ， 根据 生产 和 用户 的 要求 ， 有 选择地 把 实时 数据库 中 的 数据 存入 历史 数据库 中 ， 以供 生产 信息 查询 和 生产 状况 分析 。 同时 ， 数据仓库 层 还 对 实时 数据库 和 历史 数据库 定期 地 进行 处理 和 维护 ， 如 删除 无用信息 ， 定期 备份 等 。 另外 ， 提供 标准 数据库 接口 ( 如 ODBC ) 及 通信协议 与 MIS 系统 交换 信息 。 
 　 　 ( 3 ) 监控 管理层 ： 负责 对 整个 系统 进行 监控 与 管理 ， 层中 的 每 一个 子系统 即 为 生产 信息管理系统 的 一个 客户 。 这些 子系统 直接 供 厂长 、 总工程师 等 人员 以及 总 调度室 等 部门 使用 。 监控 管理层 要 完成 的 任务 是 ： 合理 分配 存储空间 、 外设 等 资源 ， 对 每个 客户 做 正确 的 设置 ； 绘制 工艺流程 、 趋势 、 状态 、 报警 等 各类 画面 ； 建立 与 数据仓库 层 的 双向 联系 ， 可 相互交换 信息 ； 根据 客户 需要 进行 相应 组态 ， 设置 各种 组态 信息 ； 对 生产 信息 作 相应 的 分析 与 处理 ， 如 运算 、 统计 、 报警 处理 等 ； 生成 各种 客户 所 需要 的 报表 并 可 打印 ； 根据 用户 级别 的 高低 ， 设置 相应 的 权限 ； 根据 需要 ， 建立 本 机 数据库 ， 并 进行 科学 的 管理 和 处理 ， 如 生成 时报 、 班报 、 日报 、 周报 、 月 报 和 年报 等 运行 报表 ； 对 生产 情况 进行 考核 。 
 2.3   网络拓扑 结构 
 　 　 ( 1 ) 生产区 的 网络拓扑 结构 采用 总线 型 ， 如果 生产 信息 传送 速率 要求 很 高 ， 可 采用 环型 拓扑 结构 ， 因为 环型 拓扑 结构 具有 时延 和 确定 上限 的 优点 ， 能够 保证 实时性 。 
 　 　 ( 2 ) 对于 小型 系统 ， DCS 接口 单元 数目 不 多 、 比较 集中 且 数据通信 量 不是 很大 ， 通信 层 和 数据仓库 层 可 由 一台 计算机 来 实现 。 
 
 
 图 2 　 网络拓扑 结构 示意图 
 2.4   技术 要点 
 　 　 ( 1 ) 与 DCS 接口 单元 通信   集成 DCS 与 MIS 的 前提 是 能够 与 DCS 建立 良好 的 通信 环境 。 通常 DCS 均会 提供 标准接口 来 完成 DCS 与 其它 系统 之间 的 通信 。 最 常用 的 是 RS232C ， 如 Bailey 的 Network - 90 ， Yokogawa 的 μ XL ， HoneyWell 的 6200 系列 ， ABB 的 ASEA   Masterpiece 等 。 有些 DCS 提供 了 专门 的 插卡 来 完成 通信 ， 现在 一些 开放 性能 较 好 的 DCS 也 可以 通过 Ethernet 接口 来 与 其它 计算机系统 通信 。 因此 ， 在 设计 通信 层时 ， 须 认真 阅读 DCS 产品 说明书 ， 以便 编制 通信 程序 。 当然 ， 部分 DCS 厂商 也 会 提供 通信接口 软件包 。 
 　 　 ( 2 ) 数据 存储 　 根据 数据 集成 的 要求 ， 需将 从 DCS 采集 到 的 大量 实时 数据 实时 地 、 有 选择地 存 到 数据仓库 中 ， 以备 生产 信息管理系统 信息 的 存储 、 查询 和 MIS 系统 能 对 这些 数据 作 进一步 的 加工 处理 ， 使 其 发挥 更大 的 作用 。 数据仓库 需要 在 数据库 中 插入 时间 标志 ， 以 表明 历史数据 的 先后顺序 。 数据仓库 需要 巨大 的 存储空间 ， 因此 可以 放在 全厂 MIS 系统 的 总 服务器 上 。 
 　 　 为 减少 历史数据 所 耗费 的 存储空间 ， 系统 可 采用 例外 报告 传送 方式 来 形成 数据仓库 。 每 一个 过程 变量 要 传送 到 数据仓库 都 必须 受到 一些 限制 ， 无论 时间 或 信号 值 的 大小 都 是 这样 。 当 过程 变量 有 " 明显 " 改变 时 ， 就 产生 一个 新 的 例外 报告 。 在 例外 报告 传送 方式 中 规定 最小 时间 和 最大 时间 。 最小 时间 是 用来 限制 快速 变化 信号 的 传送 速率 ， 以 防止 耗费 大量 的 存储空间 。 最大 时间 是 用来 使 缓慢 变化 信号 能 按 指定 时间 向 数据仓库 传送数据 。 
 　 　 ( 3 ) 组态 工具软件 　 系统 应 根据 可靠性 高 的 原则 ， 选择 国内外 成熟 、 可靠 的 通用 组态 软件包 ， 以 实现 实时 数据 的 监督 和 管理 。 当然 ， 也 可以 自行 开发 组态 软件 。 组态 软件 通常 应 具有 如下 功能 ： 各类 应用 工具 ， 如 画面 、 警报 、 动态 趋势 、 变量 标识 、 动态 图形 、 实时 数据 、 软 功能键 、 控制器 面板 、 密码保护 、 在线 组态 开发 等 ； 对 实时 数据 及 历史数据 进行 数据 趋势 显示 、 分析 和 打印 ； 提供 各种 函数 及 逻辑 计算 功能 ， 使 用户 方便 地 对 实时 数据库 的 数据 进行 操作 ， 并 支持 非 编程 实现 各种 计算 功能 ； 对 各类 应用 工具 ( 例如 对 报警 、 实时 趋势 、 变量 标志 及 画面 上 的 动态 图形 和 功能键 ) 进行 在线 和 离线 组态 、 定义 ； 具有 绘制 流程 画面 的 制图 软件包 ； 具有 密码 编辑 软件包 ； 支持 与 其它 软件包 相连 的 动态 数据交换 接口 ， 如 DDE 等 。 
 　 　 ( 4 ) 数据库 接口 　 可 采用 DDE 、 ODBC 等 标准接口 来 实现 生产 信息系统 与 其它 MIS 系统 之间 的 数据交换 。 
 3 　 应用 实例 
 　 　 抚顺 石化 公司 洗涤剂 化工厂 ( 以下 简称 洗化厂 ) 是 亚洲 最大 的 洗涤剂 原料 生产 基地 ， 90 年代 初 从 美国 贝利 公司 引入 Network - 90   DCS 设备 用于 烷基苯 和 脂肪醇 的 生产 监测 和 控制 。 1997 年 5 月 委托 我 单位 开发 管理信息系统 。 计算机 生产 信息系统 为 该 系统 内 的 一个 特殊 的 子系统 。 该 系统 已 于 当年 12 月 安装 并 投入使用 ， 现 正常 运行 至今 。 系统 具有 技术 先进 、 开放性 良好 、 扩充 灵活 、 可靠 、 安全 、 界面 友好 、 操作 与 维护 简单 等 优点 ， 从而 受到 厂方 各级 用户 的 一致 好评 ， 并 为 洗化厂 生产 系统 的 正常 运行 提供 了 良好 的 监测 与 管理 环境 。 
 3.1   洗化厂 DCS 系统 
 　 　 洗化厂 DCS 系统 为 美国 贝利 公司 ( Bailey ) 的 Network - 90 系统 ， 它 由 3 个 过程 控制 单元 PCU ， 6 个 管理 控制系统 MCS ， 1 个 过程 计算机 接口 单元 CIU 和 1 个 上位 机 接口 单元 共 11 个 节点 组成 。 Network - 90 系统 的 通信 环路 为厂 环 ， 它 把 环路 上 的 节点 联结 起来 。 整个 生产 系统 的 控制 回路 近 400 个 ， I / O 点数 有 4003 点   ( AI ： 1363 ， AO ： 672 ， DI ： 1152 ， DO ： 816 ) 。 
 3.2   计算机 生产 信息管理系统 XH _ PIMS 
 　 　 ( 1 ) 检测 点数   厂方 指定 的 系统 参数 点 ( 包括 模拟量 与 开关 量 ) 总共 为 1748 点 。 
 　 　 ( 2 ) 各类 画面 幅数   流程 画面 123 幅 ； 趋势 画面 378 幅 ； 总貌 画面 9 幅 ； 累积 量 画面 55 幅 ； 报警 画面 87 幅 ； 报表 画面 114 幅 ； 系统 介绍 画面 17 幅 ； 其它 画面 31 幅 ； 总计 ： 814 幅 
 　 　 ( 3 ) 报表 数量   实时 报表 114 张 ； 历史 报表 114 张 ； 报表 查询 任意 记录 参数 。 
 　 　 ( 4 ) 通信 速率 与 数据 平均 刷新 频率   网络通信 速率 10Mbps ； 数据 平均 刷新 频率 10 秒 。 
 　 　 ( 5 ) 数据 存储 、 管理 性能   将 采集 的 数据 全部 按 要求 准确无误 地 存入 实时 数据库 ； 按照 一定 的 选择 条件 从 实时 数据库 中 选取 数据 存入 历史 数据库 ， 存储 的 时间 长短 由 用户 定义 ( 1 小时 到 数年 ) ； 将 历史数据 进行 备份 等 处理 。 
 　 　 ( 6 ) 画面 性能   颜色 256 色 或 更 高 ； 画面 大小 640   x   480 ， 可 支持 更 高分辨率 ； 画面 显示 速度 < 4 秒 。 
 　 　 ( 7 ) 开发 平台 性能   人机界面 友好 ， 操作 方便 ， 全中文 显示 ； 开放性 良好 ， 厂方 技术人员 培训 后能 进行 修改 和 二次开发 。 
 　 　 ( 8 ) 系统维护   利用 MIS 系统 的 网络 功能 ， 通过 通信 设施 ， 以 远程 终端 的 方式 进入 抚顺 石化 公司 洗涤剂 化工厂 计算机 生产 信息管理系统 ， 对系统 进行 在线 维护 。 
 4 　 结束语 
 　 　 生产 与 管理 是 企业 的 中心 主题 。 对于 已经 引入 DCS 设备 的 企业 来说 ， 将 DCS 和 MIS 集成 不失为 一种 投资 小 、 建设 周期短 、 见效快 的 新思路 ， 是 企业 实现 CIMS 的 一条 捷径 。 
 作者简介 ： 严 　 华 ( 1971 ～ ) ， 男 ， 讲师 ， 主要 从事 计算机 与 自动化 方面 的 研究 与 工程 应用 
 作者 单位 ： 四川大学 电子信息 学院 ， 成都 　 610064 
 参考文献 
 1   王常力 ， 罗安 .   集散 型 控制系统 选型 与 应用 . 北京 ： 清华大学 出版   社 ， 1996 
 2   王常力 ， 廖道 文 .   集散 型 控制系统 的 设计 与 应用 . 北京 ： 清华大学   出版社 ， 1993 
 收稿 日期 ： 1999 - 03 - 19 
