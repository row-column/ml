自动化 学报 
 ACTA   AUTOMATICA   SINICA 
 1998 年   第 24 卷   第 1 期     Vol.24     No.1   1998 
 
 
 
 多层 前向 网络 的 随机 学习 新 算法 
 及其 工业 应用 
 戴连奎 　 马 龙华 　 李晓东 
 关键词 　 多层 前向 网络 ， 学习 算法 ， 催化裂化 装置 .   
 A   NOVEL   RANDOM   LEARNING   ALGORITHM   FOR   MULTILAYER 
 NEURAL   NETWORKS   AND   ITS   APPLICATION 
 DAI   LIANKUI 　 　 MA   LONGHUA 　 　 LI   XIAODONG 
 ( Institute   of   Industrial   Process   Control , 　 Zhejiang   University , 　 Hangzhou   310027 ) 
 Key   words 　 Multilayer   networks , learning   algorithm , fluidized   catalytic   cracking   units . 
 1 　 引言 
 　 　 许多 复杂 的 工业 过程 建模 问题 ， 如 系统 辨识 、 参数估计 与 函数 逼近 等 ， 都 可 转化 为 下面 的 非线性 最优 拟合 问题 . 
 　 　 给定 样本 集合 ｛ x ( k ) , y ( k ) k = 1 , … ， M ｝ ， 求 最优 拟合 函数 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 1 ) 
 使 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 2 ) 
 极小 化 ， 其中 x ( k ) = ( x1 ( k ) , … ， xn ( k ) ) T 为 样本 输入 向量 ； M 为 样本数 ； y ( k ) ∈ R1 为 样本 实际 输出 ； f ( 。 ) 为 最优 拟合 函数 ； ( k ) 为 对应 的 输出 估计值 . 
 　 　 神经元网络 作为 一种 新型 的 非线性 系统 描述 方法 ， 它 通过 对 简单 非线性 函数 的 复合 以 实现 复杂 的 函数 ， 具有 模型 结构 简单 、 自 学习 功能 强 等 特点 ， 目前 已 广泛应用 于 各种 工业 过程 . 本文 针对 多层 前向 网络 反向 传播 学习 算法 存在 的 不足 ， 提出 了 一种 新 的 多层 前向 网络 随机 学习 算法 ， 并 将 其 应用 于 某 催化裂化 装置 粗 汽油 干点 的 实时 估计 与 控制 . 工业 应用 结果表明 ， 该 随机 学习 算法 具有 较 快 的 学习 速度 和 较 高 的 拟合 精度 ， 能够 避免 学习 过程 陷入 局部 极小 点 ， 可 广泛 用于 工业 过程 的 建模 与 控制 . 
 2 　 多层 前向 网络 的 随机 学习 算法 
 　 　 反向 传播 学习 算法 ［ 1 ］ 解决 了 多层 前向 网络 的 学习 问题 ， 使前 向 网络 成为 目前 应用 最 广泛 的 神经网络 之一 ， 但 它 存在 以下 主要 问题 ： 
 　 　 1 ) 学习 算法 的 收敛 速度 过 慢 ； 
 　 　 2 ) 由于 网络 的 权 系数 较 多 ， 采用 普通 的 梯度 下降 优化 算法 ， 极易 陷入 局部 极小 点 ， 最终 使 估计 误差 无法 进一步 减少 . 
 　 　 为此 ， 文 ［ 2 ］ 提出 了 利用 动态 规划 思想 训练 前向 网络 的 方法 ； Witts 等 人 基于 随机 优化 思想 提出 了 前 向 网络 的 随机 学习 算法 ［ 3 ］ . 本文 结合 网络 的 结构 特点 ， 提出 了 相应 的 随机 学习 算法 . 
 　 　 多层 前向 网络 的 存在 定理 ［ 4 ］ 证明 了 一个 仅 含有 隐层 非线性 连续 变换 函数 的 多 输入 单 输出 三层 网络 可以 用来 逼近 有界闭 区域 上 的 任一 连续函数 f ( x ) , 因此 以上 最优 拟合 问题 等价 于 以下 非线性 优化 问题 . 
 　 　 　 　 　 　 　 ( 3 ) 
 其中 　 V = ( v0 , v1 , … ， vm ) T 为 输出 层权 系数 阵 ； 
 　 　 　 W = ｛ wij ｜ i = 1 , … , m ; 　 j = 0 , 1 , … , n ｝ 为 隐层权 系数 阵 ； 
 　 　 　 m   为 隐 节点 数 ；   n 为 输入 节点 数 ； ( k ) 为 该 网络 的 输出 估计值 ； 
 　 　 　 hi ( k ) , zi ( k ) 分别 为 第 i 个 隐 节点 的 输入 与 输出 ， i = 1 , … ， m ; 
 　 　 　 g ( x ) 为 Sigmoid 函数 　 
 针对 此类 三层 网络 的 具体 特点 ： 若 ｛ wij ｝ 一定 ， 则 vi ( i = 0 , 1 , … , m ) 的 估计 问题 属 典型 的 线性 最小 二乘 问题 ， 可 采用 递推 线性 最小 二乘 算法 予以 求解 ； 而 隐层权 系数 可 采用 随机 寻优 方法 获得 ， 由此 提出 了 以下 随机 学习 算法 . 
 　 　 多层 前向 网络 的 随机 学习 算法 ： 
 　 　 第一步 . 样本 归一化 
 　 　 　 　 　 　 　 ( 4 ) 
 其中   xi , max , xi , min 为 ｛ xi ( k ) ｜ k = 1 , … , M ｝ 的 最大 最小值 ， i = 1 , … ， n ; ymax , ymin 为 ｛ y ( k ) ｜ k = 1 , … ， M ｝ 的 最大 最小值 . 
 　 　 第二步 . 设置 允许 误差 ε ， 最大 迭代 次数 qmax 与 隐 节点 数 m , 令 迭代 次数 q = 0 ; 初始化 均方 误差   Eopt 与 隐层权 系数 ｛ wij ｝ 及其 最优 值 ｛ woptij ｝ ， 
 wij = ξ t , woptij = wij , 　 i = 1 , … , m , j = 0 , 1 , … , n , 
 其中 ξ t 为 ( - 1 ， 1 ) 之间 的 均匀分布 随机数 . 
 　 　 第三步 . 针对 每组 样本 ， 计算 网络 的 隐 单元 输出 
 
 　 　 第四步 . 基于 ｛ z1 ( k ) , … ， zm ( k ) ; 　 y ( k ) ｜ k = 1 , … ， M ｝ 用 递推 最小 二乘 算法 估计 权 系数 阵 ｛ vi ｜ i = 0 , 1 , … , m ｝ . 
 　 　 第五步 . 计算 整体 均方 误差 
 
 　 　 第六步 . 若 E ＜ Eopt , 则 令置 q = 0 . 若 E ＜ ε ， 则 迭代 结束 ； 否则 ， 令 并 转 第三步 . 其中 为 近似   N ( 0 ， σ 2 ) 的 高斯分布 随机数 ， σ 为 平均 方差 . 
 　 　 第七步 . 若 E ≥ Eopt , 则 令 若 q ≥ qmax , 则 迭代 过程 结束 ； 否则 ， 令 Δ wij 并 转 第三步 . 其中 Δ wij 为 近似 N ( 0 ， σ 2 ) 的 高斯分布 随机数 . 
 3 　 工业 应用 — — 催化裂化 装置 粗 汽油 干点 的 实时 估计 与 控制 ［ 5 ］ 
 　 　 基于 某 工业 催化裂化 装置 的 现场 采集 数据 ， 采用 前面 提出 的 神经元网络 随机 学习 算法 ， 建立 了 粗 汽油 干点 的 估计 模型 ， 实现 了 该 质量指标 的 预测 控制 . 长期 工业 现场 运行 数据 表明 ， 估计 模型 具有 较 高 的 精度 ， 而且 可 适应 处理量 的 变化 与 原料 性质 的 波动 . 所 开发 的 闭环 预测 控制系统 具有 良好 的 调节 性能 与 较 强 的 鲁棒性 ， 该 系统 的 引入 提高 了 分馏塔 的 平稳性 ， 而 使 粗 汽油 干点 的 波动 范围 显著 减少 ， 并 使 分馏塔 的 操作 处于 较佳 的 水准 上 ， 产生 了 明显 的 经济效益 . 
 　 　 工业 应用 结果表明 ， 由于 该 随机 学习 算法 克服 了 反向 传播 学习 算法 收敛 速度慢 ， 极易 陷入 局部 极小 点 的 不足 ， 使得 多层 前向 网络 用于 实时 估计 与 控制 成为 可能 . 同时 ， 由于 该 网络 的 输出 层为 线性 函数 ， 有时 为了 提高 实时性 ， 可 采用 递推 最小 二乘 算法 仅 更新 输出 层权 系数 ， 这 就 给 前 向 网络 的 工业 应用 带来 了 便利 . 
 作者 单位 ： 浙江大学 工业 控制技术 研究所 　 杭州 　 310027 
 参考文献 
 ［ 1 ］ 　 Rimelhart   D   E , McClelland   J   L . Parellel   distributed   processing . MIT   Press , 1986 . 
 ［ 2 ］ 　 Saratchandram   P . Dynamic   programming   approach   to   optimal   weight   selection   in   multilayer   neural   networks . IEEE   Trans . Neural   Network , 1991 , 2 : 465 - 467 . 
 ［ 3 ］ 　 Witts   M   J   et   al . Artificial   neural   networks   in   process   engineering . IEEE   Processings - D , 1991 , 138 : 256 - 266 . 
 ［ 4 ］ 　 Robert   H   N . Theory   of   the   backpropagation   neural   network . In : Proc . of   IJCNN , 1989 , 1 , 593 - 598 . 
 ［ 5 ］ 　 李晓东 ， 戴连奎 ， 孙优贤 . 粗 汽油 干点 的 实时 估计 与 控制 . 化工 自动化 及 仪表 ， 1996 ， 23 增刊 ： 23 - 27 . 
 收稿 日期 　 1995 - 03 - 31 
