自动化 学报 
 ACTA   AUTOMATICA   SINICA 
 1999 年   第 25 卷   第 1 期   vol.25   No.1   1999 
 
 
 
 工业 过程 广义 稳态 优化 控制 研究 1 ) 
 罗 旭光 　 万 百五 
 摘 　 要 　 基于 广义 稳态 和 稳态 集合 的 中心 名义 值 概念 ， 给出 了 工业 过程 广义 稳态 优化 控制 问题 的 数学 描述 ， 并 就 该 问题 的 存在 性 给予 了 充分性 证明 ； 此外 ， 对 处理 工业 过程 广义 稳态 优化 控制 问题 的 一种 等效 方法 展开 了 深入 讨论 ， 给出 了 具体 算法 步骤 ， 并 对 一个 化工 过程 的 广义 稳态 优化 算例 进行 了 仿真 计算 ； 结果表明 ， 文中 关于 广义 稳态 优化 控制 问题 的 定义 是 正确 的 ， 算法 是 有效 的 . 
 
 关键词 　 混沌 ， 唯一 遍历 ， 广义 稳态 ， 工业 过程 ， 稳态 优化 . 
 
 STUDY   ON   OPTIMIZING   CONTROL   OF   GENERALIZED   STEADY 
 STATE   FOR   INDUSTRIAL   PROCESSES 
 LUO   Xuguang 　 WAN   Baiwu 
 ( Systems   Engineering   Institute , Xi ′ an   Jiaotong   University , Xi ′ an 　 710049 ) 
 Abstract 　 According   to   the   definitions   of   the   generalized   steady   state   and   the   nominal   central   value   of   steady - state   sets , the   problem   of   generalized   steady - state   optimizing   control   for   industrial   processes   is   stringently   described . The   existence   of   the   problem   is   also   proved   for   the   sufficiency . On   the   other   hand , an   equivlent   method   for   optimizing   control   of   the   generalized   steady   state   is   deeply   discussed , and   an   algorithm   for   solving   the   problam   is   given . Based   on   the   algorithm , a   generalized   steady   state   of   a   chemical   engineering   process   is   calculated . The   conclusion   shows   that   the   definition   about   optimizing   control   for   generalized   steady   state   is   suitable , and   that   the   algorithm   is   effective . 
 Key   words 　 Chaos ,   unique   ergodicity ,   generalized   steady   state ,   industrial   processes ,   steady - state   optimizing . 
 
 
 1 　 引言 
 　 　 混沌 现象 普遍存在 于 各类 非线性 系统 中 ， 使得 工业 过程 的 稳态 形式 已 不能 仅仅 用 常值 稳态 ( 平衡态 ) 简单 概括 ， 它 还 应当 包括 周期 稳态 、 拟 周期 稳态 和 混沌 稳态 ； 对于 如此 复杂 的 稳态 行为 ， 工业 过程 的 稳态 优化 控制 问题 研究 将 面临 着 新 的 挑战 . 文 ［ 1 ］ 根据 非线性 动力学 系统 理论 ， 针对 工业 过程 中 存在 的 上述 多种 稳态 形式 ， 给出 了 一种 统一 的 数学 描述 — — 即 广义 稳态 ； 证明 了 非线性 系统 在 满足 较 宽 的 条件 下 ， 其 广义 稳态 存在 . 另一方面 ， 文 ［ 2 ］ 对 广义 稳态 集合 的 度量 问题 作 了 有益 的 研究 ， 利用 遍历 理论 的 Borel 不变 测度 积分 定义 了 广义 稳态 集合 的 中心 名义 值 ， 证明 了 非线性 系统 在 广义 稳态 存在 的 前提 下 ， 其 稳态 集合 的 中心 名义 值 唯一 存在 ； 从而 ， 为 本文 研究 工业 过程 的 广义 稳态 优化 控制 问题 做好 了 必要 的 理论 准备 . 
 
 2 　 工业 过程 描述 
 　 　 通常 ， 实际 工业 过程 可以 表示 为 图 1 的 形式 ， 图中 c ( k ) ∈ C 是 过程 控制器 的 设定 点 ， u ( k ) ∈ U 是 过程 A 的 控制变量 ， x ( k ) ∈ X 是 过程 A 的 输出 变量 ， y ( k ) ∈ Y 是 过程 B 的 输出 变量 ， 它 可以 是 生产 过程 输出 产品 的 产量 ， 也 可以 是 产品 的 某个 质量指标 ； v ( k ) ∈ VRl , w ( k ) ∈ WRm 分别 是 过程 A 和 B 的 物料 输入 ( 扰动 ) ； 而 过程 A 和 B 合成 一个 完整 的 工业生产 过程 ［ 3 ］ . 一般来说 ， u ( k ) , x ( k ) 和 y ( k ) 均 是 可量 测 的 ， 而 v ( k ) 和 w ( k ) 在 一个 较长 的 时间段 内 是 不变 的 ， 因此 ， 在 数学模型 中 可以 不 考虑 它们 的 影响 . 图 1 所示 系统 可 由 如下 差分 方程 描述 ： 
 ( 1a ) 
 由于 控制器 设定 点 变量 c ( k ) 在 每 一次 调整 间隔 内 保持 不变 ， 故可 将 ( 1a ) 式 中 差分 方程 u ( k + 1 ) = f3 ( * ) 中 的 c ( k ) , c ( k - 1 ) ， … ， c ( k - i + 1 ) 用 c 表示 ， 即 在 每 一次 调整 间隔 内 ， c 只是 差分 方程 中 的 一个 参数 ， 而 非 动态 变量 . 进一步 将 ( 1a ) 式 差分 方程 化成 一阶 差分 状态方程 的 矩阵 形式 ［ 1 ］ 
 z ( k + 1 ) = F ( z ( k ) ) , 　 k ∈ Z , ( 1b ) 
 式 中 　 z ( k + 1 ) ∈ Z = Y × X × URs + r + j . 由文 ［ 1 ］ 可知 ， 描述 图 1 所示 非线性 系统 的 ( 1a ) 和 ( 1b ) 式 具有 等价 性 ， 故 在 研究 非线性 系统 的 稳态 行为 时 ， 可 不必 加以 区别 . 
 
 图 １   工业 过程 结构 框图 
 　 　 假设 1.1 )   在 非线性 系统 ( 1 ) 中 ， f1 ( . ) , f2 ( . ) , f3 ( . ) ∈ Cr ( r 次连续 可微 函数 空间 ， r ≥ 1 ) ; 2 )   非线性 系统 ( 1 ) 的 运动 状态 是 闭环 输入输出 稳定 的 ， 即 对 c ∈ CRi ， ｜ c ｜ ≤ Mc , 　 0 ＜ Mc ＜ ∞ , 　 k ∈ Z + , 则 有 ｜ y ( k ) ｜ ≤ My , 　 ｜ x ( k ) ｜ ≤ Mx 和 ｜ u ( k ) ｜ ≤ Mu ， 其中 0 ＜ My ＜ ∞ , 　 0 ＜ Mx ＜ ∞ , 　 0 ＜ Mu ＜ ∞ , 　 k ∈ z +. 
 
 3 　 工业 过程 广义 稳态 问题 描述 及其 存在 性 
 　 　 设 控制器 设定 点 容许 集合 C = ｛ c ∈ Ri : D ( c ) ≤ 0 ｝ 为 紧集 ， D ( * ) 是 连续 可微 的 凸 向量 函数 ， 若非 线性系统 ( 1 ) 的 平衡态 是 一 常值 稳态 时 ， 系统 的 稳态 优化 则 是 一个 带 等式 约束 和 不等式 约束 的 非线性 规划 问题 ， 即 
 ( 2 ) 
 上式 中 　 Q ( . ， . ， . ) ∈ Cr ( r ≥ 1 ) ， 并且 是 凸 标量 函数 ， 它 表示 工业 过程 的 技术 经济指标 ； G1 ( . ) 和 G2 ( . ) 是 过程 相对 于 设定 点 c 的 稳态 非线性 映射 关系 . 
 　 　 由 ( 2 ) 式 描述 的 DOP 问题 就是 过去 用于 处理 确定性 系统 的 通常 方法 ， 即将 其 简单 地 视为 常值 稳态 的 优化 问题 . 根据 文 ［ 1 ］ 的 研究 知道 ， 由于 系统 内在 的 非线性 机制 ， 使得 在 控制器 设定 点 改变 或者 过程 参数 发生变化 时 ， 非线性 系统 ( 1 ) 除 存在 常值 稳态 之外 ， 还 可能 出现 周期 稳态 、 拟 周期 稳态 和 混沌 稳态 ； 此时 ， 设定 点 c ∈ C 与 系统 稳态 ｛ ｝ ｜ c ［ 1 ］ 之间 的 关系 是 一种 点到 集合 的 映射 ， 如果 仍用 ( 2 ) 式 定义 的 DOP 问题 去 描述 具有 广义 稳态 的 非线性 系统 ( 1 ) 的 稳态 优化 控制 问题 已经 毫无意义 . 
 　 　 当 非线性 系统 ( 1 ) 满足 假设 1 的 条件 ， 并且 其 离散 动力学 系统 是 同 胚 映射 时 ， 由文 ［ 2 ］ 可知 ， 它 的 离散 动力学 系统 在 达到 稳态 时 是 唯一 遍历 的 . 这 表明 ， 过程 A 和 过程 B 的 输出 x ( k ) ， y ( k ) 虽然 可能 不 收敛 于 一个 常值 ， 但是 时间 序列 y ( k ) 和 x ( k ) 在 平均 意义 下 将 一致 收敛 于 各自 相空间 上 按 正规 Borel 测度 μ 的 积分 μ ( f2 ) ， 而 μ ( f1 ) 和 μ ( f2 ) 是 唯一 不变 的 ［ 2 ］ . 因此 ， 基于 这一 结论 ， 具有 广义 稳态 的 非线性 系统 ( 1 ) 的 稳态 优化 控制 问题 定义 为 
 ( 3 ) 
 式 中 
 
 　 　 关于 由 ( 3 ) 式 定义 的 非线性 系统 ( 1 ) 的 稳态 优化 问题 ( GOP ) 的 存在 性 ， 有 下面 的 定理 . 
 　 　 定理 1 . 若非 线性系统 ( 1 ) 满足 假设 1 的 条件 ， 并且 其 离散 动力学 系统 的 映射   φ : Z → Z 是 同 胚 的 ， 则 由 ( 3 ) 式 描述 的 GOP 问题 存在 ， 并且 指标 函数 Q ( c , f1 ( φ kz ) ,   f2 ( φ kz ) ) 的 时间 均值 一致 收敛 . 
 　 　 定理 1 的 证明 略 ， 详见 文 ［ 4 ］ . 定理 1 保证 了 非线性 系统 ( 1 ) 在 满足 假设 1 的 条件 下 ， 并且 其 离散 动力学 系统 是 同 胚 映射 时 ， 其 GOP 问题 存在 ； 从而 ， 可 构造 求解 GOP 问题 的 有效 算法 . 
 
 4 　 广义 稳态 优化 算法 
 　 　 事实上 ， 由 ( 3 ) 式 描述 的 稳态 优化 是 指标 函数 未知 的 确定性 稳态 优化 问题 ， 为了 借鉴 ISOPE 方法 ［ 5 ］ 的 主要 思想 ， 以及 Lin 用于 处理 随机 稳态 的 技术 ［ 3 ］ ， 建立 一种 处理 GOP 问题 的 有效 算法 ， 必须 保证 q ( c ) 关于 c 是 可微 的 . 为此 ， 有 以下 一些 引理 . 
 　 　 引理 1 . 若非 线性系统 ( 1 ) 满足 假设 1 的 条件 ， 并且 Q ( . ， . ， . ) ∈ Cr ( r ≥ 1 ) ， 则 Q / c 是 关于 c , y ( k ) , x ( k ) , y ( k ) / c 和 x ( k ) / c 的 连续函数 . 
 　 　 引理 1 的 证明 略 ， 详见 文 ［ 4 ］ . 简记 yc ( k ) y ( k ) / c ,   xc ( k ) x ( k ) / c , Q / cqc ( c , x ( k ) , y ( k ) , xc ( k ) , yc ( k ) ) = qc ( c , f1 , f2 , f ′ 1c , f ′ 2c ) ;   式 中 yc ( k ) = f ′ 1c ( . ) 和 xc ( k ) = f ′ 2c ( . ) 仍然 是 差分 方程 . 
 　 　 假设 2 .   时间 序列 yc ( k ) , xc ( k ) 和 uc ( K ) 是 有界 的 ， 即 对 k ∈ Z + ,   ｜ yc ( k ) ｜ ＜ + ∞ , ｜ xc ( k ) ｜ ＜ + ∞ 和 ｜ uc ( k ) ｜ ＜ + ∞ . 
 　 　 引理 2 .   若非 线性系统 ( 1 ) 满足 假设 1 ( 1 ) 的 条件 ， 则 差分 方程 yc ( k + 1 ) = f ′ 1c ( . ) ,   xc ( k + 1 ) = f ′ 2c ( . ) 和 uc ( k + 1 ) = f ′ 3c ( . ) ; 以及 y ( k + 1 ) = f1 ( . ) ,   x ( k + 1 ) = f2 ( . ) 和 u ( k + 1 ) = f3 ( . ) 在 ZcR2 × ( s + r + j ) 上 确定 了 一个 离散 动力学 系统 ｛ Ψ k : k ∈ Z ｝ ,   Ψ : Zc → Zc , 其中 Zc ［ Y , X , U , Yc , Xc , Uc ］ T . 
 　 　 引理 2 的 证明 略 ， 详见 文 ［ 4 ］ . 
 　 　 引理 3 .   若 对 t ∈ TRn , 有限 ， 以及 对 存在 ， 并且 有 可积 函数 g ( x ) , 使得 
 　 　 引理 3 的 证明 略 ， 详见 文 ［ 6 ］ . 
 　 　 引理 2 .   若非 线性系统 ( 1 ) 满足 假设 1 和 假设 2 的 条件 ， 并且 φ : Z → Z 是 同 胚 映射 ， 如果 Q ( . ， . ， . ) ∈ Cr ( r ≥ 1 ) ， 则 GOP 问题 的 指标 函数 q ( c ) 关于 设定 点 c 是 连续 可微 的 . 
 　 　 定理 2 的 证明 略 ， 详见 文 ［ 4 ］ . 正是 因为 非线性 系统 ( 1 ) 在 满足 假设 1 和 假设 2 时 ， 定理 1 和 定理 2 保证 了 GOP 问题 的 存在 性 以及 q ( c ) 关于 c 的 连续 可微性 ， 从而 为 建立 GOP 问题 的 优化 算法 奠定 了 基础 ， 下面 给出 广义 稳态 优化 控制算法 . 
 　 　 对于 任意 给定 的 控制器 设定 点 初值 v0 ∈ C ,   当 迭代 计算 第 L 步时 ： 
 　 　 1 ) 计算 　 λ L = λ ( vL ) = Q ′ ( vL , G1 ( vL ) , G2 ( vL ) ) - q ′ ( vL ) ′ ( vL ) - q ′ ( vL ) . 
 式 中 　 G1 : CRi → YRs ,   G2 : CRi → XRr ， 它们 分别 是 过程 B 和 A 相对 于 设定 点 v ∈ C 的 稳态 映射 ，   Q ′ ( . ) 和 q ′ ( . ) 是 对 v 的 偏 导数 . 
 　 　 2 )   对于 给定 的 λ L ， 求解 下 式 基于 模型 的 优化 问题 
 
 得到 相对 于 vL 的 最优 解 c ( vL ) ， 简记 为 cL . 
 　 　 3 )   采用 松弛法 修正 控制器 设定 点 vL ， 即 
 vL + 1 = vL + ε . ( cL - vL ) ， 　 ε 为 步长 . 
 　 　 4 )   若 vL + 1 = vL ， 迭代 结束 ； 否则 ， 转 1 ) . 
 　 　 上述 算法 实质 上 是 一种 建立 在 稳态 模型 基础 上 、 并 利用 过程 的 动态 信息 进行 修正 的 优化 方法 ， 最终 结果 使得 实际 过程 达到 稳态 最优 . 可以 证明 ， MOP 问题 的 最优 解亦是 GOP 问题 的 最优 解 . 由于 篇幅 限制 ， 关于 优化 算法 的 最优性 和 收敛性 证明 将 另文 介绍 . 
 
 5 　 仿真 算例 
 　 　 考虑 由 一个 液位 控制系统 ( LLCS ) 和 一个 连续 搅拌 反应器 系统 ( CSTR ) 组成 的 化工 过程 ， 如图 2 所示 ， 文 ［ 7 ］ 就 LLCS 系统 和 CSTR 系统 在 离散 控制 下 可以 产生 混沌 现象 进行 了 验证 . 　 
 
 
 图 2 　 化工 过程 示意图 
 　 　 在 LLCS 系统 中 ， Qi , Qm 分别 为 物料 输入 和 输出 流量 ， d 为 扰动 输入 ， ρ 为 流体密度 ， A 为 容器 横截面 积 ， h 为 液面 高度 ； 该 系统 通过 一个 比例 控制器 P 对 输入 流量 Qi 进行 调节 以 控制 容器 中 的 液面 高度 h . 在 CSTR 系统 中 ， Qm , Qo 分别 为 输入 和 输出 流量 ， cin 和 c 分别 为 输入 和 输出 浓度 ， 且 输入 流 的 浓度 cin 恒定 ， V 为 反应物 体积 . 由 物料 平衡 关系 ， 可 得 描述 图 2 所示 化工 过程 的 数学模型 
 ( 4 ) 
 上式 中 　 y 表示 由 化工 过程 生成 的 反应物 相对 浓度 c / cin ， x 是 化工 过程 的 受控 中间 变量 ， 亦 即 液面 相对高度 h / h0 ， u 是 调节 液面 高度 的 控制变量 ； 通过 控制 液面 高度 间接 控制 最终 反应物 的 浓度 ； Δ θ 1 , Δ θ 2 分别 为 LLCS 和 CSTR 系统 的 采样 周期 ， v 为 阀门 系数 ， g 为 控制器 增益 . 若令 ( 4 ) 式 中 各 参数 为 = 0.16667 ,   v = 2.68556 ， h0 = 1 , g = 20.0 , λ = 5.0 , Δ θ 1 = Δ θ 2 = 0.15 ， 并且 - 1.0 ＜ u ( k ) ＜ 4.0 ,   1.0 ≤ xc ≤ 5.0 ； 经 整理 ， 得 
 ( 5 ) 
 　 　 显然 ， 由 ( 5 ) 式 描述 的 化工 过程 是 一个 非线性 控制系统 ， 它 满足 假设 1 的 条件 ， 因此 ， 该 系统 的 广义 稳态 存在 ： 另一方面 ， 容易 证明 非线性 系统 ( 5 ) 的 离散 动力学 系统 是 同 胚 的 ， 所以 它们 是 唯一 遍历 的 ， 根据 定理 1 ， 非线性 系统 ( 5 ) 的 广义 稳态 优化 控制 问题 ( GOP ) 存在 . 因为 有 控制器 的 调节作用 ， 使得 x 始终 围绕 设定 点 xc 上下 波动 ， 而 xc ∈ ［ 1.0 ， 5.0 ］ ， 所以 x 的 取值 不会 趋近 于 0 ， 从而 可以 保证 非线性 系统 ( 5 ) 满足 假设 2 的 条件 . 因此 ， 可以 按照 上节 中 的 优化 算法 将 该 系统 的 GOP 问题 转化 为 MOP 问题 求解 . 
 　 　 设 非线性 系统 ( 5 ) 的 稳态 优化 指标 函数 为 
 Q = ( xc - 2 ) 2 + ( xc - x ( k ) ) 2 + ( y ( k ) - 1 ) 2 ; ( 6 ) 
 置 设定 点 初值   xc = 2.8 , v = 3.0 ;   修正 步长 ε = 1.0 ； 经过 3 次 迭代 计算 ， 便 得到 广义 稳态 的 最优 设定 点 ， 结果 如表 1 所示 . 图 3 和 图 4 是 非线性 系统 ( 5 ) 相应 于 第 1 次 和 第 3 次 设定 点 修正 时 ， 时间 序列 x ( k ) 和 y ( k ) 的 变化 曲线 ， 从图 中 可以 看出 ， 非线性 系统 ( 5 ) 具有 广义 稳态 . 
 
 
 图 3 　 第 1 次 迭代 时 的 x ( k ) 和 y ( k ) 的 响应 曲线 　 图 4 　 第 3 次 迭代 时 的 x ( k ) 和 y ( k ) 的 响应 曲线 
 
 　 
 表 1 　 数值 计算结果 
 
 迭代 次数 L 最优 设定 点 c ( v ) 中心 值 μ ( x ) 中心 值 μ ( y ) 性能指标 q ( c ) 
 31.9283401 . 8662660.4233180 . 754063 
 
 
 6 　 结束语 
 
 　 　 文中 对 工业 过程 广义 稳态 优化 控制 问题 ( GOP ) 进行 了 深入研究 . 将 GOP 问题 引入 有限 测度 空间 ， 并 依据 测度 理论 证明 了 同 胚 的 非线性 系统 在 满足 假设 1 的 条件 下 ， 其 GOP 问题 唯一 存在 ； 证明 了 同 胚 的 非线性 系统 在 满足 假设 1 和 假设 2 的 条件 下 ， 便 可 将 GOP 问题 化为 MOP 问题 后 求解 ， 并 给出 了 算法 步骤 ； 最后 ， 对 一个 由 液位 控制系统 和 连续 搅拌 反应器 系统 组成 的 工业 过程 进行 了 数值 计算 ， 结果表明 ， 文中 关于 GOP 问题 的 定义 是 正确 的 ， 算法 是 有效 的 . 
 
 1 ) 国家自然科学基金 资助 项目 . 
 　 　 罗 旭光 　 1990 年 毕业 于 西北工业大学 航天 学院 ， 获 硕士学位 ； 1998 年 毕业 于 西安交通大学 系统工程 研究所 ， 获 博士学位 . 现在 广东 美的 集团 R & D 研究所 工作 ， 主要 研究 领域 为 ： 工业 过程 稳态 优化 控制 、 模糊 神经元网络 、 混沌 理论 、 智能 控制 等 . 
 　 　 万 百五 　 1951 年 交通 大学 电信 研究所 研究生 毕业 ， 现为 西安交通大学 系统工程 研究所 教授 、 博士生 导师 ， 中国 自动化 学会 荣誉 理事 ； 曾 获得 国家教委 科技进步 一等奖 一次 、 二等奖 两次 、 三等奖 一次 以及 机械 电子 工业部 科技进步 一等奖 一次 . 主要 研究 领域 为 ： 大 系统 理论 与 应用 ， 大 工业 过程 递阶 稳态 优化 与 智能 控制 等 . 
 作者 单位 ： ( 西安交通大学 系统工程 研究所 　 西安 　 710049 ) 
 参考文献 
 1 　 罗 旭光 ， 万 百五 . 工业 过程 广义 稳态 研究 . 西安交通大学 学报 ， 1998 ， 32 ( 5 ) ： 1 — 6 
 2 　 罗 旭光 ， 万 百五 . 工业 过程 广义 稳态 的 平均 度量 . 西北大学 学报 ( 自然科学 版 ) ， 1998 ， 28 ( 3 ) ： 198 ～ 202 
 3 　 Lin   J ， Wang   M , Roberts   P   D . Improvements   in   the   formulation   and   solution   approach   for   stochastic   optimizing   control   of   steady - state   industrial   processes . Int . J . Control , 1990 , 52 ( 3 ) : 517 — 548 
 4 　 罗 旭光 . 工业 过程 广义 稳态 及其 优化 控制 的 研究 ［ 博士学位 论文 ］ . 西安 ： 西安交通大学 ， 1997 
 5 　 Roberts   P   D . An   algorithm   for   steady - state   system   optimization   and   parameter   estimation . Int . J . Systems   Science , 1979 , 10 : 719 — 730 
 6 　 严士健 ， 刘秀芳 . 测度 与 概率 . 北京 ： 北京师范大学 出版社 ， 1994 ， 163 — 173 
 7 　 Lee   J   S , Chang   K   S . Applications   of   chaos   and   fractals   in   process   systems   engineering . In : J . Proc . Cont . , 1996 , 6 ( 2 / 3 ) : 71 — 87 
 
 
 收稿 日期 　 1997 - 07 - 21 　 收到 修改稿 日期 　 1998 - 03 - 16 
