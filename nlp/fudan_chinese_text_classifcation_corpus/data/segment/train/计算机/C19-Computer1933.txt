微型机 与 应用 
 MICROCOMPUTER   &   ITS   APPLICATIONS 
 2000 　 Vol.19 　 No.6 　 P.45 - 47 
 
 
 
 
 刀具 电子 样本 系统 的 设计 与 实现 
 彭冰 　 陈永洁 
 摘要 ： 应用 面向对象 数据库 软件 PowerBuilder 开发 刀具 电子 样本 系统 的 设计 思想 与 实现 方法 。 
 关键词 ： 电子 样本   实体 — 联系 模型   数据 窗口 
 　 　 企业 的 产品 样本 是 用户 全面 深入 了解 该 企业 主导产品 的 重要途径 。 随着 计算机技术 的 发展 和 应用 的 普及 ， 将 企业 产品 的 相关 参数 汇集 成册 ， 以 电子 样本 的 形式 提供 给 用户 已 成为 一种 时尚 。 
 在 机械加工 领域 ， 硬质合金 可 转位 刀片 是 一种 广泛 使用 的 具有 较 高 经济效益 的 刀具 。 用户 依据 不同 的 应用 场合 、 不同 的 使用 条件 、 不同 的 加工 工艺 以及 对 工件 加工 精度 的 不同 要求 ， 需要 从 各式各样 的 刀片 形式 中 选择 最佳 者 。 这 类 刀片 往往 具有 复杂 的 三维 槽 型 结构 ， 不同 的 槽 型 有 不同 的 适用范围 ， 所以 与 刀片 有关 的 参数 比较 多 ， 其 数据 关系 也 较 复杂 。 本文 以 硬质合金 可 转位 刀片 这种 系列化 产品 为例 ， 设计 出 一种 刀具 电子 样本 系统 ， 探讨 了 开发 电子 样本 的 一些 基本 设计 环节 。 
 1     电子 样本 系统 概要 设计 
 1.1   开发 环境 的 选择 
 　 　 本 系统 采用 PowerBuilder ( 以下 简称 PB ) 进行 设计 。 PB 是 美国 Powersoft 公司 推出 的 基于 客户 ／ 服务器 体系结构 的 可视化 快速 交互式 开发工具 。 PB 支持 常见 的 各种 数据库 ， 既 能 直接 连接 Sybase 、 SQL   Server 、 Oracle 等 大型 数据库系统 ， 亦可 通过 开放 数据库 互连 ( ODBC ) 连接 xBase 、 Access 、 Excel 等 小型 数据库系统 。 PB 采用 类似 于 VB 和 C语言 混和物 的 编程语言 — — Powerscript ， 能 较 完善 地 支持 对象 的 封装 、 继承 ， 并 以 一种 几乎 一致 的 方式 操纵 各种 数据库 ， 从而 易于 将 应用程序 从 一种 数据库 移植 到 另 一种 数据库 。 采用 PB 独特 的 数据 窗口 技术 ， 可以 相当 方便 地 修改 、 更新 、 插入 、 删除 、 滚页 、 打印 或 以 11 种 文件格式 中 的 任何 一种 方式 表现 数据 。 作为 一种 主要 进行 数据库 前端开发 的 工具 ， PB 的 简洁 和 高效性 是 其 最 显著 的 特点 。 
 1.2   数据模型 
 　 　 数据模型 反映 了 客观 世界 中 实体 与 实体 之间 的 各种 内部联系 和 外部 联系 。 现实 世界 中 实体 之间 的 关系 可 抽象化 为 1 — 1 、 1 — M 、 M — N 三类 映射 关系 。 在 众多 描述 客观 世界 及其 联系 的 数据模型 中 ， 比较 简单明了 、 使用方便 有效 的 是 实体 — 联系 模型 ( 又称 E — R 模型 ) 。 实体 — 联系 模型 图以 长方形 表示 实体 ， 以 椭圆 表示 实体 的 属性 ， 以 菱形 表示 实体 之间 的 联系 。 建立 实体 — 联系 模型 的 关键在于 正确 划分 实体 属性 和 实体 间 的 关系 。 
 　 　 在 进行 用户 需求 分析 的 基础 上 ， 本 刀具 电子 样本 系统 的 实体 — 联系 模型 如图 1 所示 。 
 
 图 1     刀具 电子 样本 系统 的 实体 — 联系 模型 
 1.3   数据库 结构 
 　 　 实体 — 联系 模型 是 作为 中间 数据模型 来 使用 的 ， 一般 还须 将 其 转化 为 数据库 管理系统 ( DBMS ) 所 能 支持 的 模型 。 表格 是 人们 较为 熟悉 的 数据表示 方式 ， 关系 模型 数据库 以 一组 结构 简单 、 逻辑 严密 的 二维 平面 表来 刻画 实体 间 的 关系 ， 它 要求 开发人员 结合 具体情况 规范 设计 关系 模式 。 采用 关系 模型 的 优点 在于 ： 
 　 　 ( 1 ) 数据结构 简单 ， 没有 层次 或 网状 模型 中 错综复杂 的 指针 ； 
 　 　 ( 2 ) 可以 直接 处理 M — N 的 关系 ； 
 　 　 ( 3 ) 能够 一次 提供 1 个 元组 集合 ； 
 　 　 ( 4 ) 具有 很 高 的 数据 独立性 。 
 　 　 在 将 有 逻辑关系 的 字 段 组织 成表 的 过程 中 ， 尚需 注意 以下 二点 ： 
 　 　 ( 1 ) 应 将 相似 的 信息 放入 1 张表中 ， 并 尽可能 使表中 的 字 段 由 主键 的 值来 决定 ； 
 　 　 ( 2 ) 应 尽可能减少 数据 冗余 量 。 
 　 　 表 1 为 刀具 电子 样本 系统 中 的 加工 场合 表 结构 。 
 表 1     加工 场合 表 结构 
 字段名 数据类型 数据 宽度 可否 为 
 NULL 备注 
 加工 场合 代码 整型 4 否 主键 、 索引 
 加工 类别 代码 整型 3 否 　 
 工件 材料 字符 型 10 否 　 
 加工 工艺 字符 型 20 可 　 
 
 　 　 其中 设置 加工 类别 代码 为 外键 ， 与 加工 类别 表 进行 联系 ， 有助于 信息 规范化 和 减少 信息 存储量 。 
 2     系统 实现 
 　 　 用户界面 的 友好 程度 对于 电子 样本 的 推广 使用 至关重要 。 PB 在 设计 用户 接口界面 及 实现 相应 功能 方面 十分 出色 ， 开发人员 可以 采用 丰富 的 控件 、 面板 、 属性 对话框 等 ， 编写 少量 代码 来 迅速 构建 应用 程序界面 。 采用 PB 的 数据 窗口 无须 编写 SQL 语句 即能 操作 关系数据库 的 数据 。 通过 这种 功能强大 的 数据 窗口 ， 不但 可以 对 每个 数据库 的 表 进行 查询 、 插入 、 删除 、 更新 ， 还 可以 为 数据 指定 编辑 格式 、 显示 风格 ， 并 可 添加 各种 对象 、 制表 的 附加 信息 、 统计图 以及 生成 报表 等 。 
 刀具 电子 样本 系统 主要 实现 下述 功能 ： 
 　 　 ( 1 ) 呈现 刀片 的 所有 信息 
 　 　 在 呈现 刀片 各类 信息 方面 ， 既 要 继承 传统 印刷 的 样本 模式 ， 又 要 适应 计算机 显示 数据 的 方式 。 与 刀片 某一 属性 有关 的 信息 应当 尽量 集中 到 1 个 窗口 中 ， 并 采用 静态 文本框 、 组合 框 、 列表框 、 网格 部件 、 滚动条 等 最为 常用 的 控件 。 例如 ， 刀具 的 几何 角度 ， 除了 以 图片 示意 外 ， 还 可 将 所有 的 角度 参数 以 电子表格 形式 罗列 出来 ， 以便 于 对比 。 此外 ， 在 推荐 选择 图中 嵌入 具有 一定 图形 外观 的 按钮 。 在 界面设计 中 ， 不 应当 过分 花哨 ， 应 本着 简洁 朴素 的 原则 ， 根据 实际 数据格式 采用 较 好 的 数据 表现 方式 。 
 　 　 ( 2 ) 查询 功能 
 　 　 用户 选择 刀片 时 ， 往往 是 依靠 查询 他们 感兴趣 的 参数 进而 了解 该 刀片 的 全部 信息 。 PB 采用 结构化 查询语言 SQL 完成 数据 的 访问 、 输入 、 修改 、 定义 。 电子 样本 系统 可以 让 用户 进行 简单 查询 、 精确 查询 、 模糊 查询 、 多 条件 交叉 查询 等 。 
 　 　 例如 ： 要 查询 株州 硬质合金 厂 生产 的 切削速度 在 100 ～ 200   m ／ min 的 外圆 车刀 刀片 ( 加工 类型 代码 为 10 ) ， 其 实现 代码 为 ： 
 SELECT   Chip ＿ Code   FROM 
 　 　 　 　 CompanyTable ， CuttingConditionTable ， 
 　 　 　 　 CuttingCaseTable 
 WHERE 
 　 　 CompanyTable . Chip ＿ Code ＝ 
 　 　 　 　 CuttingConditionTable . Chip ＿ Code 　 AND 
 　 　 CompanyTable . Chip ＿ Code ＝ 
 　 　 CuttingCaseTable . Chip ＿ Code 　 AND 
 　 　 CompanyTable . Company ＿ Name 
 　 　 　 　 　 ＝ “ 株州 硬质合金 厂 ” 　 AND 
 　 　 CuttingConditionTable . Cutting ＿ Speed ＞ ＝ 100 　 AND 
 　 　 CuttingConditionTable . Cutting ＿ Speed ＜ ＝ 200 　 AND 
 　 　 CuttingCaseTable . ManuClass ＿ Code ＝ 10 
 　 　 ORDER   BY   Chip ＿ Code ； 
 　 　 ( 3 ) 打印 报表 
 　 　 用户 除 通过 获得 刀片 的 具体 参数 外 ， 系统 还 可以 提供 打印 功能 ， 按 逻辑关系 以 报表 形式 打印 。 这 需要 在 创建 有关 数据 窗口 对象 时 ， 用 所 需 报表 的 格式 构建 数据 窗口 。 可 将 数据 分成 单组 或 多个 组 ， 对 数据 进行 计算 后 加以 组织 ， 包括 自定义 格式 、 排序 、 增加 图片 等 。 以下 为 同时 打印 多个 数据 窗口 对象 的 实现 代码 ： 
 int   Print ＿ Job 
 Print ＿ Job ＝ PrintOpen ( ″ Chip   Reports ″ ) 
 If   Print ＿ Job ＜ 1     Then 
 　 　 MessageBox ( ″ 打印 失败 ″ ， ″ 不能 进行 报表 打印 ″ ) 
 　 　 Return 
 Endif 
 Print   DataWindow ( Print ＿ Job ， dw ＿ Company ) 
 Print   DataWindow ( Print ＿ Job ， dw ＿ CuttingCondition ) 
 Print   DataWindow ( Print ＿ Job ， dw ＿ CuttingCase ) 
 PrintClose ( Print ＿ Job ) 
 　 　 ( 4 ) 联机帮助 
 　 　 良好 的 联机帮助 是 用户 尽快 熟悉 电子 样本 的 必要 保证 。 基于 Windows 环境 下 的 帮助文件 的 创建 一般 包含 以下 步骤 ： 
 　 　 ① 创建 帮助文件 源文件 。 这种 文件 要 采用 RTF 格式 保存 ； 
 　 　 ② 利用 帮助文件 编辑器 创建 目录 文件 ， 以 分门别类 形式 安排 各 主题 页 的 隶属 关系 ； 
 　 　 ③ 创建 帮助 项目 文件 ， 将 有关 RTF 文件 、 BMP 文件 、 AVI 文件 等 添加 到 项目 文件 中 ， 然后 编译 生成 帮助文件 ( hlp 文件 ) 和 目录 文件 ( cnt 文件 ) ； 
 　 　 ④ 在 应用程序 的 相应 事件 中 调用 Showhelp ( ) 函数 ， 触发 Windows 操作系统 的 Winhelp 程序 ， 打开 相应 帮助文件 的 例程 。 
 　 　 应当 指出 ， 尽管 创建 帮助文件 的 过程 并 不 复杂 ， 但 帮助文件 本身 的 内容 组织 却 不 太 容易 。 如果 在 系统 其它 功能 全部 实现 之后 再 去 单独 编写 帮助文件 ， 往往 造成 帮助 与 应用 配合 不 紧密 的 现象 。 所以 ， 在 实现 系统 某项 局部 功能 的 时候 应 同步 考虑 帮助文件 的 组织 撰写 。 
 3     系统 的 发布 、 运行 和 维护 
 　 　 在 完成 有关 对象 的 定义 、 表 的 创建 、 界面 元素 的 配置 及 程序编制 和 调试 等 工作 后 ， 刀具 电子 样本 系统 进入 运行 和 发布 阶段 ， 即 编译 生成 可执行文件 并 可 脱离 PowerBuilder 的 开发 环境 而 独立 运行 。 对于 应用程序 较大 ( 如 大于 2MB ) 或 多个 应用程序 共享 某 部分 对象 的 情况 ， 可 考虑 采用 动态 库 文件 ( PBD 文件 ) ， 从而 可 减少 可执行文件 的 大小 ， 提高 运行 效率 ， 也 便于 程序 的 维护 和 管理 。 在 应用程序 中 动态 指定 的 资源 或 数据 窗口 对象 等 应 建立 相应 的 资源 文件 清单 ( PBR 文件 ) ， 将 上述 这些 文件 有机 地 组织 起来 后 ， 经 编译 连接 生成 可执行文件 。 最终 交付 用户 的 文件 主要 有 ： 
 　 　 ( 1 ) 可执行文件 ( EXE 文件 ) ； 
 　 　 ( 2 ) 所有 涉及 的 动态 库 文件 ( PBD 文件 ) ； 
 　 　 ( 3 ) 未 包含 在 资源 文件 清单 中 的 资源 文件 ( 如 位图文件 、 图标 文件 、 光标 文件 等 ) ； 
 　 　 ( 4 ) 应用程序 的 配置文件 ( INI 文件 ) ； 
 　 　 ( 5 ) 帮助文件 ( HLP 文件 、 CNT 文件 ) ； 
 　 　 ( 6 ) PowerBuilder 应用程序 独立 运行 所 必需 的 动态 连接 库 文件 ( DLL 文件 ) ； 
 　 　 ( 7 ) 所 使用 的 数据库 管理系统 的 驱动程序 。 
 　 　 上述 这些 文件 还 应当 经过 安装 制作 工具 做成 安装程序 的 形式 提供 给 用户 。 
 　 　 一个 应用 系统 性能 的 优劣 、 效率 的 高低 最终 要 由 用户 来 做出 判决 。 应用 系统 在 运行 过程 中 ， 用户 会 提出 一些 新 的 需求 和 建议 。 有 必要 根据 用户 需求 的 变化 及时 对 电子 样本 应用 系统 做 一定 的 修改 ， 使 其 进一步 得到 完善 和 提高 。 同时 ， 在 新 产品 面市 时 ， 亦 要 考虑 其 样本 与 以前 电子 样本 的 一致性 、 兼容性 。 
 　 　 电子 样本 是 1 种 应用 前景 相当 广阔 的 数据库 应用软件 ， 它 的 出现 将 极大 地 改变 用户 选择 产品 的 方式 ， 尤其 是 可 利用 Internet 网络 为 企业 提供 新 的 销售 方式 。 本文 阐明 了 用 PowerBuilder 开发 刀具 电子 样本 系统 的 一般 方法 和 基本 步骤 ， 我们 相信 电子 样本 的 研究 必将 随着 计算机 与 数据库 技术 的 发展 而 继续 深入 下去 。 
 彭冰 （ 武汉 华中理工大学 机械 科学 与 工程学院  430074 ） 
 陈永洁 （ 武汉 华中理工大学 机械 科学 与 工程学院  430074 ） 
 参考文献 
 1 ， 萨师煊 ， 王珊 ． 数据库系统 概论 ． 北京 ： 高等教育出版社 ， 1991 
 2 ， 冯玉才 ． 数据库系统 基础 ． 武汉 ： 华中理工大学 出版社 ， 1993 
 3 ， Hatfield   B ． PowerBuilder   5 应用 程序开发 指南 ． 北京 ： 清   华 大学 出版社 ， 1997 
 4 ， 沃得 工作室 ． PowerBuilder   6 ． 0 应用 开发 指南 ． 北京 ： 人民   邮电 出版社 ， 1998 
 收稿 日期 ： 1999 － 12 － 26 
