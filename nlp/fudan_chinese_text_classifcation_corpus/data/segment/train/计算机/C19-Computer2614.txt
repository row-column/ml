软件 学报 
 JOURNAL   OF   SOFTWARE 
 1999 年   第 6 期   第 10 卷   Vol.10   No.6   1999 
 
 
 
 烟雾 的 快速 模拟 
 童若锋 　 陈凌钧 　 汪国昭 
 　 　 摘要 　 文章 提出 利用 粒子系统 和 浓度 场 相结合 的 方法 来 模拟 烟雾 的 运动 与 扩散 . 在 粒子 属性 中 加入 一 浓度 函数 , 通过 粒子 作用 半径 及 浓度 函数 的 变化 模拟 烟雾 的 扩散 , 还 通过 粒子 的 运动 及 分裂 反映 风力 场 的 作用 . 与 原有 的 粒子系统 相比 , 不仅 增加 了 对 烟雾 扩散 的 描述 , 还 可以 用 少量 的 粒子 生成 连续 的 浓度 场 , 在 很大 程度 上 提高 了 计算速度 . 同时 文章 还 给出 了 一种 快速 的 烟雾 绘制 方法 . 
 　 　 关键词 　 动态 模拟 , 粒子系统 , 浓度 场 , 光线 投射 . 
 　 　 中图法 分类号 　 TP391 
 　 
 A   Method   for   Quick   Smog   Simulation 
 TONG   Ruo - feng1 , 2   CHEN   Ling - jun3   WANG   Guo - zhao3 
 1   ( Artificial   Intelligence   Institute   Zhejiang   University   Hangzhou   310027 ) 
 2 ( State   Key   Laboratory   of   CAD   &   CG   Zhejiang   University   Hangzhou   310027 ) 
 3 ( Department   of   Applied   Mathematics   Zhejiang   University   Hangzhou   310027 ) 
 　 　 Abstract 　   In   this   paper ,   a   method   of   combining   particle   system   with   density   fields   is   presented   to   simulate   smog   movement   and   diffusion   .   By   attaching   a   density   function   to   the   particle   attributes ,   smog   diffusion   is   simulated   through   the   variance   of   particle   effect   radius   and   density   functions ,   effect   of   turbulence   is   imitated   through   particle   movement   and   fragmentation .   Compared   with   the   traditional   particle   system ,   this   method   can   describe   smog   diffusion   and   produce   continuous   density   fields   with   less   particles ,   the   computation   is   thus   greatly   speeded   up .   A   quick   algorithm   for   smog   rendering   is   also   presented   for   real - time   simulation . 
 　 　 Key   words 　 Dynamic   simulation ,   particle   system ,   density   field ,   ray   casting . 
 　 　 近年来 , 自然景观 的 模拟 成为 计算机 图形学 的 热点 之一 , 其中 烟雾 等 气态 流体 的 动态 模拟 由于 其 广泛 的 应用 前景 吸引 了 众多 图形学 研究者 的 关注 . 它 还 可以 应用 于 影视广告 , 产生 各种 效果 , 节省 大量 的 人力物力 ; 还 可以 应用 于 飞行 模拟 , 不但 节省开支 , 而且 为 飞行员 的 安全 带来 一定 的 保障 . 然而 , 烟雾 的 气态 特性 使得 对 其 进行 真实 的 模拟 具有 较大 的 难度 : 
 　 　 ( 1 )   在 显示 方面 , 由于 烟雾 不 存在 明显 的 边界 及法 向 , 从而 无法 用 传统 的 方法 进行 绘制 , 而 光线 在 烟雾 中 的 散射 与 衰减 为 真实感 的 显示 带来 了 更 大 的 难度 . 
 　 　 ( 2 )   在 运动 控制 方面 , 气态 物质 的 易 流动 及 扩散 特性 也 使 在 计算机 动画 中 常用 的 运动 控制 方法 无法 得以 实施 . 
 　 　 在 以往 对 烟雾 的 研究 中 , Nishita , Klassen 等 人 在 绘制 时 考虑 了 光线 在 云雾 中 的 衰减 、 反射 、 散射 等 因素 , 获得 了 较大 成功 ［ 1 , 2 ］ ; 在 烟雾 的 模型 方面 , Peitgen 等 人 采用 分形 方法 对 云雾 等 进行 模拟 ［ 3 , 4 ］ , Sakas 运用 谱分析 ［ 5 ］ , 而 Ebert 等 人 则 采用 基于 气流 场 的 密度 函数 ［ 6 ］ . 这些 方法 都 有 其 各自 的 优越性 , 但 也 存在 着 不足 . 分形 方法 很难 根据 物理 意义 ( 如 风力 场 等 ) 对 烟雾 进行 运动 控制 , 基本上 只 适用 于 对 云 等 远景 的 模拟 . 密度 函数 的 方法 在 控制 烟雾 的 运动 时 , 将 烟雾 的 密度 定义 为 气流 场 的 函数 来 反映 气流 场 的 变动 , 函数 由 人工 给定 , 不能 非常 真实 地 反映 气流 的 物理 意义 . 另外 ， 还有 一种 烟雾 模型 是 粒子系统 ［ 7 , 8 ］ , 用 大量 形状 简单 的 微小 粒子 作为 基本 元素 来 表示 烟雾 , 通过 对 粒子 运动 的 描述 来 控制 烟雾 的 运动 , 这一 方法 能够 较为 真实 地 反映 气流 对 烟雾 的 作用 , 但 计算 量 大 , 要 生成 具有 一定 连续性 的 烟雾 浓度 需要 庞大 的 粒子 数目 . 1993 年 , Stam 和 Fiume 给 粒子 定义 了 浓度 函数 , 在 较大 程度 上 加快 了 计算速度 , 但 在 风力 场 对 定义 了 浓度 函数 的 粒子 如何 作用 以及 如何 较 好 地用 浓度 场 的 变动 反映 烟雾 的 扩散 方面 未能 深入研究 ［ 9 ］ . 
 　 　 本文 提出 了 一个 粒子系统 和 浓度 场 相结合 的 烟雾 模型 , 着重 研究 了 粒子 在 风力 作用 下 如何 运动 分裂 以及 如何 真实 地 描述 烟雾 的 扩散 , 并 给出 了 一个 快速 绘制 算法 . 本文 第 1 节 介绍 了 粒子系统 与 浓度 场 相结合 的 烟雾 模型 . 第 2 节 根据 扩散 方程 给出 了 描述 粒子 浓度 函数 变化 的 方法 . 第 3 节 描述 粒子 在 风力 场下 分裂 时 如何 保持 浓度 守衡 . 第 4 节 给出 了 一个 快速 的 烟雾 绘制 方法 . 
 1 　 粒子系统 与 浓度 场 相结合 的 烟雾 模型 
 　 　 烟雾 的 运动 主要 可 分为 烟雾 自身 的 扩散 和 烟雾 在 气流 下 的 运动 ( 包括 由 比重 引起 的 烟雾 的 上升 ) 两个 方面 . 因此 , 一个 好 的 烟雾 模型 首先 应 能 满足 以下 要求 : ( 1 )   能 真实 描述 气流 对 烟雾 的 作用 ; ( 2 )   能 真实 描述 烟雾 的 扩散 过程 ; ( 3 )   能 满足 真实感 绘制 的 需要 . 
 　 　   在 满足 上述 几点 的 基础 上 , 速度 的 快慢 也 是 评价 模型 好坏 的 一个 标准 . 如前所述 , 分形 及 浓度 场 模型 在 速度 和 真实感 绘制 方面 效果 较 好 , 但 较 难 真实 模拟 烟雾 的 运动 , 而 粒子系统 则 正好 相反 . 因此 ， 本文 提出 了 一个 粒子系统 和 浓度 场 相结合 的 烟雾 模型 , 先由 粒子 的 运动 及 变化 将 烟雾 的 扩散 及 气流 的 作用 表现 出来 , 再 由 粒子 的 分布 及其 浓度 属性 得到 当前 的 总 浓度 场 分布 , 以 满足 真实感 绘制 的 需要 . 为 克服 传统 粒子系统 中 计算 量 大 的 缺陷 , 我们 为 每个 粒子 定义 作用 半径 及 浓度 函数 , 从而 用 少量 的 粒子 就 可以 得到 较为 连续 的 浓度 分布 . 这样 , 在 我们 的 系统 中 , 粒子 的 主要 属性 有 : 粒子 的 位置 P 、 粒子 的 速度 V 、 粒子 的 加速度 A 、 粒子 的 作用 范围 ( 由 作用 半径 R 表示 ) 、 粒子 的 浓度 函数 f ( r , t ) （ 具体 实现 时 只 存放 浓度 系数 k ） . 
 　 　 粒子 的 位置 、 速度 和 加速度 用于 反映 气流 的 作用 . 将 时间轴 从 t0 开始 , 以 间隔 Δ t 作 均匀 分割 , tj = t0 + j . Δ t , 设 已知 粒子 I 在 时刻 tj 的 位置 为 , 速度 为 , 所 处 位置 的 加速度 为 Aj , 根据 位移 、 速度 、 加速度 间 的 关系 , 在 tj + 1 时 ， 粒子 I 的 速度 及 位置 为 
 ( 1 ) 
 ( 2 ) 
 
 　 　 粒子 的 作用 范围 和 浓度 函数 则 用来 控制 烟雾 的 扩散 及 总体 烟雾 浓度 的 生成 : 
 ( 3 ) 
 
 其中 t 为 时刻 , ρ ( X , t ) 为 空间 中 t 时刻 总 的 烟雾 浓度 , X 为 空间 位置 ; n 为 系统 中 生命 粒子 的 数目 , ρ i ( X , t ) = fi ( r , t ) 为 t 时刻 粒子 I 产生 的 浓度 , r 为 空间 点到 粒子 I 的 中心点 的 距离 . 
 　 　 烟雾 总体 浓度 场 的 变化 主要 有 气流 场 的 影响 和 烟雾 本身 的 扩散 两 方面 的 原因 . 这 虽然 可 由 一个 总体 的 微分方程 表示 出来 , 但 由于 这一 方程 计算 量 大 , 且 在 系统 中有 烟源 时 更为 复杂 . 因此 , 我们 将 其 分开 考虑 （ 这 也 正是 我们 采用 粒子系统 的 一个 原因 ） : 气流 场使 粒子 产生 运动 , 并 使 作用 范围 较大 的 粒子 分裂 为 几个 作用 范围 较 小 的 粒子 ; 烟雾 的 扩散 则 通过 粒子 作用 半径 及 浓度 函数 的 变化 来 实现 . 
 2 　 烟雾 的 扩散 
 当 不 考虑 气流 场 的 作用 时 , 单个 粒子 中 烟雾 浓度 的 扩散 是 各向同性 的 , 根据 Nernst 实验 定律 , 可用 如下 热传导 方程 表示 烟雾 的 扩散 ［ 10 ］ : 
 ( 4 ) 
 
 其中 a2 为 扩散系数 , g ( x , y , z , t ) 为 烟源 产生 的 浓度 , φ （ x , y , z ） 为 t0 时刻 浓度 的 初始条件 . 在 我们 的 方法 中 , 烟雾 的 产生 由 粒子 的 生成 来 描述 , 式 ( 4 ) 仅 用来 模拟 粒子 生成 后 其 浓度 的 变化 , 因此 g ( x , y , z , t ) = 0 . 此时 , 式 ( 4 ) 的 解为 
 ( 5 ) 
 
 其中 
 
 　 　 下面 我们 来 确定 每个 粒子 生成 时 的 初始 浓度 φ ( x , y , z ) . 一个 粒子 生成 后 其 总 浓度 保持 不变 , 不妨 设其为 1 , 而 粒子 的 作用 范围 由于 扩散 而 越来越 大 , 因此 有 
 ( 6 ) 
 
 其中 φ R ( x , y , z ) 为 
 ( 7 ) 
 
 将 ( 6 ) ( 7 ) 两 式 代入 式 ( 5 ) , 有 
 ( 8 ) 
 
 其中 r 为 空间 点到 粒子 位置 的 距离 . 这样 , 由式 ( 8 ) 即可 得到 粒子 出生 后 各 时刻 粒子 的 浓度 , 这是 一个 高斯 函数 , t - t0 越小 , 分布 越 集中 于 r = 0 附近 , 随着 t - t0 的 增大 , 分布 越来越 平坦 . 由于 高斯 函数 在 整个 空间 中 的 值 都 大于 0 , 这样 , 在 计算 空间 某 一点 X 的 浓度 值时 , 每个 粒子 对 其 都 有 各自 的 贡献 , 而 那些 距 X 很远 的 粒子 的 贡献 小得 可以 忽略 . 因此 , 为了 减少 计算 量 , 我们 给 每个 粒子 规定 各自 的 作用 范围 R , 当 空间 点 与 粒子 位置 间 的 距离 r 小于 R 时 , 浓度 为 f ( r , t ) ; 当 r > R 时 , 浓度 为 0 . 粒子 作用 范围 R 的 设定 方法 为 : 首先 给 系统 设定 一 浓度 阈值 ρ 0 , 通过 解方程 f ( R , t ) = ρ 0 , 获得 粒子 的 作用 范围 R . 显然 , 作用 范围 R 将 随着 时间 t 的 增大 而 增大 , 如图 1 所示 . 
 
 　 　 　 　 　 
 图 1   粒子 作用 半径 的 选取 
 　 　 由于 扩散系数 a 及 时间 间隔 Δ t 都 已 预先 给定 , 因此 , 我们 先 计算 出 粒子 在 各个 年龄 时 的 作用 半径 , 把 浓度 函数 放入 各 年龄段 的 浓度 表中 ( 每一 年龄 对应 于 一条 作用 半径 , 各 作用 半径 组成 一个 作用 半径 表 , 每一 作用 半径 对应 于 一个 浓度 函数 表 , 浓度 函数 表中 存放 作用 半径 内 各 采样 距离处 的 浓度 值 ) , 需要 时 ， 通过 查表 获得 . 
 3 　 气流 场 的 作用 
 　 　 在 我们 的 系统 中 ， 由于 粒子 具有 作用 范围 及 浓度 函数 , 因此 ， 气流 场 不仅 使 粒子 产生 运动 , 还 将 对 粒子 的 浓度 函数 产生 影响 , 我们 通过 粒子 的 分裂 来 实现 . 
 　 　 将 系统 中 所有 生命 粒子 进行 分类 : 设定 一 阈值 R0 , 粒子 的 作用 半径 小于 R0 的 归入 W1 , 大于 R0 的 归入 W2 . 对 W1 中 的 粒子 , 我们 认为 , 气流 场 只 使 其 产生 运动 , 而 没有 其他 影响 ; 对 W2 中 的 粒子 , 气流 场 不仅 使 其 产生 运动 , 还 将 使 其 产生 分裂 . 
 　 　 具体方法 为 : 先 将 三维空间 进行 网格 划分 , 并 得到 气流 场 引起 的 在 各 网格 单元 处 的 加速度 . 将 系统 中 所有 粒子 根据 其 位置 放入 网格 单元 , 并 根据 其 作用 半径 确定 与 周围 哪几个 网格 单元 有交 . 
 　 　 对 W1 中 的 粒子 I , 其下 一步 的 位置 由式 ( 1 ) 、 式 ( 2 ) 决定 , 其中 加速度 A 由 如下 方法 得到 : 
 　 　 设 粒子 I 与 网格 单元 C1 , C2 , C3 , ... , Cn 有交 , 粒子 位置 与 各 网格 单元 中心 的 距离 分别 为 l1 , l2 , l3 , ... , ln , 气流 场 在 各 网格 单元 形成 的 加速度 为 a1 , a2 , a3 , ... , an , 则 粒子 的 加速度 为 以 距离 的 倒数 为 权值 的 各 网格 单元 的 加速度 的 加权 平均 : 
 
 　 　 对于 W2 中 的 粒子 J , 气流 场 将 使 其 分裂 为 几个 作用 半径 较 小 的 粒子 , 分别 使 它们 运动 . 同样 地 , 我们 先 得到 与 粒子 J 相交 的 网格 单元 C1 , C2 , C3 , ... , Cn 及其 加速度 a1 , a2 , a3 , ... , an , 并 计算 出 距离 l1 , l2 , l3 , ... , ln , 删去 粒子 J , 同时 生成 粒子 J1 , J2 , J3 , ... , Jn , 粒子 Ji 具有 与 粒子 J 相同 的 速度 , 位置 位于 与其 相对 应 的 网格 单元 Ci 的 中心 , 加速度 为 Ci 处 的 加速度 , 其 作用 半径 Ri 由 如下 方法 获得 : 
 　 　 先 计算 系数 , 然后 从 作用 半径 表中 查出 与 ki 最 接近 的 一个 作为 粒子 的 作用 半径 Ri . 此时 , 粒子 的 浓度 函数 不再 是 与其 相对 应 的 浓度 表 , 而应 再 乘 上 系数 kik , 以 保持 粒子 分裂 前后 总 浓度 的 一致 ( 其中 k 为 分裂 前 的 粒子 J 的 浓度 系数 , 我们 将 系数 ki 也 作为 粒子 的 属性 保存 下来 , 粒子 出生 时 的 初始 浓度 系数 可 设置 为 1 . 只有 在 粒子 发生 分裂 时 , 其 浓度 系数 才 会 改变 ) . 
 　 　 在 粒子 的 各 属性 设定 之后 , 即可 由式 ( 1 ) 、 式 ( 2 ) 得到 下 一 时刻 的 位置 . 
 4 　 烟雾 的 绘制 
 　 　 在 烟雾 的 总 浓度 场 生成 后 , 即可 根据 效果 的 要求 采用 不同 的 方法 进行 绘制 , 其中 光线 投射 是 较为 常用 的 一种 ［ 5 ］ . 它 可以 模拟 烟雾 对 光线 的 衰减 、 散射 等 效果 , 但 这 一 方法 计算 量 大 、 速度 较慢 . 为此 , 我们 简化 烟雾 的 光照 模型 , 采用 投影 法对 烟雾 进行 绘制 : 
 　 　 ( 1 )   将 屏幕 作为 投影 平面 , 在 屏幕 各 像素点 处 设置 一 浓度 表并设 初值 为 0 . 
 　 　 ( 2 )   将 系统 中 的 所有 粒子 按 z 值 排序 . 
 　 　 ( 3 )   将 系统 中 的 粒子 按 z 值 从 大到 小 的 顺序 投影 到 屏幕 ( 不妨 设离 屏幕 越近 ， 其 z 值越 大 ) , 计算 出其 投影 浓度 , 累加 到 浓度 表中 . 
 　 　 投影 浓度 的 计算方法 为 : 近似 认为 烟雾 粒子 的 作用 范围 在 屏幕 上 的 投影 为 一个 圆 , 圆心 为 ( xp , yp ) , xp = k ( x1 - x0 ) + x0 , yp = k ( y1 - y0 ) + y0 , 其中 , ( x0 , y0 , z0 ) 为 视点 坐标 , ( x1 , y1 , z1 ) 为 烟雾 粒子 的 空间 位置 , z 为 屏幕 的 Z 坐标 ; 投影 圆 的 半径 为 Rp = kR , R 为 烟雾 粒子 的 作用 范围 . 年龄 为 tj 的 粒子 在 投影 圆内 一点 ( x , y ) 处 的 投影 浓度 为 
 ( 9 ) 
 
 其中 r 为 ( x , y ) 到 投影 圆心 ( xp , yp ) 的 距离 . 
 　 　 对 这 一 积分 , 我们 仍然 采用 预先 计算 , 然后 查表 的 方法 . 由于 采用 投影 法已 无需 计算 空间 中 的 总 浓度 场 , 因此 ， 我们 在 作用 范围 为 R 的 粒子 的 浓度 表中 不再 存放 其 浓度 函数 , 而是 存放 在 r 从 0 以 一定 的 间隔 变到 R 时 的 各 浓度 值 . 
 　 　 得到 粒子 在 ( x , y ) 的 投影 浓度 后 , 即可 将 系统 中 所有 生命 粒子 在 ( x , y ) 处 的 投影 浓度 进行 叠加 , 得到 ( x , y ) 处 的 总 浓度 . 考虑 到 衰减 , 累加 方法 为 
 ( 10 ) 
 
 其中 ρ old 为 ( x , y ) 处 的 原有 浓度 , ρ new 为 某 粒子 投影 后 ( x , y ) 处 的 新 浓度 . 
 　 　 将 tj 时刻 系统 中 的 所有 粒子 都 作 投影 后 , 即可 由 像素点 ( x , y ) 处 的 浓度 得到 其 颜色 ( 颜色 为 浓度 的 函数 ) 来 进行 绘制 . 
 5 　 结   论 
 　 　 在 以往 的 烟雾 模拟 中 往往 忽略 了 烟雾 本身 的 扩散 . 而用 传统 的 粒子系统 模拟 烟雾 时 , 要 生成 连续 的 浓度 场 需要 大量 的 粒子 . 本文 对 粒子 加入 浓度 函数 这一 属性 , 通过 浓度 函数 的 变化 较 真实 地 反映 了 烟雾 的 扩散 , 并 大大减少 了 生成 连续 浓度 函数 所 需 的 粒子 数 , 从而 降低 了 计算 量 . 本文 给出 的 烟雾 绘制 的 投影 法 , 目前 虽然 仅 局限于 单纯 的 烟雾 场景 , 但 由于 其 显示 速度 较 快 , 在 对 烟雾 各 属性 的 调试 中 不失为 一种 行之有效 的 方法 . 我们 在 SGI ( indigo2 ) 工作站 上 实现 了 本文 的 算法 , 图 2 和 图 3 为用 投影 法 生成 的 画面 , 生成 100 幅图 只 需 6s , 基本 达到 了 实时 的 要求 . 
 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 
 图 2   t = 30 时刻 的 烟雾 画面 ( 投影 法 生成 )   　 　 图 3   t = 50 时刻 的 烟雾 画面 ( 投影 法 生成 ) 
 致谢 　 本文 的 研究 工作 得到 国家自然科学基金 资助 ， 此 项目编号 为 19571071 . 
 * 　 本文 研究 得到 国家自然科学基金 、 国家教育部 博士点 基金 、 浙江省 自然科学 基金 和 浙江大学 曹光彪 基金 资助 . 
 作者简介 　 童若锋 , 1969 年生 , 博士 , 副教授 , 主要 研究 领域 为 计算机 图形学 , 计算机辅助 设计 , 图像处理 . 
 　 　 　 　 　 陈凌钧 , 1969 年生 , 博士 , 副教授 , 主要 研究 领域 为 计算机 图形学 , 科学计算 可视化 . 
 　 　 　 　 　 汪国昭 , 1944 年生 , 教授 , 博士生 导师 , 主要 研究 领域 为 计算机辅助 几何 设计 , 计算机 图形学 , 动态 模拟 , 医学 图像 三维重建 . 
 本文 通讯联系 人 : 童若锋 ， 杭州   310027 , 浙江大学 人工智能 研究所 
 作者 单位 ： 童若锋 （ 浙江大学 人工智能 研究所 　 杭州 　 310027 ） 
 　 　 　 　 　 童若锋 ( 浙江大学   CAD & CG   国家 重点 实验室 　 杭州 　 310027 ) 
 　 　 　 　 　 陈凌钧 　 汪国昭 ( 浙江大学 应用 数学系 　 杭州 　 310027 ) 
 参考文献 
 　 1   Klassen   R   V .   Modeling   the   effect   of   the   atmosphere   on   light .   ACM   Transactions   on   Graphics ,   1987 , 6 ( 3 ) : 215 ～ 237 
 　 2   Nishita   T ,   Miyawaki   Y ,   Nakamae   E .   A   shading   model   for   atmospheric   scattering   considering   luminous   intensity   distribution   of   light   sources .   Computer   Graphics ,   1987 , 21 ( 4 ) : 303 ～ 310 
 　 3   Peitgen   H   O ,   Saupe   D .   The   Science   of   Fractal   Images .   New   York :   Springer - Verlag ,   1988 
 　 4   齐东旭 . 分形 及其 计算 生成 . 北京 : 科学出版社 , 1994 
 ( Qi   Dong - xu .   Fractal   and   Its   Generation .   Beijing :   Science   Press ,   1994 ) 
 　 5   Sakas   G .   Modeling   and   animating   turbulent   gaseous   phenomena   using   spectral   synthesis .   The   Visual   Computer ,   1993 , 9 ( 4 ) : 200 ～ 212 
 　 6   Ebert   D   S ,   Parent   R   E .   Rendering   and   animation   of   gaseous   phenomena   by   combining   fast   volume   and   scanline   a - buffer   techniques .   Computer   Graphics ,   1990 , 24 ( 4 ) : 357 ～ 366 
 　 7   ChiBa   N ,   Muraoka   K ,   Takahashi   H   et   al . Two - dimensional   visual   simulation   of   flames ,   smoke   and   the   spread   of   fire .   The   Journal   of   Visualization   and   Computer   Animation ,   1994 , 5 ( 1 ) : 37 ～ 53 
 　 8   Sims   K .   Particle   animation   and   rendering   using   data   parallel   computation .   Computer   Graphics ,   1990 , 24 ( 4 ) : 405 ～ 413 
 　 9   Stam   J ,   Fiume   E .   Turbulent   wind   fields   for   gaseous   phenomena .   Computer   Graphics ,   1993 , 27 ( 4 ) : 369 ～ 373 
 　 10   董光昌 , 陈仲慈 等 . 数学 物理 方程 . 杭州 : 浙江大学 出版社 , 1989 
 ( Dong   Guang - chang ,   Chen   Zhong - ci   et   al .   Partial   Differential   Equations .   Hangzhou :   Zhejiang   University   Press ,   1989 ) 
 本文 1998 - 05 - 05 收到 原稿 , 1998 - 07 - 13 收到 修改稿 
