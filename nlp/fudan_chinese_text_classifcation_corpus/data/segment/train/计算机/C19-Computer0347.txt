计算机 应用 
 COMPUTER   APPLICATIONS 
 1999 年   第 19 卷   第 9 期   Vol.19   No.9   1999 
 
 
 
 代理服务器 在 校园网 中 的 应用 
 刘循 　 廖蓉 
 　 　 摘 　 要 　 本文 分析 了 代理服务器 （ Proxy   Server ） 的 结构 和 在 代理服务 、 网络 计费 、 高速缓存 ( cache ) 、 网络安全 上 的 功能 ， 并 就 校园网 环境 ， 阐述 了 代理服务器 的 应用 。 
 　 　 关键词 　 代理服务器 ,   校园网 ,   网络管理 
 　 　 　 　 随着 校园网 的 开通 运行 和 大量 计算机 接入 ， 网络 规模 不断扩大 ， 网络 用户 日益 增多 ， 对 网络 可靠 、 安全 、 高效 运行 提出 了 更 高 要求 。 如何 使 网络 计费 不 受 IP地址 混用 影响 ， 真实 反映 用户 流量 ； 如何 加快 网络 浏览 速度 、 降低 不必要 的 出国 费用 ； 如何 监控 网络 以 了解 、 掌握 、 控制 网络 信息 ， 对 不良信息 进行 过滤 ， 保证 校园网 健康 应用 和 发展 ； 如何 有效 保护 网络资源 ， 特别 是 校园网 内部 资源 。 这些 是 网络 计费 和 网络安全 要 解决 的 问题 ， 也 是 校园网 网络管理 的 难题 。 代理服务器 的 运用 可 有效 地 解决 这一 难题 。 
 　 　 代理服务器 软件包 的 种类 很多 ， 有 Netscape   Proxy   Server   、 Wingate 、 Winroute   及华胜 公司 的 NetGate ， 我校 采用 的 是 华胜 公司 的 NetGate 。   
 1 　 代理服务器 及其 结构 
 1.1 　 代理服务器 
 　 　 代理服务器 是 执行 代理服务 的 特殊 软件包 。 它 由 服务器端 程序 与 客户端程序 组成 ， 它 一般 不 允许 内部网 （ Intranet 校园网 ） 和 外部 网 （ Internet 互连网 ） 之间 直接 通信 。 若 内部网 用户 需 访问 外部 网 ， 首先 内部网 用户 应 和 代理服务器 之间 建立 通信 连接 ， 然后 代理服务器 再 与 外部 网 的 服务器 建立 通信 连接 。 可见 ， 代理服务 是 内部网 和 外部 网 之间 的 一个 关联 设备 ， 如图 1 所示 。 该 设备 不但 具有 安全 作用 （ 该 安全 作用 在 网络 中 称为 “ 防火墙 ” ） ， 而且 用户 必须 通过 它 与 外部 通信 ， 所以 可 在 其 上 进行 网络 用户 管理 、 网络 计费 管理 、 网络 信息 缓存 及 网络 监控 管理 。 
 
 图 1 　 代理服务器 
 1.2 　 代理服务器 的 结构 
 　 　 代理服务器 是 建立 于 网络 的 物理层 、 数据 链路层 、 网络层 之上 的 管理软件 ， 它 主要 由 以下 几个 部分 构成 ： 
 　 　 网络层 IP 包 过滤 ： 网络层 的 IP 包 过滤 只 对 包 的 头部 信息 （ 地址 段 ） 进行 控制 ， 对包 的 内容 不 作 任何 处理 。 包 过滤 是 针对 网络 信息 的 目的 和 来源 作 限制 ， 是 网络 信息安全 的 一种 保障 。 
 　 　 会话层 的 SOCKS   Proxy ： 通过 会话层 的 SOCKS   Proxy ， 使 客户端 和 代理 服务器端 建立 通信 连接 。 只有 代理 服务器端 验证 通过 的 客户 才能 和 校园网 外 的 服务器 建立 通信 连接 ， 并 通过 缓存 实现 cache 功能 。 
 　 　 网络 监控 ： 它 包括 校园网 内部 各 子网 连网 机器 的 状态 监控 和 目前 正 通过 代理服务器 的 各源 、 目 地 IP地址 监控 两 方面 。 
 　 　 网络 计费 系统 ： 代理服务器 的 网络 计费 系统 主要 由 用户 访问 日志 、 计费 标准 设置 、 用户 费用 动态 查询 、 用户 费用 统计 构成 。 
 2 　 代理服务器 的 主要 功能 
 　 　 从 以上 结构 分析 可知 ， 代理服务器 的 主要 功能 是 代理服务 、 网络 监控 管理 、 计费 管理 。 
 　 　 代理服务 　 主要 包括 用户名 管理 、 用户名 认证 及 防火墙 功能 等 。 
 　 　 计费 管理 　 用户 费用 日志 、 用户 费用 统计 、 用户 月 费用 限制 、 用户 费用 预交 、 用户 费用 动态 查询 等 。 
 　 　 网络 监控 管理 　 网络 监控 管理 是 监控 校园网 内部 各 子网 连网 机器 的 状态 监控 和 目前 正 通过 代理服务器 的 各源 、 目 地 IP地址 。 通过 对 校园网 内部 各 子网 监控 可 了解 各 子网 运行 情况 ； 通过 对 校园网 内部 连网 机器 的 状态 监控 可 确定 连网 机器 的 IP地址 是否 合法 ； 通过 对 目前 正 通过 代理服务器 的 各源 、 目 地 IP地址 监控 可 知道 当前 的 热门 站点 ， 以便 采取相应 的 管理 措施 。 
 　 　 高速缓存 　 高速缓存 ( cache ) 能 把 通过 代理服务器 访问 过 的 信息内容 在 自己 的 硬盘 中 保存 一份 , 当 用户 下 次访问 相同 的 内容 时 就 不必 从 Internet 上 下载 , 而是 从 代理服务器 上 的 cache 中 下载 。 代理服务器 可以 配置 成 自动式 cache 功能 ， 它 能 自动 地 定期 更新 cache 中 指定 的 内容 ， 利用 这一 功能 可 减少 网络 使用 传输 流量 ， 提高 网络 传输速度 ， 节约 访问 时间 ， 降低 访问 费用 。 
 3 　 代理服务器 在 校园网 中 的 应用 
 3.1 　 校园网 与 CERNET 
 　 　 校园网 是 通过 光缆 将 校园内 各 干线 节点 连接起来 ， 干线 节点 又 将 各 大楼 的 局域网 等 连接 在 一起 。 国家教育部 将 我国 绝大多数 大学 的 校园网 连接起来 ， 构成 中国 教育 科研 计算机网 （ CERNET ） 。 由于 CERNET 的 特殊 收费 方式 ： 既有 免费 IP 站点 又 有 收费 IP 站点 ， 而 计费 是 按 CERNET 网络管理 中心 的 路由器 上 采集 到 的 每个 IP 从 收费站 点 进入 CERNET 的 流量 。 但 对于 校园网 一级 的 用户 来说 ， 由于 IP 混用 存在 ， 该 计费 方式 不能 很 好 地 反映 用户 流量 ， 目前 大家 认可 的 方式 是 按 用户名 和 用户 口令 计费 。 
 3.2 　 代理服务器 在 校园网 中 的 应用 
 　 　 代理服务器 用于 校园网 ， 当 校园内 客户 要 访问 收费 IP 站点 时 ， 在 出口 路由器 上作 IP 过滤 ， 使要 访问 收费 IP 站点 的 用户 必须 通过 代理服务器 。 在 用户端 ， 用户 必须 输入 用户 帐号 和 口令 才能 和 代理服务器 建立 连接 ， 也 才能 进行 所 需 站点 访问 。 系统结构 方式 详见 图 2 。 在 代理服务器 上 计费 系统 的 功能 有 用户 费用 日志 、 用户 费用 预交 、 用户 月 费用 控制 、 用户 月 费用 统计 、 用户 费用 实时 查询 等 。 
 
 图 2 　 代理服务器 系统结构 
 　 　 四川大学 校园网 用 NetGate 作 代理 软件包 ， 操作系统 是 Solarias 。 该 代理服务器 的 主要 功能 如下 。 
 　 　 访问控制 　 设置 过滤 规则 ； 设置 月 费用 上限 ； 设置 可 信任 主机 ； 系统配置 。 
 　 　 流量 计费 　 设置 域 内 IP地址 类 ； 设置 计费 标准 ； 按 IP 分类 统计 ； 设置 域 内 IP地址 类 ； 按 用户名 分类 统计 ； 查询 日志 ； 按 用户名 查询 ； 预付 款项 管理 ； 费用 统计 。 
 　 　 实时 监控 
 　 　 网络 状态 
 　 　 Internet 是 开放式 互联网 ， 网上 不 安全 的 信息 及 因素 很多 。 代理服务器 的 防火墙 功能 可 将 校园网 内 的 客户 保护 起来 ， 使 校园网 外 无法 攻击 校园内 的 用户 ； 代理服务器 的 监控 功能 可 监视 校园网 内外 站点 访问 ， 杜绝 不 健康 的 、 非法 的 信息 ； 代理服务器 的 网络 状态 功能 可 观察 校园网 内 用户 接入 情况 。 
 4 　 结语 
 　 　 代理服务器 是 网络管理 中 非常 重要 的 工具 ， 它 不仅 在 校园网 的 管理 中 发挥 着 日益 明显 的 作用 ， 它 在 整个 网络 领域 也 得到 了 越来越 广泛 的 应用 ， 同时 其 功能 也 不断完善 和 发展 。 
 作者简介 ： 刘循 　 工程师 。 主要 研究 方向 ： 计算机网络 管理 及 应用 。 
 廖蓉 　 工程师 。 主要 研究 方向 ： 计算机网络 管理 及 应用 。 
 作者 单位 ： 四川大学 计算机网络 管理中心 　 四川 . 成都 （ 610064 ） 
 参考文献 
 ［ 1 ］ 　 周 明天 ， 汪文勇 .   TCP / IP 网络 原理 与 技术 .   北京 ： 清华大学出版社 ， 1993 
 收稿 日期 : 1999 - 06 - 07 ( 修改稿 ) 
