自动化 学报 
 ACTA   AUTOMATICA   SINICA 
 1999 年   第 25 卷   第 6 期   Vol.25   No.6   1999 
 
 
 
 多 尺度 脊 边缘 及其 在 图像 目标 
 分割 中 的 应用 1 ) 
 宋焕生 　 刘 春阳 　 吴成 柯 　 梁德群 
 关键词 　 边缘 检测 ， 目标 分割 ， 屋顶 状 边缘 ， 多 尺度 . 
 MULTI - SCALE   RIDGE   EDGES   AND   THEIR   APPLICATIONS 
 IN   OBJECT   SEGMENTATION 
 SONG   Huansheng 
 ( National   Key   Laboratory   of   Integrated   Services   Networks ,   Xidian   University ,   Xi ' an 　 710071 ) 
 LIU   Chunyang 
 ( Space   Center   of   the   Chinese   Academy   of   Sciences ,   Beijing 　 100080 ) 
 WU   Chengke 
 ( National   Key   Laboratory   of   Integrated   Services   Networks ,   Xidian   University ,   Xi ' an 　 710071 ) 
 LIANG   Dequn 
 ( Image   Research   Institute   of   Xi ' an   Jiaotong   University ,   Xi ' an 　 710049 ) 
 Key   words 　 Edge   detection ,   object   segmentation ,   ridge   edge ,   multi - scale . 
 1 　 引言 
 　 　 到 目前为止 ， 关于 边缘 的 研究 主要 是 针对 阶跃 边缘 ， 而 对 屋顶 状 边缘 ( 以下 简作 脊 边缘 ) 则 研究 甚少 . 但是 在 一些 实际 应用 中 ， 如果 我们 主要 关心 的 是 呈 屋顶 状 的 目标 ， 那么 从 脊 边缘 入手 进行 分析 ， 往往 要 比 从 常用 的 阶跃 边缘 出发 更 容易 把握 目标 的 本质 . 图 1 给出 一个 具有 代表性 的 例子 ， 这里 的 目的 是 分割 出图 1 ( a ) 中 对应 焊缝 缺陷 的 局部 发 “ 亮 ” 的 斑状 和 线状 区域 . 文献 ［ 1 ］ 采用 的 办法 是 首先 检测 原图 的 阶跃 边缘 ， 然后 从中 取出 焊缝 缺陷 的 对应 者 ， 并 由此 出发 完成 目标 区域分割 的 目的 . 然而 正如 从图 1 ( b ) 中 看到 的 ， 要 想 从 这些 交织 在 一起 的 阶跃 边缘 中 取出 对应 于 焊缝 缺陷 的 部分 是 相当 困难 的 . 在 图 1 ( c ) 中 显示 的 脊 边缘 则 是 完全 另 一种 情形 ， 这是 我们 将 在 后面 提出 的 多 尺度 脊 边缘 中 大致 与 缺陷 大小 相当 的 一个 尺度 . 在 这里 给出 的 对应 于 焊缝 缺陷 的 脊 边缘 如此 明确 清晰 ， 这是 任何 基于 阶跃 边缘 的 算法 ［ 3 ］ 所 望尘莫及 的 . 
 
 
 ( a ) 焊缝 图像 
 
 
 ( b ) 阶跃 边缘 
 
 
 ( c ) 脊 边缘 
 
 
 ( d ) 基于 脊 边缘 的 分割 结果 
 图 1 　 焊缝 图像 的 阶跃 边缘 、 脊 边缘 和 基于 脊 边缘 的 分割 结果 
 2 　 脊 边缘 及其 检测 
 　 　 考察 几种 比较 典型 的 脊 边缘 在 正交 截面 上 对应 的 一维 信号 f ( x ) ( 如图 2 所示 ) ， 可以 看到 ， 脊 边缘 位置 与 f ( x ) 一阶 导数 的 零 交叉 或 二阶 导数 极值 点 对应 ， 然而 并非 所有 二阶 导数 极值 点 都 对应 于 脊 边缘 ， 所以 不能 用 二阶 导数 极值 点 而 只能 用 一阶 导数 的 零 交叉 确定 脊 边缘 的 位置 . 此外 ， 为了 剔除 脊 边缘 中 次要 的 和 由 噪声 产生 的 无 意义 的 部分 ， 除了 对 脊 边缘 的 位置 描述 ， 还 需要 关于 它 的 强度 描述 . 由于 脊 边缘 表现 为 f ( x ) 由 增加 到 减少 ( 或 由 减少 到 增加 ) 的 转折 ， 这种 转折 的 方向 ( 向上 凸 或 向下 凹 ) 和 剧烈 程度 大小 分别 反映 为  f ( x ) 二阶 导数 的 正负 符号 和 绝对值 ， 所以 可以 用 一阶 导数 零 交叉处 的 二阶 导数 描述 脊 边缘 的 强度 ， 其中 强度 为 正 代表 “ 暗 ” 的 脊 边缘 ， 强度 为 负 代表 “ 亮 ” 的 脊 边缘 . f ( x ) 的 导数 实际上 就是 图像 在 脊 边缘 法线 方向 的 方向 导数 ， 所以 脊 边缘 的 描述 涉及 二个 内容 ： 一个 是 脊 边缘 的 法线 方向 ； 另 一个 是 在 法线 方向 上 的 一阶 和 二阶 导数 . 
 
 
 图 2 　 脊 边缘 与 一 、 二阶 导数 的 关系 
 　 　 在 脊 边缘 位置 上 ， 脊 边缘 的 法线 方向 为 二阶 方向 导数 取 到 极值 的 方向 . 用 f ( i , j ) 表示 图像 信号 ， α m ( i , j ) 表示 在 ( i , j ) 点上 图像 二阶 方向 导数 取 到 极值 的 方向 1 ) ， 则 图像 脊 边缘 描述 为 ： 1 ) 如果 图像 在 ( i , j ) 位置 上 沿 α m ( i , j ) 方向 的 一阶 方向 导数 为 零 交叉点 ， 那么 ( i , j ) 为 图像 脊 边缘 位置 ； 2 ) 如果 ( i , j ) 为 脊 边缘 点 ， 那么 该点 上 脊 边缘 的 强度 为 图像 在 ( i , j ) 位置 上 沿 α m ( i , j ) 方向 的 二阶 方向 导数 . 
 　 　 
 　 　 1 ) 本文 中 的 方向 都 指 相对 水平 坐标轴 i 的 逆 时钟 旋转 角度 . 图像 沿 α 方向 的 方向 导数 为 
 　 　 ( 1 ) 
 由于 在 α m ( i , j ) 方向 ， f ″ α ( i , j ) 取 到 极值 ， 所以 
 　 　 ( 2 ) 
 α m ( i , j ) 的 取值 范围 为 ( - π / 2 , π / 2 ) ， 所以 
 　 　 ( 3 ) 
 图像 f ( i , j ) 沿 α m ( i , j ) 的 一阶 和 二阶 方向 导数 分别 为 
 f ′ α m ( i , j ) = fisin α + fjcos α , 　 　 ( 4 ) 
 f ″ α m ( i , j ) = fiisin2 α + fijsin α cos α + fjjcos2 α . 　 　 ( 5 ) 
 在 ( 3 ～ 5 ) 式 中 
 　 　 ( 6 ) 
 　 　 对 数字图像 信号 ， 以上 微分 表示 在 实际 计算 中 可以 用 差分 近似 代替 ， 因此 ( 4 ) 和 ( 5 ) 式 在 实际 应用 中 的 计算 是 方便 的 . 
 3 　 多 尺度 脊 边缘 
 　 　 多 尺度 脊 边缘 是 指 从 若干个 尺度 下 的 平滑 图像 中 分别 提取 出 的 脊 边缘 的 总体 . 脊 边缘 在 尺度空间 的 响应 具有 较 好 的 局部 化 特点 . 这里 仍然 以 焊缝 图像 为 例来 说明 脊 边缘 的 这 一 特点 ， 图 1 ( b ) 和 ( c ) 所示 为 与 焊缝 缺陷 大小 相当 的 尺度 上 的 强度 大于 某 阈值 的 阶跃 边缘 和 脊 边缘 ， 我们 看到 ， 有 较 强 强度 的 脊 边缘 主要 对应 于 与 当前 尺度 有 相当 大小 的 目标 ， 而 另 一些 大 目标 ( 如 焊缝 自身 ) 却 由于 在 当前 的 尺度 上 强度 较 小 而 没有 出现 在 图 1 ( c ) 中 . 与 此 形成 鲜明对比 ， 图 1 ( b ) 中 的 情况 则 完全 不同 ， 各种 大小 的 目标 由于 在 当前 尺度 都 有 较 强 的 响应 而 在 图 1 ( b ) 中 混杂 在 一起 . 脊 边缘 的 这 一 特点 决定 了 它 在 分割 具有 特定 大小 的 目标 时比 阶跃 边缘 更为 优越 . 
 　 　 Mallat ［ 4 ， 5 ］ 证明 ， 基于 B 样条 的 小波 变换 等于 对 图像 进行 多 尺度 平滑 后 的 水平 和 垂直 方向 的 一阶 方向 导数 ， 也 就是 各个 2 进 尺度 上 的 小波 变换 等于 相应 尺度 上 的 fi 和 fj ， 而 从 fi 和 fj 出发 又 可 直接 计算 fii , fij 和 fjj ， 所以 我们 可以 利用 Mallat 快速 算法 完成 ( 3 ～ 5 ) 式 的 计算 ， 从而 实现 多 尺度 脊 边缘 的 快速 计算 . 
 
 4 　 基于 脊 边缘 的 尺度空间 滤波 及 应用 实例 
 　 　 文献 ［ 6 ］ 研究 了 基于 阶跃 边缘 的 尺度空间 滤波 算法 ， 这种 算法 可以 推广 为 基于 脊 边缘 的 尺度空间 滤波器 ， 具体 算法 如下 ： 
 　 　 1 ) 利用 Mallat 算法 ， 对 图像 作二进 小波 分解 ； 
 　 　 2 ) 从二进 小波 变换 出发 ， 计算 在 二进 尺度空间 的 多 尺度 脊 边缘 及其 强度 ； 
 　 　 3 ) 在 尺度空间 进行 脊 边缘 跟踪 ， 建立 脊 边缘 在 尺度空间 的 对应 关系 ， 然后 利用 脊 边缘 在 尺度空间 的 协调 关系 和 脊 边缘 的 强度 选出 重要 的 脊 边缘 ， 滤除 由 不 重要 的 目标 和 噪声 产生 的 脊 边缘 ； 
 　 　 4 ) 依据 具体 应用 目的 和 先验 知识 ， 从 剩下 的 多 尺度 脊 边缘 中 选出 所 关心 的 那 一部分 ； 
 　 　 5 ) 以 选定 的 脊 边缘 为 基础 ， 利用 类似 文献 ［ 6 ］ 中 的 方法 设计 小 波 变换 选通域 ； 
 　 　 6 ) 对 选通 后 的 小波 变换 作反 变换 ， 就 得到 最后 滤波 结果 . 
 　 　 上面 算法 用于 焊缝 缺陷 分割 的 结果 如图 1 ( d ) 所示 ， 这是 相当 令人满意 的 . 所以 ， 在 某些 图像 目标 分割 的 应用 中 ， 脊 边缘 具有 阶跃 边缘 无法 替代 的 独特 优势 . 
 1 ) 国家自然科学基金 ( 批准 号 69575014 ) 资助 课题 . 
 作者简介 ： 宋焕生 　 1964 年生 ， 博士后 . 主要 研究 方向 为 非线性 图像处理 、 计算机 视觉 . 
 　 　 　 　 　 刘 春阳 　 1962 年生 ， 博士后 . 主要 研究 方向 为 图像压缩 编码 . 
 作者 单位 ： 宋焕生 　 西安电子科技大学 综合 业务网 及 关键技术 国家 重点 实验室 　 西安 　 710071 
 　 　 　 　 　 刘 春阳 　 中国科学院 空间 中心 　 北京 　 100080 
 　 　 　 　 　 吴成 柯 　 西安电子科技大学 综合 业务网 及 关键技术 国家 重点 实验室 　 西安 　 710071 
 　 　 　 　 　 梁德群 　 西安交通大学 图像 研究所 　 西安 　 710049 
 参考文献 
 1 　 Liang   Dequn   et   al .   Antomatic   identification   of   the   defect   level   of   welding   seam   based   on   X - ray   image .   FENDT ' 92 ,   1992 ,   267 ～ 274 
 2 　 Witkin   A .   Scale   space   filtering .   In :   Proc . Int . Joint   Conf . Artifical   Intell ,   1983 ,   1019 ～ 1022 
 3 　 Marr   D ,   Hildreth   E .   Theory   of   edge   detection   In :   Proc . Royal   Soc .   London   B ,   1981 ,   207 ( 2 ) : 187 ～ 217 
 4 　 Mallat   S   et   al .   Characterisitics   of   signals   from   mlutiscale   edges .   IEEE   Trans .   Pattern   Anal .   &   Mach . Intell .   1992 ,   14 ( 7 ) : 710 ～ 732 
 5 　 Mallat   S   et   al .   Singularity   detection   and   processing   with   wavelets .   IEEE   Trans .   Inf .   Theory ,   1992 ,   38 ( 2 ) : 617 ～ 643 
 6 　 宋焕生 等 . 一种 新 的 小波 变换 域 选通 滤波器 . 信号处理 ， 1996 ， 12 ( 4 ) ： 311 ～ 315 
 收稿 日期 　 1997 - 09 - 08 　 　 收 修改稿 日期 　 1998 - 03 - 23 研究 简报 
