计算机 工程 
 COMPUTER   ENGINEERING 
 1999 年   第 25 卷   第 12 期   vol.25   No.12   1999 
 
 
 
 基于 分色 和 一种 新有 去 噪 算法 的 地图 自动 输入 技术 
 沈琳琳 　 陈 洪亮 　 向 　 峥 
 　 　 电子地图 数据库 是 地理信息系统 ( GIS ) 的 核心 所在 ， 也 是 交通路线 引导 系统 不可 缺少 的 一部分 。 只有 建立 数字地图 数据库 ， 才能 实现 诸如 无级 放大 、 搜寻 最短 路径 等 功能 。 
 　 　 因为 数字地图 数据库 包含 数据量 大 、 数据类型 多 ， 所以 开发周期 长 。 若 采用 数字化仪 ， 一般 开发 全国性 的 数字地图 数据库 需要 几年 甚至 十几年 的 时间 ， 且 耗费 大量 人力 、 物力 ； 若能 实现 自动 输入 和 数字化 ， 则 可 节约 大量 人力 、 物力 。 
 　 　 本文 主要 研究 如何 实现 地图 自动 输入 和 数字化 ， 最终 建立 电子地图 数据库 。 所用 方法 主要 包含 4 个 部分 ： 路径 抽取 、 预处理 、 城市 识别 和 矢量化 。 
 1   实现 流程 
 1.1   彩色 空间 选择 和 路径 抽取 
 　 　 在 用 计算机 进行 彩色 图象处理 时 , 采用 何种 彩色 空间 是 非常 重要 的 。 一般 采用 的 彩色 空间 有 RGB 、 HLS 、 HBS 、 YIQ 等 。 使用 RGB 彩色 空间 时 ， 其 R 、 G 、 B 分量 均 具有 较强 的 明度 因子 且 彼此之间 相关 ， 因此 ， 随着 明度 的 不同 容易 产生 错误 的 分割 。 同时 ， 由于 R 、 G 、 B 中均 含有 明度 、 色调 和 饱和度 ， 所以 处理 不易 实现 。 在 利用 HBS 或 HLS 彩色 空间 时 ， 由于 其 3 个 分量 相对 独立 ， 易于 对 某个 分量 进行 处理 ， 可以 克服 以上 几个 缺点 。 但是 其 H 分量 只 在 有限 情况 下 有 意义 ( 特别 是 当 R = G = B 时 存在 本征 奇点 ) ， 不 适合 用 计算机 进行 处理 。 更 重要 的 是 H 和 S 分量 受 图纸 质量 ( 如 偏色 等 ) 和 照明 影响 较大 ， 两者 往往 在 试验 中是 不可避免 的 。 另外 ， HLS 或 HBS 是 RGB 的 非线性 变换 ， 计算 耗费 较大 。 
 　 　 采用 RGB 彩色 空间 的 线性变换 空间 [ 3 ] I1 - I2 - I3 ， 其 表达式 为 ： 
 　 　 I1 = ( R + G + B ) / 3 
 　 　 I2 = R - B 
 　 　 I3 = ( 2G - R - B ) / 2 
 I1 为 彩色 空间 的 明度 分量 ， I2 分量 能 有效 区分 棕色 和 蓝色 ， I3 分量 能 突出 绿色 ， 因此 较 适合 于 我国 三色 或 四色 地图 的 彩色 分层 处理 。 
 　 　 抽取 路径 时 ， 首先 对位 图中 道路 上 的 点 进行 采样 ， 即 选择性 地 抽取 道路 上 的 样点 ， 分别 记录 其 I1 、 I2 、 I3 的 值 ， 在样 点数 有 一定 规模 后 ， 计算 这一 样本空间 的 平均值 和 方差 。 然后 对位 图 的 每个 象素 逐一 进行 扫描 ， 判断 其 是否 属于 这一 样本空间 ， 如是 则 置 为 黑点 ( 1 ) ， 否则 置 为 白点 ( 0 ) ， 最后 得到 一张 仅 含 路径 信息 的 二值 图象 。 
 1.2   预处理 
 　 　 ( 1 ) 噪声 消除 和 膨胀 、 腐蚀 
 　 　 在 得到 的 二值 图中 ， 由于 阈值 选取 存在 误差 、 扫描 误差 等 原因 ， 因此 存在 不少 孤立 的 噪声 点 或 点集 ， 同时 得到 的 路径 信息 也 会 存在 断点 。 若 采用 高斯 滤波 、 中 值 滤波 等 方法 ， 会 造成 图象 模糊 、 效果 不好 。 鉴于 道路 的 连续性 ， 采用 以下 算法 消除 噪声 。 
 　 　 设 函数 f   [ a * a ] ， 表示 在 一 正方形 区域 a * a 中前 景点 ( 黑点 ) 数目 ， 则 满足 下 式 ： 
 　 　 f   [ ( a + 2 ) * ( a + 2 ) ]   =   f ( a * a ) 　 　 　 　 　 a = 1 ， 3 ， 5 
 的 点集 是 噪声 ， 应予 消除 。 具体 算法 如下 : 
 　 　 设 采取 从左到右 、 从上到下 的 顺序 ， 对于 每个 当前 象素 点 A ( i , j ) 
 　 　 1 ) 判断 此 象素 是否 为 前 景点 ( 1 ) ， 是 则 继续 ， 否则 退出 继续 搜索 ； 
 　 　 2 ) 计算 以 此前 景点 A 为 中心 的 3 * 3 窗口 内前 景点 的 个数 S3 ； 
 　 　 3 ) 计算 以 此前 景点 A 为 中心 的 5 * 5 窗口 内前 景点 的 个数 S5 ； 
 　 　 4 ) 判断 S3 和 S5 是否 相等 ， 是 则 继续 ， 否则 退出 ； 
 　 　 5 ) 计算 以 此前 景点 A 为 中心 的 7 * 7 窗口 内前 景点 的 个数 S7 ； 
 　 　 6 ) 判断 S5 和 S7 是否 相等 ， 是 则 继续 ， 否则 退出 ； 
 　 　 7 ) 以 当前 点 A 为 中心 的 7 * 7 窗口 内 的 点 集为 噪声 点集 ， 应予 消除 ， 将 此点集 全部 赋为 0 ( 背景 点 ) 。 
 　 　 一般 计算 到 7 * 7 窗口 已经 足够 ， 窗口 再大 反而 会误 将 道路 删除 。 
 　 　 对于 路径 中 间隔 不大 的 断点 ， 则 可 采用 膨胀 的 方法 消除 ， 而 腐蚀 则 是 膨胀 的 逆 操作 ， 用 它 保持 图象 的 不变性 。 膨胀 和 腐蚀 都 是 图象处理 中 常用 的 方法 。 
 　 　 ( 2 ) 细化 
 　 　 在 得到 的 二值 图中 ， 道路 的 宽度 一般 都 大于 1 ， 这样 的 图 跟踪 起来 是 很 困难 的 。 细化 是 指 将 线路 的 边界点 消除 ， 只 留下 骨架 象素 ， 从而 使 其 宽度 成为 单 象素 宽 。 其 通常 步骤 为 ： 逐一 扫描 前 景点 ( 黑点 ) ， 根据 其八 邻域 值 判断 其 是 可 删除 象素 还是 骨架 ( 保留 ) 象素 ， 并 不断 进行 迭代 ， 直到 不 存在 可 删点 为止 。 
 　 　 需要 注意 的 是 ， 在 判断 某 一点 是否 可 删除 之前 ， 需 判断 其 是否 为 端点 ( 邻 点数 为 1 ) ， 如是 ， 则 应予 保留 。 
 1.3   城市 识别 
 　 　 在 交通图 中 ， 各 城市 用 一 小圆圈 表示 ， 半径 因 城市 等级 而异 。 对 城市 识别 可 采用 常用 的 Hough 变换 [ 2 ] 法 。 具体 可 参考 有关 书籍 ， 在 此 将 不予 叙述 。 
 1.4   矢量化 
 　 　 矢量化 是 将 原始 的 点阵图 转化 为 计算机 可 识别 和 查询 的 最后 一步 。 它用 一组 带 参数 的 图元 ( 如 一次 或 二次曲线 、 箭头 等 ) 去 拟合 原有 的 位图 点阵 信息 ， 从而 达到 在 识别 信息 的 同时 压缩 信息 的 目的 。 本文 主要 采用 折线 段 逼近 法 ， 主要 步骤 可 参考文献 [ 5 ] 。 
 2   实验 结果 及 结论 
 　 　 利用 上述 方法 对图 1 路径 进行 识别 、 抽取 ， 得到 图 2 。 再 进行 滤噪 、 细化 等 预处理 之后 得到 图 3 。 最终 得到 两张 数据表 ， 一张 为 城市 表 ， 一张 为 道路 表 。 
 
 图 1   原始 图 
 
 图 2   对图 1 路径 进行 识别 和 抽取 的 结果 
 
 图 3   对图 2 进行 滤噪 细化 处理 的 结果 
 　 　 通过 实验 说明 本 方法 对于 交通图 中 路径 识别 抽取 、 矢量化 到 最终 建立 数据库 ， 具有 较 好 的 效果 。 且 整个 过程 不需 人工干预 ， 对 上述 图 1 处理 只 需 2 分钟 左右 ， 比用 数字化仪 大大 节省 了 时间 。 
 作者 单位 : 上海交通大学 信息 与 控制 工程系 , 上海 200240 
 参考文献 
 1   Auckland   D   W . Automatic   Map   Reading   for   Distribution   System   Design . IEE   Proc . Gener . Trans . Distrib , 142 ( 6 ) 
 2   Yamada   H . Directional   Mathematical   Morphologh   and   Reformalized   Hough   Transformation   for   the   Analysis   of   Topographic   Maps . IEEE   Trans . Pattern   Analysis   and   Machine   Intelligence , 15 ( 4 ) 
 3   Yu - ICHI   OHTA , et   al . Color   Information   for   Recog   Segmentation   Computer   Graphics   and   Image   Processing.1990 , 13 :   222 - 241 
 4   朱 海洲 ， 姚耀文 . 地图 等高线 矢量化 的 图象处理 . 小型 微型 计算机   系统 , 1996 , 12 : 43 - 46 
 5   徐 建华 . 图象处理 与 分析 . 北京 ： 科学出版社 , 1992 
