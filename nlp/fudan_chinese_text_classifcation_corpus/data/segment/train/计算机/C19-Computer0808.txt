自动化 学报 
 ACTA   AUTOMATICA   SINICA 
 2000 　 Vol.26 　 No.1 　 P.68 - 73 
 
 
 
 基于 HM 非线性 模型 的 滚动 时域 H ∞ 控制 
 耿晓军   席裕庚 
 摘   要   基于 HM   ( Heterogeneous   Model ) 非线性 系统 模型 ， 提出 并 研究 了 滚动 时域 H ∞ 控制器 的 设计 . 给出 了 基于 H ∞ 性能指标 的 最优控制 律 和 其 存在 的 充分性 条件 ， 该 控制 律 可以 保证系统 稳定 和 干扰 衰减 增益 不 超过 某一 上限 . 然后 ， 为了 减少 计算 量 , 设计 了 有 上述 相同 性能 保证 的 次优 控制器 . 
 关键词   滚动 时域 控制 ， H ∞ 控制 ， 非线性 系统 ， 预测 控制 . 
 RECEDING   HORIZON   H ∞   CONTROL   BASED   ON   HM 
 NONLINEAR   MODEL 
 GENG   Xiaojun   XI   Yugeng 
 ( Institute   of   Automation ,   Shanghai   Jiaotong   University ,   Shanghai   200030 ) 
 Abstract   This   paper   concentrates   on   the   problem   of   receding   horizon   H ∞   control   for   a   family   of   nonlinear   systems   that   can   be   represented   by   a   heterogeneous   model   ( HM ) .   Under   H ∞   performance   index ,   the   sufficient   conditions   arederived   for   the   optimal   controller   which   guarantees   the   stability   with   disturbance   attenuation .   Then ,   in   order   to   reduce   the   computational   burden ,   a   suboptimal   controller   which   can   guarantee   the   same   system   performance   is   designed . 
 Key   words   Receding   horizon   control , H ∞   control ,   nonlinear   systems ,   predictive   control . 
 1   引   言 
 　 　 70 年代 末 Kwon 等 ［ 1 ］ 针对 线性 时变 系统 ， 提出 了 一种 稳定 的 控制策略 — — 带 终端 约束 的 滚动 时域 控制 ( CRHC ) . 90 年代 以来 ， Mayne 等 ［ 2 ］ 将 其 思想 扩展 到 非线性 系统 ， 并 证明 在 一定 假设 条件 下 系统 闭环 稳定 . 在 要求 控制系统 稳定 的 同时 ， 人们 往往 还 希望 系统 性能 优良 . H ∞ 控制 正是如此 ， 它 要求 控制 输出 对 扰动 输入 的 增益 能够 不 超过 某个 上界 . 结合 滚动 时域 控制 和 H ∞ 控制 ， 本文 提出 并 研究 了 一类 有 扰动 非线性 系统 的 滚动 时域 H ∞ 控制 . 
 　 　 本文 内容 共分 4 节 ， 在 第 2 节 中将 给出 系统 的 模型 和 问题 的 描述 . 第 3 节是 本文 的 主要 工作 部分 ， 首先 基于 H ∞ 性能指标 给出 滚动 时域 H ∞ 最优控制 律 及其 存在 的 充分性 条件 ， 然后 为了 求解 方便 ， 利用 HM 非线性 模型 的 特点 ， 得到 了 该 问题 的 次优 控制器 . 该 控制器 同 最优控制 器 一样 可以 保证系统 稳定 和 干扰 衰减 增益 小于 某一 上限 的 性能 要求 . 第 4 节是 结束语 . 
 2   问题 描述 
 2.1   非线性 系统 HM 模型 
 　 　 实际 系统 的 全局 数学模型 常常 难以 得到 . 本文 采用 由 如下 一系列 局部 模型 集结 而成 的 HM 近似 非线性 模型 ［ 3 ］ 
 　 ( 1 ) 
 其中 Rl 表示 第 l 个 局部 区域 ， 为 系统 ( 1 ) 的 第 l 个 子系统 ， x ( t ) , u ( t ) , w ( t ) , z ( t ) , yl ( t ) 分别 为 第 l 个 子系统 的 状态 、 输入 ， 扰动 、 输出 和量 测 变量 ， w ( t ) ∈ L2 ［ 0 , ∞ ) . 令 GT ［ F   G ］ = ［ 0   I ］ . 
 　 　 系统 的 全局 近似 模型表示 如下 ： 
 （ 2 ） 
 这里 其余 类似 ， 为 特征 基 函数 ， μ ∈ M , M 为 特征 基 函数 的 集合 ， 且 
 　 　 下面 引入 标称 模型 系统 ( 2 ) 重写 为 
 　 ( 3 ) 
 这里   其余  Δ B ( μ ( t ) ) ， Δ C ( μ ( t ) ) ， Δ D ( μ ( t ) ) ， Δ H ( μ ( t ) ) 的 表达式 与 Δ A ( μ ( t ) ) 类似 . 
 　 　 对于 系统 HM 的 建立 ， 包括 局部 区域 的 划分 、 基 函数 的 选取 、 子系统 结构 参见 文 ［ 4 ］ . 
 2.2   滚动 时域 H ∞ 控制策略 
 　 　 本文 选取 如下 的 滚动 时域 性能指标 ： 
 
 s . t 　 x ( t + T ) = 0 　 ( 4 ) 
 其中 λ > 0 ， Q ， R 均 为 正定 方阵 ， R 可逆 . x ( t + T ) = 0 为 滚动 时域 控制 的 终端 约束 项 ， ( 4 ) 式 中 后半部 分为 常用 的 min - max 干扰 衰减 性能指标 ， 前半部 分是 为 兼顾 系统 的 动态 响应 性能 而 设计 的 . 总的来说 它 意味着 在 每 一 时刻 t 要 找到 一个 稳定 的 控制 律 u ( τ ) ， τ ∈ ［ t , t + T ］ ， 使 系统 在 最坏 的 干扰 情况 下 性能 最优 ， 同时 只 将 u ( t ) 作为 实施 于 系统 的 控制 量 . 
 3   主要 结果 
 3.1   滚动 时域 H ∞ 控制 问题 的 最优 解 
 　 　 在 线性系统 滚动 时域 H ∞ 控制 基础 上 ［ 5 ］ ， 给出 系统 ( 2 ) 在 性能指标 ( 4 ) 下 的 最优 解和其 存在 的 充分性 条件 . 
 　 　 定理 1 .   如果 存在 正 实数 γ ， T ， λ ， 使 微分 Riccati 方程 
 　 ( 5 ) 
 边界条件 为 P ( t + T , t + T ) = 0 ， 存在 一致 有 界 对称 正定 阵 P ( τ , t + T ) , t ≤ τ ≤ t + T ， 并且 P ( t , t + T ) - 1 存在 且 一致 有 界 ， 则 系统 ( 2 ) 稳定 ， 且 干扰 衰减 增益 满足 相应 的 最优控制 律 u ( t ) = K ( μ ) x ( t ) = - ( λ R + I ) - 1BT ( μ ) P ( t , t + T ) - 1x ( t ) ， 其中 
 　 ( 6 ) 
 　 　 证明 . 沿用 文 ［ 5 ］ 的 证明 思路 ， 我们 同样 令 V = xT ( t ) P ( t , t + T ) - 1x ( t ) . 
 　 　 1 ) 首先 证明 系统 的 闭环 稳定性 ( w = 0 时 ) . 由 ( 5 ) 有 下式 成立 ： 
  
 P ( t + T , t + T ) = 0 保证 了 半 正定 ［ 5 ］ , 故上式 最后 一项 非正 . 并 注意 到 ( 6 ) 式 ， 有 
  
 对 V 求导 ， 并 将 上式 代入 ， 可 得到 
 
 因此 系统 闭环 渐近 稳定 . 
 　 　 2 ) 下面 考虑 闭环 系统 的 干扰 衰减 性质 . 由于 闭环 渐近 稳定 ， 对于 任意 初值 x ( t0 ) 和 w ∈ L2 ［ 0 , ∞ ) ， 有 x ( ∞ ) = 0 ， 于是 
  
 上式 中 ‖ . ‖ 为 L2 ［ t0 , ∞ ) 范数 ， 记令 x ( t0 ) = 0 ， 则 有 
 
 　 　 该 定理 表明 ， 只要 ( 5 ) 式 有 可行 解 ， 滚动 时域 H ∞ 控制 在 性能指标 ( 4 ) 式 下 的 最优控制 律 即可 由 ( 6 ) 式 得到 . ( 5 ) 式 虽然 形式 上 是 偏 微分方程 ， 但 其 第二个 参数 是 固定值 t + T ， 因此 完全 可以 同 微分方程 一样 数值积分 求解 . 然而 ， 在 计算 ( 5 ) 式 的 过程 中 ， 任一 时刻 t + τ 时 ， ( 5 ) 式 中 系数 A ( μ ) ， B ( μ ) ， H ( μ ) 皆 依赖于 x ( t + τ ) ， 而 x ( t + τ ) 又 依赖于 u ( t + τ ) ， 这样 就 形成 了 一个 迭代 过程 . 在 每 一 时刻 要求 解 u ( t ) ， 都 需要 许多 这样 的 迭代 过程 ， 计算 量 非常 大 . 
 　 　 于是 ， 本文 下面 的 工作 从 实际 可行性 出发 ， 试图 找寻 原 控制 问题 的 一个 满足 控制 性能 要求 的 次优 解 . 
 　 　 为此 ， 在 定理 1 基础 上 ， 首先 针对 系统 ( 3 ) 的 标称 模型 
 　 ( 7 ) 
 给出 下面 改进 的 充分性 条件 . 
 　 　 推论 1 .   对于 系统 ( 7 ) ， 如果 存在 正 实数 γ 和 T ， 使 下面 微分 Riccati 不等式 有解 ， 
  　 ( 8 ) 
 边界条件 P ( t + T , t + T ) = 0 ， P ( τ , t + T ) 性质 同 定理 1 ， 则 系统 ( 7 ) 稳定 ， 且 有 
 　 ( 9 ) 
 且 控制 律为 
 　 　 证明 . 证明 过程 可 参照 定理 1 ， 故略 . 
 　 　 推论 1 说明 将 定理 1 中 的 微分 Riccati 方程 ( 5 ) 放松 为 上述 Riccati 微分 不等式 ( 8 ) 后 ， 所 得到 的 控制 律 仍然 可以 实现 和 定理 1 的 最优控制 律 相同 的 控制 目的 . 
 3.2   滚动 时域 H ∞ 控制 问题 的 次优 解 
 　 　 首先 引入 下面 的 上界 概念 ［ 3 ］ 
 　 ( 10 ) 
 其中 M 为基 函数 的 集合 . ETE 即为 Δ A ( μ ) T Δ A ( μ ) 的 上界 . 寻求 上界 的 方法 可 参考 文 ［ 3 ］ . 类似 地 我们 可以 得到 B ( μ ) ( λ R + I ) - 1B ( μ ) T 的 下界 和 H ( μ ) H ( μ ) T 的 上界 . 分别 记 为 
 　 ( 11 ) 
 　 ( 12 ) 
 　 　 由文 ［ 3 , 4 ］ 可知 ， 由于 标准 基 函数 的 性质 ， 这里 得到 的 上 下界 都 是 与 状态 量 无关 的 常量 . 
 　 　 定理 2 .   对于 系统 ( 2 ) ， 如果 存在 正 实数 T ， γ ， ε ， δ ， 使 下面 微分 Riccati 方程 有解 ， 
   　 ( 13 ) 
 边界条件 P ( t + T ， t + T ) = 0 , P ( τ , t + T ) 性质 同 定理 1 ， 则 系统 ( 2 ) 稳定 ， 系统 性能 满足 式 ( 9 ) . 反馈 控制 律 形同 式 ( 6 ) . 
 　 　 证明 .   在 不 发生 混淆 的 情况 下 ， 下面 记 P ( τ , t + T ) 为 P . 将 ( 6 ) 式 代入 系统 ( 2 ) ， 得到 闭环 系统 . 
 　 　 1 ) 对于 闭环控制 系统 ， 令 Lyapunov 函数 V = xT ( t ) P ( t , t + T ) - 1x ( t ) . 
 　 ( 14 ) 
 利用 式 ( 10 ) ～ ( 12 ) ， 及 故 闭环 稳定 . 
 　 　 2 ) 由于 闭环 渐近 稳定 ， 对于 任意 初值 x ( t0 ) 和 w ∈ L2 ［ 0 , ∞ ) ， 有 x ( ∞ ) = 0 . 积分 式 ( 14 ) ， 计算 x ( t0 ) = 0 时 系统 的 干扰 衰减 增益 如下 ： 
  
 　 　 由 定理 2 可知 ， 在 t 时刻 ， 只要 根据 将来 有限 时域 ［ t , t + T ］ 内 Δ A ( μ ) T Δ A ( μ ) ， H ( μ ) H ( μ ) T 的 上界 和 B ( μ ) ( λ R + I ) - 1B ( μ ) T 的 下界 ， 以及 某一 恰当 的 ε ， δ ， 我们 就 可以 通过 积分 求解 ( 13 ) 式 ， 得到 当前 时刻 相对 性能指标 ( 4 ) 式 的 一个 次优 控制 律 u ( t ) ， 该 次优 控制 律 可以 保证系统 稳定 ， 且 干扰 增益 小于 γ . 
 　 　 当 优化 时域 长度 T → ∞ 时 ， 上述 滚动 时域 H ∞ 控制器 等价 于文 ［ 3 ］ 的 H ∞ 控制器 ， 而 这时 求解 控制器 需要 整个 时域 内 的 系统 参数 ， 由于 实际 系统 往往 有 许多 不 确定 和 不可 长期 预测 的 因素 ， 因此 ， 本文 提出 的 滚动 时域 H ∞ 控制器 具有 更强 的 实用性 . 
 　 　 类似 文 ［ 3 ］ 中 H ∞ 控制 律 的 算法 设计 ， 我们 同样 可以 给出 定理 2 中 控制 律 的 求解 过程 . 基本 思想 是 先 假定 ε 和 δ 的 值 ， 从 t + T 时刻 逆向 求解 ( 13 ) 式 ， 得到 P ( t , t + T ) . 若 P ( t , t + T ) 满足条件 ， 则 可求 出 u ( t ) . 否则 ， 依次 减小 ε 和 δ 的 值 ， 直到 找到 符合条件 的 解 . 
 4   结束语 
 　 　 本文 基于 HM 非线性 模型 ， 提出 并 研究 了 滚动 时域 H ∞ 控制器 的 设计 . 定理 1 给出 的 结论 是 基于 性能指标 的 H ∞ 最优控制 器 的 充分条件 . 为了 解决 求解 问题 ， 定理 2 给出 次优 控制器 及其 算法 . 该 控制器 可以 满足 系统 稳定 和 干扰 衰减 的 性能 要求 . 本文 研究 的 滚动 时域 H ∞ 控制器 结合 了 滚动 优化 的 预测 控制 和 H ∞ 控制 ， 因而 它 一方面 可以 依据 将来 有限 时段 的 系统 信息 在线 滚动 地 设计 控制 律 ， 克服 了 系统 信息 不可 长期 预测性 ， 另一方面 它 采用 H ∞ 性能指标 ， 在 设计 控制器 时 考虑 了 扰动 影响 ， 保证 了 干扰 衰减 增益 在 某 一 设定 范围 内 . 
 国家自然科学基金 重点项目 资助 ( 69934020 ) . 
 耿晓军   女 ， 1972 年生 . 1996 年于 西北工业大学 获工学 硕士 ， 现为 上海交通大学 自动化系 博士 研究生 . 主要 从事 非线性 预测 控制 的 研究 . 
 席裕庚   男 ， 1946 年生 . 1968 年 毕业 于 哈尔滨军事工程学院 ， 1984 年 在 德国 获工学 博士学位 ， 现为 上海交通大学 自动化系 教授 ， 博士生 导师 . 著有 动态 大 系统 方法 导论 ， 预测 控制 等 书 . 主要 从事 复杂 系统控制 理论 的 研究 . 目前 主要 研究 领域 是 复杂 工业 过程 的 优化 控制 及 智能 机器人 控制 . 
 耿晓军 ( 上海交通大学 自动化 研究所   200030 ) 
 席裕庚 ( 上海交通大学 自动化 研究所   200030 ) 
 参考文献 
 1 ， Kwon   W   H ,   A   E   Pearson .   A   modified   quadratic   cost   problem   and   feedback 
 stabilization   of   a   linear   system .   IEEE   Trans .   Autom .   Control , 1977 ， AC  22 ( 5 ) : 838 ～ 842 
 2 ， Mayne   D   Q ,   H   Michalska .   Receding   horizon   control   of   nonlinear   systems . IEEE   
 Trans .   Autom .   Contr . , 1990 ， AC  35 ( 7 ) ： 814 ～ 824 
 3 ， Feng   G ,   S   G   Cao ,   N   W   Ress .   An   approach   to   H ∞   control   of   nonlinear   systems . Automatica ,   1996 ， 32 ( 10 ) ： 1469 ～ 1474 
 4 ， Cao   S   G ,   G   Feng .   Modeling   of   complex   control   systems .   In : Proc . IFAC   NOLOCOS ' 95 
 , 1995 ： 935 ～ 938 
 5 ， Tadmor   G .   Receding   horizon   revisited : an   easy   way   to   robustly   stabilize   an   LTV 
 system . Systems   &   Control   Letters , 1992 ， 18 ： 285 ～ 294 
 收稿 日期   1998 - 06 - 19   收 修改稿 日期   1999 - 02 - 12 
