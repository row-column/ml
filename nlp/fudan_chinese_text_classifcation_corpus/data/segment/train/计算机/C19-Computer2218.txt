计算机 应用 研究 
 APPLICATION   RESEARCH   OF   COMPUTERS 
 2000   Vol.17   No.3   P.15 - 16 
 
 
 
 
 应用 神经网络 分类器 识别 手写 邮政编码 
 顾军捷 　 陈焱 
 摘 　 要 ： 介绍 了 神经网络 分类器 的 一般 原理 ， 提出 了 应用 神经网络 分类器 识别 手写 邮政编码 的 基本 方法 。 针对 手写 邮政编码 模式 内在 的 多样性 和 复杂性 ， 又 提出 一种 自 适应 树状 网络 模型 以 适应 复杂 数据 的 处理 。 
 关键词 ： 神经网络 分类器   识别   自 适应 树状 网络 模型 
 1 　 引言 
 　 　 准确 有效 地 自动识别 信封 上 的 邮政编码 ， 可以 提高 邮件 的 分组 投递 速度 ， 大大 节省时间 和 人力 ， 提高 邮政 服务质量 。 但是 ， 由于 各种各样 的 手写 字体 在 大小 、 位置 、 方向 、 风格 等 方面 存在 很大 的 差异 ， 包含 了 大量 的 模糊 信息 ， 很 难用 一套 确定 的 描述 或者 符号 来 定义 。 这 给 利用计算机 进行 模式识别 带来 了 非常 大 的 困难 。 
 　 　 近年来 发展 起来 的 人工神经网络 理论 ， 建立 了 一种 由 大量 处理单元 组成 的 非线性 大规模 自 适应 动力系统 [ 1 ] ， 具有 学习 能力 、 记忆 能力 、 计算能力 以及 智能 处理 功能 ， 并 在 不同 程度 和 层次 上 模仿 人脑 神经系统 的 信息处理 、 存储 及 检索 功能 。 基于 神经网络 的 分类器 与 传统 的 模式识别 方法 相比 ， 在 对 模糊 问题 或 模糊 数据 的 处理 中 表现 出 了 强大 的 适应能力 [ 2 ] ， 被 广泛应用 于 图象 纹理 分类 、 模糊控制 等 领域 。 在 此 ， 我们 提出 使用 神经网络 分类器 来 识别 手写 邮政编码 。 
 2 　 神经网络 的 基本原理 
 　 　 我们 先 介绍 一般 的 多层 感知机 ( MLP ) 网络 的 反传 ( BP ， Back   Propagation ) 算法 [ 3 ] ， 网络 基本 结构 见图 1 。 在 BP 网络 中 ， 训练 过程 包含 了 正向 传播 过程 和 反向 传播 过程 。 输入 信号 从 输入 层经 隐层 单元 逐层 处理 ， 并 传向 输出 层 。 如果 在 输出 层 得不到 期望 的 输出 ， 则 依靠 反向 传播 ， 将 误差 沿 原来 的 连接 通路 返回 ， 修改 各层 神经元 的 权值 ， 采用 误差 梯度 下降 的 方法 , 使 误差 信号 最小 。 
 
 图 1 　 神经网络 的 基本 模型 
 　 　 下面 给出 训练 神经网络 训练 过程 的 一般 算法 。 
 　 　 设 神经元 输出 函数 
 
 其中 θ ( 为 阈值 参数 。 
 　 　 Step1 .   初始化 权值 系数 、 阈值 为 小 的 随机数 ， 给定 迭代 结束 参数 ε 。 
 　 　 Step2 .   提供 样本 矢量 ＝ （ x1 ， … ， xN ） , 通过 f ( x ) 计算 出 网络 输出 矢量 ＝ （ y1 ， … ， yM ） 。 
 　 　 Step3 .   输入 导师 信号 ＝ （ d1 ， … ， dM ） , 并 反传 改变 权 参数 的 值 
 wij ( t + 1 ) ＝ wji ( t ) + η δ jx ' i + α ( wji ( t ) - wji ( t - 1 ) ) 
 其中 ， ( 为 学习 因子 ( Gain   term ) ， α 为 动量 因子 ( Momentum   term ) ； x ＇ i 为 i 单元 所在 层 的 输出 ； δ j 为 j 单元 的 误差 因子 。 
 　 　 ( i )   如果 j 单元 是 输出 单元 ， 那么 
 δ j = yj ( 1 - yj ) ( dj - yj ) 
 　 　 ( ii )   如果 j 单元 是 隐 单元 ， 则 
 
 　 　 k 取 所有 j 所 连接 的 上层 单元 。 
 　 　 Step4 .   当 误差 | | δ output | | < ε 时 ， 结束 迭代 ， 退出 训练 ， 否则 ， 转 Step2 。 
 3 　 应用 神经网络 分类器 识别 手写 邮政编码 
 　 　 采用 神经网络 的 方法 识别 手写 邮政编码 ， 分为 两个 步骤 ： 第一步 ， 使用 手写 数字 样本 集 训练 网络 。 首先 将 样本 进行 数字化 处理 ， 将 其 转化成 二值 的 图形 矢量 ， 以 7 × 7 为例 ， 见图 2 。 然后 将 数字化 后 的 图形 矢量 输入 网络 ， 输入 层 49 个 结点 ， 输出 层 10 个 结点 ， 分别 代表 0 ～ 9 这 10 个 类别 ， 隐含 层 可以 取 20 ～ 25 个 结点 。 用 BP 算法 训练 直至 误差 收敛 ， 具体方法 如下 ： 图形 矢量 输入 网络 ， 其 导师 信号 ( 或 称为 期望 输出 ) 在 其 对应 的 结点 处为 1.0 ， 其余 结点 均 为 0 。 每 一轮 训练 结束 后 计算 实际 输出 与 期望 输出 之间 的 误差 ， 如 小于 规定 的 门限 ， 则 训练 结束 ， 否则 ， 继续 训练 。 
 
 图 2 　 手写 字体 与 数字化 后 的 图形 矢量 
 　 　 第二步 ， 用 训练 好 的 网络 来 识别 手写 邮政编码 。 网络 的 输入 为 待 识别 的 手写 邮政编码 经过 数字化 后 得到 的 图形 矢量 。 输入 数据 经过 网络 的 正向 传输 在 输出 层 得到 输出 。 选取 输出 层 10 个 结点 中 数值 最大 的 结点 ， 我们 将 其 判决 为 该 编码 所属 类别 。 
 　 　 采用 基本 BP 网络 分类器 在 对手 写 邮政编码 识别 的 具体 实现 时 , 经常 会 遇到 一些 预料不到 的 复杂 情况 。 例如 ， 不少 人 在 书写 “ 7 ” 的 时候 ， 习惯于 加上 一短划 ， 见图 3 。 这种 情况 大大增加 了 数字 模式 的 复杂性 ， 使 各类 模式 的 分布 扩散 ， 类内 方差 增大 ， 容易 引起 模式 相近 类别 的 误判 。 
 
 图 3 　 一种 容易 与 “ 2 ” 引起 混淆 的 手写体 “ 7 ” 
 　 　 为了 解决 这个 问题 ， 增强 网络 对于 复杂 数据 的 识别 能力 ， 我们 对 基本 BP 网络 分类器 进行 了 改进 ， 提出 一种 自 适应 树状 网络 模型 。 
 　 　 我们 先对 训练样本 进行 一次 预处理 。 首先 计算 一下 各类 数字 内部 各种 模式 分布 的 分散 情况 ， 在 此 我们 利用 方差 来 表达 一个 分散度 的 概念 。 
 
 其中 i 为 类别 号 ， x 为 图象 矢量 ， mij 为 均值 。 
 　 　 显然 ， D 越大 ， 各种 模式 的 分布 越 分散 。 如果 分散 度过 大 ， 说明 该类 数字 模式 较 多 较 复杂 ， 需要 进一步 地 分类 。 按照 某种 法则 将 其 分为 若干类 之后 ， 重新 计算 各小类 的 分散度 ， 再 判断 是否 需要 进一步 分类 ， 直至 将 这 一大 类 分离 出 若干 相对 较为 单纯 的 模式 为止 。 
 　 　 仍 以 “ 7 ” 为例 。 首先 计算 类号 为 7 的 样本 的 均值 m 和 方差 D ， 由于 D > T ( T 为 设定 的 门限 ) ， 故 进行 一次 类内 的 细分 ； 按 比例 减小 T ， 对分 出来 的 两小类 重新 计算 均值 和 方差 ， 进行 再 一次 的 细分 。 假定 这样 直至 最后 分出 7 ( I ) ,   7 ( II ) ,   7 ( III ) 三类 ， 见图 4 。 
 
 图 4 　 自 适应 分类 的 树状 结构 
 　 　 对 其它 数字 的 类别 也 进行 同样 的 处理 。 这样 ， 通过 树状 的 自 适应 预 分类器 ， 我们 就 得到 分布 比 原来 的 10 个大类 更 精细 的 若干个 小类 ， 记为 I ( j ) ,   I { 0 ... 9 } ,   j { I ,   II ,   III , ... } 。 用 它们 代替 上 文中 基本 BP 网络 分类器 输出 层 的 10 个 结点 ， 然后 采用 同样 的 方法 训练 网络 直至 收敛 。 
 
 图 5 　 改进 的 识别 手写 邮政编码 的 神经网络 分类器 模型 
 　 　 用 训练 好 的 网络 对手 写 邮政编码 数据 进行 识别 ， 分类器 输出 类别 号 I ( j ) ,   I { 0 ... 9 } ,   j { I ,   II ,   III , ... } 。 将 所有 的 I ( j ) 类 ( j { I ,   II ,   III , ... } ) 归为 第 I 类 ， 即 得到 最后 的 判决 结果 。 
 4 　 结论 与 讨论 
 　 　 神经网络 分类器 对 模糊 数据 的 强大 处理 能力 ， 使 自动 准确 地 识别 手写 邮政编码 成为 可能 。 本文 提出 的 自 适应 树状 网络 模型 ， 提供 了 一种 进一步提高 识别 精度 的 有效途径 。 关于 系统 的 实现 ， 还有 若干 具体 问题 值得 探讨 ： 
 　 　 1 )   基于 BP 网络 分类器 在 对手 写 邮政编码 识别 的 具体 实现 时 ， 由于 输入 结点 数据量 较大 ， 所以 存在 着 网络 复杂 、 训练 时间 较长 的 缺点 。 为了 解决 这个 问题 ， 我们 认为 有 必要 对 输入 层 的 图形 矢量 进行 一些 分块 处理 ， 以 加快 训练 速度 。 
 　 　 2 )   面向对象 的 程序设计 方法 ( OOP ) 同 神经元 以及 树状 网络 模型 存在 着 内在 一致性 ， 可以 方便 地 进行 建立 、 合并 、 删除 网络 结点 等 处理 。 从 理论 上 支持 动态 拓扑 结构 ， 为 神经网络 分类器 的 编程 提供 了 一个 很 好 的 解决方案 。 
 顾军捷 ( 中国 科学技术 大学 电子 工程 与 信息 科学系   信息处理 中心   合肥   230027 )   
 陈焱   ( 中国 科学技术 大学 电子 工程 与 信息 科学系   信息处理 中心   合肥   230027 )   
 参考文献 
 1   史忠植 .   神经计算 .   北京 ： 电子 工业 出版社 ,   1993 
 2   Massimo   MeneGanti ,   Francesco   S .   Saviello ,   and   Roherto   Tagliaferri .   Fuzzy   Neural   Networks   for   Classification   and   Detection   of   Anomalies .   IEEE   Trans .   Neural   Networks ,   1998 ,   9 ( 5 ) :   848 ～ 861 
 3   中国 科学技术 大学 生物医学 工程 跨系 委员会 .   神经网络 及其 应用 .   合肥 ： 中国 科学技术 大学 出版社 ,   1992 
 4   Claus   Neubauer .   Evaluation   of   Convolutional   Neural   Networks   for   Visual   Recognition .   IEEE   Trans .   Neural   Networks ,   1998 ,   9 ( 4 ) :   685 ～ 695 
 收稿 日期 ： 1999 年 9 月 13 日 
