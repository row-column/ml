　 宇航学 报 
 JOURNAL   OF   ASTRONAUTICS 
 1999 年   第 20 卷   第 3 期   vol.20   No.3   1999 
 
 
 
 　 　 用 标定 和 亚 像素 技术 
 实现 三维 运动 目标 的 高精度 测量 
 于 起峰 　 孙祥 一 　 权 铁汉 　 雷志辉 
 　 　 摘 　 要 　 本文 介绍 一种 利用 多种 亚 像素 图像 技术 提取 目标 及 网格 节点 ， 并 采用 新 的 摄影 系统 标定 与 系统误差 修正 技术 ， 用 多个 摄像机 实现 对 有 特殊 标志 的 空间 三维 运动 目标 的 高精度 测量方法 。 
 　 　 主题词 　 亚 像素 　 三维 测量 　 模式识别 　 数字图像 　 自动 匹配 
 ACCURATE   MEASUREMENT   OF   A   3D   MOVING   
 OBJECT   THROUGH   CALIBRATION   
 AND   SUBPIXEL   TECHNIQUES 
 Yu   Qifeng   Sun   Xiangyi   Zhang   Dongsheng   Quan   Tiehan   Lei   Zhihui 
 ( Dept . of   Aerospace   Engineering , National   Univ . of   Defense   Tech . , 
 Changsha , Hunan , P . R   China   410073 ) 
 　 　 Abstract 　 A   high   accuracy   measurement   method   for   a   3D   moving   object   with   specified   marks   is   presented   in   this   paper . Several   subpixel   image   processing   algorithms   are   used   to   derive   the   object   position   and   grating   intersections . A   new   camera   calibration   and   correction   method   is   introduced   and   used . With   these   techniques , the   3D   movement   of   objects   is   measured   accurately   with   multicamera   system . 
 　 　 Key   words 　 Subpixel   3D   measurement   Pattern   recognition   Digital   image   Automate   matching 
 　 　 1 　 引言 
 　 　 运动 目标 的 三维 运动 参数 测量 具有 重要 的 意义 。 例如 航空 、 航天器 运动 分析 ， 地面 机动 目标 试验 碰撞 运动 分析 ， 及 飞行员 弹射 着陆 冲击 运动 分析 等 。 这 类 问题 通常 是 用 高速摄影机 或 摄像机 将 运动 过程 记录下来 ， 然后 对 胶片 或 录像带 进行 后处理 分析 得到 结果 。 目前 国内 这 类 后处理 工作 主要 是 用 手动 和 半自动 方法 完成 ， 并 主要 限于 二维 运动 测量 。 同时 由于 测量 系统 的 硬件 分辨率 有限 ， 摄影 系统 存在 系统误差 等 因素 ， 使得 测量 结果 ， 尤其 是 三维 运动 的 结果 精度 较差 。 
 　 　 要 实现 运动 目标 三维 运动 参数 的 高精度 测量 ， 首先 必须 对 目标 实现 高精度 三维 定位 。 利用 多台 像机 空间 三角 交汇 原理 进行 三维 位置 测量 中 ， 精确 标定 出像 机系统 的 内外 参数 和 精确测量 目标 在 各像机 图象 上 的 位置 ， 是 提高 测量 精度 的 两个 关键问题 。 在 图象 目标 精确定位 上 ， 许多 研究者 提出 了 各种 亚 象素 精度 定位 技术 。 例如 国际 上 对 某些 图像 特征 点 的 定位精度 可 优于 1% 个 像素点 。 然而 各种 图像 必须 通过 光学 成像 系统 才能 得到 ， 各种 非 针孔 形 的 实际 光学系统 都 存在 系统误差 或 像 差 。 对于 普通 镜头 ， 其 误差 在 图像 周边 可 达 几个 像素点 。 在 这种 数字图像 上 ， 亚 像素 处理 技术 失去 了 意义 。 要 提高 摄影 测量 精度 ， 必须 首先 消除 或 修正 摄影 系统 的 系统误差 。 
 　 　 本文 针对 上述 问题 ， 提出 了 测量 摄影 系统 内外 系统 参数 的 标定 方法 ， 并 较 全面 地 修正 摄影 系统 的 系统 像 差 。 同时 提出 两种 亚 像素 技术 ， 高精度 地 提取 标定 用 的 网格 节点 和 运动 目标 上 的 特殊 圆 标志点 。 对 目标 上 有 多个 标志点 的 情况 ， 提出 了 对 不同 摄影机 图像 上 的 标志点 进行 自动 匹配 的 方法 ， 利用 三角测量 原理 确定 目标 三维空间 位置 。 最后 介绍 对 图象 序列 中 运动 目标 的 自动 跟踪 匹配 。 形成 一套 较完整 的 三维 运动 精密 测量 图像 分析 系统 。 
 　 　 2 　 摄影 系统 的 标定 与 修正 
 　 　 根据 被测 对象 在 图像 中 的 位置 确定 其 空间 位置 ， 摄像机 系统 参数 必须 已知 ， 而 摄像机 镜头 一般 都 由 复合 透镜 组成 ， 系统 参数 必须 通过 标定 才能 精确 得到 。 一般 摄影 系统 包含 十个 标定 参数 ： 光 心 空间 位置 ( Tx , Ty , Tz ) ， 光轴 方向 矢量 ( α ， β ， γ ) ， 有效 焦距 ( F ) ， 图像 中心 ( X0 ， Y0 ) ， 图像 纵横 比 ( Sx ) 。 成像 系统 通常 有 系统 畸变 像 差 ， 如图 1 所示 ： 
 
 图 1 　 
 　 　 对于 精密 测量 ， 这些 系统 畸变 必须 进行 修正 。 目前 国际 上 较 多 采用 Tsai 提出 的 一种 简便 实用 的 模型 ， 万能 标定 修正 模型 ［ 1 ］ 。 对 该 模型 进行 求解 ， 可 同时 得到 摄影 系统 的 内外 系统 参数 和 消除 对应 轴对称 系统 像 差 。 该 方法 求解 外部 参数 时 不须 迭代 ， 速度 较 快 ； 但 该 模型 没 考虑 非对称 系统 像 差 ， 轴对称 像 差 考虑 也 不 全面 。 因而 不能 满足 高精度 的 测量 要求 。 
 　 　 针对 Tsai 方法 的 不足 ， 我们 采用 自己 提出 的 一种 同时 考虑 多种 轴对称 像 差 和 非对称 像 差 的 模型 ： 
 　 　 
 　 　 
 　 　 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 1 ) 
 其中 　 xw , yw , zw 是 物点 的 空间 坐标 ， ， 是 含 像 差 的 像 点 坐标 ， k0 , k1 , k2 , k3 分别 为 多种 轴对称 像 差 修正 系数 ， k4 , k5 , k6 , k7 为 多种 非 轴对称 像 差 修正 系数 ， F 为 有效 焦距 ， Tx , Ty , Tz 为 光心 空间 坐标 ， r 为 坐标 旋转 矩阵 系数 。 
 　 　 在 标定 过程 中 ， 我们 把 一个 精确 的 正交 网格 放置 于待测 目标 的 大致相同 位置 处 ， 如图 2 所示 。 然后 采用 相关 滤波 和 线 跟踪 算法 提取 图像 上 的 网格 结点 ［ 3 ］ ： 运用 标准 的 线 相交 模板 对 初选 的 网格 结点 区域 进行 相关 匹配 ， 再 对 相关系数 进行 曲面 拟合 ， 取 相关系数 极大 点处 为 所求 的 网格 结点 位置 。 该 提取 方法 的 精度 可 达到 0.1 亚 像素 精度 。 
 
 图 2 
 　 　 已知 了 网格 结点 的 实际 空间 位置 和 其 图象 位置 ， 就 可 对 ( 1 ) 式 求解 。 该 方程 参数 较 多 ， 我们 用 一种 三步 隔离 标定 法 进行 了 巧妙 的 求解 。 求解 步骤 如下 ： ( 1 ) 用亚 像素 方法 提取 网格 的 结点 后 ， 假设 中心 部分 结点 像 差 很小 ， 先 以 这部分 结点 拟合 一 近似 无 误差 的 网格 像场 。 在 无 像 差 的 情况 下 ， 空间 面内 的 正方形 网格 的 图像 ， 应是 两 簇共点 的 直线 ( 线 平行 时交于 无穷 远处 ) 。 ( 2 ) 根据 拟合 出 的 无 误差 网格 图象 场 与 空间 实际 网格 的 关系 进行 求解 ， 由此 可解 得 摄像机 的 内外部 参数 。 ( 3 ) 根据 拟合 出来 的 网格 场 与 用亚 像素 方法 提取 出来 的 对应 图像 结点 值之差 对系统 像 差 修正 系数 进行 求解 。 这 一步 的 求解 只 需解 一 线性 的 方程组 。 
 　 　 用 以上 方法 求解 ， 避免 了 求解 多 参数 非 线性方程组 的 情况 ， 得到 了 摄像机 的 系统 参数 与 镜头 误差 修正 系数 ， 从而 可 建立 图像 坐标 与 空间 坐标 的 对应 关系 。 实践证明 该 方法 确实 可行 且 有效 。 
 　 　 3 　 目标 的 亚 像素 精度 提取 
 　 为了 精确测量 目标 的 三维空间 位置 ， 我们 采用 多种 亚 像素 技术 来 提取 目标 的 图像 位置 。 首先 用 一些 特征 标志 对 目标 进行 标记 。 在 我们 的 测量 中 一般 采用 如图 3 所示 的 圆形 特征 点 。 对 这种 圆 特点 ， 我们 研究 了 三种 自动 提取 方法 ： 灰度 差法 、 模板 相关 法 与 圆 边缘 提取 法 。 
 
 图 3 
 　 　 对于 灰度 差法 ， 识别 判据 为 在 两倍 特征 点 尺寸 的 窗口 内 ， 计算 十字 交叉 线上 中央 与 边缘 像素 的 灰度 差值 ， 该 灰度 差 大于 某一值 时 ， 说明 存在 一圆 标志点 ， 再 采用 灰度 重心 算法 计算 标志 中心 ， 可 达到 亚 像素 精度 。 该 方法 计算 简单 ， 对于 图 的 质量 较差 ， 图像 模糊 的 情况 比较 有效 。 不足之处 是 光照 变化 对 灰度 分布 的 影响 较大 。 
 　 　 模板 相关 法 采用 圆 特征 的 理想 模板 对 搜索 区域 进行 相关 匹配 ， 以 相关系数 作为 判据 ， 对 相关系数 进行 二维 曲面 拟合 ， 取 极值 点为 目标 点 ， 可 达到 0.1 亚 像素 精度 。 该 方法 对 灰度 分布 变化 较大 的 目标 有 较 高 的 精度 ， 但 处理 运算量 大 ， 对 有 平台 的 特征 点 提取 精度 降低 。 
 　 　 圆 边缘 提取 法在 全场 搜索 具有 圆 特征 的 点 ， 此 方法 抗 光照 不均 的 能力 强 ， 对于 对比度 较 好 的 图像 有 很 高 的 可靠 度 。 具体 处理过程 为 ： ( 1 ) 对 图像 进行 增强 。 ( 2 ) 锐化 图像 边缘 ， 并用 适当 的 门限 将 图像 进行 二值化 ， 得到 目标 的 边缘 。 ( 3 ) 对二值化 图像 进行 闭合 边缘 的 外 边界 跟踪 ， 得到 目标 的 周长 ， 若此 周长 的 平方 与 区域 的 面积 之 比 接近 为 4 π ， 则 可 判断 该 区域 近似 为 圆形 。 再 利用 面积 除以 半个 周长 ， 可 得 等效 半径 ， 若 它 与 特征 点 尺寸 相近 则 可 判断 该处 存在 特征 标志点 。 ( 4 ) 最后 对 该 圆 区域 求 质心 即得 特征 点 在 图像 上 的 亚 像素 坐标 。 运用 相关 滤波 方法 可 进一步提高 其亚 像素 精度 。 当圆 特征 区 直径 大于 5 ～ 6 个 像素 时 ， 其 精度 可 优于 0.2 个亚 像素 。 
 　 　 利用 上述 模式识别 方法 和 亚 像素 定位 方法 ， 我们 实现 了 在 图象 上 对 圆 特征 标志点 的 自动识别 与 精确定位 。 
 　 　 4 　 特征 点 的 自动 匹配 
 　 　 通常 测量 物体 上 有 多个 标记 点 ， 它们 在 各个 摄像机 的 摄影 图像 中 的 相对 位置 并不一定 一致 ， 如图 5 、 6 的 实验 。 因此 求解 空间 三维 位置 必须 首先 对 各 图像 间 不同 特征 点 进行 匹配 。 采用 手工 匹配 的 方法 非常 烦琐 。 我们 提出 如下 自动 匹配 方法 。 
 　 　 三维 摄影 测量 原理 可 简单 表示 如图 4 ， 根据 各 摄影 图像 上 的 对应 目标 点 与 标定 的 摄像机 参数 得到 一条 通过 像 点 与 光心 的 直线 ， 这些 直线 将 相交 于物点 处 。 实际 测量 中 ， 由于 标定 及 像 点 的 提取 精度 总是 有限 ， 直线 并 不 恰好 交于 物点 ， 通常 存在 一 差值 。 实测 中 我们 取 到 这些 直线 距离 和 为 最小 的 点 作为 物点 的 测量 位置 ， 而取 测量 的 物点 到 各 直线 最小 距离 和 表示 测量误差 。 那么 我们 可用 最小 误差 原则 进行 匹配 ， 即 计算 所有 可能 图像 特征 点 组合 的 测量误差 ， 具有 最小 测量误差 的 特征 点 组合 即 为 匹配 正确 的 特征 点组 。 这样 就 很 方便 地 实现 了 各 图像 特征 点 的 自动 匹配 。 
 
 图 4 
 　 　 5 　 对 图象 序列 中 运动 目标 的 自动 跟踪 
 　 　 对 静止 的 目标 实现 三维空间 精确定位 后 ， 我们 可 进一步 实现 对 图象 序列 中 运动 目标 的 三维 运动 精密 测量 。 首先 要 对 各 目标 点 进行 自动 跟踪 匹配 。 利用 目标 运动 是 连续 的 假设 ， 即 相邻 两幅 图 之间 同一 目标 的 位移 较 小 ， 用 前述 提取 标志点 的 三种 方法 ： 相关 滤波 法 、 灰度 差法 和 圆 边界 求 圆心 法 ， 可 直接 对 目标 进行 跟踪 匹配 。 
 　 　 用 相关 滤波 法 ， 将 前 一幅 图 的 目标区 作为 相关 模板 ， 并 在 前 一幅 图 目标 位置 的 一个 邻域 对后 一幅 图 进行 相关 运算 ， 然后 对 相关系数 作 二次曲面 拟合 ， 取 拟合 曲面 的 极值 点 作为 后 一幅 图 的 目标 位置 ， 从而 实现目标 的 自动 跟踪 。 该 方法 对 有 任意 明显 灰度 变化 的 特征 点 都 能 实现 自动 跟踪 。 
 　 　 用 灰度 差法 判别 求 灰度 重心 或 圆 边界 求 圆心 法 ， 以前 一幅 图 目标 位置 的 一个 邻域 对后 一幅 图 寻找 圆形 标志 ， 并 将 圆 标志 定位 。 根据 前述 连续 运动 假设 ， 确定 该 最近 距离 标志点 即 实现 了 对 圆 标志 目标 的 自动 跟踪 。 
 　 　 分别 用 上述 方法 对 不同 相机 的 图象 序列 中 的 目标 进行 跟踪 ， 然后 用 上述 最小 交会 误差 准则 对 同一 时刻 不同 相机 图象 中 的 目标 点 进行 匹配 ， 最后 将 各 匹配 的 目标 点组 进行 空间 三角 交会 ， 得 空间 三维 位置 ， 对 整个 图象 序列 重复 此 工作 即可 得到 目标 的 三维 运动 轨迹 。 考虑 图象 序列 间 的 时间 间隔 ， 可 得到 三维 运动 速度 、 加速度 等 参数 。 
 　 　 6 　 实验 与 结论 
 　 　 为了 检验 上述 方法 ， 我们 进行 如下 验证 实验 ： 将 标定 网格 置于 水平 平台 上 ， 用 两个 摄像机 从 不同 角度 分别 进行 摄影 标定 与 系统误差 修正 。 然后 将标 定量 柱 放置 到 网格 上 ， 量柱 的 端 面上 贴 有 标记 点 ， 再次 用 两 摄像机 进行 摄影 ， 如图 5 、 6 所示 。 
 
 图 5 
 
 图 6 
 　 　 运用 前述 的 方法 ， 对 各 圆圈 特征 目标 点 进行 自动 提取 与 自动 匹配 ， 并用 标定 与 系统 修正 参数 得到 各 目标 的 空间 三维 坐标 。 实验 结果 如表 1 所示 ( 表中 列出 了 误差 较大 的 Z 坐标 测量 值 ) 。 表 1 的 数据 说明 该 方法 测量 精度 可 达到 0.25 毫米 ， 换算 到 实际 图像 像素 坐标 ， 整个 系统 测量 可达 0.2 亚 像素 精度 。 
 表 1 　 Z 方向 的 实验 结果 值 ( 按 高低 排序 ) 
 
 序号 12345 
 实验 值 ( mm ) 40.5130 . 3725.2420 . 2115.25 
 真 　 值 ( mm ) 40.2630 . 2025.2020 . 2015.20 
 误 　 差 ( mm ) 0.250 . 170.040 . 010.05 
 
 　 　 用 上述 方法 对 图像 序列 中 各 时刻 对应 图像 上 的 目标 进行 测量 ， 然后 将 各 时刻 目标 三维 位置 与 时间 序列 结合 ， 就 得到 了 三维 运动 目标 的 运动 参数 。 
 　 　 由此可见 ， 我们 的 三维 测量 系统 ， 由于 亚 像素 技术 、 镜头 误差 修正 技术 及 特征 点 自动 提取 与 匹配 技术 的 运用 ， 实现 了 高精度 的 三维空间 自动 测量 ， 并 已 成功 实用 于 记录 飞行员 着陆 冲击 运动 的 高速 胶片 自动 分析 。 
 作者 单位 ： 国防科技大学 航天技术 系 . 长沙 . 410073 
 参考文献 
 　 　 1 　 Tsai   R   Y . A   versatile   camera   calibration   technique   for   high - accuracy   3D   machine   vision   metrology   using   off - the - shelf   TV   camera   and   lenses . IEEE   J . of   Robotics   and   Automation , vol . Ra - 3 ( 4 ) : 323 - 334 , 8 ( 1987 ) . 
 　 　 2 　 Weng   J . Camera   Calibration   with   Distortion   Models   and   Accuracy   Evaluation . IEEE   Trans . Patt . Anal . Machine   Intell . , 1992 , 14 ( 10 )   OCT 
 　 　 3 　 雷志辉 ， 于 起峰 . 亚 像素 图像处理 技术 及其 在 网格法 中 的 应用 . 国防科 大学 报 ， 1996 ， 18 ( 4 ) 
 收稿 日期 : 1997 年 7 月 7 日 , 修回 日期 : 1998 年 1 月 8 日 
