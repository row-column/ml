宇   航   学   报 
 JOURNAL   OF   ASTRONAUTICS 
 1998 年     第 3 期       No.3   May       1998 
 科技期刊 
 　 　 用于 飞行器 导航 的 边缘 匹配 
 方法 研究 
 
 丁明跃 　 吴 　 晏 　 彭嘉雄 
 ( 华中理工大学 * 武汉 * 430074 ) 
 　 　 摘 　 要 　 地图 匹配 制导 由于 具有 良好 的 自主性 而 成为 飞行器 导航 的 一种 重要 方式 。 本文 首先 从 飞行器 导航 的 应用 出发 , 对于 可 用于 地图 匹配 制导 的 匹配 方法 的 特点 进行 了 分析 ; 然后 , 提出 了 一种 基于 二值 边缘 新 的 匹配 度量 , 并 给出 了 基于 距离 变换 的 边缘 二值 图像匹配 方法 ; 通过 采用 航片 与 卫片 、 可见光 图像 与 合成孔径雷达 图像 等 所 进行 的 大量 实验 , 结果表明 本文 所 提出 的 方法 比 常用 的 平均 绝对 算法 和 归一化 互相 关 算法 速度 更 快 、 匹配 定位精度 更高 。 
 　 　 主题词 　 边缘 匹配 　 飞行器 导航 　 距离 变换 
 STUDY   OF   EDGE   MATCHING   APPROACH   
 TO   AIRCRAFT   NAVIGATION 
 
 Ding   Mingyue 　 Wu   Yan 　 Peng   Jiaxiong 
 ( Huazhong   University   of   Science   and   Technology * Wuhan * 430074 ) 
 　 　 Abstract 　 Map   matching   becomes   an   important   means   of   aircraft   navigation   due   to   its   high   autonomousness . In   this   paper , beginning   from   the   consideration   of   the   application   of   aircraft   navigation , the   characteristics   of   matching   approaches   which   can   be   used   to   map   matching   guidance   are   analyzed . Then , a   new   matching   measure   based   on   binary   edges   is   proposed   and   a   new   natching   method   based   on   Distance   Transform   is   given . After   a   lot   of   experiments   using   aerial   and   satellite   photographs   as   well   as   optical   and   SAR   images , it   is   demonstrated   that   the   method   proposed   in   this   paper   is   much   better   than   the   common   used   correlation   algorithms , such   as   MAD   algorithm   and   Normalized   Cross   Correlation   algorithm   in   speed   and   registration   accuracy . 
 　 　 Key   words 　 Edge   matching 　 Aircraft   navigation 　 Distance   transform 
 1 　 引 　 言 
 　 　 图像匹配 ( 也 称之为 图像 配准 ) 是 图像处理 的 一项 关键技术 ［ 1 ］ , 可 广泛 用于 目标 识别 与 跟踪 、 立体 视觉 、 变化检测 、 测绘 等 领域 。 随着 计算机技术 的 不断 发展 , 特别 是 速度 更 快 、 价格 更 低 处理 芯片 的 问世 , 图像匹配 速度 大大提高 , 从而 使 其 在 飞行器 导航 与 控制 等 实时性 要求 很 高 的 领域 也 得到 了 广泛应用 。 与 传统 的 惯性导航 、 无线电 导航 等 方式 比较 , 地图 匹配 制导 具有 自主性 强 、 制导 精度 高等 优点 , 因此 受到 人们 的 高度重视 。 
 　 　 与 一般 的 图像匹配 应用 不同 , 飞行器 导航 地图 匹配 具有 以下 特点 : 
 　 　 1 ) 实时性 强 、 存储量 小 。 由于 整个 地图 匹配 相关器 将 安装 在 飞行器 上 , 因此 它 对于 体积 、 重量 等 都 有 一定 的 要求 。 同时 由于 飞行器 速度 快 , 因此 要求 它 实时 完成 匹配 , 并 能够 及时 提供 所 需要 的 导航 信息 。 
 　 　 2 ) 对于 场景 适应性 强 。 作为 一种 导航 方式 , 要求 它 能够 在 不同 的 地点 、 时间 等 条件 下 正常 工作 。 因此 要求 它 能够 在 不同 类型 的 场景 , 如 山区 、 平原 、 丘陵 , 以及 不同 特征 的 场景 , 如 农田 、 道路 、 村庄 、 街道 、 湖泊 、 森林 等 , 均 具有 良好 的 匹配 性能 。 
 　 　 3 ) 基准 图像 与 实测 图像 之间 不仅 在 灰度 上 , 而且 在 特征 上 ( 如 边缘 、 拐点 等 ) 存在 差异 。 这种 差异 来源于 不同 传感器 的 成像 特性 , 成像 距离 的 变化 以及 视点 的 变化 等 ［ 2 ］ 。 因此 , 它 是 一种 所谓 的 不 相似 图像匹配 ( dissimilar   image   matching ) 问题 ( 见 文献 ［ 3 ］ ) 。 
 　 　 目前 在 飞行器 导航 中 所 采用 的 算法 主要 有 平均 绝对 差 算法 和 归一化 互相 关 算法 。 然而 , 这 类 相关 算法 主要 基于 图像 灰度 的 相似性 , 所 存在 的 主要 问题 是 对于 噪声 及 各种 干扰 十分 敏感 , 因此 其 匹配 定位精度 和 可靠性 难以 保证 。 近年来 , 人们 为了 解决 这一 问题 也 提出 了 许多 不同 的 匹配 方法 ［ 4 - 6 ］ , 但 主要 是 针对 测绘 中 图像 的 对准 问题 而 提出 来 的 , 不能 满足 飞行器 导航 中 实际 应用 的 需要 。 
 　 　 本文 从 在 正确 匹配 点 , 实测 图像 与 窗口 图像 的 像素 重合 和 基本 重合 的 比例 最大 这一 基本 思想 出发 , 提出 了 一种 基于 二值 边缘 新 的 匹配 度量 , 并 讨论 了 该 定义 的 有关 性质 。 同时 与 距离 变换 相结合 , 给出 了 一种 可 用于 飞行器 导航 的 匹配 方法 。 实验 结果表明 , 本文 所 提出 的 匹配 方法 无论 在 匹配 速度 还是 在 匹配 精度 上均 优于 常用 的 平均 绝对 差 算法 和 归一化 互相 关 算法 。 
 2 　 基于 边缘 的 匹配 度量 
 2.1 　 基本 定义 
 　 　 对于 实测 图像 和 基准 图像 , 经过 边缘 检测 和 分割 预处理 可以 获得 边缘 的 二值 图像 。 基于 二值 边缘 图像 的 匹配 被 证明 是 飞行器 导航 的 一种 有效 的 方法 , 例如 在 美国 的 战斧 式 巡航导弹 上 所 采用 的 DSMAC 景象 相关器 就 属于 这一 方式 。 为了 便于 引入 新 的 二值 图像匹配 度量 , 首先 给出 以下 的 基本 定义 : 
 　 　 定义 2.1 　 实测 图像 集合 A : 在 实测 图像 中 所有 边缘 点 所 组成 的 集合 被 称之为 实测 图像 集合 , 用 大写字母 A 表示 : 
 　 　 定义 2.2 　 窗口 图像 集合 B ( i , j ) : 在 基准 图像 ( i , j ) 处 的 窗口 图像 中 所有 边缘 点 所 组成 的 集合 被 称之为 窗口 图像 集合 , 用 B ( i , j ) 表示 。 
 　 　 定义 2.3 　 重合 : 当 集合 A 中一 元素 a 与 集合 B 中一 元素 b 有 ‖ a - b ‖ = 0 , 则 称 a 与 b 重合 。 
 　 　 定义 2.4 　 基本 重合 : 当 集合 A 中一 元素 a 与 集合 B 中一 元素 b 有 ‖ a - b ‖ ≤ th , 则 称 a 与 b 基本 重合 。 这里 th 为 一 预置 门限 。 
 　 　 实验 结果表明 , 尽管 实测 图像 和 基准 图像 之间 存在 一定 差异 , 但是 对于 大部分 边缘 点 来说 , 它们 仍然 是 基本 重合 的 。 因此 , 可以 假定 在 正确 匹配 点 , 实测 图像 集合 与 窗口 图像 集合 中 像素 重合 和 基本 重合 的 比例 最大 。 
 2.2 　 新 的 匹配 度量 
 　 　 新 的 匹配 度量 定义 为 : 
 Sth ( A , B ) = min ( numa / TotalA , numb / TotalB ) 
 ( 1 ) 
 　 　 其中 numa , numb 分别 表示 集合 A 与 集合 B 中 重合 和 基本 重合 点 的 总数 ; TotalA , TotalB 分别 表示 集合 A 与 集合 B 中点 的 总数 。 下面 就 ( 1 ) 式 所 定义 匹配 度量 的 有关 性质 进行 讨论 : 
 　 　 1 )  A ,  B , 0 ≤ S  th ≤ 1 
 　 　 Sth ( A , B ) = 0 时 , 有 numa = 0 或 numb = 0 , 这时 集合 A 与 集合 B 完全 不 匹配 。 
 　 　 Sth ( A , B ) = 1 时 , 有 numa = TotalA 和 numb = TotalB 。 这时 集合 A 中 任意 一点 与 集合 B 中 某 一点 匹配 。 反之 , 集合 B 中 任意 一点 与 集合 A 中 某 一点 匹配 。 这时 , 我们 称 A 和 B 是 完全 匹配 的 。 
 　 　 Sth ( A , B ) = 1 ( th ≠ 0 ) , 是 考虑 了 成像 机理 的 不同 和 边缘 提取 可能 出现 的 偏移 时 的 集合 A 与 B 的 匹配 。 
 　 　 2 ) 对称性 
 　 　 从 ( 1 ) 式 的 定义 中 很 容易 看出  A ,  B , Sth ( A , B ) = Sth ( B , A ) 。 
 　 　 3 ) 弱 传递性 
 　 　 定理 2.1 　 当 th ≠ 0 时 , Sth ( A , B ) = 1 , Sth ( B , C ) = 1 , 不 一定 有 Sth ( A , C ) = 1 , 但是 一定 有 S2 + h ( A , C ) = 1 。 
 　 　 证明 : 由 Sth ( A , B ) = 1 , Sth ( B , C ) = 1 可以 推断出 , A 中 任意 一点 a 一定 与 B 中 某 一点 ( 如 b ) 基本 重合 , 即 满足 ‖ a - b ‖ ≤ th 。 这时 , 不 一定 有 ‖ a - c ‖ ≤ th , 因此 无法 保证 A 与 C 完全 匹配 。 但是 , 一定 有 ‖ a - c ‖ ≤ ‖ a - b ‖ + ‖ b - c ‖ ≤ 2 + h 成立 。 证毕 。 
 　 　 定理 2.1 的 结果表明 , 如果 将 基本 重合 的 定义 从 th 扩大 到 2th , 那么 a 可以 与 c 基本 重合 。 
 　 　 定理 2.2 当 th = 0 时 , Sth ( A , B ) = 1 , Sth ( B , C ) = 1 , 一定 有 Sth ( A , C ) = 1 。 
 　 　 证明 : 采用 与 证明 定理 2.1 类似 的 方法 可 推得 
 ‖ a - c ‖ ≤ ‖ a - b ‖ + ‖ b - c ‖ = 0 
 ( 2 ) 
 从 ( 2 ) 中 即可 得到 ‖ a - c ‖ = 0 。 证毕 。 
 　 　 定理 2.2 表明 , 在 th = 0 的 条件 下 , A 与 B 完全 匹配 , B 与 C 完全 匹配 , 则 一定 有 A 与 C 完全 匹配 。 
 　 　 定理 2.1 和 定理 2.2 的 结果 证明 了 Sth 满足 一种 弱 的 传递性 。 
 3 　 基于 距离 变换 的 边缘 匹配 方法 
 3.1 　 距离 变换 
 　 　 距离 变换 是 将 二值 图像 变换 为 近似 距离 的 图像 ( 称之为 距离 图像 ) 。 在 距离 图像 中 , 一点 的 图像 灰度 值 反映 了 该 点 到 最近 边缘 点 的 近似 距离 。 文献 ［ 5 ］ 中 说明 了 在 计算 距离 时 , 采用 直接 计算 像素点 之间 的 欧几里德 距离 是 不必要 的 。 在 这里 , 我们 采用 文献 ［ 5 ］ 中 所 提出 的 3 - 4DT 算法 计算 距离 图像 , 具体 算法 如下 : 
 　 　 ( 1 ) 初始化 : 
 　 　 将 边缘 二值 图像 中 的 边缘 点赋 为 0 , 非 边缘 点赋 为 无究大 。 
 　 　 ( 2 ) 在 第 K 次 迭代 时 , 对于 每 一点 ( i , j ) 计算 下 式 : 
 
 ( 3 ) 
 　 　 其中 VKi , j 表示 ( i , j ) 点 第 K 次 迭代 的 值 。 
 　 　 ( 3 ) 重复 步骤 ( 2 ) 直到 所有 点 的 灰度 值 不再 改变 。 
 　 　 显然 , 迭代 的 次数 取决于 图像 中非 边缘 点到 最近 边缘 点 的 最大 距离 。 变换 后 图像 边缘 点 的 灰度 值为 0 。 
 3.2 　 基于 距离 变换 的 边缘 匹配 新 方法 
 　 　 根据 第 2 节所 定义 的 新 的 匹配 度量 , 结合 距离 变换 的 概念 , 下面 给出 一种 新 的 图像匹配 方法 : 
 　 　 ( 1 ) 边缘 提取 。 对于 实测 图像 和 基准 图像 , 我们 选用 Sobel 算子 进行 边缘 检测 , 并 采用 文献 ［ 7 ］ 中 的 方法 进行 边缘 二值 比 。 
 　 　 ( 2 ) 距离 变换 
 　 　 对于 ( 1 ) 所 获得 的 边缘 二值 图像 采用 第 3.1 节 的 方法 进行 距离 变换 即可 得到 近似 距离 图像 。 在 该 图像 中 , 像素点 的 灰度 值 反映 了 该点 最近 边缘 点 的 距离 。 如果 在 初始化 时 将 非 边缘 点赋 初值 为 无穷大 , 则 可能 迭代 的 时间 较长 。 考虑 到 在 我们 的 匹配 方法 中 只 需 确定 图像 中 每 一点 到 离 它 最近 的 边缘 点 的 距离 是否 小于 门限 th , 即 若 实测 图像 中一 边缘 点 位于 窗口 图像 中 小于 th 的 位置 时 , 则 认为 此 边缘 点 与 窗口 图像 的 最近 边缘 点 基本 重合 ; 而 若 实测 图像 中一 边缘 点 位于 窗口 图像 中 大于 或 等于 th 的 位置 时 , 则 认为 窗口 图像 无 边缘 点 与 之 对应 。 
 　 　 ( 3 ) 图像匹配 
 　 　 对于 基准 图像 中 每 一个 可能 的 匹配 位置 ( x , y ) , 将 实测 图像 作为 集合 A , 对应 的 窗口 图像 作为 集合 B ( x , y ) 。 初始化 TotalA = TotalB = 0 , numa = numb = 0 。 对于 集合 A 中 的 每 一个 灰度 值为 0 的 像素点 A ［ u , v ］ , TotalA 加 1 。 如果 窗口 图像 中 的 对应点 B ( x + u , y + v ) 的 值 小于 TH ( 门限 TH 由 th 和 具体 的 距离 变换 算法 确定 , 在 本文 中 采用 文献 ［ 4 ］ 中 的 3 - 4DT 算法 , 通过 大量 实验 取 TH = 12 ) 则 认为 它 与 窗口 图像 内 的 某 一个 边缘 点 重合 或 基本 重合 , numa 加 1 ; 类似 地 , 对于 集合 B 中 的 每 一 灰度 值为 0 的 像素点 B ［ i , j ］ , TotalB 加 1 。 如果 实测 图像 中 对应点 A ( i - x , j - y ) 的 值 小于 th , numb 加 1 。 最后 , 根据 ( 1 ) 式 计算 它们 之间 的 相似 度 。 
 　 　 最后 , 相似 度取 最大值 所 对应 的 匹配 位置 ( x * , y * ) 即 为 所求 的 正确 匹配 点 。 
 4 　 实验 结果 与 分析 
 
 
 图 1 　 采用 航片 和 卫片 的 匹配 结果 
 为了 验证 本文 所 提出 匹配 方法 的 有效性 , 我们 在 486 / 50 微机 上 进行 了 大量 的 匹配 实验 , 并 与 常用 的 平均 绝对 差值 算法 和 归一化 互相 关 算法 进行 了 比较 。 图 1 给出 了 采用 航空 照片 和 卫星 照片 所 进行 实验 的 部分 结果 图像 。 表 1 则 列出 了 它们 的 匹配 精度 和 运行 时间 的 比较 结果 。 在 图 1 中 , ( a ) 、 ( c ) 分别 是 实测 的 航片 和 卫片 基准 图 , 其 大小 分别 为 64 × 67 和 120 × 131 。 ( b ) 、 ( d ) 分别 是 它们 所 对应 的 边缘 二值 图像 , 而 ( e ) 、 ( f ) 、 ( g ) 则 是 采用 本文 的 方法 、 平均 绝对 差 算法 和 归一化 互相 关 算法 的 匹配 结果 。 从图 1 中 可以 看出 , 实测 图像 与 基准 图像 比较 , 不仅 有 灰度 的 变化 , 同时 也 存在 局部 的 灰度 反转 , 因此 导致 了 基于 图像 灰度 一致性 假设 的 平均 绝对 差 算法 和 归一化 互相 关 算法 匹配 的 失败 , 而 本文 所 提出 的 方法 由于 事先 考虑 了 这种 变化 , 因此 能够 完成 正确 匹配 。 此外 , 从表 1 的 统计 结果 中 也 可以 看出 , 即使 在 不 出现 误 匹配 的 情况 下 , 本文 所 提出 算法 的 匹配 定位精度 也 高于 平均 绝对 差 算法 和 归一化 互相 关 算法 , 并 获得 了 更 快 的 匹配 速度 。 同时 我们 还 采用 合成孔径雷达 图像 与 可见光 图像 进行 了 匹配 实验 , 部分 实验 结果 图像 见图 2 。 从图 2 的 结果 中 可以 看出 , 对于 不同 传感器 图像 , 其 灰度 和 特征 的 变化 更为 剧烈 , 因此 平均 绝对 差 算法 和 归一化 互相 关 算法 等 方法 产生 了 较大 的 误 匹配 , 而 只有 采用 本文 所 提出 的 基于 边缘 的 匹配 方法 仍能 获得理想 的 实验 效果 。 
 
 
 图 2 　 采用 合成孔径雷达 图像 与 可见光 图像匹配 结果 
 表 1 　 匹配 实验 结果 的 比较 
 序 
 
 号 实测 图 
 大小 基准 图 
 大小 正确 
 匹配 点 本文 匹配 方法 平均 绝差 算法 归一化 互相 关 
 匹配 点 
 　 时间 
 ( S ) 匹配 点 
 　 时间 
 ( S ) 匹配 点 
 　 时间 
 ( S ) 
 164 × 64144 × 1440 , 00 , 0870 , 01460 , 1140 
 264 × 67144 × 1470 , 00 , 01120 , 01530 , 0146 
 364 × 67144 × 14728 , 6128 , 609727 , 6415027 , 64144 
 492 × 100177 × 15617 , 3917 , 3917416 , 3824416 , 38233 
 571 × 80135 × 13624 , 3223 , 3310024 , 3211324 , 32109 
 663 × 72143 × 1445 , 415 , 38934 , 371465 , 37138 
 764 × 67120 × 13132 , 2833 , 296354 , 288754 , 2882 
 874 × 76202 × 21283 , 2583 , 2532899 , 13157499 , 131520 
 5 　 结 　 论 
 　 　 与 一般 的 图像匹配 问题 不同 , 应用 于 飞行器 导航 的 匹配 方法 有 其 特殊性 。 针对 这些 特殊要求 , 本文 提出 了 一种 计算 简单 、 匹配 定位精度 高 的 基于 边缘 点 相似 度量 的 匹配 新 方法 。 实验 结果表明 , 本文 所 提出 的 这种 匹配 方法 对于 灰度 变化 具有 较强 适应性 , 同时 也 适合 于 不同 传感器 图像 之间 的 匹配 , 较 好 地 满足 了 飞行器 导航 对于 匹配 方法 的 要求 , 为 飞行器 导航 及 制导 用 地图 匹配 相关器 的 研制 提供 了 一条 新途径 。 目前 , 该 方法 尚未 考虑 存在 较大 旋转 和 比例 失真 等 问题 。 如何 使该 方法 更好 地 适应 旋转 、 比例 失真 以及 透视 失真 等 变化 将 成为 我们 进一步 开展 的 主要 工作 。 
 参考文献 
 1 　 孙仲康 , 沈振康 . 数字图像处理 及其 应用 . 国防工业 出版社 , 1985 年 
 2 　 桑农 , 张天序 , 汪 国有 , 魏洛刚 . 抗 区域 灰度 变化 的 景像 匹配 方法 研究 . 华中理工大学 学报 , 1996 , 24 ( 2 ) : 1 - 3 
 3 　 David   Lavine   et   al . , Further   study   of   digital   matching   of   dissimilar   images . AD - A153112 , Feb.1985 
 4 　 Borgefors   G . Hierarchical   Chamfer   Matching : A   Parametric   Edge   Matching   Algorithm . IEEE   Trans . on   PAMI , Nov.1988 , 10 ( 6 ) : 849 - 865 
 5 　 Jezching   Ton   and   Jain , A   K . Registering   Landsat   Images   by   Point   Matching . IEEE   Trans . on   GRS , Sept.1989 , 27 ( 5 ) : 642 - 651 
 6 　 Ventura   A   D , Ramipini   A   and   Schetini   R . Image   Registration   by   Recognition   of   Corresponding   Structures . IEEE   Trans . on   GRS , May   1990 , 28 ( 3 ) : 305 - 314 
 7 　 彭嘉雄 . 图像 的 二值化 与 边缘 提取 技术 . 电信 科学 , 1986 , 10 : 17 - 22 
