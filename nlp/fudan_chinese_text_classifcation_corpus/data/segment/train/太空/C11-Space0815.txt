航空 动力学 报 
 JOURNAL   OF   AEROSPACE   POWER 
 1998 年     第 13 卷     第 1 期 科技期刊 
 
 航空 发动机 仿真 模型 参数 自 适应 校正 
 
 西北工业大学   谢 光华 * *       曾庆福   张燕东 
 【 摘要 】     采用 修正 因子 方法 建立 自 适应 仿真 模型 ， 运用 改进 的 共轭 梯度 算法 求解 
 非线性 规划 问题 ， 依据 发动机 台架 试车 和 空中 试飞 测量 数据 ， 对 发动机 仿真 模型 的 
 部件 特性 参数 进行 校正 ， 使 模型 的 计算 输出 与 试验 测量 数据 吻合 。 应用 本文 方法 对 
 某型 双 转子 加力 涡喷 发动机 仿真 模型 进行 校正 ， 获得 了 满意 的 仿真 精度 。 
 主题词 ：     航空 发动机     仿真     参数     自 适应控制       非线性 规划 
 分类号 ：     V233.7 
 
 １     引     言 
 
         发动机 模型 的 精度 ， 一方面 决定 于 模型 算法 的 简化 程度 ， 而 更 重要 的 一方面 是 
 部件 特性 参数 的 准确 程度 ， 这 决定 于 部件 试验 是否 充分 。 部件 试验 耗资 大 、 周期长 ， 
 而且 部件 试验 得到 的 数据 在 整机 共同 工作 情况 下 ， 会 因为 各种因素 的 影响 发生变化 。 
 这 使得 发动机 仿真 模型 的 检验 和 校正 、 自 适应 仿真 及其 应用 一直 是 受到重视 的 研究 
 课题 ［ 1 - 3 ］ 。 本文 通过 建立 发动机 自 适应 模型 ， 根据 测量 数据 校正 部件 特性 参数 ， 
 从而 提高 发动机 仿真 模型 的 精度 。 
 
 ２       发动机 仿真 模型 修正 因子 方法 
 
         发动机 的 气动 热力学 模型 以 一组 非线性 方程 描述 ， 其 数值 解 一般 采用 牛顿 迭代 方 
 法 ( 包括 拟 牛顿 方法 ) ， 由 预解 向量 构造 误差 方程 ， 若用 误差 向量 E = ｛ ei ， i = 1 ， … ， n ｝ 
 构造 代价 函数 ， 其中 ai 为 大于 零 的 权 系数 ， 则 非 线性方程组 解 等价 于 非线性 规划 问题 解 ： 
 
                                                   ( 1 ) 
 
 其中 预解 向量 与 误差 向量 是 同维 的 。 
 
         当 模型 计算 输出 与 试验 测量 有 较大 误差 时 ， 设 Pact 为 发动机 部件 的 实际 特性 值 ， 
 Pref 为 由 相应 部件 特性 线族 求得 的 特性 值 ， 定义 修正 因子 mf = Pact / Pref ， 则 构造 如下 
 代价 函数 ： 
 
                                 ( 2 ) 
 
 其中 bi 为 大于 零 的 权 系数 ， Qmi 为 测量 结果 ， Qci 为 相应 的 发动机 模型 估算 结果 。 上述 
 代价 函数 也 可 表示 成 预解 变量 xi 和 修正 因子 mfi 的 函数 ， 且 ( 1 ) 式 非线性 规划 问题 变为 ： 
 
                   ( 3 ) 
 
 其中 ， n 为 发动机 模型 数值 解中 预解 向量 的 维数 ， l 为 修正 因子 向量 的 维数 ， m 为 发动 
 机 测量 与 模型 估算 误差 向量 的 维数 ， 在 本文 研究 问题 中 n + l ＞ n + m 。 
 
         通过 对 ( 3 ) 式 的 求解 即可 在 保证 各 部件 匹配 关系 的 前提 下 ， 求得 所 需 的 修正 因子 
 值 。 运用 求得 的 修正 因子 值 进行 仿真 计算 ， 将 使 测量 数据 与 仿真 结果 之间 的 误差 接 
 近 最小 。 
 
 ３     模型 参数 自 适应 校正 
 
         图 1 为 发动机 自 适应 模型 的 结构 框图 。 以 某型 双 转子 加力 涡喷 发动机 为例 ， 其仿 
 真 模型 是 准 一元 绝热 流动 、 考虑 变 比热 影响 的 部件 级 气动 热力 模型 ， 模型 数值 解中 
 预猜 如下 6 个 变量 ( n = 6 ) ： ( 1 ) 低压 压气机 增压 比 π LP ； ( 2 ) 高压 压气机 增压 比 π HP ； 
 ( 3 ) 高压 压气机 转速 NH ； ( 4 ) 主 燃烧室 出口 温度 T4 ； ( 5 ) 高压 涡轮 进口 质量 换算 流量 cw4 ； 
 ( 6 ) 低压 涡轮 进口 质量 换算 流量 cw4A 。 
 
 图 1   自 适应 模型 的 结构 框图 
         该 发动机 自 适应 模型 中 部件 特性 采用 如下 10 个 修正 因子 ( l = 10 ) ： 
 
 低压 压气机 mf1 = ( cwLP ) act ／ ( cwLP ) ref   mf2 = ( η * LP ) act ／ ( η * LP ) ref 
 高压 压气机 mf3 = ( cwHP ) act ／ ( cwLP ) ref   mf4 = ( η * HP ) act ／ ( η * LP ) ref 
 燃烧室 mf5 = ( η b ) act ／ ( η b ) ref 
 高压 涡轮 mf6 = ( dhHT ) act ／ ( dhHT )  ref   mf7 = ( η * HT ) act ／ ( η * HT ) ref 
 低压 涡轮 mf8 = ( dhLT ) act ／ ( dhLT )  ref   mf9 = ( η * LT ) act ／ ( η * LT ) ref 
 加力燃烧 室 mf10 = ( η af ) act ／ ( η af ) ref 
 
 其中 cwLP ， η * LP 和 cwHP ， η * HP 分别 为 低 、 高压 压气机 的 质量 换算 流量 和 绝 热效率 ， 
 η b 为主 燃烧室 燃烧 效率 ， dhHT ， η * HT 和 dhLT ， η * LT 分别 为 高 、 低压 涡轮 单位 焓 降 
 和 绝 热效率 ， η af 为 加力燃烧 室 燃烧 效率 。 
 
         测量 参数 Qmi 为 高压 转子 转速 NH ， 主 燃烧室 进口 总温 T * 3 ， 总压 P * 3 ， 加力燃烧 室 
 进口 总温 T * 6 和 主 燃油 流量 wf ， 模型 估算 相应 参数 Qci 为 NHref ， T * 3ref ， P * 3ref ， T * 6ref 
 和 wfref ， 定义 误差 ： 
 
 ε i = Qci - Qmi   i = 1 ， … ， m   ( m = 5 )                                                     ( 4 ) 
 
 再 加上 发动机 模型 的 平衡 检验 误差 ei ， i = 1 ， … ， n ( n = 6 ) ， 于是 ( 2 ) 式 的 代价 函数 ： 
 
                                                                     ( 5 ) 
 
 因自 适应 仿真 模型 中解 向量 的 维数 ( n + l = 16 ) 大于 误差 向量 的 维数 ( n + m = 11 ) ， 故 本文 求 
 解 非线性 规划 问题 时 ， 采用 改进 的 共轭 梯度 算法 ( LMINN 算法 ) 进行 非线性 寻优 。 该算 
 法在 构造 搜索 方向 和 步长 时 对 共轭 梯度 算法 作 了 有效 的 改进 。 搜索 方向 构造 如下 ［ 4 ］ ： 
 
                     ( 6 ) 
 
 迭代 序列 xk + 1 = xk + α kpk ， 其中 α k 和 γ k + 1 均 为 最优 步长 ， 即 
 
 f ( xk + α kpk ) = min α f ( xk + α pk )   ，   f ( wk + 1 + γ k + 1pk ) = min γ f ( wk + 1 + γ pk ) 
 
         LMINN 算法 的 初始 步长 ， 要求 并 不象 其它 算法 那么 严格 ， 在 整个 计算 过程 中 ， 只是 在 
 搜索 α 0 和 β 1 时 作为 初始 步长 使用 ， 当 k ≥ 1 时 ， 搜索 α k ， γ k 和 β k + 1 的 初始 步长 则 取为 β k 。 
 
         预解 变量 的 初值 仍 按 发动机 模型 的 常用 数值 解法 进行 选取 ， 修正 因子 的 初值 取为 
 1.0 。 代价 函数 的 梯度 向量 ▽ f ( xk ) 的 各个 分量 ， 按 中心 差分 求得 ： 
 
 ( FC ) / ( xi ) = ( FC ( x ( k ) i + △ xi ) - FC ( x ( k ) i - △ xi ) ) / ( 2 △ xi ) 　 　 　 　 　 ( i = 1 ， … ， n ) 
 ( FC ) / ( mfj ) = ( FC ( mf ( k ) j + △ mfj ) - FC ( mf ( k ) j - △ mfj ) ) / ( 2 △ mfj ) 　 　 ( j = 1 ， … ， l ) 
 
 算法 收敛 的 精度 控制 为 ： ‖ ▽ f ( xk ) ‖ ≤ 1.0 e - 6 。 
 
 ４     模型 校正 结果 
 
         本文 应用 上述 方法 建立 某型 双 转子 加力 涡喷 发动机 自 适应 模型 ， 代价 函数 按 ( 5 ) 式 
 构造 ， 加权 系数 ai 分别 取 ｛ 2.0 ， 2.0 ， 2.0 ， 2.0 ， 2.0 ， 2.0 ｝ ， bi 分别 取 ｛ 1.0 e - 4 ， 0.1 ， 
 1.0 e - 3 ， 1.0 e - 3 ， 5.0 ｝ 。 这样 选取 的 目的 是 ： 该 发动机 仿真 模型 计算 时 ， 使 代价 函数 
 中 参数 误差 项 处于 同一个 数量级 ， 同时 ， 对 保证 发动机 各 部件 匹配 关系 的 发动机 模型 
 平衡 的 检验 误差 项 的 权 加重 。 ai 和 bi 可以 根据 模型 最终 的 精度 要求 和 测量 参数 的 数值 
 范围 来 选取 。 
 
 图 2   高空 转速 特性 主 燃烧室 进口 总温             图 3   高空 转速 特性 主 燃烧室 进口 总压 
 
 图 4   高度 特性 加力燃烧 室 进口 总温                   图 5   高度 特性 主 燃油 流量 
 
         在 采用 LMINN 算法 求解 非线性 规划 问题 时 ， 算法 中 的 初始 步长 取为 0.01 ， 当 迭代 
 达到 一定 次数 后 ， LMINN 算法 趋于 一阶 收敛 ， 为了 提高 收敛 速率 ， 本文 用 k ＞ 16 作为 算 
 法 重新启动 准则 ， 用 最速 下降 方向 重新 构造 共轭 方向 进行 搜索 。 
 
         根据 发动机 试验 记录 的 4 千多个 状态 点 数据 ， 本文 由 自 适应 模型 求 出 发动机 部件 
 特性 的 修正 因子 ， 对 某型 双 转子 加力 涡喷 发动机 模型 部件 特性 参数 进行 了 校正 ， 校正 
 后 的 仿真 模型 用 试验 测量 数据 进行 了 检验 。 
 
 图 6   台架 加速 过程 高 、 低压 转子 转速 
         图 2 和 图 3 分别 为 高度 特性 加力燃烧 室 进口 总 温和 主 燃油 流量 校正 前后 模型 计算 
 结果 与 测量 数据 间 的 比较 。 飞行 马赫数 Ma = 0.90 ， 低压 转子 转速 NL = 100.5% 。 图 4 和 
 图 5 分别 为 高空 转速 特性 主 燃烧室 进口 总 温和 总压 校正 前后 模型 计算结果 与 测量 数 
 据间 的 比较 。 飞行高度 H = 4.96   km ， 飞行速度 v = 407   m / s 。 
 
         图 6 是 经过 校正 后 的 特性 线 参数 用于 台架 加速 过程 计算 所得 高 、 低压 转子 转速 与 
 测量 数据 间 的 比较 。 试验 时 大气 条件 为 压力 86320   Pa ， 温度 21 ℃ ， 记录 数据 的 采样 间 
 隔为 20   ms 。 
 
 5     结束语 
 
         本文 研究 部件 特性 参数 的 校正 ， 校正 点 是 发动机 的 各 稳态 工作 点 ， 而 各 特性 线 
 皆 以 相似 参数 描述 ， 在 整个 飞行 包线 内 ， 这些 校正 点 分布 在 发动机 共同 工作 线 的 周 
 围 。 由于 测量 噪声 ， 使 得到 的 修正 因子 有 一定 的 分散度 ， 因此 试验 数据 愈 充分 ， 并 
 采取 滤波 处理 ， 则 对 特性 线 的 校正 愈 有效 。 本文 方法 将 模型 的 简化 和 特性 的 不 精确 
 都 归结 于 修正 因子 ， 若 模型简化 到 不能 反映 发动机 的 气动 热力过程 ， 或 特性 线 偏差 
 很大 ， 或 测试数据 偏差 很大 ， 都 将 导致 算法 的 不 收敛 或 修正 因子 偏离 1.0 太远 ， 算法 
 中 对 修正 因子 的 大小 作 了 一定 限制 ， 并 将 那些 超出范围 和 发散 的 校正 点 数据 予以 剔 
 除 。 当 得到 校正 点 修正 因子 后 ， 对 各 部件 特性 加以 调整 ， 调整 后 的 特性 用于 过渡 过 
 程 的 仿真 ， 计算结果 与 试验 结果 能 得到 满意 的 吻合 。 
 
         文中 对 某型 双 转子 加力 涡喷 发动机 的 部件 特性 参数 进行 校正 后 ， 模型 输出 参数 
 与 试验 测量 数据 之间 地面 稳态 误差 最大 不 超过 1.0% ， 地面 动态 和 空中 误差 最大 都 不 
 超过 2.0% ， 提高 了 发动机 模型 的 仿真 精度 。 自 适应 方法 在 较 精确 地 估计 发动机 的 状 
 态及 发动机 状态 监控 、 传感器 故障诊断 等 方面 有 发展潜力 。 
 
 男     27 岁     博士 研究生     西北工业大学 573 信箱     710072 
 参考文献 
 1Stamatis   A , Mathioudakis   K , et   al . Adaptive   Simulation   of   Gas   Turbine   
 Performance . ASME   Paper   89 - GT - 205 , 1989 
 2Stamatis   A , Mathioudakis   K , et   al . Gas   Turbine   Component   Fault   Identification   
 by   Means   of   Adaptive   Performance   Modelling . ASME   Paper   90 - GT - 376 , 1990 
 3Mathioudakis   K , Stamatis   A . Compressor   Fault   Identification   from   Overall   
 Performance   Data   Based   on   Adatpive   Stage   Stacking . ASME   Paper   92 - GT - 28 , 1992 
 4LE   D . A   Fast   and   Robust   Unconstrained   Optimization   Method   Requiring   
 Minimum   Storage . Mathematical   Programming , 1985 , ( 32 ) : 41 - 68 
 
 1996 年 11 月 收稿 ； 1997 年 5 月 收到 修改稿 。 
 
 （ 责任编辑     王震 华 ） 
