宇航学 报 
 JOURNAL   OF   ASTRONAUTICS 
 1999 年 　 第 1 期 　 No.1 　 1999 
 
 
 
 　 基于 局部 熵 差 的 图象 匹配 方法 
 — — 算法 及 计算机 仿真 * 
 田 金文 　 苏康 　 柳健 
 　 　 摘 　 要 　 传统 的 灰度 相关 匹配 和 基于 边缘 特征 的 匹配 方法 抗噪 能力 和 抗 几何 失真 能力 较差 , 将 信息熵 的 概念 引入 到 图象 匹配 中 , 定义 了 图象 局部 熵 , 并 由此 提出 一种 新颖 的 基于 局部 熵 差 的 图象 匹配 方法 。 由于 图象 熵 反映 的 是 图象 的 局部 , 因此 基于 局部 熵 差 的 图象 匹配 方法 具有 较强 的 抗噪 能力 。 由于 采用 了 分块 、 序贯 检测 及 分层 搜索 技术 , 计算 量 大为 减少 , 试验 结果表明 这是 一种 非常 好 的 图像匹配 方法 。 
 　 　 主题词 　 图象 匹配 　 局部 熵 　 抗 几何 失真 　 鲁棒性 　 计算机 仿真 
 IMAGE   MATCHING   BASED   ON   
 LOCAL   ENTROPY   DIFFERENCE 
 — — ALGORITHM   AND   COMPUTER   SIMULATION 
 Tian   Jinwen   Yang   Lei   Su   Kang   Liu   Jian 
 ( Huazhong   University   of   Science   and   Technology ． Wuhan ． 430074 ) 
 　 　 Abstract 　 Traditional   image   matching   methods , which   are   the   gray   relating   matching   algorithm   and   the   edge - based   features   matching   algorithm , have   neither   scale   invariability   nor   rotational   invariability . In   this   paper   we   have   introduced   information   entropy   to   image   matching   and   have   defined   a   image   local   entropy . We   propose   a   novel   image   matching   method   based   on   local   entropy   difference . This   image   matching   method   has   very   good   anti - noise   properties   because   the   image   entropy   is   relating   to   image   local   property . In   addition , we   adopt   some   techniques : dividing   image   to   some   blocks , series   testing   and   multiresolution   searching   technique . These   techniques   have   led   to   raising   computing   effect . The   experiment   results   show   our   image   matching   method   is   very   efficient . 
 　 　 Key   words 　 Image   matching   Local   entropy   Anti - geometrical   deform   Robustness   Computing   simulating 
 1 　 引言 
 　 　 随着 科学技术 的 发展 , 图像匹配 技术 已 成为 近代 信息处理 领域 中 一项 极为重要 的 技术 , 它 的 应用 范围 是 相当 广泛 的 , 其中 包括 : 导弹 的 地形 和 地图 匹配 制导 , 飞航 导弹 , 武器 投射 系统 的 末 制导 和 寻 的 , 光学 和 雷达 的 目标 跟踪 , 资源 分析 , 气象预报 , 医疗 诊断 , 文字 读取 , 以及 景物 分析 中 的 变换 检测 等 ［ 1 - 2 ］ 。 
 　 　 所谓 图像匹配 指 的 是 把 两个 不同 的 传感器 从 同一 景物 录取 下来 的 两幅 图像 在 空间 上 进行 对准 , 以 确定 出 这 两幅 图像 之间 相对 平移 的 过程 。 飞行器 地形 和 地图 匹配 制导 中 图像匹配 技术 是 非常 重要 的 , 在 这种 图像匹配 系统 中 , 首先 将 卫星 拍摄 的 飞行器 预定 航线 中 某 一 区域 的 卫片 ( 称为 基准 图 ) 存贮 在 机载 计算机 内 , 在 飞行器 飞行 过程 中 , 机载 传感器 飞行 到 该 区域 时 获得 的 图像 ( 称为 实时 图 ) 与 基准 图 进行 匹配 比较 , 以 确定 飞行器 的 位置 , 这种 匹配 定位系统 称为 地图 匹配 定位系统 。 
 　 　 在 图像匹配 系统 中 , 匹配 算法 的 研究 至关重要 。 由于 参考 图 与 实时 图 的 拍摄 时间 与 条件 的 变化 , 同时 由于 成像 设备 的 限制 , 使得 参考 图 与 实时 图 之间 不仅 存在 着 严重 的 灰度 差异 , 而且 存在 有 相当 的 几何形 变 。 通过 对 参考 图 进行 灰度 校正 和 几何 校正 可以 很大 程度 上 改善 这种 情况 , 但 在 参考 图 和 实时 图 之间 仍 存在 着 一定 的 灰度 失真 和 几何形 变 ; 另外 , 实时 图 本身 也 存在 着 一定 的 噪声 干扰 。 因此 匹配 算法 不仅 应该 具有 计算 量 小 、 易于 硬件 实现 的 特点 , 还 必须 要 有 良好 的 抗噪 能力 和 抗 几何形 变 的 能力 。 
 　 　 图像匹配 可 分为 三个 层次 : 基于 灰度 相关 的 匹配 , 基于 特征 的 图象 匹配 和 基于 解释 的 图象 匹配 。 基于 灰度 的 图象 匹配 研究 了 近 二十年 , 这是 一种 对 共轭 图像 逐象 元 以 一定 大小 的 窗口 的 灰度 阵列 按 某种 或 几种 相似性 度量 顺次 进行 搜索 匹配 的 方法 。 这种 匹配 一旦 进入 信息 贪乏 区域 , 或 共轭 图像 之间 存在 较大 比例尺 差异 或 扭曲 的 区域 , 匹配 难免 失败 。 而 基于 解释 的 图像匹配 需要 建立 在 图片 自动 判读 的 专家系统 之上 , 至今 的 研究 尚未 取得 突破性 的 进展 。 
 　 　 本文 将 信息熵 的 概念 引入 到 图象 匹配 中 , 定义 了 图象 局部 熵 , 并 由此 提出 一种 新颖 的 基于 局部 熵 差 的 图象 匹配 算法 。 它 不仅 保持 了 抗 灰度 反转 、 计算 简单 等 特点 , 而且 能够 在 一定 程度 上抗 几何 失真 , 经过 采用 不同 航片 、 卫片 所 进行 的 大量 匹配 实验 , 其 结果表明 采用 本文 提出 的 匹配 方法 的 匹配 精度 可 达到 子 象素 级 。 
 2 　 图象 的 局部 熵 
 　 　 自从 申农 将 物理 中 熵 的 概念 引入 信息论 以来 ［ 3 ］ , 熵 已 被 广泛应用 于 信号处理 、 图象处理 等 各种 领域 ［ 4 - 5 ］ 。 为了 将 申农 在 信息论 中 所 定义 熵 的 概念 应用 于 图象 匹配 , 我们 需要 定义 图象 的 熵 。 首先 假定 图像 函数 具有 非负值 , 即 f ( x , y ) ＞ 0 , 对于 一幅 M × N 大小 的 图象 , 定义 
 
 ( 1 ) 
 称其为 该 图象 的 熵 。 如果 只 对 图象 的 某 一 局部 定义 熵 , 则 称 其 为 局部 熵 。 
 　 　 由 熵 的 定义 可知 , 图象 的 局部 熵 反映 了 该 局部 所 含有 信息量 的 大小 , 因此 局部 熵 可以 描述 图象 的 局部 性质 。 如果 该 局部 存在 边缘 , 则 该 局部 灰度 值会 急剧 变化 , 这时 计算 出 的 熵 小 , 所以 局部 熵 也 可以 应用 于 边缘 检测 。 另外 , 从 图象 局部 熵 的 定义 中 , 我们 可以 看到 : 如果 图象 的 某 一 局部 ( 比较 小 的 范围 ) 存在 辐射 失真 ( 此时 的 点 扩展 函数 为 脉冲 函数 的 线性组合 的 情况 下 ) , 则 局部 熵 不变 , 因而 局部 熵 具有 辐射 失真 不变 的 性质 ; 由于 熵 的 大小 依赖于 整个 的 局部 区域 , 单个 象素 的 灰度 值 对 熵 的 影响 很小 , pij 的 归一化 处理 也 具有 平滑 噪声 的 作用 , 局部 熵 对 噪声 是 不 敏感 的 ; 且 从 熵 的 定义 也 可以 直接 看出 , 熵 对 一定 程度 的 几何 失真 是 不 敏感 的 , 利用 局部 熵 建立 的 匹配 方法 必然 具有 良好 的 抗 几何 失真 能力 。 
 由于 ( 1 - 1 ) 式 定义 的 熵 的 计算 涉及 对数 运算 , 计算 量 是 比较 大 的 , 为此 利用 泰勒 展开 可 得 如下 的 近似 公式 。 
 　 ( 2 ) 
 ( 2 ) 式 是 比较简单 的 代数 运算 , 因此 易于 硬件 实现 。 
 3 　 匹配 算法 
 　 　 利用 前节 介绍 的 局部 熵 , 我们 构造 基于 局部 熵 差 的 图象 匹配 算法 , 其 基本 步骤 是 : 
 　 　 第一步 　 将 实时 图 划分 为 若干 大小 相同 的 子块 ; 
 　 　 第二步 　 利用 前面 介绍 的 局部 熵 计算方法 计算 实时 图 各子 块 的 局部 熵 , 并用 一 有序 数组 保存 ; 
 　 　 第三步 　 粗 匹配 阶段 : 
 　 　 为了 提高 匹配 效率 , 我们 采用 以下 的 匹配 策略 : 
 　 　 跳跃式 的 搜索 : 以前 的 搜索 方法 一般 采用 在 参考 图上 逐行扫描 的 方法 , 这里 在 粗 匹配 阶段 我们 采用 间隔 扫描 方式 ( 一般 间隔 2 - 3 个象 元 ) ; 
 　 　 序贯 检验 方法 : 以前 的 匹配 方法 一般 采用 实时 图 和 参考 图 全部 计算 的 方式 , 这里 我们 采用 序贯 的 检验 方法 , 具体说来 就是 一边 计算 一边 检验 的 方法 ; 
 　 　 匹配 准则 如下 : 
 　 　 ( 1 ) 在 参考 图上 以 扫描 点为 中心 ( 或 作为 左上角 坐标 ) 获得 与 实时 图 大小 相等 的 候选 匹配 图 , 在 该 候选 匹配 图 按 实时 图 的 分块 方式 进行 分块 ; 
 　 　 ( 2 ) 序贯 计算 参考 图上 选取 的 每 一 候选 匹配 图 局部 熵 数组 与 实时 图 的 局部 熵 数组 对应 相减 , 再取 绝对值 累加 得 一 熵 差 , 如果 该 差值 大于 某一 阈值 , 则 停止 计算 下面 的 子块 的 熵 而 转向 下次 的 循环 ; 
 　 　 ( 3 ) 熵 差 最小 的 候选 匹配 图为 粗 匹配 阶段 的 匹配 图 ; 
 　 　 第四步 　 精 匹配 阶段 : 
 　 　 ( 1 ) 以 粗 匹配 图 的 坐标 为 中心 , 在 参考 图上 形成 一个 5 × 5 的 搜索 范围 ; 
 　 　 ( 2 ) 利用 粗 匹配 阶段 的 方法 进行 逐象 元 的 匹配 , 此时 获得 的 匹配 结果 为 最终 的 匹配 结果 。 
 　 　 注释 : 匹配 阶段 的 阈值 可 按 如下 的 方法 确定 , 匹配 阶段 的 当前 最小 熵 差 作为 下一阶段 的 阈值 ( 第一次 的 阈值 取为 一个 较大 的 数值 , 以 保证 第一个 匹配 图 的 所有 子块 全部 计算 ) 。 
 　 　 熵 差 匹配 方法 具有 以下 性质 : 
 　 　 ( 1 ) 当 参考 图 与 实时 图 完全 重合 时 , 熵 差 为 零 , 因而 熵 差 最小 准则 是 合理 的 ; 
 　 　 ( 2 ) 实时 图 进行 分块 求 熵 是 基于 如下 的 考虑 , 由于 云彩 , 光照 的 不 均匀 , 都 可 造成 图象 的 局部 辐射 失真 , 分子 块求 熵 可以 有效 地 消除 辐射 失真 ; 另外 分块 求 熵 可以 减少 计算 量 , 因为 如果 部分 子块 的 熵 差 大于 上次 搜索 的 熵 差时 , 则 放弃 此 参考 图块 的 其余 计算 , 转 至 下面 的 步骤 ; 
 　 　 ( 3 ) 局部 熵 的 大小 反映 了 该 图象 块 包含 信息量 大小 , 局部 熵 越 大 , 信息量 越 少 , 局部 熵 越 小 , 信息量 越 多 , 因此 熵 差 最小 准则 有利于 信息量 丰富 的 图象 匹配 ; 
 　 　 ( 4 ) 由于 局部 熵 差 方法 不用 提取 边缘 、 纹理 特征 , 而 又 包含 了 图象 的 边缘 、 纹理 信息 , 因此 , 对于 边缘 、 纹理 特征 缺乏 的 图象 也 具有 良好 的 适用性 , 这是 基于 边缘 、 纹理 特征 匹配 方法 所 无法 达到 的 ; 
 　 　 ( 5 ) 由于 局部 熵 采用 的 是 邻域 信息 , 因此 我们 的 方法 具有 较强 的 抗 几何 失真 能力 , 且子 块 越 大 , 抗 几何 失真 能力 越强 ; 
 　 　 ( 6 ) 局部 熵 差 方法 具有 算法 简单 , 计算 量 小 , 并行处理 的 优良 特性 , 因而 易于 并行 硬件 实现 ; 
 　 　 ( 7 ) 上述 的 局部 熵 差 匹配 方法 的 第四步 略 做 变化 , 可 达到 子 象素 精度 匹配 ; 
 　 　 ( 8 ) 以 局部 熵 作为 特征 输入 , 可以 采用 人工神经网络 实现 图象 匹配 , 具体方法 另文 介绍 。 
 4 　 实验 结果 与 讨论 
 　 　 采用 本 方法 在 多组 图象 对 上 进行 了 实验 , 包括 : 不同 大小 的 实时 图 、 不同 大小 的 参考 图 、 不同 的 信噪比 、 不同 的 几何 失真 等 ［ 1 ］ 。 结果表明 , 当 参考 图 与 实时 图中 相同 目标 有 一定 的 几何 变形 时 , 用 灰度 相关 算法 与 边缘 相关 算法 均 不能 正确 匹配 , 采用 这种 基于 局部 熵 差 匹配 算法 测能 很 好 的 匹配 。 此 算法 计算 量 比较 小 , 当 参考 图 大小 为 200 × 200 , 实时 图 大小 为 32 × 32 时 , 在 596 / 133 微机 上 的 运行 时间 在 15 秒左右 。 
 　 　 如下 为 两组 比较 实验 结果 , 一种 匹配 方法 是 边缘 相关 匹配 方法 , 另 一种 是 本文 方法 。 实验 1 是 两个 航空 照片 的 匹配 , 实时 图 与 参考 图约 存在 3 度 的 旋转 , 参考 图 大小 为 200 × 200 ; 实验 2 是 卫星 照片 与 航片 的 匹配 ( 参考 图为 卫片 , 实时 图为 航片 ) , 实时 图 与 参考 图 之间 在 一些 区域 存在 几何 失真 , 参考 图 大小 为 300 × 300 。 表 1 列出 了 实验 2 中 采用 两种 不同 匹配 方法 的 正确 匹配 率 , 其中 实时 图是 在 大图 上 随机 选取 的 , 总数 都 为 500 个 。 正确 匹配 的 含义 是 指 实验 配 准点 ( 图象 的 左上角 ) 与 实际 的 配准 误差 在 一个 象素 内 , 图 1 和 图 2 则 分别 是 实验 1 和 实验 2 的 一个 匹配 结果 。 图 2 中 ( a ) 为 参考 图 , ( b ) 为 实时 图 , ( c ) 是 采用 边缘 相关 方法 的 匹配 结果 , ( d ) 为 采用 本文 方法 得到 的 匹配 结果 。 
 
 图 1 　 第一组 实验 结果 , 其中 ( a ) ( b ) 为 两个 实 
 时图 , ( c ) ( d ) 为 采用 本文 方法 得到 的 匹配 结果 , 
 方框 所示 为 匹配 位置 , ( e ) ( f ) 是 采用 边缘 相 
 关 匹配 方法 的 匹配 结果 , 方框 所示 为 匹配 位置 
 
 图 2 　 第二组 实验 结果 , 其中 ( a ) 为 参考 图 , 方框 所标 
 为 正确 匹配 位置 , ( b ) 中 方框 所标 为 实时 图 , 它 是从 
 大图 上 随机 选取 的 , ( c ) 是 采用 边缘 相关 匹配 方法 的 
 匹配 结果 , ( d ) 为 采用 本文 方法 得到 的 匹配 结果 
 表 1 　 两种 匹配 方法 的 比较 结果 
 　 匹配 方法 匹配 概率 
 实验 结果 边缘 相关 匹配 46% 
 局部 熵 差 方法 匹配 78% 
 　 　 由 实验 结果 可以 看出 , 当 参考 图 与 实时 图 之间 存在 几何形 变时 , 传统 的 边缘 相关 匹配 方法 常常 不能 得到 好 的 匹配 结果 , 而 采用 本文 方法 则 可 正确 匹配 , 说明 这种 基于 局部 熵 差 的 匹配 方法 在 克服 几何形 变上 有 比较 好 的 效果 。 
 　 　 从 本文 的 算法 分析 和 大量 的 实验 结果 , 可以 确定 本 算法 对 地面 景物 的 适用范围 : 参考 图 与 实时 图 基本 相似 , 即 对应 实时 图 位置 参考 图中 的 景象 与 实时 图中 景象 基本一致 , 但 允许 存在 一定 的 辐射 失真 和 几何 失真 。 
 5 　 结论 
 　 　 本文 提出 了 一种 基于 局部 熵 差 的 匹配 算法 , 它 不仅 保持 了 抗噪 能力 、 抗辐射 失真 、 计算 简单 等 优点 , 而且 能够 在 一定 程度 上抗 几何 失真 , 由于 不 存在 门限 选取 , 参数 确定 等 人为因素 的 影响 , 因此 匹配 算法 适应能力 强 , 稳健性 好 , 实验 结果表明 这是 一种 很 有 实用 前途 的 匹配 方法 。 
 * 本文 得到 国家自然科学基金 和 国防 预研 基金 的 资助 
 作者 单位 : 田 金文 　 苏康 　 柳健 　 ( 华中理工大学 图象 所 图像 信息处理 与 智能 控制 国家教委 开放 实验室 ． 武汉 ． 430074 ) 
 参考文献 
 　 [ 1 ] 柳健 等 . 基于 局部 熵 差 的 快速 图象 匹配 方法 . 华中理工大学 研究 报告 , 1995 
 　 [ 2 ] 孙仲康 , 沈振康 . 数字 图象处理 及其 应用 . 北京 : 国防工业 出版社 , 1985 
 　 [ 3 ] 荆仁杰 等 . 计算机 图象处理 . 杭州 : 浙江大学 出版社 , 1992 
 　 [ 4 ] Shiozaki   A . Edge   extraction   using   entropy   operator . CVGIP   Proc.1986 , 36 : 1 - 9 
 　 [ 5 ] Pal   N . et   al . Object - background   segmentation   using   new   definitions   of   entropy . IEEE   Proc . Pt . E , 1989 : 136 ( 4 ) : 284 - 295 
 收稿 日期 : 1996 年 10 月 7 日 , 修回 日期 : 1997 年 7 月 11 日 
