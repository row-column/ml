　 宇航学 报 
 JOURNAL   OF   ASTRONAUTICS 
 1999 年   第 20 卷   第 3 期   vol.20   No.3   1999 
 
 
 
 　 旋转 与 比例 不变 点 特征 松弛 匹配 算法 的 
 Hopfield 神经网络 实现 *  
 桑 　 农 　 张天序 
 　 　 摘 　 要 　 本文 在 旋转 与 比例 不变 点 特征 松弛 匹配 方法 的 基础 上 ， 提出 了 用 Hopfield 神经网络 实现 该 匹配 过程 的 方法 。 通过 对 模拟 图象 进行 的 大量 实验 ， 得到 了 令人满意 的 结果 ， 证实 了 采用 Hopfield 神经网络 完成 旋转 与 比例 不变 点 特征 松弛 匹配 过程 的 有效性 和 可行性 。 
 　 　 主题词 　 松弛 匹配 　 点 特征 　 不变性 　 神经网络 　 Hopfield 模型 
 POINT   PATTERN   RELAXATION   MATCHING   
 INVARIANT   TO   ROTATIONS   AND   SCALE   
 CHANGES   BY   HOPFIELD   NEURAL   NETWORK 
 Sang   Nong 
 ( Institute   for   Pattern   Recognition   and   Artificial   Intelligence , 
 Huazhong   University   of   Science   and   Technology . Wuhan.430074 ) 
 Zhang   Tianxu 
 ( State   Education   Commission   Laboratory   for   Image   Processing   and   Intelligent   Control . Wuhan.430074 ) 
 　 　 Abstract 　 On   the   basis   of   point   pattern   relaxation   matching   method   which   is   invariant   to   rotation   and   scale   changes , a   method   that   makes   the   Hopfield   neural   network   perform   this   matching   process   is   discussed . Experimental   results   with   large   simulated   images   prove   the   effectiveness   and   feasibility   of   the   method   to   perform   point   pattern   relaxation   matching   invarian   to   rotation   and   scale   changes   by   the   Hopfield   neural   network . 
 　 　 Key   words 　 Relaxation   matching   Point   patterns   Invariance   Neural   network   Hopfield   model 
 　 　 1 　 引言 
 　 　 图像匹配 在 配准 、 导航 、 变化检测 及 立体 视觉 等 应用 中是 一项 极其重要 的 技术 。 关于 图象 匹配 方法 ， 已有 大量 的 文献 发表 ， 其中 松弛 匹配 算法 是 一种 有效 的 图象 匹配 技术 。 文献 ［ 1 ］ 提出 了 基于 特征 点 的 松弛 匹配 方法 ， 它 能克服 小 的 比例 及 旋转 变化 ， 但 对于 较大 的 比例 与 旋转 变化 则 不 具有 不变性 。 文献 ［ 2 ］ 则 给出 了 具有 旋转 与 比例 不变 的 点 特征 构弛 匹配 算法 。 由于 松弛 匹配 算法 与 Hopfield 神经网络 间 存在 的 密切关系 ， 使 其 具有 实时 应用 前景 ， 因此 ， 研究 采用 Hopfield 神经网络 实现 松弛 匹配 算法 是 有 实际意义 的 。 文献 ［ 3 ］ 给出 了 用 神经网络 实现 概率 松弛 过程 的 一种 方法 ， 并用 该 方法 实现 了 二值化 门限 的 功能 ， 文献 ［ 4 ］ 和 ［ 5 ］ 实现 了 利用 Hopfield 神经网络 的 点 特征 匹配 技术 ， 其中 文献 ［ 4 ］ 的 方法 不能 克服 旋转 和 比例 变化 ， 而 文献 ［ 5 ］ 的 方法 虽然 对 旋转 和 比例 变化 不 敏感 ， 但 由于 采用 双 Hopfield 网络结构 ， 不仅 增加 了 网络 规模 ， 而且 在 用于 假设检验 的 第二级 网络 中 ， 顺序 检验 第一级 假设 生成器 网络 生成 的 所有 假设 ， 其 运行 速度 也 受到 了 影响 ， 文献 ［ 6 ］ ［ 7 ］ 则 给出 了 用 Hopfield 神经网络 实现 基本点 特征 松弛 匹配 过程 的 一种 方法 。 
 　 　 本文 中 ， 我们 在 旋转 与 比例 不变 的 点 特征 松弛 匹配 方法 的 基础 上 ［ 2 ］ ， 研究 了 用 Hopfield 神经网络 完成 旋转 与 比例 不变 的 点 特征 松弛 匹配 过程 的 方法 。 在 第 2 节中 ， 简要 描述 了 具有 旋转 与 比例 不变性 的 点 特性 松弛 匹配 算法 的 实现 过程 。 第 3 节则 给出 了 用 Hopfield 神经网络 实现 旋转 与 比例 不变 点 特征 松弛 匹配 过程 的 方法 。 第 4 节中 给出 了 实验 结果 ， 最后 是 结论 。 
 　 　 2 　 旋转 和 比例 不变 点 特征 松弛 匹配 算法 ［ 2 ］ 
 　 　 文献 ［ 2 ］ 给出 了 旋转 与 比例 不变 的 点 特征 松弛 匹配 算法 的 详细描述 ， 这里 简述 如下 。 考虑 两 特征 点集 P = { p1 , p2 , … , pm } 及 Q = { q1 , q2 ， … , qn } , 其中 P 为 Q 的 某 一 子集 经过 平移 、 旋转 及 比例 变化 后 ， 再迭加 一定 的 随机 游动 误差 而 得到 的 点集 。 对 每 一 四元组 ( pi , qj , ph , qk ) ， 定义 两 特征 点集间 的 相对 偏移 。 令 δ ijhk ( u , v ) 为 当 pi 与 qj 配对 且 ph 与 qk 配对 时 pu 与 qv 间 的 距离 。 
 　 　 令 ： 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 1 ) 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 2 ) 
 则 由 四元组 ( pi , qj , ph , qk ) 可 求得 在 pi 与 qj 配对 且 ph 与 qk 配对 的 情况 下 ， 从 Q 到 P 的 比例 变化 α 为 ： 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 3 ) 
 Δ p 与 x 轴 正向 间 的 夹角 为 ： 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 4 ) 
 而 Δ q 与 x 轴 正向 间 的 夹角 为 ： 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 5 ) 
 这里 i = ( 1 , 0 ) T ， 即 沿 x 轴 正向 的 单位 矢量 。 
 　 　 于是 可得 从 Q 到 P 的 旋转 变化 θ 为 ： 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 6 ) 
 从而 得到 δ ijhk ( u , v ) 的 计算公式 如下 ： 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 7 ) 
 其中 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 8 ) 
 这里 α 表示 由式 ( 3 ) 所 确定 的 比例 变化 因子 ， A2 为 由式 ( 6 ) 确定 的 旋转 变化 因子 所 构成 的 旋转 变化 矩阵 。 
 　 　 令 ( pu , qv ) 对 ( pi , qj , ph , qk ) 的 支持 度为 ： 
  　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 9 ) 
 　 　 若 要求 当 pi 与 qj 配对 且 ph 与 qk 配对 时 ， pu 仅 与 和 其 相 联系 的 、 对 ( pi , qj , ph , qk ) 的 支持 度 最大 的 qv 相配 对 ， 则 可得 如下 支持 度 表达形式 ： 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 10 ) 
 　 　 取 所有 pu 之 和 的 平均 得到 ( pi , qj , ph , qk ) 的 初始 支持 度为 ： 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 11 ) 
 及 ( pi , qj ) 的 初始 支持 度为 ： 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 12 ) 
 　 　 在 第 r 次 迭代 ( r ＞ 0 ) 时 ， ( pu , qv ) 及 ( pi , qj , ph , qk ) 的 支持 度 同时 依赖于 在 pi 与 qj 配对 且 ph 与 qk 配对 的 条件 下 pu 和 qv 间 的 位置 差别 及 它们 的 sr - 11 ( pu , qv ) 值 。 为了 体现 出 这 两个 因素 的 相互作用 ， 我们 取 它们 中 的 最小值 ， 因此 有 ： 
 　 　 　 　 　 　 ( 13 ) 
 及 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 14 ) 
 　 　 定义 ： ， 则 当 dr ＜ ε 时 ， 迭代 终止 ， 这里 ε 为 一个 预先 设定 的 极小 正数 。 
 　 　 3 　 用 Hopfield 神经网络 实现 的 旋转 与 比例 不变 松弛 匹配 算法 
 　 　 在 Hopfield 网络 中 ， 每 一个 神经元 都 和 所有 其它 神经元 相连接 。 若令 ui 表示 神经元 i 的 状态 ， 则 描述 ui 变化 的 过程 为 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 15 ) 
 这里 Tij 为 神经元 i 与 j 间 的 连接 权 ； Ii 表示 外部 输入 偏置 ； τ i 为 一个 时间常数 ， 为 简单 起 见 ， 可 设定 为 1 ； Vj 表示 神经元 j 的 输出 ， 其 取值 为 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 16 ) 
 它 是 一个 S 型 单调 递增 函数 。 
 　 　 描述 网络 状态 的 能量 函数 定义 为 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 17 ) 
 由于 神经元 i 的 输出 变化 dVi 而 带来 的 E 的 变化 dEi 则 为 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 18 ) 
 　 　 我们 的 目标 就是 找到 一个 优度 函数 ， 使得 其值 在 松弛 过程 中 不断 增加 ， 并 将 该 优度 函数 变换 成 Hopfield 神经网络 的 能量 函数 ， 网络 中 的 一个 神经元 与 一个 s ( pi , qj , ph , qk ) 值 相对 应 ， 而 神经元 之间 的 连接 则 体现 了 各 神经元 之间 的 关系 。 
 　 　 在 我们 的 松弛 匹配 过程 中 ， 定义 优度 函数 F 如下 ： 
 　 　 　 　 　 　 　 　 　 　 　 　 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 19 ) 
 并 使用 如下 的 Hopfield 神经网络 能量 函数 ： 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 20 ) 
 　 　 其中 第 1 项 除了 存在 一个 常 数值 ( m - 1 ) / 2 外与式 ( 19 ) 基本相同 ； 而 第 2 项 在 所有 表示 某个 pi 不同 配对 点 的 神经元 的 输出 之 和 等于 1 ( 这 意味着 每 一个 pi 只能 与 一个 qj 配对 ) 时 ， 得到 最小值 零 。 
 　 　 将式 ( 19 ) 代入 式 ( 20 ) ， 并 展开式 ( 20 ) ， 可 得 ： 
 　 　 　 　 　 　 　 　 　 　 　 ( 21 ) 
 　 　 忽略 常数 项 ， 由式 ( 21 ) 可 得 连接 权 矩阵 和 输入 偏置 的 值 为 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 22 ) 
 其中 
 　 　 　 　 
 　 　 　 　 
 　 　 　 　 
 　 　 　 　 
 　 　 　 　 
 而 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 23 ) 
 注意 这里 ( ijhk ) 和 ( uvst ) 表示 两个 单一 的 下标 。 
 其中 
 　 　 　 　 　 　 　 　 　 　 
 　 　 　 　 　 　 　 　 　 　 
 　 　 为了 保证 映射 后 的 Hopfield 网络 的 收敛性 ， T 必需 为 对称 矩阵 ， 因此 我们 将 T ′ ( ijhk ) ( uvst ) 和 σ ( ijhk ) ( uvst ) 的 定义 修改 为 
 　 　 　 　 　 　 　 　 　 
 　 　 　 　 　 　 　 　 　 
 　 　 此时 连接 权 矩阵 为 ： 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 24 ) 
 　 　 当 T ( ijhk ) ( uvst ) 和 Iijhk 固定 以后 ， 神经网络 的 最终 状态 便 仅仅 依赖于 它 的 初始状态 。 因此 在 网络 演变 开始 以前 ， 必需 根据 先验 知识 设定 各 神经元 的 初始状态 。 在 本文 中 ， 设定 各 神经元 的 初始状态 u0ijhk 为 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 25 ) 
 　 　 在 确定 了 连接 权 矩阵 、 输入 偏置 及 各 神经元 的 初始状态 以后 ， 网络 的 能量 面 和 局部 最小 点 便 完全 确定 了 ， 整个 网络 将 达到 某个 特定 的 局部 最小 点 。 
 　 　 4 　 实验 结果 
 　 　 为了 证明 本文 算法 的 正确性 ， 在 模拟 图像 上 进行 了 大量 的 实验 ， 得到 令人满意 的 实验 结果 。 
 　 　 ( 1 ) 模拟实验 方法 
 　 　 设 匹配 所用 两幅 图像 I1 和 I2 的 大小 分别 为 N1 × N2 和 M1 × M2 ， 其中 N1 ＞ M1 ， N2 ＞ M2 。 首先 在 I1 中 任意 产生 N 个点 作为 特征 点 ， 此即 为 匹配 算法 中 的 特征 点集 Q 。 然后 选取 I1 中 大小 为 M1 × M2 的 一个 子图 ， 设该 子图 包含 M 个 特征 点 ， 将 这 M 个 特征 点 绕子 图 中心 旋转 θ 角 ， 并 加上 大小 为 的 比例 变化 ( 假定 经过 旋转 和 比例 变化 后 这 M 个 特征 点均 未 超出 子图 范围 ) ， 最后 所得 图像 即 为 匹配 算法 中 的 特征 点集 P 。 
 　 　 ( 2 ) 模拟实验 结果 
 　 　 实验 中 ， 取 N1 = N2 = 128 , M1 = M2 = 64 ， 在 I1 中 产生 30 个 特征 点 ， 式 ( 15 ) 中 的 dt 取值 为 0.0001 ， 式 ( 16 ) 中 的 λ 取值 为 10 。 这里 给出 了 其中 的 两个 实验 结果 。 图 1 至图 3 为 一个 实验 结果 ， 图 1 ( a ) 和 ( b ) 分别 表示 产生 的 I1 和 I2 ， 其中 取 θ = - 80 ° ， α = 1.6 。 图 2 显示 了 用于 获得 旋转 和 比例 变化 因子 的 累加器 的 三维 曲线图 。 由图 2 ， 我们 可 求得 α = - 80 ° ， α = 1.6 。 图 3 ( a ) 显示 了 在 θ = - 80 ° 及 α = 1.6 的 条件 下 ， 所有 偏移 的 匹配 度量 值 。 图 3 ( b ) 中 的 方框 显示 了 点集 Q 中 与 最大 匹配 度量 值 所 对应 的 子 图 位置 。 图 4 至图 6 为 另 一个 实验 结果 ， 这里 取 θ = 60 ° ， α = 1.6 。 
 　 　 　 　 　 
 　 　 ( a ) 点集 Q 　 　 　 　 　 　 　 　 　 ( b ) 点集 P 
 图 1 　 点集 Q 和 p 
 
 图 2 　 用于 获得 旋转 和 比例 变化 因子 
 的 螺加器 的 三维 曲线图 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 
 　 　 ( a ) 在 θ = - 80 ° 及 α = 1.6 的 条件 下 ， 　 　 　 ( b ) 匹配 结果 
 　 　 　 　 　 　 　 　 　 　 　 　 所有 偏移 的 匹配 度量 值 
 图 3 　 实验 结果 
 　 　 　 　 　 　 
 　 ( a ) 点集 Q 　 　 　 　 　 　 　 　 　 　 ( b ) 点集 P 
 　 图 4 　 点集 Q 和 p 
 
 图 5 　 用于 获得 旋转 和 比例 变化 因子 的 
 累加器 的 三维 曲线图 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 
 　 　 ( a ) 在 θ = 60 ° 及 α = 1.6 的 条件 下 ， 　 　 　 　 　 　 ( b ) 匹配 结果 
 　 　 　 　 　 　 　 　 　 　 　 所有 偏移 的 匹配 度量 值 
 　 　 　 图 6 　 实验 结果 
 　 　 5 　 结论 
 　 　 根据 松弛 匹配 算法 与 Hopfield 神经网络 间 存在 的 内在联系 ， 本文 在 旋转 与 比例 不变 点 特征 松弛 匹配 算法 的 基础 上 ， 提出 了 用 Hopfield 神经网络 完成 旋转 与 比例 不变 点 特征 松弛 匹配 过程 的 方法 ， 利用 神经网络 强大 的 并行处理 信息 的 能力 ， 实时 实现 松弛 匹配 过程 。 对 模拟 图像 进行 的 大量 实验 ， 证实 了 采用 Hopfield 神经网络 完成 旋转 与 比例 不变 点 特征 松弛 匹配 过程 的 有效性 和 可行性 。 
 * 国防科工委 预研 基金 资助 项目 
 作者 单位 ： 桑农 ： 华中理工大学 图象识别 与 人工智能 研究所 . 武汉 . 430074 
 　 　 　 　 　 张天序 ： 图象 信息处理 与 智能 控制 国家教委 开放 实验室 . 武汉 . 430074 
 参考文献 
 　 　 1 　 Ranade   S , Rosenfeld   A . Point   pattern   matching   by   relaxation . Pattern   Recognition , 1980 , 12 ( 4 ) : 269 - 275 
 　 　 2 　 桑农 ， 张天序 . 旋转 与 比例 不变 的 点 特征 松弛 匹配 算法 . 电子学 报 ， 1998 ， 26 ( 6 ) ： 74 - 77 , 81 
 　 　 3 　 Yu   S   S , Tsai   W   H . Relaxation   by   the   Hopfield   neural   network . Pattern   Recognition , 1992 , 25 ( 2 ) : 197 - 209 
 　 　 4 　 赵宇明 ， 李介谷 . 用于 点 特征 匹配 的 神经网络 算法 . 模式识别 与 人工智能 ， 1995 ， 8 ( 4 ) ： 313 - 319 
 　 　 5 　 黎倩 ， 陈迪 ， 吴 健康 . 神经网络 图像匹配 . 模式识别 与 人工智能 ， 1992 ， 5 ( 3 ) ： 221 - 228 
 　 　 6 　 桑农 等 . 松弛 匹配 算法 的 神经网络 实现 . 通信 学报 ， 1996 ， 17 ( 2 ) ： 46 - 52 
 　 　 7 　 Sang   N   etc . Relaxation   matching   by   the   Hopfield   neural   network . Proc . of   SPIE , 1996 , 2664 : 182 - 190 
 收稿 日期 : 1997 年 1 月 2 日 , 修回 日期 : 1998 年 7 月 30 日 
