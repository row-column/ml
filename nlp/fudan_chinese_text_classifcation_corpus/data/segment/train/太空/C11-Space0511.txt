航空 计测 技术 
 Aviation 　 Metrology 　 & 　 Measurement 　 Technology 
 1999 年   第 19 卷   第 3 期   Vol.19   No.3   1999 
 
 
 
 最小 二乘 参数估计 若干 问题 的 讨论 
 周维虎  　 费业 泰 　 丁叔丹 
 摘 　 要 　 讨论 了 最小 二乘 估计 中应 注意 的 几个 问题 ， 指出 了 最小 二乘 估计 的 一些 新 的 研究 和 应用 方向 。 
 关键词 　 最小 二乘 　 参数估计 　 精度 预测 　 稳健 估计 
 Discussion   on   Some   Problems   about   the   Use   of   Least   Square   Parameter   Estimation 
 Zhou   Weihu 　 Fei   Yetai 　 Ding   Shudan 
 Abstract 　 Some   attentive   problems   involved   in   least   square ( LSQ )   parameter   estimation   are   discussed   in   this   paper . The   new   research   and   application   trends   about   LSQ   are   pointed   out   as   well . 
 Key   words 　 LSQ , Parameter   estimation , Precision   prediction , Robust   estimation 
 　 　 在 各种 工程 测量 中 ， 最小 二乘 参数估计 不 受 测量 值 误差 分布 的 影响 ， 因而是 一种 有效 的 方法 ， 得到 了 广泛 的 应用 。 但 也 会 出现 一些 问题 ， 使 最小 二 乘法 的 应用 受到 影响 ， 如 ： 随着 参数 的 增加 ， 解算 效率 和解 算 精度 下降 ； 参数 相关 或复 相关 导致 法 方程 奇异 ； 粗差 对 参数估计 影响 较大 等 。 本文 提出 若干 问题 加以 讨论 。 
 1 　 基本原理 
 　 　 使用 最小 二 乘法 估计 参数 时 ， 首先 应 列出 误差 方程式 。 设有 n 个 测量 方程 
 
 误差 方程 为 
 
 式 中 ， 
 
 误差 方程 的 矩阵 形式 为   V ＝ AX ＋ l 
 当 测量 值 L 相互 独立 时 ， 其权阵 P 是 对角 阵 。 
 法 方程 为 　 ATPAX ＋ ATPl ＝ 0   ( 2 ) 
 参数 的 最佳 估计值 为 　 X ＝ － ( ATPA ) － 1 . ( ATPl ) ＝ － N － 1 . U ( 3 ) 
 式 中 ， N ＝ ATPA 　 U ＝ ATPl 
 当 误差 方程 为 非线性 时 ， 设 vi ＝ fi ( x1 ， x2 ， … ， xt ) － Li   ( i ＝ 1 ， 2 ， … ， n ) 
 按 泰勒 公式 展开 ， 略去 二次 以上 的 高次 项 ， 得 
 
 按 线性方程 处理 ， 解得 δ xj ( j ＝ 1 ， 2 ， … ， t ) 
 参数 解 　 　 　 　 　 　 　 　 xj ＝ x0j ＋ δ xj 　 　 
 以下 讨论 仅限于 线性 参数 最小 二乘 估计 。 
 2 　 若干 问题 的 讨论 
 2.1 　 初值 的 选定 
 　 　 测量 中 ， 经常 会 出现 误差 方程 中 常数 项 有效数字 位数 较 多 的 情况 ， 因此 ， 法 方程 常数 项 的 数字 位数 也 较 多 ， 使 后续 计算 难度 增加 。 此时 ， 可 引入 未知数 近似值 加以 简化 。 
 令 　 xj ＝ x0j ＋ δ xj   ( j ＝ 1 ， 2 ， … ， t ) 
 代入 ( 1 ) 式 得 
 
 　 　 vi ＝ ai δ x1 ＋ bi δ x2 ＋ … ＋ ti δ xt ＋ li   ( 5 ) 
 式 中 ， li ＝ aix01 ＋ bix02 ＋ … ＋ tix0t ＋ di － Li 
 　 　 　 　 ＝ L0i － Li 
 矩阵 形式 　 V ＝ A δ X ＋ l 　 　 
 　 　 应 注意 的 是 ， 参数 近似值 一旦 选定 ， 不能 再 变动 。 否则 ， 将 得不到 正确 的 估计 结果 。 其次 ， 由于 引用 了 参数 近似值 ， 误差 方程 ( 5 ) 中 常数 项 li 有效数字 变 少 。 为了 计算 方便 ， 计算 单位 应 作 相应 调整 ， 选用 测量 值 最小 单位 作为 计算 单位 。 
 　 　 当 参数 模型 为 非线性 时 ， 误差 方程 需在 x0j 处 展开 成 线性 模型 ， 若 x0j 给 的 不准 ， 会 影响 计算精度 。 因为 ， 只有 当 δ xj 很 小时 ， 高次 项 才 可 忽略不计 。 一般 先 通过 少量 数据 或 其它 简单 公式 得到 近似值 。 
 　 　 例如 ： 在 球面 拟合 中 ， 当 ( xi ， yi ， zi ) 为 球面 上 的 均匀 采集 点时 ， 球心 坐标 和 半径 ( 球面 拟合 中 的 待估 参数 ) 的 近似值 可取 为 近似 圆心 到 第 i 点 的 距离 。 也 可以 采用 多次 迭代 。 此时 ， 参数 的 最后 估计 结果 为 
 
 中等 式 右端 分别 为 xj 的 初值 、 第一次 、 第二次 、 … 第 n 次 迭代 结果 。 
 2.2 　 待估 参数 的 选取 
 　 　 最小 二乘 参数估计 中 ， 未知数 个数 应 等于 待估 参数 的 个数 ， 且 应 相互 独立 ， 当 未知数 之间 相关 时 ， 法 方程 ( 2 ) 中 ATPA 奇异 ， 法 方程 无 确定 解 。 因此 ， 要 使法 方程 有 确定 解 ， ATPA 应非 奇异 ， 即 A 阵中 不能 有 相关 项 。 拟定 测试 方案 时 ， 应使 未知数 足数 且 相互 独立 。 万一 系统 参数 或待估 参数 过多 ， 导致 相关 或复 相关 ， 应对 系统 参数 进行 比较 和 优选 。 或者 ， 通过 检查 A 阵 ， 发现 相关 列则 去掉 这些 列 ， 将列 中待估 参数 当成 零 处理 。 在 最小 二乘 参数估计 中 ， 过度 选取 参数 极易 造成 相关 ， 这 一点 使用 时需 加以 注意 。 
 　 　 例如 : 在 机器人 空间 定位 误差 补偿 时 ， 需 识别 关节 几何 误差 参数 。 每个 关节 有 三个 旋转 参数 ， 三个 移动 参数 。 若有 n 个 关节 ， 待估 参数 总数 为 6n 个 。 因此 ， 当 n 较多时 ， 极易 造成 相关 或复 相关 。 对 某台 RM — 501 五 关节 机器人 研究 发现 ， 在 总共 30 项待估 参数 中 ， 仅 有 15 项 参数 独立 ， 其余 15 项 相关 或复 相关 。 
 2.3 　 参数 及其 函数 的 精度 评定 
 2.3 . 1 　 单位 权 标准偏差 σ 0 ＝ ( [ pvv ] ／ ( n － t ) 1 ／ 2   ( 7 ) 
 式 中 ， n 为 测量 值 个数 ； t 为 未知数 个数 。 
 [ pvv ] 值 可 根据 剩余 误差 直接 求得 　 vi ＝ ai δ x1 ＋ bi δ x2 ＋ … ＋ ti δ xt ＋ li   ( i ＝ 1 ， 2 ， … ， n ) 也 可 按 下式 求得 
 
 
 顾及 ATPV ＝ 0 ， 得 
 
 ATPl 是 ( 2 ) 中 的 常数 项 矩阵 。 
 顾及 ( 3 ) 式 得 
 　 　 
 　 　 可以 看出 ， 由 ( 8 ) 式 计算 [ pvv ] 较之 先 计算 vi 再 计算 [ pvv ] 要 简便 得 多 。 [ pvv ] 的 两种 计算方法 可 相互 核验 。 
 　 　 单位 权 标准偏差 求得 后 ， 还 需 给出 参数 及其 函数 的 权 倒数 ， 才能 计算 出 它们 的 精度 。 
 2.3 . 2 　 参数 的 权 倒数 及其 标准偏差 
 最小 二乘 估计 参数 的 权 倒数 为 　 Qxx ＝ N － 1   ( 9 ) 
 它 是 法 方程 系数 阵 的 逆阵 , 所以 ， 参数 的 标准偏差 
 
 2.3 . 3 　 参数 函数 的 权 倒数 及其 标准偏差 
 　 　 设 测量 结果 表示 成 参数 的 函数 ， 其 关系式 为 F ＝ f ( x1 ， x2 ， … ， xt ) 
 函数 F 的 权函数 式 为 
 
 按协 因素 ( 权 倒数 ) 传播 律 ， 得 
 
 ( 12 ) 式 中 q ＝ N － 1 ． f 等价 于 　 N ． q － f ＝ 0   ( 13 ) 
 在 ( 12 ) 、 ( 13 ) 式 中 ， q ＝ ( q1 ， q2 ， … ， qt ) T 。 由 ( 13 ) 式 可以 看出 ， 只要 将法 方程 ( 2 ) 中 的 常数 项 换成 f ， 解法 方程 即可 求得 q 。 最后 ， 参数 函数 F 的 标准偏差 
 　 　 
 　 　 由 上述 推导 可以 看出 ， 参数 的 权 倒数 阵 Qxx 无论 对于 参数 精度 或是 参数 函数 的 精度 都 具有 重要 意义 。 
 2.3 . 4 　 待估 参数 的 精度 预测 
 　 　 前 已 说明 ， 待估 参数 的 精度 取决于 权 系数 阵 N － 1 ， 而 N － 1 ＝ ATPA 仅 由 误差 方程 系数 和 测量 值 L 的 权 决定 ， 与 测量 值 无关 。 这样 ， 在 实施 测量 之前 ， 就 有 可能 利用 误差 方程 系数 阵 ( 由 具体 问题 决定 ) 求得 N － 1 。 根据 N － 1 可以 知道 某 估计量 的 权 倒数 ， 从而 事先 预测 该 参数 的 精度 。 
 　 　 另外 ， 在 知道 N － 1 的 情况 下 ， 一旦 测量 值 拿到 以后 ， 就 可以 迅速 计算 参数值 ， 从而 大大提高 了 测量 效率 。 
 2.4 　 粗差 检验 
 　 　 最小 二乘 参数估计 遵循 VTPV ＝ min 准则 ， 估计 结果 容易 受到 粗大 误差 的 影响 ; 因此 ， 在 测量 过程 中 和 参数估计 之后 尤其 应 注意 粗差 检验 。 粗差 检验 首先 要 构造 与 残差 有关 的 统计 量 ， 然后 进行 粗差 的 整体 检验 和 单个 检验 。 整体 检验 一般 可用 F 分布 或 χ 2 分布 检验法 。 检验 通过 说明 所有 测量 值均 不 含有 粗差 ， 检验 不 通过 则 需 对 测量 值 进行 单个 粗差 检验 。 一般 选 统计 量 
 
 式 中 ， qii 为 残差 V 的 权 倒数 阵 Qvv 的 对角线 元素 。 
 
 　 　 根据 选定 的 显著 水平 α ， 查 正态分布 表 的 双侧 检验 临界值 z α ， 若 ｜ zi ｜ ＜ z α ， 认为 该 测量 值 不 含有 粗差 。 否则 ， 应 剔除 该 测量 值 ， 重新 解算 。 
 　 　 值得一提的是 ， 为了 抑止 粗差 的 影响 ， 人们 提出 了 稳健 估计 ( 也 称 抗差 估计 ) ， 它 可以 有效 减小 粗差 对 参数估计 的 影响 。 
 2.5 　 稳健 估计 
 　 　 稳健 估计 ( Robust   Estimation ) 的 含义 是 ， 在 估计 过程 中 自动 进行 粗差 剔除 ， 使 参数估计 结果 不 受 含有 粗差 的 测量 值 影响 。 稳健 估计 最具 代表性 的 有 选择权 迭代法 和 P — 范 最小 法 。 
 　 　 选择权 迭代法 的 思路 是 ， 从 最小 二乘 估计 开始 ， 每次 迭代 估计 后 ， 根据 残差 大小 和 选择 的 权 计算 每个 测量 值 在 下 一步 迭代 计算 中 的 权值 。 如果 权函数 选择 适当 ， 含有 粗差 的 测量 值 的 权 将 越来越 小 ， 直至 趋于 零 。 迭代 中止 时 ， 参数估计 结果 将 不再 受 粗差 影响 。 选择权 迭代法 的 准则 为 
 
 式 中 ， pni 为 第 n 次 迭代 时 ， 第 i 个 测量 值 的 权 。 计算公式 为 
 
 f ( vi ) 为 测量 值 Li 的 权函数 ， 它 是 残差 vi 的 函数 。 权函数 的 选择 有 不同 的 方法 ， 如 丹麦 法 、 李德 仁法 等等 。 应 根据 具体 测量 对象 而定 。 
 　 　 稳健 估计 另 一种 典型 方法 是 P — 范 最小 法 ， 也 称 LP 法 。 该 估计 的 准则 为 
 
 　 　 当 测量误差 服从 P — 范 分布 时 ， 参数 估值 与 极大 似然法 估计值 一致 。 一般 常取 P ＝ 1 ～ 1.5 ， 当 P ＝ 1 时 ， 即 为 绝对值 最小 和 法 。 绝对值 最小 和 法 被 认为 具有 较 好 的 粗差 识别 能力 ， 但 估计 效率 很 低 。 最好 的 办法 是 将 各种 估计 方法 组合 起来 ， 以 充分发挥 各自 的 优势 。 如 基于 I — 范解 的 加权 最小 二乘 估计 ， 就 具有 较强 的 粗差 剔除 能力 和 良好 的 统计 特性 ， 是 一种 比较 好 的 稳健 估计 法 。 
 3 　 结束语 
 　 　 随着 理论 研究 和 应用 的 深入 ， 新 的 计算方法 不断 发展 。 对于 线性 最小 二乘 问题 ， 传统 的 方法 是从 构造 法 方程 入手 ， 而 新 的 算法 则 试图 直接 从 矛盾 方程 入手 ， 避免 了 法 方程 的 缺陷 。 非线性 最小 二乘 问题 的 发展 也 很 迅速 。 在 参数 直接 估计 的 基础 上 ， 又 出现 了 各种 带 约束条件 的 最小 二乘 问题 。 这些 问题 不仅 存在 于 工程 当中 ， 而且 也 大量 存在 于 诸如 统计 、 数学 规划 、 经济 、 控制 、 最优化 以及 社会科学 的 各个领域 。 特别 是 随着 计算机 、 矩阵 代数 、 概率 统计 理论 的 组合 应用 ， 产生 了 现代 参数估计 理论 。 
 　 　 关于 现代 参数估计 理论 ， 首先 是 测量 值 广义 化 导致 了 相关 参数估计 ， 其次 是 秩亏 参数估计 ， 随后 又 出现 了 最二乘 推估 ， 它 将 随机 过程 也 作为 未知数 包含 在 模型 之中 。 此外 ， 针对 最小 二 乘法 的 局限 ， 又 出现 了 抗差 估计 方法 ， 即 各种 稳健 估计 和 有 偏 估计 。 上述 方法 有效 地 改进 和 完善 了 最小 二 乘法 。 关于 近代 最小 二乘 估计 超出 了 本文 范围 ， 不 作 深入 讨论 。 
 作者简介 ： 36 岁 　 男 　 高级 工程师 
 作者 单位 ： 周维虎  　 费业 泰 　 丁叔丹 　 ( 长城 计量 测试 技术 研究所 ， 北京市 ， 100095 ) 
 参考文献 
 　 　 1 　 费业 泰 . 误差 理论 与 数据处理 . 北京 : 机械 工业 出版社 , 1995 
 　 　 2 　 於 宗寿 . 测量 平差 基础 . 北京 : 测绘 出版社 , 1984 
 　 　 3 　 李广 云 . 工业 测量 系统 . 北京 : 解放军出版社 , 1994 
 　 　 4 　 夏凯 等 . 机器人 控制 . 北京 : 清华大学出版社 , 1994 
 　 　 5 　 刘钦圣 . 最小 二乘 问题 计算方法 . 北京 : 北京工业大学 出版社 , 
 收稿 日期 ： 1998 - 10 - 09 
