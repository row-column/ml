航空 工艺技术 
 AERONAUTICAL   MANUFACTURING   TECHNOLOGY 
 1999 年 　 第 3 期 　 No.3   1999 
 
 
 
 三 牙轮 钻头 工艺 图 自动 生成 系统 
 The   Operation   Sketch   Generating   System   for   Tri _ Cone   Rock   Bit 
 郑联语 　 杜 　 裴 
 　 　 ［ 摘要 ］ 　 介绍 了 三 牙轮 钻头 工艺 图 自动 生成 系统 的 结构 和 功能 ， 论述 了 工艺 图 信息 模型 和 工艺 图 自动 生成 的 的 工作 原理 ， 提出 了 综合 参数 化 特征 组合 和 样板 图 尺寸 置换 2 种 方法 自动 生成 工艺 图 的 方法 。 
 　 　 关键词 ：   CAPP 　 工艺 图 　 工序 特征 　 三 牙轮 钻头 
 
 　 　 ［ ABSTRACT ］ 　 This   paper   introduces   the   structure   and   functions   of   the   operation   sketch   generating   system   for   tri _ cone   rock   bit .   The   information   model   of   operation   sketch   and   the   principle   of   automatically   generating   operation   sketch   are   discussed .   A   synthetical   approach   to   combine   parametric   features   and   to   substitute   the   dimensions   of   template   sketch   is   presented . 
 　 　 Keywords :   CAPP 　 Operation   sketch 　 Operation   feature 　 Tri - cone   rock   bit 
 
 　 　 工艺 图 自动 生成 是 计算机辅助 工艺 设计 CAPP ( Computer   Aided   Process   Planning ) 系统 的 一项 重要 任务 ， 也 是 CAPP 的 技术 难点 之一 。 将 工艺 图 生成 的 一般 原理 与 具体 产品 的 制造 工艺 特点 相结合 ， 同时 借助 商用 图形系统 为 平台 ， 可以 有效 地 自动 生成 工艺 图 ， 大大提高 自动 工艺 设计 效率 。 三 牙轮 钻头 工艺 图 自动 生成 系统 ( JZCAPP - DRAW ) 就是 我们 按照 上述 思想 开发 的 ， 它 是 JZCAPP 系统 总控 流程 控制 下 的 一个 子系统 ［ 1 ］ ， 能 完成 产品 图纸 信息 的 输入 ， 计算 工艺 尺寸 ， 自动 生成 和 交互 编辑 牙轮 和 牙 掌 的 全部 工序 图 。 该 系统 采用 CAD 图形 软件 MicroStation 作为 开发 与 使用 平台 ， 是 使用 MicroStation 提供 的 二次开发 语言 MDL ( MicroStation   Development   Language ) 开发 的 应用程序 ， 具有 原 系统 同样 的 风貌 ， 能 完全 融入 原 系统 中 ， 使用方便 。 系统 的 主要 特色 是 综合 参数 化 特征 组合 和 样板 图 尺寸 置换 2 种 方法 自动 生成 工艺 图 ， 能以 不同 颜色 分层 叠加 任意 工序 的 工艺 图 ( 前者 生成 的 ) ， 从而 能 方便 地 检查 加工余量 的 大小 及其 分布 的 合理性 。 
 
 1 　 系统结构 与 功能 
 　 　 JZCAPP - DRAW 系统结构 如图 1 。 带 方框 的 功能 菜单项 另有 子项 ， 因 篇幅 限制 未 展开 。 
 
 
 图 1 　 系统结构 
 Fig.1 　 Structure   of   the   system 
 1.1 　 文件 功能 ( File ) 
 　 　 完成 系统 所 产生 的 数据文件 的 装载 、 保存 和 查阅 ( 浏览 ) 。 其中 ， 产品 图 尺寸 信息 文件 ( PAT   File ) 和 工艺 图 尺寸 信息 文件 ( OPR   File ) 分别 用于 以 特征 为 单元 存取 产品 图 和 工艺 图 的 尺寸 信息 ； 图形 元素 信息 文件 ( DXF   File ) 用于 按 DXF 格式 存取 图形 ( 包括 产品 图 和 工艺 图 ) 的 几何 元素 信息 ， 便于 数据交换 ； 文件 浏览 ( Browse ) 用于 浏览 数据文件 的 内容 。 
 1.2 　 输入 功能 ( Input ) 
 　 　 完成 产品 信息 的 输入 。 其中 ， 总体 信息 ( Overall   Info ) 读入 产品 总体 信息 ， 包括 类型 、 名称 、 型号 、 图号 、 轴承 号 、 材料 规范 号 、 锁紧 方式 、 过程 卡 编号 等 ， 已 由 工艺 设计 时 输入 ， 这里 直接 读取 ； 毛坯 ( 锻件 ) 信息 ( ForgeInfo ) 读入 或 输入 毛坯 ( 锻件 ) 信息 ； 形状 特征 ( Features ) 用于 交互 输入 产品 的 形状 特征 信息 。 利用 特征参数 对话框 同时 结合 特征 参考 文件 ( 即 特征 图 ) 可 方便 地 输入 产品 的 几何 信息 ， 构成 产品 的 各种 不同 特征 ， 通过 特征 菜单 或 特征 图标 ( 由 Palette / Open 打开 ) 选取 。 三 牙轮 钻头 的 特征 主要 包括 ： 大 ( 小 ) 轴颈 、 大 ( 小 ) 轴承 孔 、 储油 孔 、 水孔 、 齿孔 、 定位 孔 、 塞销 孔 、 密封面 、 ( 卡簧 / 钢球 ) 锁紧 槽 、 油槽 、 合金 槽 等 。 
 1.3 　 生成 功能 ( Generate ) 
 　 　 系统 的 核心 部分 。 其中 ， 装载 工艺 过程 信息 ( Load   Plan ) 读入 工艺 过程 信息 ( 由 工艺 设计 产生 ) ； 计算 工艺 尺寸 ( Calculate ) 确定 ( 计算 / 选择 ) 工艺 尺寸 ； 连续 生成 全部 工序 图 ( Draw   All ) 用于 一次性 连续 生成 全部 工序 图 ； 生成 指定 工序 图 ( Draw   Single ) 用于 有 选择地 生成 某 指定 工序 图 ( 主要 用于 工序 间 的 加工余量 检查 ) 。 
 1.4 　 编辑 功能 ( Edit ) 
 　 　 完成 工序 图 的 特征 编辑 、 图形 元素 编辑 、 图形 元素 特性 修改 。 其中 ， 选择 工序 图 文件 ( DGN   File ) 选择 并 调入 特定 工序 的 工艺 图 ； 特征 编辑 ( Feature ) 以 特征 为 单元 对 特征 进行 删除 、 移动 和 复制 操作 ； 图形 元素 编辑 ( Element ) 对 构成 工艺 图 的 元素 ( 点 、 直线 段 、 圆 、 圆弧 、 文本 、 尺寸 ) 进行 删除 、 移动 和 复制 操作 ； 图形 元素 特性 修改 ( Properties ) 用于 更改 图形 元素 的 特性 ( 即 颜色 、 线型 、 线宽 等 属性 ) 。 
 　 　 此外 ， 调色板 图标 功能 ( Palette ) 用于 打开 和 关闭 特征 图标 调色板 。 每种 形状 特征 对应 一个 特征 图标 。 选取 某 特征 图标 与 选取 对应 的 特征 菜单 效果 相同 。 
 
 2 　 工艺 图 信息 模型 
 　 　 为 描述 工艺 图 的 动态变化 过程 ， 每个 工序 都 由 一个 工序 特征 ( OprFeature ) 集合 记录 构成 该 工艺 图 的 所有 特征 信息 ， 包括 特征 数目 、 类型 、 尺寸 参数 、 方位 及 加工 状态 等 。 随着 加工过程 的 进行 ， 工序 特征 集 的 内容 渐进 变化 ， 工艺 过程 结束 时 ， 最终 工序 的 工序 特征 集 特征 数目 恒 等于 零件 特征 数目 ， 所有 特征 的 工艺 尺寸 与 设计 尺寸 相同 。 
 　 　 为 便于 对 工艺 图 的 操作 及其 信息 的 管理 ， 工艺 图 的 信息 分两 部分 组织 ： 一部分 为 图形 的 高层 信息 ， 即 工序 特征 集合 ， 以 特征 为 单元 记录 工艺 图 的 所有 工序 特征 及 相关 尺寸 。 高层 信息 以 OPR 文件格式 存取 ， 供 生成 特征 图 和 选择 ( 或 设计 ) 工装 ( 刀 、 夹 、 量具 ) 用 ； 另 一部分 为 图形 的 低层 信息 ， 即 图形 元素 集合 ， 以 元素 为 单元 记录 工艺 图 所有 图形 元素 ( 直线 段 、 圆弧 、 圆 等 ) 的 几何 信息 。 低层 信息 以 DXF 文件格式 存取 ， 供 产生 工程图 以及 与 其他 CAD 系统 进行 数据交换 用 。 工艺 图 的 高低 两层 信息 ， 既 保持 相对 独立 又 通过 工序 特征 建立联系 。 工艺 图 信息 模型 可 概括 如下 。 
 　 　 高层 工序 特征 信息 ： 
 typedef   struct   oprSketchInfo ｛ 
 　 　 int   oprNo ; 　 　 　 　 　 　   ∥ 工序 号 ( 代码 ) 
 　 　 char * oprName ; 　 　 　 　 　 ∥ 工序 名称 
 　 　 char * oprSkhNo ; 　 　 　 　 ∥ 工序 图号 
 　 　 int   status ; 　 　 　 　 　 　 ∥ 生成 状态 标志 
 　 　 char * templateRef ; 　 　 　 ∥ 所 参考 样板 图 名 
 　 　 　 　 　 　 　 　 　 　 　 　 　 ∥ 空值 表示 无 参考 
 　 　 int   featNum ; 　 　 　 　 　 ∥ 工序 特征 数目 
 　 　 OprFeature   features ［ ］ ; ∥ 工序 特征 表 
 ｝ OprSketch ; 
 typedef   struct   oprFeatureInfo ｛ 
 　 　 int   featNo ; 　 　 　 　 　 　 ∥ 特征 号 ( 类型 编码 ) 
 　 　 int   machined ; 　 　 　 　 　 ∥ 加工 状态 标志 
 　 　 char * featName ； 　 　 　 　 ∥ 特征 名称 
 　 　 Point   location ; 　 　 　 　 ∥ 位置 信息 
 　 　 Placement   orientation ; ∥ 方向 ( 姿态 ) 信息 
 　 　 int   featParamNum ; 　 　 　 ∥ 特征参数 数目 
 　 　 DimType   featParams ［ ］ ； ∥ 特征参数 表 
 　 　 ElementNode * 　 featElemP ; ∥ 特征 图形 元素 头 指针 
 ｝ OprFeature ； 
 　 　 低层 图形 元素 信息 ： 
 　 　 typedef   struct   elemInfoNode ｛ 
 　 　 int   elementType ; 　 　 　 　 　 ∥ 图形 元素 类型 
 　 　 Element   elemInfo ; 　 　 　 　 ∥ 图形 元素 信息 
 　 　 struct   elemInfoNode * 　 link ; ∥ 元素 链表 指针 
 ｝ elementNode ; 
 typedef   union   elementUnion ｛ 
 　 　 Point   point ; 　 　 　 　 　 ∥ 点 
 　 　 Line   line ; 　 　 　 　 　 　 ∥ 线段 
 　 　 Arc   arc ; 　 　 　 　 　 　 　 ∥ 圆弧 
 　 　 Circle   circle ; 　 　 　 　 ∥ 圆 
 　 　 Text   text ; 　 　 　 　 　 　 ∥ 文本 
 　 　 Dimension   dim ; 　 　 　 　 ∥ 尺寸 
 ｝ Element ； 
 
 3 　 工艺 图 自动 生成 原理 
 　 　 工艺 图 自动 生成 过程 如图 2 所示 ， 分为 4 个 阶段 ， 即 输入 产品 信息 ( 包括 总体 、 形状 特征 与 工艺 过程 3 方面 信息 ) 、 确定 工艺 尺寸 、 生成 工艺 图 和 编辑 工艺 图 。 
 
 
 图 2 　 工艺 图 自动 生成 工作 原理 
 Fig.2 　 Working   principle   of   operation   sketch   generating   system 
 3.1 　 确定 工艺 尺寸 
 　 　 对于 任意 工序 、 工艺 尺寸 的 确定 过程 如下 ： 
 　 　 ( 1 ) 继承 上 道工序 的 工艺 尺寸 ( 即 工序 特征 集 ) 。 
 　 　 ( 2 ) 计算 或 选择 本 工序 的 工艺 尺寸 。 分 3 种 情形 ： 若 为 现有 产品 ， 则 从 工艺 数据库 中 选择 该 产品 相应 工序 的 工艺 尺寸 ； 若为 新 产品 且 与 现有 产品 类似 ， 即 只有 少数 尺寸 变化 且 变化 值 在 规定 范围 内 ， 则 最终 工序 ( 精加工 ) 的 工艺 尺寸 取 产品 尺寸 ， 而 其他 工序 则 取 类似 产品 的 相应 工序 的 工艺 尺寸 ( 目的 是 减少 专用 工装 ) ； 若为 新 产品 ， 则 按 余量 规则 和 经验 公式 计算 工艺 尺寸 。 
 　 　 ( 3 ) 根据 加工 内容 更新 工序 特征 集 。 
 　 　 ( 4 ) 生成 工艺 图 尺寸 信息 文件 ( 工艺 图号 . OPR ) 。 
 3.2 　 生成 工艺 图 
 　 　 生成 工艺 图 采用 参数 化 特征 组合 和 样板 图 尺寸 置换 2 种 方法 。 
 　 　 ( 1 ) 若 工艺 图 尺寸 和 拓扑 结构 都 变化 ( 如 牙轮 轴承 孔和牙 掌 轴颈 工艺 图 ) ， 则 采用 参数 化 特征 组合 的 方法 ， 即 调用 特征 图 生成 子程序 经过 精确 的 几何 交切 处理 生成 各 特征 图 ， 工序 特征 集中 所有 特征 图 都 生成 后 便 组合成 工艺 图 ， 并 自动 标注 工艺 尺寸 。 这种 方法 灵活性 好 ， 能 充分 满足 工艺 图 动态变化 的 要求 。 
 　 　 ( 2 ) 若 工艺 图 只有 尺寸 变化 而 拓扑 结构 不变 ( 如牙掌 外形 、 水孔 和 储油 孔 工艺 图 ) ， 则 采用 样板 图 尺寸 置换 的 方法 。 该 方法 的 原理 是 ， 先 根据 工序 代码 和 零件 总 信息 确定 复制 工艺 样板 图库 中 某个 样板 图 。 在 样板 图中 ， 充分 表示 了 加工 部位 的 结构 形状 ， 标注 了 工艺 尺寸 符号 ( 如某 直径 尺寸 用 D 表示 ) ， 但 不是 具体 尺寸 值 ， 且 须 保证 同一 样板 图中 各 尺寸 符号 唯一 。 这时 得到 的 当前 工序 的 工艺 图 与 样板 图 完全一致 ， 并 没有 标注 该 工序 的 实际 工艺 尺寸 ( 只有 尺寸 名称 或 代码 ) 。 再 自动 搜索 工艺 图中 所有 尺寸 符号 并用 相应 工序 的 工艺 尺寸 ( 前面 已 确定 并 存储 ) 替换 之 ， 便 得到 所 需 工艺 图 。 为 保证 尺寸 置换 正确 无误 ， 关键 是 需 预先 建立 工艺 样板 图 尺寸 符号 与 工序 特征参数 的 对应 关系 参照 表 。 这种 方法 简便 实用 ， 效率高 。 
 3.3 　 编辑 工艺 图 
 　 　 自动 生成 的 工艺 图可 交互进行 局部 编辑 修改 和 余量 检查 。 
 　 　 图形 编辑 ： 首先 通过 DGN   File 打开 工序 代码 和 工艺 图号 列表 窗口 ， 从中 选择 某 工艺 图 。 然后 利用 特征 编辑 、 元素 编辑 和 元素 特性 更改 3 种 手段 对 工艺 图 进行 编辑 修改 。 图形 编辑 还 可 充分利用 MicroStation 本身 提供 的 功能 。 
 　 　 余量 检查 ： 对于 由 参数 化 特征 组合 方法 生成 的 工艺 图 ， 可 直接 调入 或 重新 生成 ( Draw   Single ) 两道 或 多 道工序 的 工艺 图 ， 对齐 基准面 ， 并 以 不同 颜色 分层 叠加 ， 从而 能 方便 地 检查 加工余量 的 大小 及其 分布 的 合理性 。 
 　 　 最终 得到 的 工艺 图以 MicroStation 图形文件 形式 存储 ， 并 可 随时 由 绘图机 输出 。 
 
 4 　 结束语 
 　 　 ( 1 ) 实际 应用 表明 ， 本 系统 能 较 好 地 满足 企业 的 生产 要求 ， 大大提高 了 工艺 设计 效率 。 
 　 　 ( 2 ) 本 系统 的 结构 及 采用 的 原理 和 方法 具有 一定 的 通用性 ， 不仅 适用 于 三 牙轮 钻头 产品 ， 而且 可 用于 工艺 特点 类似 的 其他 产品 ， 我们 将 对此 作 进一步 的 研究 与 应用 开发 。 
 作者 单位 ： 北京航空航天大学 
 参考文献 
 　 　 1 　 郑联语 ， 王庆文 ， 杜裴 . 三 牙轮 钻头 CAPP 系统 . 机械 工业 自动化 ， 1997 ， 19 ( 3 ) ： 8 ～ 12 
 　 　 2 　 唐荣锡 . CAD / CAM 技术 . 北京 ： 北京航空航天大学 出版社 ， 1994 
 ( 责编 　 朝 　 晖 ) 　 
