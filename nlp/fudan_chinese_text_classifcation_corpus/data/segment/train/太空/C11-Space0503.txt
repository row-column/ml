航空 计测 技术 
 AVIATION   METROLOGY   & 
 MEASUREMENT   TECHNOLOGY 
 1999 年   第 2 期   No.2   1999 
 
 
 
 关于 冲击 信号 的 数字 处理 方法 研究 
 沈 　 文 
 　     摘要   介绍 了 冲击 信号 各项 指标 的 计算方法 ， 并 着重 介绍 了 如何 将 数字 信号处理 方法 应用 于 冲击 信号 的 处理 中 。 
 　 　 关键词 　 冲击 信号 　 数字 处理 　 研究 
 　 　 Abstract 　 In   this   paper , the   computation   method   of   each   and   every   specification   index   of   shock   signal   is   presented . And   how   to   apply   digital   signal   processing   method   to   the   shock   signal   processing   is   introduced   emphatically . 
 　 　 Key   words 　 Shock   signal , Digital   processing , Study 
 
 　 　 在 实际 工作 中 ， 常常 需要 对 所 采集 到 的 数字信号 进行 处理 。 如何 将 数字 信号处理 的 方法 恰到好处 地 应用 到 实际 情况 的 信号处理 中 ， 是 一个 需要 将 理论 与 实践 结合 起来 ， 并 经过 反复 的 实践 、 运算 、 比较 方 能 得出结论 的 问题 。 在 研制 冲击 测试仪 的 过程 中 ， 碰到 了 对 冲击 信号 ( 本文 中 的 冲击 信号 均 指 冲击 产生 的 加速度 信号 ) 进行 各项 指标 的 计算 ， 其中 包括 对 冲击 信号 进行 一定 的 数字 信号处理 的 问题 。 本文 将 对 这些 问题 进行 讨论 。 
 1 　 冲击 测试 系统 的 组成 
 　 　 在 研制 的 冲击 测试 系统 中 ， 冲击 信号 的 测试 与 记录 仪器 包括 加速度 传感器 、 电荷 放大器 、 低通滤波器 、 数据 采集 模板 、 计算机 及 PP40 打印机 等 部分 。 其 连接 框图 如图 1 所示 。 
 
 
 
 
 图 　 1 
 　 　 在 实际 信号 的 测试 中 ， 首先 由 加速度 传感器 测出 冲击 信号 ， 并 将 其 转换 为 一个 电荷 量 发送 出去 。 该 信号 被 传送 到 电荷 放大器 ， 转换 为 － 10 ～ 10   V 的 电信号 。 然后 再 经 低通滤波器 滤波 后 ， 传送 至 数据 采集 模板 ， 经 A ／ D 转换器 转换 为 数字信号 ， 并 经 数据 采集 软件 采集 数据 后 ， 将 采集 到 的 数字信号 送 至 计算机 。 在 计算机 中 对 采集 到 的 数据 进行 计算 、 处理 ， 得到 有关 该 冲击 信号 的 各项 性能指标 ， 将 计算结果 显示 到 计算机屏幕 上 或 由 打印机 打印 出来 。 
 2 　 冲击 信号 的 数字 处理 方法 的 理论依据 
 　 　 尽管 在 测试 系统 中有 低通滤波器 去除 高频 干扰 ， 但是 由于 环境因素 的 影响 ， 比如 : 电荷 放大器 的 输入输出 干扰 ; A ／ D 转换器 的 输入输出 干扰 ; 电源 的 干扰 以及 连接线 的 影响 等 ， 实际 送 至 计算机 中 的 信号 已 包括 了 一些 干扰信号 。 如何 尽可能 地 去除 这些 干扰信号 ， 使得 处理 过 的 信号 更 接近 于 冲击 台 实际 产生 的 冲击 加速度 信号 ， 是 我们 所 要 研究 的 课题 。 
 　 　 如图 2 所示 ， 未 加入 干扰 项时 的 信号 是 一条 平滑 的 曲线 ， 而 在 受到 各种 干扰 因素 的 影响 后 ， 实际 测量 到 的 信号 是 包括 有 许多 毛刺 及 高频 干扰 的 曲线 。 
 
 图 　 2 
 　 　 考虑 到 信号 与 噪声 比较 ， 信号 相当 平滑 。 而 冲击 信号 中 的 干扰 项 接近 于 平均值 为 零 的 不规则 的 完全 不 相关 的 白 噪声 。 这时 可以 用 平均法 、 单纯 移动 平均法 以及 曲线拟合 法对 信号 进行 平滑 处理 . 
 1.1 　 平均法 
 　 　 白 噪声 具有 一个 很 重要 的 统计 特性 ， 即 它 的 统计 平均值 为 零 。 即 
 
 式 中 ， n ( t ) 为 随机噪声 的 一个 样本 ； E ( n ( t ) ) 为 对 n ( t ) 取 均值 ； T0 为 观察 时间 。 
 　 　 当对 n ( t ) 进行 等 间隔 采样 时 ， 其 离散 序列 的 均值 可 表示 为 
 
 如果 n ( t ) 为 随机 白 噪声 的 一个 样本 ， 则 有 E ( nk ) ＝ 0 。 
 　 　 实际上 ， 取 无穷 多个 采样 点 是 不 可能 实现 的 ; 但是 ， 只要 N 的 数目 足够 大 ， 就 可以 近似 地用 有限 个 观察点 N 的 算术 平均值 来 逼近 统计 平均值 。 
 　 　 假设 数据系统 采得 的 数据 有 两 部分 组成 
 
 式 中 ， x ( t ) 为 处理 前 的 数据 ； s ( t ) 为 有用 数据 ； n ( t ) 为 随机噪声 。 用 离散 值 可 表示 为 
 　 　 假设 在 N 次 采样 过程 中 ， sk 的 值 基本 不变 ， 可 近似 地 看成 一个 常数 C 。 对 x 取 平均值 则 有 
 
 　 　 上 式 表明 ， 利用 时域 平均 可以 平滑 白 噪声 。 
 2.2 　 单纯 移动 平均法 
 　 　 单纯 移动 平均法 又称 算术平均 法 。 将 由 n 个点 组成 的 离散 信号 用 x ( i ) ， i ＝ 1 ， 2 ， … ， n 表示 ， 把 原 信号 进行 平滑 处理 后 在 i 点 的 平均值 为 y ( i ) 。 
 
 　 　 其中 , ， w ( j ) 表示 由 2m ＋ 1 个点 组成 的 左右 对称 的 权函数 ， 采用 矩形 权函数 ， 即 w ( j ) ＝ 1 。 
 这时 ， 
 
 　 　 其中 , N ＝ 2m ＋ 1 ， i ＝ m ＋ 1 ， … ， n － m 
 　 　 所以 , 用 单纯 移动 平均法 对 信号 的 平滑 处理 , 进行 简单 的 定量分析 。 
 　 　 在 所 处理 的 冲击波 形中 ， 通常 认为 信号 与 噪声 相比 ， 信号 是 很 平滑 的 。 而 观测 波 x ( i ) 中所含 的 噪声 ， 可以 认为 是 平均值 为 零 的 完全 不 相关 的 不规则 白 噪声 。 这时 如果 权函数 的 宽度 加大 ， 平滑 结果 y ( i ) 所 含 噪声 成份 由于 平均化 就 会 减小 。 其 大小 可用 其 方差 σ 2n 来 评价 。 
 　 　 若 ｛ xk ｝ 为 叠加 有 随机噪声 的 某 一个 数据 序列 ， 其 均值 为 E ( xk ) ＝ μ x ， 方差 为 σ 2xn ， 则 经 处理 后 的 数据 序列 的 方差 为 
 
 　 　 因此 , 通过 单纯 移动 平均法 可 使 信号 的 平均 方差 降低 到 原来 的 1 ／ N 倍 。 
 　 　 从 频域 的 观点 来 分析 ， 对 信号 数据 进行 单纯 移动 平均法 平滑 处理 ， 即 相当于 取 滤波 因子 h ( t ) ＝ ( h ( － m ) ， … h ( 0 ) ， … h ( m ) ) ， 其中 h ( － m ) ＝ … h ( 0 ) ＝ … ＝ h ( m ) ＝ 1 ／ ( 2m ＋ 1 ) 。 其 滤波 的 效果 取决于 平滑 因子 h ( t ) 的 频谱 特性 。 其 频谱 
 
 其幅 频图 如图 3 所示 。 由图 中 可 看出 ， 在 [ － 1 ／ ( ( 2m ＋ 1 ) △ ) ， 1 ／ ( ( 2m ＋ 1 ) △ ) ] 范围 内 ， h ( f ) 在 f ＝ 0 时达 最大值 ， 在 f ＝ 0 附近 取值 比较 大 ； 而 当 f 离零较 远时 ， h ( f ) 就 较 小 , 因此 ， 2m ＋ 1 点 单纯 移动 平均 相当于 低 通滤波 。 其 频带宽度 为 1 ／ ( ( 2m ＋ 1 ) △ )   Hz 。 其中 2m ＋ 1 为 平均法 所取 的 点数 ， △ 为 采样 时间 间隔 ， 单位 为 s 。 
 
 
 图 3 　 用 单纯 移动 平均法 滤波 的 幅 频图 
 
 　 　 工程 规定 ， 为了 不 丢失 冲击 信号 的 有用 成分 ， 排除 干扰 和 噪声 的 任何 处理 方法 ， 都 应 保留 原 信号 有用 成分 的 频带 范围 ， 该 范围 为 0.008 ／ T ～ 10 ／ T   Hz 。 其中 T 为 冲击 持续时间 ， 单位 为 s 。 
 　 　 在 所 采取 的 单纯 移动 平均法 中 ， 取 m ＝ 2 ， 即 低 通滤波 的 频带 范围 为 1 ／ ( 5 △ )   Hz ， 而 冲击 持续时间 T ＝ 360 △ ， 即 信号 有用 成分 的 频带 范围 为 0.008 ／ ( 360 △ ) ～ 1 ／ ( 36 △ )   Hz 。 低 通滤波 的 频带宽度 1 ／ ( 5 △ )   Hz  信号 有用 成分 频带 范围 的 最高 频率 1 ／ ( 36 △ )   Hz ， 该 滤波 保留 了 原 信号 的 有用 成分 。 因此 用 五点 滑动 平均法 去除 噪声 是 满足 工程 规定 的 频带 保证 的 。 
 2.3 　 多项式 适合 法 
 　 　 多项式 适合 法 又 称为 最小 二 乘法 。 它 是 将 观测 波形 按照 特定 的 曲线 ( 如 二次 、 三次 曲线 ) 拟合 来 取得 平滑 数据 。 考虑 到 冲击波 形 ( 标称 波形 为 半 正弦曲线 ) 接近 于 二次曲线 ， 采用 二次 曲线拟合 法来 进一步 进行 数据 平滑 处理 。 
 　 　 若 在 点 i 作为 中心点 的 2m ＋ 1 个点 内 ， 用 二次 多项式 来 拟合 信号 波形 
 y ( j ) ＝ a ( j － i ) 2 ＋ b ( j － i ) ＋ c 
 其中 ， j ＝ － m ＋ i ， … ， － 1 ＋ i ， i ， 1 ＋ i ， … ， m ＋ i 。 由 y ( j ) 与 实际 测定 值 x ( j ) 的 二 乘 误差 关系式 出发 ， 就 可 求解 出 二次 多项式 的 系数 a ， b ， c 。 
 　 　 采用 多项式 适合 法 ， 噪声 成分 的 抑制 能力 ， 可以 采用 噪声 减轻 度来 衡量 。 
 
 　 　 显然 L 是 依存 于权 系数 的 ， 噪声 减轻 度 L 因 多项式 次数 增高 而 减小 ， 随 平滑 点数 N 的 增大 而 增大 。 对 二次 多项式 拟 合法 而言 ， 当 平滑 点数 为 7 、 11 、 15 时 ， 噪声 减轻 度 分别 为 3 、 4 、 6 。 
 　 　 在 所 使用 的 冲击 信号处理 的 程序 中 ， 先 采用 单纯 移动 平均法 对 采集 信号 进行 平滑 处理 ， 再用 二次 曲线拟合 法 进一步 进行 曲线拟合 ， 可以 获得 较 好 的 噪声 抑制 能力 及 较 满意 的 数据 平滑 效果 。 
 3 　 将 数字 信号处理 方法 应用 于 信号处理 软件 的 编制 中 
 　 　 在 对 产生 半 正弦 脉冲 波形 的 凸轮 式 碰撞 试验台 进行 检定 时 , 给出 其 峰值 加速度 、 脉冲 持续时间 、 速度 改变 量 及 横向 运动 比 等 性能指标 。 在 对 其 计算 中 ， 用到 了 上 文中 所述 的 数字信号 的 处理 方法 。 
 3.1 　 峰值 的 计算方法 
 　 　 由于 传感器 的 不同 ， 在 采集 到 的 冲击波 形中 ， 包括 正 信号 波形 与 负 信号 波形 ， 如图 4 所示 。 
 
 
 图 　 4 
 　 　 在 冲击 信号处理 中 ， 首先 需要 对 冲击 信号 进行 归一化 处理 。 这就是说 ， 如果 波形 为 负 波形 ， 将 其 变为 正 波形 。 其 改变 方法 为 : 将 采集 到 的 波形 上 的 各个 数据 点 的 数字 值取 补 。 这样 ， 就 可 将 所有 如图 4 中 所示 的 负 波形 转换 为 正 波形 ， 将 所有 波形 的 处理 均 转化 为 对 正 波形 的 处理 。 
 　 　 对 归一化 后 的 波形 ， 首先 需要 计算 加速度 峰值 。 其 计算方法 为 ： 先 找出 最大值 点 amax ， 再 从 最大值 点 向 开始 点 方向 往回 找 一段距离 ， 到 位置 2 ( 如图 5 所示 ) ， 然后 再 以 该 点 为 起始 点 ， 向 后取 一小 段距离 ， 以 波形 仍 在 最小值 左右 变化 为限 ， 到 位置 3 ， 对 位置 2 到 位置 3 所 包括 的 所有 数据 点取 平均值 ， 将 其 平均值 作为 最小值 amin ， 如图 5 中 虚线 所示 ， 用 最大值 减去 最小值 ， 其差 即 为 加速度 峰值 。 即 
 aF ＝ amax － amin 
 
 
 图 5 　 冲击 信号 峰值 的 计算方法 
 　 　 在 这里 ， 有 几个 问题 需 加以 注意 。 1 ) 最大值 并 不是 峰值 。 在 冲击 过程 中 ， 由于 冲击 体 开始 是 向 与 最大值 加速度 相反 的 方向 做 加速运动 的 ， 因此 ， 得到 的 冲击 加速度 将 是 一个 负值 。 这里 ， 将 加速度 峰值 定义 为 冲击 加速度 的 最大值 与 冲击 加速度 的 最小值 之差 。 2 ) 由于 冲击 体在 运动 过程 中 受到 一定 的 外界 干扰 ， 在 波形 中会 有 一些 高频 分量 出现 ， 在 信号 中以 波动 的 形式 表现 出来 。 而 理想 冲击 曲线 的 开始 的 加速度 应为 一 恒定 值 ( 例如 : 对于 自由落体 而言 ， 应为 重力 加速度 g ＝ 9.8   m ／ s2 ) 。 在 消除 干扰 所 造成 的 影响 时 ， 可 采用 取 平均值 法 。 如前所述 ， 该 方法 可 有效 去除 原 波形 较 平滑 的 信号 的 随机噪声 。 因此 在 计算 冲击 加速度 的 最小值 时 ， 为了 降低干扰 所 造成 的 误差 ， 可 在 开始 的 加速度 值 恒定 处 选取 一定 的 点数 ， 取其 平均值 来 获得 加速度 最小值 。 其 计算方法 可 表示 为 
 
 3.2 　 脉 宽 的 计算方法 
 　 　 衡量 冲击 信号 的 第二个 重要 指标 为 冲击波 形 的 脉冲 宽度 。 
 　 　 计算方法 ： 首先 ， 以 峰值 加速度 为 100 ％ ， 在 冲击波 形 的 最大值 以前 的 8 ％ ～ 30 ％ 的 范围 内 做 五点 移动 平均法 平滑 处理 。 先 计算 出 峰值 加速度 的 8 ％ 的 点 所在 处 ， 将 此点 作为 第一个 点 ; 再 计算 出 峰值 加速度 的 30 ％ 的 点 所在 处 ， 将 该点 作为 最后 一个点 。 将 这两点 间 的 所有 点 ( 包括 这两点 在内 ) 作为 处理 对象 ， 对 其 进行 数据 平滑 处理 。 
 　 　 处理 方法 ： 在 第一个 点 之前 取 两个 点 ， 之后 取 两个 点 ， 将 包括 该点 在内 的 五个 点 做 一次 平均 计算 ， 用 其 平均值 代替 原来 的 值 。 然后 再 对 第二个 点 、 第三个 点 … 直至 最后 一个点 。 这种 处理 方法 称为 五点 移动 平均法 平滑 处理 。 公式 见 ( 1 ) 式 ， 假设 共有 n － 2m 个 处理 点 。 然后 ， 将 已 做 数据 平滑 处理 后 的 波形 用 最小 二 乘法 做 二次 直线 拟合 。 再 对 该 曲线 求出 其 在 中心点 处 的 切线 方程 ， 将 该 切线 延长 ， 延长线 与 最小值 线 的 交点 即 为 脉 宽 开始 点 ( 图 6 中 的 1 点 ) 。 用 同样 的 方法 可以 计算 出脉 宽 结束 点 的 位置 ( 图 6 中 的 2 点 ) 。 与 前者 不同 的 是 ，   这时 须 在 ( amax － 800H ) 的 8 ％ ～ 30 ％ 的 范围 内 对 数据 进行 平滑 处理 ， 计算 出其 二次 拟合 曲线 在 中心点 处 的 切线 与 800   H ( 零线 ) 的 交点 ， 该点 即 为 脉 宽 结束 点 。 脉 宽 开始 点 与 脉 宽 结束 点 之间 的 时间 间隔 即 为 脉 宽 TW 。 在 计算 脉 宽 时 ， 没有 直接 用 波形 与 最小值 线 的 交点 及 波形 与 零线 的 交点 作为 脉 宽 开始 点 与 脉 宽 结束 点 ， 是 考虑 到 波形 在 开始 上升 处 与 开始 下降 处有 一个 平缓 的 过渡 过程 ， 若 直接 用 其 与 最小值 线及 零线 的 交点 作为 脉 宽 开始 点 与 结束 点 ， 将会 使得 出 的 脉 宽 过 宽 ， 与 实际 情况 不符 。 实验 证明 ， 用 上述 方法 计算 出 的 脉 宽 与 对 实际 波形 所 估计 的 脉 宽 较 符合 。 
 
 
 图 6 　 冲击 信号 脉冲 宽度 的 计算方法 
 
 4 　 结论 
 　 　 在 冲击 信号 的 处理 中 ， 当 信号 与 噪声 比较而言 是 一条 平滑 的 曲线 时 ， 引入 单纯 移动 平均法 和 二次 曲线拟合 法相 结合 的 数据 平滑 处理 方法 ， 可 有效 地 去除 随机噪声 的 影响 。 实践证明 ， 将 其 运用 到 标称 波形 为 半 正弦 脉冲 冲击 信号 的 处理 中是 可行 的 。 
 　 
 　 
 　 　 沈 　 文 ： 30 岁 　 女 　 工程师 
 作者 单位 ： 长城 计量 测试 技术 研究所 ， 北京市 ， 100095 
 参考文献 
 　 [ 1 ] 　 周秀银 . 误差 理论 与 实验 数据处理 . 北京 : 北京 航空学院 出版社 , 1986 
 　 [ 2 ] 　 沈兰荪 . 数据 采集 与 处理 . 北京 : 能源 出版社 , 1987 
 　 [ 3 ] 　 王 正光 等 . 数据 采集 与 处理 . 北京 : 国防工业 出版社 , 1985 
 1998 - 03 - 26 收稿 ， 1998 - 05 - 06 收 修改稿 
