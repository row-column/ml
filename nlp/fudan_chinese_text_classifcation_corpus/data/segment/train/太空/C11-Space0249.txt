　 宇航学 报 
 JOURNAL   OF   ASTRONAUTICS 
 1999 年   第 20 卷   第 3 期   vol.20   No.3   1999 
 
 
 
 大 系统 增量 建模 与 最优控制 研究 
 王庆超 　 喻宝 才 
 　 　 摘 　 要 　 对 互联 大 系统 结合 近 20 个 工位 的 自动化 设备 采用 了 离散 增量 建模 ， 并 应用 了 分离 思想 ， 使 建模 中 参数 的 测定 带来 了 极大 方便 。 提出 具 限幅 值 二次 型 最优控制 问题 ， 采用 配方 形式 的 DP 法 递推 方程 获得 了 离散 的 限幅 值 最优 反馈 控制 律 。 并 对 合并 后 的 简化 模型 就 一般 参数 导出 了 最优 反馈 控制 律 ， 显示 了 该 建模 方法 及 最优控制 解法 便于 应用 于 大 系统 的 特点 。 
 　 　 主题词 　 互联 大 系统 　 增量 建模 　 限幅 反馈 
 STUDY   ON   INCREMENT   MODOLING   AND 
 OPTIMAL   CONTROL   FOR   LARGE   SCALE   SYSTEMS 
 Wang   Qingchao   Yu   Baocai 
 ( School   of   Astronautics , Harbin   Institute   of   Technology . Harbin.150001 ) 
 　 　 Abstract 　 In   this   paper , discrete   increment   modeling   connecting   nearly   20   positions   of   automatic   equipment   for   interconnect   large   scale   systems   is   adopted , and   separation   idea   is   applied , which   bring   about   it   maximal   convenience   to   determine   the   parameter   in   modeling . Problems   of   optimal   control   of   limiting   amplitude   quadrics   are   proposed , then   optimal   feedback   control   law   of   discrete   limiting   amplitude   is   acquired   by   using   DP   method   recursion   equation   of   formulation . Optimal   feedback   control   law   is   also   derived   from   generic   parameter   for   folding   simplified   model , which   have   indicated   the   character   that   this   modeling   method   and   solving   process   of   optimal   control   are   conveniently   applied   into   large   scale   systems . 
 　 　 Key   words 　 Connecting   increment   modeling   Limiting   amplitude   feedback 
 　 　 1 　 引言 
 　 　 本文 以 具有 19 个 工位 的 互联 大型 调速 系统 为例 ， 对大 系统 增量 建模 与 最优控制 进行 了 研究 。 该 系统 是 由 系统 上位 控制中心 ( DCS ) ［ 1 ］ ［ 2 ］ 与 系统 控制器 SC 组成 的 两级 计算机 控制系统 。 除 按定 比 速度 给出 主控 信号 外 ［ 3 ］ ； 结合 系统 具有 高纺速 270 米 / 分 、 高 控制精度 1 ‰ 的 特点 ， 必须 考虑 扰动 、 耦合 、 时滞 、 非线性 环节 及 不确定性 等 引起 的 速度 增量 的 变化 。 本文 力图 通过 增量 建模 及 限幅 值 二次 型 最优控制 来 实现 中心 计算机 SC ( 或 DCS ) 的 计算机 最优 增量 调节 ， 减少 人工 微调 的 强度 ， 充分发挥 国内外 尚未 考虑 的 DCS 或 SC 系统 的 作用 ， 同时 还要 通过 协调 以 达到 稳定 运行 的 目的 。 本文 研究 结果 对 许多 典型 的 大型 过程 拖动 控制系统 具有 代表性 。 
 　 　 第一个 关键问题 是 建立 线性 离散 形式 的 增量 调节 模型 。 我们 用 与 各 工位 转速 增量 变化 有关 的 增量 控制 信号 归入 BU ( k ) 部分 ； 互联 ( 或 耦合 ) 转速 增量 项 归入 AX ( k ) 部分 ， 这种 分离 思想 非常 利于 A 、 B 参数 的 测定 。 
 　 　 若 将 19 个 工位 的 互联 大 系统 模型 一一 列出 ， 讨论 十分困难 ， 经 分析 ， 可 将 同类 增量 调速 工位 合并 选 6 个 代表性 工位 简化 成 一个 6 阶 离散 线性系统 模型 ［ 4 ］ ［ 6 ］ 。 
 　 　 第二个 大 问题 是 求解 最优 反馈 控制 律 。 增量 控制 的 性能指标 提为 线性 二次 型 ( LQ ) 控制 是 最 简单 的 。 然而 ， 加上 增量 控制 信号 限幅 值 限制 ( 约束 ) ， 则 很少 见到 讨论 其 最优 反馈 控制 律 。 源于 增量 的 需要 ， 我们 探讨 了 这 一具 限幅 值 的 LQ 问题 的 最优 反馈 控制 律 。 方法 是 用 配方 形式 的 DP ( 动态 规划 ) 法 递推 方程 ， 以 获得 离散 的 具 限幅 值 的 最优 反馈 律 。 最后 再 回到 该 系统 上 就 简化 了 的 6 阶 系统 的 一般性 参数 求得 具 限幅 值 的 最优 反馈 控制 律 。 它取 反馈 控制 与 简单 变 结构 控制 ( VSC ) 的 复合 形式 ［ 5 ］ 。 
 　 　 2 　 增量 模型 的 建立 
 　 　 由于 大 系统 的 控制 采用 DCS 、 系统 控制器 SC 和 现场 母线 ， 系统 模型 应 以 离散 的 差分 方程 给出 。 以 转速 增量 Δ ω 为 k 步 控制变量 ， 主要 依据 工位 实现 时 的 时滞 性来 确定 ( k + 1 ) 步 的 Δ ω 为 状态变量 ， 加上 各 工位 耦合 互联 作用 建立 起大 系统 递阶 模型 。 结合 电气 控制系统 建立 的 递阶 网络 分 三层 ， 如图所示 。 图中 F1 - F20 ( 无 F3 ) 代表 按 流程 的 工位 及 相应 的 电气控制 设备 ； OE 、 US 分别 代表 热 定型机 和 汽蒸 定型机 拉丝 点 控制 信号 ； SL 、 1DL 、 2DL 分别 代表 垂环 和 重力 张力 架 控制 信号 。 
 
 图 　 分 三层 递阶 网络图 
 　 　 线性 离散 增量 模型 中 ， k 时 的 控制变量 U ( k ) 取 中心 计算机 给出 的 各 工位 增量 控制 信号 。 k + 1 时 的 状态变量 X ( k + 1 ) 取经 一个 步长 ( 或 采样 ) 时间 各 工位 转速 实现 增量 改变 ( 考虑 时滞 ) 时 的 转速 增量 信号 。 
 　 　 U ( k ) 的 系数 矩阵 B ( 对 角形 ) 主要 了 体现 了 本身 转速 增量 响应 系数 ， 即 转速 增量 改变 的 影响 。 X ( k ) 的 系数 矩阵 A 主要 体现 了 互联 转速 增量 响应 系数 ， 即 耦合 增量 信号 的 影响 。 这种 分离 思想 给 A 、 B 参数 的 确定 带来 了 方便 。 
 　 　 状态 差分 方程 ： 
 ( 注 ： 在 ω 之前 均 略去 Δ ； 右上角 标加 c 表示 该 变量 为 控制变量 ； 为 转速 增量 的 积分 — — 位置 增量 信号 ) 
 　 　 第一层   F13 : 
 　 　 　 　 　 F16 ： 
 　 　 第二层   F5 : 
 　 　 　 　 　 F6 : 
 　 　 　 　 　 F14 : 
 　 　 　 　 　 F17 : 
 　 　 第三层   F1 : 
 　 　 　 　 　 F2 : 
 　 　 　 　 　 F4 : 
 　 　 　 　 　 F7 : 
 　 　 　 　 　 F8 : 
 　 　 　 　 　 　 　 … … 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 2.1 ) 
 　 　 　 　 　 F12 : 
 　 　 　 　 　 F19 : 
 　 　 　 　 　 F15 : 
 　 　 　 　 　 F18 : 
 　 　 　 　 　 F20 : 
 　 　 3 　 模型 的 简化 
 　 　 19 个 工位 的 互联 大 系统 求其 协调 最优 解 ， 无论 用 什么 方法 均 是 相当 困难 的 ［ 4 ］ 。 由于 几个 工位 明显 具有 代表性 ： F5 可 代表 F6 、 F14 ( 均 受 F13 及 F5 的 耦合 影响 ) ； F1 可 代表 F2 、 F4 、 F7 - F12 、 F19 ( 只不过 F1 、 F2 、 F4 均 受 F13 及 Fs 的 耦合 影响 ； F7 受 F13 及 F6 的 耦合 影响 ， F8 受 F13 及 F7 的 耦合 影响 ， … … F12 受 F13 及 F11 的 耦合 影响 ； F19 受 F16 及 F18 的 耦合 影响 ) ； F15 可 代表 F18 、 F20 ( F15 受 F13 、 F14 及 F14 的 积分 的 耦合 的 影响 ； F18 受 F16 、 F17 及 F17 的 积分 的 影响 ； F20 受 F16 、 F19 及 F19 的 积分 的 影响 ) 。 
 　 　 因此 ， 选取 具 代表性 的 工位 变为 6 阶 线性 增量 控制系统 ( 代表性 工位 是 F13 、 F16 、 F5 、 F17 、 F1 、 F15 ) 模型 就是 必然 的 了 。 这种 将 同类 的 调速 工位 合并 的 处理 可 使 模型 大为 简化 。 
 　 　 另外 ， 为 将 ( 转速 增量 的 积分 — — 位置 增量 信号 ) 规范化 成为 转速 增量 信号 ， 在 离散 递推 方程 中取 转速 增量 的 τ 倍 来 近似 ， 其中 τ 为 步长 或 采样 间隔时间 。 
 　 　 6 阶 简化 模型 写成 状态方程 是 
 　 　 　 　 　 　 　 　 　 　 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 3.1 ) 
 即 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 3.2 ) 
 其中 　 X ( k ) = ( ω 13 ( k ) , ω 16 ( k ) , ω 5 ( k ) , ω 17 ( k ) , ω 1 ( k ) , ω 15 ( k ) ) T 
 　 　 　 U ( k ) = ( ω c13 ( k ) , ω c16 ( k ) , ω c5 ( k ) , ω c17 ( k ) , ω c1 ( k ) , ω c15 ( k ) ) T 
 　 　 ( 注 ： ( 3.1 ) 式 中 ω 15 ( k + 1 ) 应受 F14 及其 积分 的 影响 ， 不 依赖于 F5 ， 这是 一种 代替 ， 用时 应 转换 过来 ) 
 　 　 4 　 具有 闭集型 限幅 值 LQ 问题 的 最优控制 律 
 　 　 对 增量 离散 线性系统 模型 我们 按 如下 线性 二次 型 ( LQ ) 寻求 并 实现 最优控制 。 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 4.1 ) 
 X ∈ Rn , U ∈ Rm 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 4.2 ) 
 　 　 其中 权 矩阵 Q = QT ≥ 0 ( 甚至 Q ＞ 0 ) ， R = RT ＞ 0 , 
 　 　 求 ( 4.1 ) 、 ( 4.2 ) 的 最优 解 U * ( k ) , k = 0 , 1 , 2 , … , N - 1 ， 但 要 满足 限幅 值 约束 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 4.3 ) 
 　 　 这是 一个 特殊 离散系统 LQ 问题 ， 对于 增量 控制 必须 考虑 ( 4.3 ) 式 ， 因为 增量 控制 信号 相对 是 小 的 ， 通常 LQ 问题 算得 的 反馈 控制 若 要 超过 增量 的 限幅 值 约束 ， 最优 反馈 即使 有 也 是 响应速度 慢 的 。 增加 这一 限幅 值 约束 ， 一 是从 实际 出发 的 ， 一是 可 提高 LQ 问题 的 响应速度 。 当然 ， 也 就 增加 了 LQ 问题 的 求解 难度 。 
 　 　 我们 通过 动态 规划 ( DP ) 法 的 关于 最优 代价 函数 的 倒 递推 方程 ［ 7 ］ ； 配 方法 及 正 定性分析 ； 闭集型 控制 往往 在 闭域 的 边界 上 实现 的 思想 来 求解 问题 ( 4.1 ) ， ( 4.2 ) ， ( 4.3 ) 。 得到 具有 上下 限幅 值 与 反馈 控制 相结合 就是 ( 各步 ) 这一 问题 的 最优 解 。 它 在 通常 DP 法 的 最优 代价 函数 V * i ( X ( N - 1 ) ) 的 倒 递推 方程 基础 上 ［ 6 ］ ［ 7 ］ ， 必须 用配 方法 及 正 定性分析 。 
 　 　 倒 递推 ( 单步 ) 寻优 解法 是 ： 
 　 　 最后 一步 
 
 　 　 由于 R ＞ 0 ， 显然 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 4.4 ) 
 　 　 代回 上式 得到 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 4.5 ) 
 　 　 其中 　 　 　 P ( N - 1 ) = Q 。 
 　 　 倒 递推 到 ( 最后 ) 2 步 
 　 　 　 　 　 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 4.6 ) 
 　 　 对 ( 4.5 ) 式 V * 1 ( X ( N - 1 ) ) 中 的 X ( N - 1 ) 应用 状态方程 ( 4.1 ) 并取 ［ 2 ］ 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 4.7 ) 
 再 应用 配 方法 可 得 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 
 　 　 　 ( 4.8 ) 
 　 　 经此 配方 后 ， 由于 R + BTP ( N - 1 ) B ＞ 0 ， 第二项 是 正定 二次 型 ， 为求 闭集型 限幅 值下 的 最优 的 U * ( N - 2 ) ， 须分 三种 情形 讨论 ： 
 　 　 当 - K ( N - 2 ) X ( N - 2 ) 满足 
 　 　 - Ci ＜ { - K ( N - 2 ) X ( N - 2 ) } i ＜ Ci 时 ， 
 　 　 ( 此时 二次 型 最小值 点 U * ( N - 2 ) + K ( N - 2 ) X ( N - 2 ) = 0 在 限幅 值内 ) ， 有 反馈 控制 
 
 　 　 但 当 { - K ( N - 2 ) X ( N - 2 ) } i ≥ Ci 时 ， 
 　 　 二次 型 的 最小值 点 在 区间 ［ - Ci , Ci ］ 的 右侧 ， 此时 二次 型 在 ［ - Ci , Ci ］ 内 关于 第 i 个 分量 是 单调 下降 的 ， 故 控制 取上 限幅 值为 最优 ， 即 
 
 　 　 同理 ， 当 { - K ( N - 2 ) X ( N - 2 ) } i ≤ - Ci 时 ， 
 
 　 　 从而 ， ( 4.8 ) 式 有限 幅 形式 的 反馈 最优 解是 
 　 　 　 　 　 　 　 　 ( 4.9 ) 
 将 ( 4.9 ) 式 的 反馈 控制 代 回到 ( 4.8 ) 式 中 得到 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 4.10 ) 
 　 　 其中 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 4.11 ) 
 　 　 下面 再 倒 递推 到 3 步 ( 完全 与 2 步 相同 ) ， … … ， 一般 地有 
 　 　 　 　 　 　 ( 4.12 ) 
 其中 
 　 　 　 　 　 　 　 　 　 　 　 ( 4.13 ) 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 4.14 ) 
 步 序号 为 　 j = 2 , 3 , … ， N 。 
 　 　 { - K ( N - j ) X ( N - j ) } i 是 反馈 控制 向量 的 第 i 个 分量 ， i = 1 , 2 , … , m 。 
 　 　 注 ： 这样 取 具有 限幅 值 的 反馈 控制 U * ( 最后 一步 U * ( N - 1 ) = OX ( N - 1 ) = 0 ) ［ 6 ］ ， 在 整个 N 步 的 全局 上 对 - Ci ＜ Ui ( k ) ＜ Ci 是 二次 型 最优 的 ； 而 在 每 一步 又 是 闭集型 限幅 值下 ( - Ci ≤ Ui ( K ) ≤ Ci ) 最优 的 。 从 控制 方法 的 交叉 综合 来说 它取 反馈 控制 与 简单 变 结构 控制 ( VSC ) 的 复合 形式 ［ 5 ］ 。 
 　 　 5 　 简化 模型 的 LQ 问题 的 最优控制 律 
 　 　 在 6 阶 模型 ( 3.2 ) 基础 上 ， 取 ( 4.2 ) 式 的 二次 型 ， 其中 权 矩阵 为 Q = I6 × 6 
 
 又 取 N = 3 。 为求 在 ( 4.3 ) 约束 下 的 U * ( 0 ) , U * ( 1 ) , U * ( 2 ) ， 将 应用 4 段 已 推得 的 结果 。 
 　 　 由 4 段 的 ( 4.4 ) 及 ( 4.6 ) 式 可知 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 5.1 ) 
 　 　 将 3 段 ( 3.2 ) 式 的 A 、 B 及 已取 的 R ， Q 矩阵 代入 ( 4.7 ) 式 中 ， 可 得 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 5.2 ) 
 其中 　 , , 
 　 　 　 , ， , 
 再 由 ( 4.11 ) 式 可得 
 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 5.3 ) 
 　 　 其中 
 　 　 　 　 　 ， 　 　 　 　 　 　 , 
 　 　 　 　 　 
 　 　 从而 ， 由 ( 4.9 ) 及 ( 5.2 ) 式 知 ， 最优控制 U * ( 1 ) 分别 是 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 5.4 ) 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 5.5 ) 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 5.6 ) 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 5.7 ) 
 　 　 　 　 　 　 　 　 　 　 　 ( 5.8 ) 
 　 　 　 　 　 　 　 　 ( 5.9 ) 
 　 　 再 由 ( 4.13 ) 式 可得 
 　 　 　 　 　 　 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 5.10 ) 
 　 　 其中 ( 并设 l = ( r11 + b213p11 ) ( r33 + b25p33 ) - b25b213p213 ) 
 　 　 　 ， 
 　 　 　 , 
 　 　 　 
 　 　 　 , 　 　 , 　 　 　 。 
 　 　 从而 ， 由 ( 4.12 ) 及 ( 5.10 ) 式 知 ， 最优控制 U * ( 0 ) 分别 是 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 5.11 ) 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 5.12 ) 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 5.13 ) 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 5.14 ) 
 　 　 　 　 　 　 　 　 　 ( 5.15 ) 
 　 　 　 　 ( 5.16 ) 
 　 　 ( 注 ： 正如 第 3 段 最后 的 评注 中 指出 的 ， 最优 的 ω c15 ( 1 ) 及 ω c15 ( 0 ) 中 依赖于 ω 5 ( 1 ) 及 ω 5 ( 0 ) 部分 应 改成 依于 ω 14 ( 1 ) 及 ω 14 ( 0 ) 。 
 　 　 6 　 结束语 
 　 　 离散 限幅 值 二次 型 最优控制 ， 从 最优 反馈 控制 律 可见 ， 运用 分离 建模 思想 ， 不仅 使 参数 测定 容易 ， 而且 反馈 控制 的 耦合 项 也 没有 增加 。 
 　 　 对 简化 模型 最优控制 我们 只取 N = 3 ， 显然 N 取大些 ， 继续 迭代 下去 也 不 困难 。 简化 模型 是 对 同类 工位 进行 了 合并 处理 的 模型 ， 按 比例 转化 到 各 工位 的 限幅 值 增量 控制 也 是 容易 做到 的 。 
 　 　 离散 增量 建模 、 限幅 值 反馈 在 大 系统 过程 控制 中是 有 典型 意义 的 ， 工程 上 也 是 容易 实现 的 ， 可以 在 航天 自动化 工程 和 大型 工业 自动化 工程 中 应用 。 
 * 国家自然科学基金 资助 项目 ( 69775018 ) 
 作者 单位 ： 哈尔滨工业大学 航天 学院 . 哈尔滨 . 150001 
 参考文献 
 　 　 1 　 蒋慰 孙 . 2000 年 化工 自动化 展望 . 化工 自动化 与 仪表 . 1994 ， ( 1 ) 
 　 　 2 　 金以慧 等 . 过程 控制 的 发展 与 展望 . 控制 理论 与 应用 . 1997 ， 14 ( 2 ) 
 　 　 3 　 范俭 等 . 交流 定 速比 传动系统 的 前馈 自 适应控制 . 控制 理论 与 应用 . 1996 ， 13 ( 5 ) 
 　 　 4 　 解 三明 等 . 大规模 系统 两层 递阶控制 的 直接 分解 算法 . 信息 与 控制 . 1997 ， 26 ( 1 ) 
 　 　 5 　 费 敏锐 等 . 智能 控制 方法 的 交叉 综合 及其 应用 . 控制 理论 与 应用 ， 1996 ， 13 ( 3 ) 
 　 　 6 　 王耀南 . 智能 控制 与 专家系统 . 湖南大学 出版社 . 1996 
 　 　 7 　 林 畛 . 变分法 与 最优控制 . 哈工大 出版社 . 1987 
 　 　 8 　 Singh   MG . Dynamical   Hierarchical   Control . North - Holland , Amsterdam.1980 
 　 　 9 　 Jamshidi   M . Large   Scale   Systems : Modeling   and   Control . North - Holland , Amsterdam.1983 
 收稿 日期 : 1998 年 10 月 5 日 , 修回 日期 : 1999 年 6 月 5 日 
