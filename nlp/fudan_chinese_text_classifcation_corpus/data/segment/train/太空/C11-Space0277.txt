宇航学 报 
 JOURNAL   OF   ASTRONAUTICS   
 1999 年 　 第 20 卷 　 第 4 期 　 vol20 　 No.4 　 1999 
 
 
 
 
 地球 扁率 引起 红外 地平仪 姿态 量测 
 误差 的 数学模型 
 刘延柱 
 　 　 摘 　 要 　 本文 讨论 地球 扁率 引起 红外 地平仪 的 姿态 量测 误差 的 数学模型 ， 导出 解析 形式 姿态 误差 计算公式 ， 可 在 任意 轨道 根数 和 扫描 轴 安装 角 情况 下 用于 误差 补偿 。 算例 表明 ， 利用 本文 导出 的 解析 公式 与 利用 数值 方法 的 计算结果 完全一致 。 
 　 　 主题词 　 地球 扁率 　 红外 地平仪 　 姿态 量测 误差 
 MATHEMATICAL   MODEL   OF   ATTITUDE   CORRECTION   OF 
 SCANNING     HORIZON   SENSOR   FOR   EARTH   OBLATENESS 
 Liu   Yanzhu 
 ( Dept . of   Engineering   Mechanics , Shanghai   Jiao   Tong   University   .   Shanghai   .   200030 ) 
 　 　 Abstract 　 The   problem   of   the   mathematical   model   of   the   attitude   correction   of   scanning   horizon   sensor   for   the   earth   oblateness   is   discussed   in   present   paper . An   analytical   formula   of   attitude   measuring   error   is   obtained   and   can   be   used   as   attitude   correction   for   arbitrary   orbital   elements   and   arbitrary   installing   angle   of   the   scanning   axis . A   numerical   example   is   given   and   shows   that   the   results   of   analytical   method   and   numerical   method   are   identical   perfactly . 
 　 　 Key   words 　 Earth   oblateness   Scanning   horizon   sensor   Attitude   correction 
 1 　 引言 
 　 　 圆锥 扫描式 红外 地平仪 广泛应用 于 对 地 定向 三轴 稳定 卫星 ， 以 确定 卫星 的 俯仰角 和 滚动 角 ［ 1 ， 2 ］ 。 地球 扁率 作为 姿态 误差 的 主要 误差 源 ， 对于 轨道 面 倾角 接近 90 ° 的 太阳 同步卫星 ， 其 影响 尤为 严重 。 Tekawy 等 ( 1996 ) ［ 3 ］ 提出 的 误差 数学模型 建立 在 Newton - Raphson 数值 方法 求解 非线性 方程 的 基础 上 。 对 扫描 沿 滚动 轴 负向 安装 特殊 情况 下所作 的 数值 计算 表明 ， 地球 扁率 误差 在 两极 地区 最为 严重 。 本文 提出 计算 地球 扁率 误差 的 解析 公式 ， 可 在 任意 轨道 根数 和 扫描 轴 安装 角 情况 下 用于 误差 补偿 。 与 文献 ［ 3 ］ 的 数值 解 方法 相比 ， 可 明显 减少 星载 计算机 的 计算 量 。 
 2 　 地 平 平面 与 轮廓 椭圆 
 　 　 将 地球表面 简化 为 旋转 椭球 ， 记作 E 。 以地心 O 为 原点 ， 建立 E 的 主轴 坐标系 ( O - xyz ) ， Oz 沿 极轴 ， ( x , y ) 为 赤道 平面 。 设 Re , Rp 为 赤道 半轴 和 极 半轴 ， 且 有 Rp = Re ( 1 - ε ) , ε 为 地球 扁率 ( ε = 3.3528 × 10 - 3 ) 。 只 保留 ε 的 一次 项 ， E 的 曲面 方程 为 
 f ( x , y , z ) = x2 + y2 + z2 ( 1 + 2 ε ) - R2e = 0 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 1 ) 
 设 卫星 S 相对 ( O - xyz ) 的 坐标 为 u , v , w ， 从 S 向 地球 引 切线 矢量 L = SP , 与 E 曲面 相切 于 P ( x , y , z ) 点 ， L 与 P 点处 的 曲面 法线 矢量 n0 应 正交 ， 即 L   .   n0 = 0 ， 利用 此 条件 导出 平面 方程 ： 
 g ( x , y , z ) = ux + vy + ( 1 + 2 ε ) wz - R2e = 0 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 2 ) 
 此 方程 所 确定 的 平面 称作 地 平 平面 ， 记 作 Π ， Π 平面 在 E 曲面 上 截出 的 椭圆 即 卫星 上 观测 到 的 地球 轮廓线 ， 称作 地 平 轮廓 椭圆 ( 见图 1 ) 。 设天底 轴 OS 与 E 椭球面 交于 S ′ ， 与 Π 平面 交于 S * 。 S ′ 与 S * 分别 为 地球表面 和 地 平平 面上 的 星下点 。 设 OS = r 为 卫星 距地心 距离 ， 对于 圆 轨道 情形 r 为 常数 。 S ′ 点 的 坐标 应 满足 椭球 方程 ( 1 ) ， 导出 OS ′ = R 与 纬度 角 的 关系式 
 R2 = R2e ( 1 - 2 ε sin2 ) 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 3 ) 
 
 图 1 　 地球 椭球 表面 与 地平 平面 
 自 O 点 向 Π 平面 作 垂线 OA ， 设 OA = d , OS * = D ， 可 证明 D 与 d 的 差别 仅为 ε 的 二次 微量 ， 导出 
 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 4 ) 
 不失 一般性 ， 将 ( x , z ) 坐标 面 旋转 至 与 星下点 重合 ， 则 Π 平面 的 法线 基 矢量 n * 为 
 　 　 　 　 　 　 　 　 ( 5 ) 
 　 　 以 S * 为 原点 ， 在 地平 平面 Π 上 建立 地理 坐标系 ( S * - x * y * z * ) ， 其中 z * 轴 沿 - n * 方向 ， ( x * , y * ) 沿 Π 平面 ， x * 轴 沿 子午线 指北 ， y  轴 沿 纬线 指东 ( 见图 2 ) 。 将 轮廓 椭圆 上 任意 点 P 的 坐标 代入 椭球 方程 ( 1 ) ， 可 导出 P 点 在 ( x * , y * ) 坐标 面中 的 极坐标 ( ρ ， σ ) 表达式 
 　 　 　 　 　 　 　 　 ( 6 ) 
 
 图 2 　 地 平 轮廓 椭圆 
 其中 为 忽略 地球 扁率 ， 即 ε = 0 时 轮廓 椭圆 转变 为 圆 的 半径 。 上 式 表明 ， 轮廓 椭圆 与 地球 扁率 ε ， 卫星 轨道 半径 r 及星 下点 纬度 角 等 因素 有关 。 在 赤道 上空 ( = 0 ) 轮廓 椭圆 有 最大 偏心率 ， 在 两极 上空 ( = π / 2 ) 转变 为 圆 。 
 　 　 设 h = SS * 为 卫星 距地平 平面 的 高度 ， 可 利用 式 ( 3 ， 4 ) 算 出 
 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 7 ) 
 其中 h0 = ( r2 - R2e ) / r 为 忽略 地球 扁率 时 的 h 值 。 利用 P ， S 点 的 坐标 计算 切线 矢量 L 的 长度 ， 得到 
 　 　 　 　 　 　 　 　 　 　 　 ( 8 ) 
 对图 1 中 的 三角形 SPS  应用 余弦定理 和 式 ( 7 ) 、 ( 8 ) ， 求 出 切线 矢量 L 与 天底 轴 OS 之间 的 夹角 η 的 余弦 
 cos η = cos η 0 ［ 1 + ε F ( , σ ) ］ 　 　 　 　 　 　 　 　 　 　 　 ( 9 ) 
 其中 为 忽略 地球 扁率 时 的 η 值 ， 函数 F ( , σ ) 定义 为 
 
 ( 10 ) 
 3 　 姿态 角 计算公式 
 　 　 卫星 的 轨道 面 倾角 i 和 纬度 幅角 u 与 地理纬度 角 和 轨道 面 与 子午面 夹角 χ 的 关系 为 ［ 4 ］ 
 sin = sinisinu , 　 　 cot χ = tanicosu 　 　 　 　 　 　 　 　 　 　 　 ( 11 ) 
 以 S 为 原点 建立 轨道 坐标系 ( S - x0y0z0 ) ， 星体 坐标系 ( S - xryrzr ) 和 地平仪 坐标系 ( S - xsyszs ) ， 其中 z0 轴 指向 地 心 ， y0 轴 沿 轨道 面 法线 ， xr , yr , zr 分别 为 滚动 轴 ， 俯仰 轴 和 偏航 轴 。 设 滚动 角 ， 俯仰角 和 偏航 角 分别 为 ， θ ， ψ ， 地平仪 的 扫描 轴 H 安装 在 ( xr , yr ) 平面 上 作为 ys 轴 ， 与 yr 轴 的 夹角 为 γ 。 zs 轴 与 zr 轴 重合 ( 见图 3 ) 。 
 
 图 3 　 星体 坐标系 与 地平仪 坐标系 的 姿态 角 
 　 　 设 扫描 圆锥 面 与 地平 轮廓 椭圆 交于 P1 ， P2 两点 ， P1 为 扫入 点 ， P2 为 扫 出点 ， 过 P1P2 的 垂直面 与 扫描 轴交于 C 点 ， 与 zs 轴 平行 的 矢量 CM 为 固定 于 星体 的 量 测 基准 ， 令 扫描 圆锥 半角 为 α , β 1 = ∠ P1CM , β 2 = ∠ P2CM 为 与 扫描时间 脉冲 成 比例 的 输出 信息 ， 引 切线 矢量 L1 = SP1 ， L2 = SP2 ， 计算 其基 矢量 L01 及 L02 及天 底轴基 矢量 z00 相对 ( S - xsyszs ) 的 投影 ( 见图 4 ) ， 并 代入 以下 关系式 ： 
 L01   .   z00 = cos η 1 , 　 　 L02   .   z00 = cos η 2 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 12 ) 
 
 图 4 　 扫描 圆锥 面 与 地平 轮廓 椭圆 的 相交 点 
 其中 η 1 ， η 2 为 L01 ， L02 与 z00 的 夹角 。 可解出 姿态 角 θ ， 为 α ， γ ， η 1 ， η 2 ， β 1 ， β 2 的 函数 ； 
 　 　 　 　 　 　 　 　 ( 13a ) 
 　 　 　 　 　 　 　 　 ( 13b ) 
 　 　 对于 忽略 地球 扁率 的 理想 情形 ， 将 理想 情形 的 姿态 角 θ ， 记 作 θ 0 ， 0 代入 式 ( 13 ) ， 且 忽略 β 1 - β 2 的 二阶 以上 微量 ， 令 η 1 = η 2 = η 0 ， 简化 为 ： 
 　 　 　 　 　 　 　 　 ( 14a ) 
 　 　 　 　 　 　 　 　 ( 14b ) 
 作为 特例 ， 令 γ = - 90 ° ， 即 得到 文献 ［ 3 ］ 的 结果 。 上式 为 更 普遍 的 计算公式 。 
 4 　 地球 扁率 误差 
 　 　 考虑 地球 扁率 时须 利用 式 ( 9 ) 计算 切线 矢量 与 星地 矢量 z0 轴 之间 的 夹角 η 1 ， η 2 。 为此 必须 先 确定 扫入 点 P1 和 扫 出点 P2 在 地球 轮廓 椭圆 上 的 坐标 σ 1 和 σ 2 。 只 保留 ε ， θ ， 的 一次 项时 ， 在 σ 1 和 σ 2 的 确定 过程 中 可不 考虑 地球 扁率 和 星体 偏转 的 影响 。 设 C  为 C 在 地 平平 面上 的 投影 ， 则 S * P1 ， S * P2 与 S * C * 有 相同 夹角 Δ σ ， CP1 ， CP2 与 CC  有 相同 夹角 β 0 。 设 S * C * 与 y * 轴 的 夹角 为 σ 0 ， 利用 简单 的 几何 关系 可 导出 σ 0 = γ - χ ， 且 有 ( 见图 5 ) 
 
 图 5 　 扫入 点 和 扫 出点 的 位置 坐标 
 　 　 　 　 　 　 ( 15 ) 
 则 σ 1 ， σ 2 可 写作 
 σ 1 = σ 0 - Δ σ , 　 　 σ 2 = σ 0 + Δ σ 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 16 ) 
 将式 ( 15 ) 、 ( 16 ) 代入 式 ( 9 ) 、 ( 10 ) 计算 η 1 、 η 2 ， 得到 
 cos η i = cos η 0 ［ 1 + ε F ( , σ i ) ］ 　 　 ( i = 1 , 2 ) 　 　 　 　 　 　 　 　 　 　 ( 17 ) 
 将 上式 代入 式 ( 13 ) ， 修正 函数 F ( ， σ i ) 记作 Fi ( i = 1 , 2 ) ， 导出 修正 后 的 姿态 角 计算公式 
 θ = θ 0 + Δ θ ， 　 　 = 0 + Δ 　 　 　 　 　 　 　 　 　 　 　 　 　 ( 18 ) 
 其中 Δ θ ， Δ 为 地球 扁率 引起 的 姿态 角量 测 误差 ， 计算公式 为 
 　 　 　 　 　 　 　 　 ( 19 ) 
 5 　 算例 
 　 　 利用 文献 ［ 3 ］ 的 算例 ， 令 i = 98.70 ， r = 7230km , α = 600 , γ = - 900 , 利用 本文 导出 的 解析 公式 计算 得到 ρ 0 = 3003.7 km , h0 = 1603.6 km , β 0 = 57.060 , Δ σ = 55.470 ， 姿态 量测 误差 Δ θ ， Δ 随 纬度 幅角 u 的 变化 曲线 见图 6 ， 与 文献 ［ 3 ］ 用 数值 方法 的 计算结果 完全一致 。 
 
 图 6 　 姿态 量测 误差 随 纬度 幅角 u 的 变化 曲线 
 作者 单位 ： 上海交通大学 工程力学 系   .   上海   .   200030 
 参考文献 
 1 　 Wertz   J   R . Spacecraft   Attitude   Determination   and   Control . Dordrecht : Kluwer   Acad . , 1978 : 98 - 106 
 2 　 孙宝祥 ， 赵健翔 ， 陈义庆 . 对 地 定向 三轴 稳定 卫星 的 圆锥 扫描式 地球 敏感 器 的 数学模型 . 控制工程 ， 1995 ， ( 2 ) ： 1 - 7 
 3 　 Tekawy   J   A , Wang   P , Gray   C   W . Scanning   Horizon   Sensor   Attitude   Correction   for   Earth   Oblateness , J . Guidance , 1996 , 19 ( 3 ) : 706 - 708 
 4 　 刘延柱 . 航天器 姿态 动力学 . 北京 ： 国防工业 出版社 ， 1995 
 收稿 日期 : 1998 年 3 月 3 日 
 修回 日期 : 1999 年 5 月 12 日 
