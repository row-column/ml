环境 技术 
 ENVIRONMENTAL   TECHNOLOGY   
 1999 年     第 4 期     No.4   1999 
 
 
 
 VSS 算法 用于 抑制 心电图 中 50Hz 干扰 
 杜丽冰    
 摘要 ： 由于 可变 步长 LMS ( VSS ) 算法 能 有效 地 改善 LMS 算法 存在 的 收敛 速度 与 收敛 误差 之间 的 矛盾 ， 因此 可以 显著 地 提高 对 干扰 的 抑制 性能 。 为 进一步 改善 心电图 （ ECG ） 中 的 50Hz 干扰 的 抑制 性能 ， 本文 应用 VSS 算法 。 通过 模拟实验 分析 了 参数 与 抑制 性能 的 关系 ， 并 从 各 方面 与 LMS 算法 和 其它 改进 的 LMS 算法 进行 比较 。    
 关键词 ： 心电图 ； 可变 步长 LMS 算法 ； 50Hz 干扰 ； 抑制 性能  
 中 图 分类号 ： TN911.4 　 　 文献 标识码 ： A 
 VSS   Algqrithm   for   Suppression   50Hz   Interference   
 in   Electrocardiogram  
 DU   Li - bing 
    ( BOX.171   Beijing   Univ . of   Post   &   Telecom , Beijing   100876 )     
 1 前言 
 　 　 为 有效 地 抑制 心电图 （ ECG ） 中 的 工频 50Hz 干扰 ， 除了 在 干扰 抑制器 的 结构 上 采用 特殊 的 最 简单 的 两个 权 的 凹口 滤波器 的 自 适应 干扰 对 消器 （ AIC ） ， 并 考虑 采用 更 有效 的 自 适应 算法 。 经典 的 LMS 算法 虽 简单 、 运算量 小 和 收敛 性能 稳定 ， 但 存在 收敛 速度 与 收敛 误差 之间 的 矛盾 ， 因此 要 得到 最佳 的 抑制 性能 比较 困难 。 为 更 有效 地 抑制 50Hz 干扰 ， 在 [ 1 ] 中 采用 了 变动 量 LMS （ VMS ） 算法 ， 通过 计算机 模拟实验 ， 在 相同 条件 下 分析 比较 了 LMS 和 VMS 算法 的 抑制 性能 。 从 结果表明 VMS 算法 较之 LMS 算法 收敛 速度 改善 了 近一半 ， 但 收敛 误差 仅 改善 了 1.8 dB ， 因此 抑制 性能 还 不够 理想 ， 故 本文 提出 采用 VSS 算法 ［ 2 ］ 以 进一步提高 抑制 性能   。 经 计算机 模拟实验 也 说明 了 VSS 算法 对于 有用 信号 的 幅度 变化 的 动态 范围 较大 的 ECG 信号 的 跟踪 能 较 强 ， 抑制 性能 优于 LMS 算法 和 其它 的 LMS 改进 算法 。  
 2 Ｖ Ｓ Ｓ 算法 
 　 　 本文 仍 采用 [ 1 ] 中 的 最 简单 的 两个 权 的 凹口 滤波器 自 适应 干扰 对 消器 （ AIC ） 抑制 ecg 中 的 50Hz 干扰 ， 它 的 结构 如图 1 所示 。 
 
    图 1AIC 的 原理图    
 　 　 图中 原始 输入 d ( t ) = S ( t ) + n  o ( t ) ，      
 其中 S ( t ) 为 ECG 信号 ， no ( t ) 为 50Hz 干扰 ， AUC 中 的 自 适应 滤波器 （ AF ） 的 参考 输入 为 50Hz 的 干扰源 n1 ( t ) = X ( t ) ， 它们 均 以 取样 周期 T 取样 ， 在 k 时刻 的 取样 值 分别 为 Sk 、 nok  、 n1k 、 dk ， Sk 与 nok 、 n1k 不 相关 ， 但 nok 与 n1k 相关 ， 这里 考虑 两者 的 幅度 有关 。 
 　 　 AIC 的 输出 或 误差 信号 ek = dk - yk ， 其中 
 　 　 yk 为 AF 的 输出 ， W1k 、 W2k 为 权值 取样 值 。 
    本文 中自 适应 算法 采用 VSS 算法 。    
 　 　 VSS 算法 使 步长 因子 随 e2k 变化 而 变化 ， 权值 调整 公式 如下 ［ ２ ］     
 　 　 Wk + 1 = Wk + μ k Ｘ kek   ( 1 ) 
 　 　 μ k + 1 = α μ k + γ e2k ( 2 ) 
 其中 0 ＜ α ＜ 1 ， γ ＞ 0 
    由 ( 2 ) 式 可见 ， μ k 总为 正 ， 并 由 ek 和 两个 常量 α 、 γ 来 控制 。 在 权值 调整 开始 时 ，   ek 较大 ， μ k 也 较大 ， 以 快速 跟踪 达到 快速 收敛 。 收敛 后 ek 减小 ， μ k 也 随之 减小 ， 失调 也 减小 。 衡量 收敛 误差 的 稳态 失调 M 经 推导 为 
 　 　 M = ( 1 - B ) / ( 1 + B )   ( 4 )  
 其中 B = ［ 1 - 2tr ［ R ］ ( 3 - α ) γ ξ min / ( 1 - α 2 ) ］ 1 / 2     
 其中 ξ min 为均方 误差 MSE = E ［ e2k ］ = ξ k 的 最小值 ， tr [ R ] 为 R 的 迹 ， R = E ［ XkXTk ] 。 由 （ 2 ） 式 可见 ， M 随着 α 和 γ 减小 而 减小 。 为 使 M 小 ， α 、 γ 应 尽可能 小 ， 但 为 保证 跟踪 的 自 适应能力 ， 也 不能 太小 。 为 保证 MSE 总有界 ， μ max 的 充分条件 为 μ max   ≤ 2 / ( 3tr [ R ] ) 。 初始 步长 μ o 选为 μ max ， μ min 的 选择 以 提供 最小 跟踪 能力 ， 通常 按 LMS 算法 中 的 μ 值 。 由 （ 1 ） 、 （ 2 ） 式 可见 ， VSS 算法 由于 μ k 的 变化 直接 与 ek 有关 ， 且 有 两个 可调 参数 、 所以 跟踪 能力 和 失调 较之 LMS 算法 和 其它 LMS 改进 的 算法 均 有 较大 的 改善 ， 通过 模拟实验 也 证实 了 。    
 3 计算机 模拟 及 分析 
 　 　 为 便于 与 LMS 算法 和 其 LMS 改进 的 算法 的 抑制 性能 比较 ， 模拟 中 仍 采用 稳态 平均 相对误差 SMRE 或 输出 噪信 比 NSR 。 来 衡量 ， 即 160 次 迭代 的 10lg ( ek - sk ) 2 / s2k ( dB ) 的 平均值 。 采用 的 参数 与 [ 1 ] 相同 ， 即 取样 频率 fn = 1 / T = 200Hz ， 输入 信噪比 为 - 5dB ， ECG 的 等效 幅度 为 0.113858 , n0 = 0.286337 ， n1 = c = 1.030814 , no 、 n1 为 no ( t ) 、 n1 ( t ） 的 幅度 。 不同 参数 α 、 γ 时 的 收敛 曲线 如图 2 所示 。 由图 2 曲线 可见 ， 曲线 ① 最佳 ， 此时 α 1 = 0.986601 , γ 1 = 0.00065 , AIC 的 输出 波形 如图 3 所示 ， 图 3 波形 基本上 与 AIC 的 输入 心电图 S ( t ) 的 波形 一样 ， 说明 心电图 中 的 50Hz 干扰 基本上 完全 被 抑制 ， 此时 AIC 的 SMRE = - 33dB ， 收敛 迭代 次数 为 640 。    
 　 　 　 　 　 　 　 　 　 
 图 2 不同 参数 的 收敛 曲线 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 图 3AIC 的 输出 波形  
 　 　 为 比较 LMS 、 VMS 和 VSS 三种 算法 抑制 性能 ， 通过 调整 各 算法 的 参数 在 两种 情况 下 进行 比较 ， 一是 在 同样 的 SMRE 下 比较 各种 算法 的 收敛 迭代 次数 ， 如图 4 所示 ； 二是 在 同样 的 收敛 迭代 次数 下 比较 各种 算法 的 SMRE ， 如图 5 所示 。    
 　 　 　 　 　 　 
 图 4SMRE 相同         　 　 　 　 　 　 　 　 　 　 　 　 图 5 收敛 迭代 次数 相同  
 　 　 图 4 、 图 5 中 曲线 2 是 变 步长 变动 量 因子 LMS 算法 （ VSVMS ） ， 由于 此 算法 的 运算量 最大 ， 且 抑制 性能 较差 ， 不 适合 用于 抑制 ECG 中 50 Ｈ z 干扰 ， 所以 本文 中 不 进行 讨论 。 由图 4 、 图 5 可 得到 三种 算法 的 抑制 性能 列于 下表 1 ， 在 表中 也 比较 了 它们 的 运算量 和 调节 参数 。 
 表 1 各种 算法 的 性能 比较 
 算法 类型 SMRE = - 29dB 时 的 收敛 迭代 次数 收敛 迭代 次数 为 640 时 的 SMRE （ dB ） 运算量 调节 参数 数 
 LMS700 - 27.21 小 1 
 VMS320 - 28 大 2 
 VSS320 - 31.4 稍 大于 VMS2 
 
 　 　 由表 １ 可见 ， 抑制 性能 最好 的 是 VSS 算法 ，   而且 VSS 算法 的 运算量 稍 大于 VMS 算法 。  
 4 小结  
 　 　 由 理论 分析 和 模拟实验 结果 均 表明 ， VSS 算法 在 抑制 ECG 中 50HZ 干扰   的 抑制 性能 优于 LMS 和 其它 LMS 改进 的 算法 ， 而且 VSS   逄法 的 运算量 和 硬件 增加 不 多 ， 因此 ， 总的来说 ， VSS 算法 是 最佳 的 选择 。  
 　 　 王晋龙 、 倪敬华 、 陈学 、 宋鸿升 等 同学 参加 了 模拟实验 ， 在 此 表示感谢 ！ 
 参考文献 ：  
 [ 1 ] 杜丽冰 ． 改善 ECG 中 50Hz 干扰 的 抑制 性能 [ J ] ． 环境 技术 ， 1999 年 ， ( 1 ) ， P8 ～ 10 
 [ 2 ] R . H . Kwong   &   E . W . Johnston ,   A   Variable   Step   Sije   LMS   Algorithm ［ Ｊ ］ .   IEEE . SP - 40 , NO.7 , 1992 , PP1633 ～ 1642 〗   
 作者简介 ： 杜丽冰 ( 1937 - ) ， 女 ， 江苏 江阴人 ， 教授 ， 主要 从事 通信 理论 、 通信 与 电子系统 的 电磁兼容 和  干扰 抑制 的 教学 和 科研工作 。 
 作者 单位 ： 北京邮电大学 电信 工程学院 171 信箱 ，   北京 100876 ） 
 收稿 日期 ： 1999 - 07 - 09  
